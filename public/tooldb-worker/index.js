!function(f){"object"==typeof exports&&"undefined"!=typeof module?module.exports=f():"function"==typeof define&&define.amd?define([],f):("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).tooldbworker=f()}(function(){return function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);throw(f=new Error("Cannot find module '"+i+"'")).code="MODULE_NOT_FOUND",f}c=n[i]={exports:{}},e[i][0].call(c.exports,function(r){return o(e[i][1][r]||r)},c,c.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}({1:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.DEFAULT_PEERS=void 0;const mtgatool_db_1=require("mtgatool-db"),toolDb=(exports.DEFAULT_PEERS=["ccdde0f639db3ccb18ed2d48ed405323eac3ce86762923c1010796433e9a392dec3771400f524d4f0a466c0701cad99bbd8b509df3a467c8ca76fab7dc5504bb"],new mtgatool_db_1.ToolDb({topic:"mtgatool-db-swarm-v4",server:!1}));toolDb.on("init",key=>console.warn("ToolDb initialized!",key)),exports.DEFAULT_PEERS.forEach(peer=>{const networkModule=toolDb.network;networkModule.findServer(peer)}),toolDb.onConnect=()=>{toolDb.onConnect=()=>{}},self.onmessage=e=>{var{}=e.data}},{"mtgatool-db":268}],2:[function(require,module,exports){"use strict";const emptyOptions=Object.freeze({});function AbstractChainedBatch(db){if("object"!=typeof db||null===db)throw new TypeError("First argument must be an abstract-leveldown compliant store");this.db=db,this._operations=[],this._written=!1}AbstractChainedBatch.prototype._checkWritten=function(){if(this._written)throw new Error("write() already called on this batch")},AbstractChainedBatch.prototype.put=function(key,value,options){this._checkWritten();var err=this.db._checkKey(key)||this.db._checkValue(value);if(err)throw err;return key=this.db._serializeKey(key),value=this.db._serializeValue(value),this._put(key,value,null!=options?options:emptyOptions),this},AbstractChainedBatch.prototype._put=function(key,value,options){this._operations.push({...options,type:"put",key:key,value:value})},AbstractChainedBatch.prototype.del=function(key,options){this._checkWritten();var err=this.db._checkKey(key);if(err)throw err;return key=this.db._serializeKey(key),this._del(key,null!=options?options:emptyOptions),this},AbstractChainedBatch.prototype._del=function(key,options){this._operations.push({...options,type:"del",key:key})},AbstractChainedBatch.prototype.clear=function(){return this._checkWritten(),this._clear(),this},AbstractChainedBatch.prototype._clear=function(){this._operations=[]},AbstractChainedBatch.prototype.write=function(options,callback){if(this._checkWritten(),"function"!=typeof(callback="function"==typeof options?options:callback))throw new Error("write() requires a callback argument");"object"==typeof options&&null!==options||(options={}),this._written=!0,this._write(options,callback)},AbstractChainedBatch.prototype._write=function(options,callback){this.db._batch(this._operations,options,callback)},AbstractChainedBatch.prototype._nextTick=require("./next-tick"),module.exports=AbstractChainedBatch},{"./next-tick":7}],3:[function(require,module,exports){"use strict";function AbstractIterator(db){if("object"!=typeof db||null===db)throw new TypeError("First argument must be an abstract-leveldown compliant store");this.db=db,this._ended=!1,this._nexting=!1}AbstractIterator.prototype.next=function(callback){let ret=this;if(void 0===callback)ret=new Promise(function(resolve,reject){callback=function(err,key,value){err?reject(err):void 0===key&&void 0===value?resolve():resolve([key,value])}});else if("function"!=typeof callback)throw new Error("next() requires a callback argument");return this._ended?this._nextTick(callback,new Error("cannot call next() after end()")):this._nexting?this._nextTick(callback,new Error("cannot call next() before previous next() has completed")):(this._nexting=!0,this._next((err,...rest)=>{this._nexting=!1,callback(err,...rest)})),ret},AbstractIterator.prototype._next=function(callback){this._nextTick(callback)},AbstractIterator.prototype.seek=function(target){if(this._ended)throw new Error("cannot call seek() after end()");if(this._nexting)throw new Error("cannot call seek() before next() has completed");target=this.db._serializeKey(target),this._seek(target)},AbstractIterator.prototype._seek=function(target){},AbstractIterator.prototype.end=function(callback){let promise;if(void 0===callback)promise=new Promise(function(resolve,reject){callback=function(err){err?reject(err):resolve()}});else if("function"!=typeof callback)throw new Error("end() requires a callback argument");return this._ended?this._nextTick(callback,new Error("end() already called on iterator")):(this._ended=!0,this._end(callback)),promise},AbstractIterator.prototype._end=function(callback){this._nextTick(callback)},AbstractIterator.prototype[Symbol.asyncIterator]=async function*(){try{for(var kv;void 0!==(kv=await this.next());)yield kv}finally{this._ended||await this.end()}},AbstractIterator.prototype._nextTick=require("./next-tick"),module.exports=AbstractIterator},{"./next-tick":7}],4:[function(require,module,exports){"use strict";const supports=require("level-supports"),isBuffer=require("is-buffer"),catering=require("catering"),AbstractIterator=require("./abstract-iterator"),AbstractChainedBatch=require("./abstract-chained-batch"),getCallback=require("./lib/common").getCallback,getOptions=require("./lib/common").getOptions,hasOwnProperty=Object.prototype.hasOwnProperty,rangeOptions=["lt","lte","gt","gte"];function AbstractLevelDOWN(manifest){this.status="new",this.supports=supports(manifest,{status:!0})}function cleanRangeOptions(db,options){const result={};for(const k in options)if(hasOwnProperty.call(options,k)){if("start"===k||"end"===k)throw new Error('Legacy range options ("start" and "end") have been removed');let opt=options[k];!function(k){return-1!==rangeOptions.indexOf(k)}(k)||(opt=db._serializeKey(opt)),result[k]=opt}return result}AbstractLevelDOWN.prototype.open=function(options,callback){const oldStatus=this.status;if("function"!=typeof(callback="function"==typeof options?options:callback))throw new Error("open() requires a callback argument");(options="object"==typeof options&&null!==options?options:{}).createIfMissing=!1!==options.createIfMissing,options.errorIfExists=!!options.errorIfExists,this.status="opening",this._open(options,err=>{if(err)return this.status=oldStatus,callback(err);this.status="open",callback()})},AbstractLevelDOWN.prototype._open=function(options,callback){this._nextTick(callback)},AbstractLevelDOWN.prototype.close=function(callback){const oldStatus=this.status;if("function"!=typeof callback)throw new Error("close() requires a callback argument");this.status="closing",this._close(err=>{if(err)return this.status=oldStatus,callback(err);this.status="closed",callback()})},AbstractLevelDOWN.prototype._close=function(callback){this._nextTick(callback)},AbstractLevelDOWN.prototype.get=function(key,options,callback){if("function"!=typeof(callback="function"==typeof options?options:callback))throw new Error("get() requires a callback argument");var err=this._checkKey(key);if(err)return this._nextTick(callback,err);key=this._serializeKey(key),(options="object"==typeof options&&null!==options?options:{}).asBuffer=!1!==options.asBuffer,this._get(key,options,callback)},AbstractLevelDOWN.prototype._get=function(key,options,callback){this._nextTick(function(){callback(new Error("NotFound"))})},AbstractLevelDOWN.prototype.getMany=function(keys,options,callback){if(callback=getCallback(options,callback),callback=catering.fromCallback(callback),options=getOptions(options),function(db,callback){return!db.isOperational()&&(db._nextTick(callback,new Error("Database is not open")),!0)}(this,callback))return callback.promise;if(!Array.isArray(keys))return this._nextTick(callback,new Error("getMany() requires an array argument")),callback.promise;if(0===keys.length)return this._nextTick(callback,null,[]),callback.promise;"boolean"!=typeof options.asBuffer&&(options={...options,asBuffer:!0});const serialized=new Array(keys.length);for(let i=0;i<keys.length;i++){var key=keys[i],err=this._checkKey(key);if(err)return this._nextTick(callback,err),callback.promise;serialized[i]=this._serializeKey(key)}return this._getMany(serialized,options,callback),callback.promise},AbstractLevelDOWN.prototype._getMany=function(keys,options,callback){this._nextTick(callback,null,new Array(keys.length).fill(void 0))},AbstractLevelDOWN.prototype.put=function(key,value,options,callback){if("function"!=typeof(callback="function"==typeof options?options:callback))throw new Error("put() requires a callback argument");var err=this._checkKey(key)||this._checkValue(value);if(err)return this._nextTick(callback,err);key=this._serializeKey(key),value=this._serializeValue(value),this._put(key,value,options="object"==typeof options&&null!==options?options:{},callback)},AbstractLevelDOWN.prototype._put=function(key,value,options,callback){this._nextTick(callback)},AbstractLevelDOWN.prototype.del=function(key,options,callback){if("function"!=typeof(callback="function"==typeof options?options:callback))throw new Error("del() requires a callback argument");var err=this._checkKey(key);if(err)return this._nextTick(callback,err);key=this._serializeKey(key),this._del(key,options="object"==typeof options&&null!==options?options:{},callback)},AbstractLevelDOWN.prototype._del=function(key,options,callback){this._nextTick(callback)},AbstractLevelDOWN.prototype.batch=function(array,options,callback){if(!arguments.length)return this._chainedBatch();if("function"==typeof options&&(callback=options),"function"!=typeof(callback="function"==typeof array?array:callback))throw new Error("batch(array) requires a callback argument");if(!Array.isArray(array))return this._nextTick(callback,new Error("batch(array) requires an array argument"));if(0===array.length)return this._nextTick(callback);"object"==typeof options&&null!==options||(options={});const serialized=new Array(array.length);for(let i=0;i<array.length;i++){if("object"!=typeof array[i]||null===array[i])return this._nextTick(callback,new Error("batch(array) element must be an object and not `null`"));const e=Object.assign({},array[i]);if("put"!==e.type&&"del"!==e.type)return this._nextTick(callback,new Error("`type` must be 'put' or 'del'"));var err=this._checkKey(e.key);if(err)return this._nextTick(callback,err);if(e.key=this._serializeKey(e.key),"put"===e.type){err=this._checkValue(e.value);if(err)return this._nextTick(callback,err);e.value=this._serializeValue(e.value)}serialized[i]=e}this._batch(serialized,options,callback)},AbstractLevelDOWN.prototype._batch=function(array,options,callback){this._nextTick(callback)},AbstractLevelDOWN.prototype.clear=function(options,callback){if("function"==typeof options)callback=options;else if("function"!=typeof callback)throw new Error("clear() requires a callback argument");(options=cleanRangeOptions(this,options)).reverse=!!options.reverse,options.limit="limit"in options?options.limit:-1,this._clear(options,callback)},AbstractLevelDOWN.prototype._clear=function(options,callback){options.keys=!0,options.values=!1,options.keyAsBuffer=!0,options.valueAsBuffer=!0;const iterator=this._iterator(options),emptyOptions={},next=err=>{if(err)return iterator.end(function(){callback(err)});iterator.next((err,key)=>err?next(err):void 0===key?iterator.end(callback):void this._del(key,emptyOptions,next))};next()},AbstractLevelDOWN.prototype._setupIteratorOptions=function(options){return(options=cleanRangeOptions(this,options)).reverse=!!options.reverse,options.keys=!1!==options.keys,options.values=!1!==options.values,options.limit="limit"in options?options.limit:-1,options.keyAsBuffer=!1!==options.keyAsBuffer,options.valueAsBuffer=!1!==options.valueAsBuffer,options},AbstractLevelDOWN.prototype.iterator=function(options){return options=this._setupIteratorOptions(options="object"==typeof options&&null!==options?options:{}),this._iterator(options)},AbstractLevelDOWN.prototype._iterator=function(options){return new AbstractIterator(this)},AbstractLevelDOWN.prototype._chainedBatch=function(){return new AbstractChainedBatch(this)},AbstractLevelDOWN.prototype._serializeKey=function(key){return key},AbstractLevelDOWN.prototype._serializeValue=function(value){return value},AbstractLevelDOWN.prototype._checkKey=function(key){return null==key?new Error("key cannot be `null` or `undefined`"):isBuffer(key)&&0===key.length?new Error("key cannot be an empty Buffer"):""===key?new Error("key cannot be an empty String"):Array.isArray(key)&&0===key.length?new Error("key cannot be an empty Array"):void 0},AbstractLevelDOWN.prototype._checkValue=function(value){if(null==value)return new Error("value cannot be `null` or `undefined`")},AbstractLevelDOWN.prototype.isOperational=function(){return"open"===this.status||this._isOperational()},AbstractLevelDOWN.prototype._isOperational=function(){return!1},AbstractLevelDOWN.prototype._nextTick=require("./next-tick"),module.exports=AbstractLevelDOWN},{"./abstract-chained-batch":2,"./abstract-iterator":3,"./lib/common":6,"./next-tick":7,catering:134,"is-buffer":223,"level-supports":254}],5:[function(require,module,exports){"use strict";exports.AbstractLevelDOWN=require("./abstract-leveldown"),exports.AbstractIterator=require("./abstract-iterator"),exports.AbstractChainedBatch=require("./abstract-chained-batch")},{"./abstract-chained-batch":2,"./abstract-iterator":3,"./abstract-leveldown":4}],6:[function(require,module,exports){"use strict";exports.getCallback=function(options,callback){return"function"==typeof options?options:callback},exports.getOptions=function(options){return"object"==typeof options&&null!==options?options:{}}},{}],7:[function(require,module,exports){"use strict";const queueMicrotask=require("queue-microtask");module.exports=function(fn,...args){0===args.length?queueMicrotask(fn):queueMicrotask(()=>fn(...args))}},{"queue-microtask":362}],8:[function(require,module,exports){"use strict";const asn1=exports;asn1.bignum=require("bn.js"),asn1.define=require("./asn1/api").define,asn1.base=require("./asn1/base"),asn1.constants=require("./asn1/constants"),asn1.decoders=require("./asn1/decoders"),asn1.encoders=require("./asn1/encoders")},{"./asn1/api":9,"./asn1/base":11,"./asn1/constants":15,"./asn1/decoders":17,"./asn1/encoders":20,"bn.js":22}],9:[function(require,module,exports){"use strict";const encoders=require("./encoders"),decoders=require("./decoders"),inherits=require("inherits"),api=exports;function Entity(name,body){this.name=name,this.body=body,this.decoders={},this.encoders={}}api.define=function(name,body){return new Entity(name,body)},Entity.prototype._createNamed=function(Base){const name=this.name;function Generated(entity){this._initNamed(entity,name)}return inherits(Generated,Base),Generated.prototype._initNamed=function(entity,name){Base.call(this,entity,name)},new Generated(this)},Entity.prototype._getDecoder=function(enc){return this.decoders.hasOwnProperty(enc=enc||"der")||(this.decoders[enc]=this._createNamed(decoders[enc])),this.decoders[enc]},Entity.prototype.decode=function(data,enc,options){return this._getDecoder(enc).decode(data,options)},Entity.prototype._getEncoder=function(enc){return this.encoders.hasOwnProperty(enc=enc||"der")||(this.encoders[enc]=this._createNamed(encoders[enc])),this.encoders[enc]},Entity.prototype.encode=function(data,enc,reporter){return this._getEncoder(enc).encode(data,reporter)}},{"./decoders":17,"./encoders":20,inherits:220}],10:[function(require,module,exports){"use strict";const inherits=require("inherits"),Reporter=require("../base/reporter").Reporter,Buffer=require("safer-buffer").Buffer;function DecoderBuffer(base,options){Reporter.call(this,options),Buffer.isBuffer(base)?(this.base=base,this.offset=0,this.length=base.length):this.error("Input not Buffer")}function EncoderBuffer(value,reporter){if(Array.isArray(value))this.length=0,this.value=value.map(function(item){return EncoderBuffer.isEncoderBuffer(item)||(item=new EncoderBuffer(item,reporter)),this.length+=item.length,item},this);else if("number"==typeof value){if(!(0<=value&&value<=255))return reporter.error("non-byte EncoderBuffer value");this.value=value,this.length=1}else if("string"==typeof value)this.value=value,this.length=Buffer.byteLength(value);else{if(!Buffer.isBuffer(value))return reporter.error("Unsupported type: "+typeof value);this.value=value,this.length=value.length}}inherits(DecoderBuffer,Reporter),(exports.DecoderBuffer=DecoderBuffer).isDecoderBuffer=function(data){return data instanceof DecoderBuffer||"object"==typeof data&&Buffer.isBuffer(data.base)&&"DecoderBuffer"===data.constructor.name&&"number"==typeof data.offset&&"number"==typeof data.length&&"function"==typeof data.save&&"function"==typeof data.restore&&"function"==typeof data.isEmpty&&"function"==typeof data.readUInt8&&"function"==typeof data.skip&&"function"==typeof data.raw},DecoderBuffer.prototype.save=function(){return{offset:this.offset,reporter:Reporter.prototype.save.call(this)}},DecoderBuffer.prototype.restore=function(save){const res=new DecoderBuffer(this.base);return res.offset=save.offset,res.length=this.offset,this.offset=save.offset,Reporter.prototype.restore.call(this,save.reporter),res},DecoderBuffer.prototype.isEmpty=function(){return this.offset===this.length},DecoderBuffer.prototype.readUInt8=function(fail){return this.offset+1<=this.length?this.base.readUInt8(this.offset++,!0):this.error(fail||"DecoderBuffer overrun")},DecoderBuffer.prototype.skip=function(bytes,fail){if(!(this.offset+bytes<=this.length))return this.error(fail||"DecoderBuffer overrun");const res=new DecoderBuffer(this.base);return res._reporterState=this._reporterState,res.offset=this.offset,res.length=this.offset+bytes,this.offset+=bytes,res},DecoderBuffer.prototype.raw=function(save){return this.base.slice((save||this).offset,this.length)},(exports.EncoderBuffer=EncoderBuffer).isEncoderBuffer=function(data){return data instanceof EncoderBuffer||"object"==typeof data&&"EncoderBuffer"===data.constructor.name&&"number"==typeof data.length&&"function"==typeof data.join},EncoderBuffer.prototype.join=function(out,offset){return out=out||Buffer.alloc(this.length),offset=offset||0,0===this.length||(Array.isArray(this.value)?this.value.forEach(function(item){item.join(out,offset),offset+=item.length}):("number"==typeof this.value?out[offset]=this.value:"string"==typeof this.value?out.write(this.value,offset):Buffer.isBuffer(this.value)&&this.value.copy(out,offset),offset+=this.length)),out}},{"../base/reporter":13,inherits:220,"safer-buffer":368}],11:[function(require,module,exports){"use strict";const base=exports;base.Reporter=require("./reporter").Reporter,base.DecoderBuffer=require("./buffer").DecoderBuffer,base.EncoderBuffer=require("./buffer").EncoderBuffer,base.Node=require("./node")},{"./buffer":10,"./node":12,"./reporter":13}],12:[function(require,module,exports){"use strict";const Reporter=require("../base/reporter").Reporter,EncoderBuffer=require("../base/buffer").EncoderBuffer,DecoderBuffer=require("../base/buffer").DecoderBuffer,assert=require("minimalistic-assert"),tags=["seq","seqof","set","setof","objid","bool","gentime","utctime","null_","enum","int","objDesc","bitstr","bmpstr","charstr","genstr","graphstr","ia5str","iso646str","numstr","octstr","printstr","t61str","unistr","utf8str","videostr"],methods=["key","obj","use","optional","explicit","implicit","def","choice","any","contains"].concat(tags);function Node(enc,parent,name){const state={};(this._baseState=state).name=name,state.enc=enc,state.parent=parent||null,state.children=null,state.tag=null,state.args=null,state.reverseArgs=null,state.choice=null,state.optional=!1,state.any=!1,state.obj=!1,state.use=null,state.useDecoder=null,state.key=null,state.default=null,state.explicit=null,state.implicit=null,state.contains=null,state.parent||(state.children=[],this._wrap())}module.exports=Node;const stateProps=["enc","parent","children","tag","args","reverseArgs","choice","optional","any","obj","use","alteredUse","key","default","explicit","implicit","contains"];Node.prototype.clone=function(){const state=this._baseState,cstate={},res=(stateProps.forEach(function(prop){cstate[prop]=state[prop]}),new this.constructor(cstate.parent));return res._baseState=cstate,res},Node.prototype._wrap=function(){const state=this._baseState;methods.forEach(function(method){this[method]=function(){const clone=new this.constructor(this);return state.children.push(clone),clone[method].apply(clone,arguments)}},this)},Node.prototype._init=function(body){const state=this._baseState;assert(null===state.parent),body.call(this),state.children=state.children.filter(function(child){return child._baseState.parent===this},this),assert.equal(state.children.length,1,"Root node can have only one child")},Node.prototype._useArgs=function(args){const state=this._baseState,children=args.filter(function(arg){return arg instanceof this.constructor},this);args=args.filter(function(arg){return!(arg instanceof this.constructor)},this),0!==children.length&&(assert(null===state.children),(state.children=children).forEach(function(child){child._baseState.parent=this},this)),0!==args.length&&(assert(null===state.args),state.args=args,state.reverseArgs=args.map(function(arg){if("object"!=typeof arg||arg.constructor!==Object)return arg;const res={};return Object.keys(arg).forEach(function(key){key==(0|key)&&(key|=0);var value=arg[key];res[value]=key}),res}))},["_peekTag","_decodeTag","_use","_decodeStr","_decodeObjid","_decodeTime","_decodeNull","_decodeInt","_decodeBool","_decodeList","_encodeComposite","_encodeStr","_encodeObjid","_encodeTime","_encodeNull","_encodeInt","_encodeBool"].forEach(function(method){Node.prototype[method]=function(){var state=this._baseState;throw new Error(method+" not implemented for encoding: "+state.enc)}}),tags.forEach(function(tag){Node.prototype[tag]=function(){const state=this._baseState;var args=Array.prototype.slice.call(arguments);return assert(null===state.tag),state.tag=tag,this._useArgs(args),this}}),Node.prototype.use=function(item){assert(item);const state=this._baseState;return assert(null===state.use),state.use=item,this},Node.prototype.optional=function(){const state=this._baseState;return state.optional=!0,this},Node.prototype.def=function(val){const state=this._baseState;return assert(null===state.default),state.default=val,state.optional=!0,this},Node.prototype.explicit=function(num){const state=this._baseState;return assert(null===state.explicit&&null===state.implicit),state.explicit=num,this},Node.prototype.implicit=function(num){const state=this._baseState;return assert(null===state.explicit&&null===state.implicit),state.implicit=num,this},Node.prototype.obj=function(){const state=this._baseState;var args=Array.prototype.slice.call(arguments);return state.obj=!0,0!==args.length&&this._useArgs(args),this},Node.prototype.key=function(newKey){const state=this._baseState;return assert(null===state.key),state.key=newKey,this},Node.prototype.any=function(){const state=this._baseState;return state.any=!0,this},Node.prototype.choice=function(obj){const state=this._baseState;return assert(null===state.choice),state.choice=obj,this._useArgs(Object.keys(obj).map(function(key){return obj[key]})),this},Node.prototype.contains=function(item){const state=this._baseState;return assert(null===state.use),state.contains=item,this},Node.prototype._decode=function(input,options){const state=this._baseState;if(null===state.parent)return input.wrapResult(state.children[0]._decode(input,options));let result=state.default,present=!0,prevKey=null;if(null!==state.key&&(prevKey=input.enterKey(state.key)),state.optional){let tag=null;if(null!==state.explicit?tag=state.explicit:null!==state.implicit?tag=state.implicit:null!==state.tag&&(tag=state.tag),null!==tag||state.any){if(present=this._peekTag(input,tag,state.any),input.isError(present))return present}else{var save=input.save();try{null===state.choice?this._decodeGeneric(state.tag,input,options):this._decodeChoice(input,options),present=!0}catch(e){present=!1}input.restore(save)}}let prevObj;if(state.obj&&present&&(prevObj=input.enterObject()),present){if(null!==state.explicit){save=this._decodeTag(input,state.explicit);if(input.isError(save))return save;input=save}save=input.offset;if(null===state.use&&null===state.choice){let save;state.any&&(save=input.save());var body=this._decodeTag(input,null!==state.implicit?state.implicit:state.tag,state.any);if(input.isError(body))return body;state.any?result=input.raw(save):input=body}if(options&&options.track&&null!==state.tag&&options.track(input.path(),save,input.length,"tagged"),options&&options.track&&null!==state.tag&&options.track(input.path(),input.offset,input.length,"content"),state.any||(result=null===state.choice?this._decodeGeneric(state.tag,input,options):this._decodeChoice(input,options)),input.isError(result))return result;state.any||null!==state.choice||null===state.children||state.children.forEach(function(child){child._decode(input,options)}),!state.contains||"octstr"!==state.tag&&"bitstr"!==state.tag||(body=new DecoderBuffer(result),result=this._getUse(state.contains,input._reporterState.obj)._decode(body,options))}return state.obj&&present&&(result=input.leaveObject(prevObj)),null===state.key||null===result&&!0!==present?null!==prevKey&&input.exitKey(prevKey):input.leaveKey(prevKey,state.key,result),result},Node.prototype._decodeGeneric=function(tag,input,options){var state=this._baseState;return"seq"===tag||"set"===tag?null:"seqof"===tag||"setof"===tag?this._decodeList(input,tag,state.args[0],options):/str$/.test(tag)?this._decodeStr(input,tag,options):"objid"===tag&&state.args?this._decodeObjid(input,state.args[0],state.args[1],options):"objid"===tag?this._decodeObjid(input,null,null,options):"gentime"===tag||"utctime"===tag?this._decodeTime(input,tag,options):"null_"===tag?this._decodeNull(input,options):"bool"===tag?this._decodeBool(input,options):"objDesc"===tag?this._decodeStr(input,tag,options):"int"===tag||"enum"===tag?this._decodeInt(input,state.args&&state.args[0],options):null!==state.use?this._getUse(state.use,input._reporterState.obj)._decode(input,options):input.error("unknown tag: "+tag)},Node.prototype._getUse=function(entity,obj){const state=this._baseState;return state.useDecoder=this._use(entity,obj),assert(null===state.useDecoder._baseState.parent),state.useDecoder=state.useDecoder._baseState.children[0],state.implicit!==state.useDecoder._baseState.implicit&&(state.useDecoder=state.useDecoder.clone(),state.useDecoder._baseState.implicit=state.implicit),state.useDecoder},Node.prototype._decodeChoice=function(input,options){const state=this._baseState;let result=null,match=!1;return Object.keys(state.choice).some(function(key){var save=input.save();const node=state.choice[key];try{var value=node._decode(input,options);if(input.isError(value))return!1;result={type:key,value:value},match=!0}catch(e){return input.restore(save),!1}return!0},this),match?result:input.error("Choice not matched")},Node.prototype._createEncoderBuffer=function(data){return new EncoderBuffer(data,this.reporter)},Node.prototype._encode=function(data,reporter,parent){var state=this._baseState;if(null===state.default||state.default!==data){state=this._encodeValue(data,reporter,parent);if(void 0!==state&&!this._skipDefault(state,reporter,parent))return state}},Node.prototype._encodeValue=function(data,reporter,parent){const state=this._baseState;if(null===state.parent)return state.children[0]._encode(data,reporter||new Reporter);let result=null;if(this.reporter=reporter,state.optional&&void 0===data){if(null===state.default)return;data=state.default}let content=null,primitive=!1;if(state.any)result=this._createEncoderBuffer(data);else if(state.choice)result=this._encodeChoice(data,reporter);else if(state.contains)content=this._getUse(state.contains,parent)._encode(data,reporter),primitive=!0;else if(state.children)content=state.children.map(function(child){if("null_"===child._baseState.tag)return child._encode(null,reporter,data);if(null===child._baseState.key)return reporter.error("Child should have a key");var prevKey=reporter.enterKey(child._baseState.key);if("object"!=typeof data)return reporter.error("Child expected, but input is not object");child=child._encode(data[child._baseState.key],reporter,data);return reporter.leaveKey(prevKey),child},this).filter(function(child){return child}),content=this._createEncoderBuffer(content);else if("seqof"===state.tag||"setof"===state.tag){if(!state.args||1!==state.args.length)return reporter.error("Too many args for : "+state.tag);if(!Array.isArray(data))return reporter.error("seqof/setof, but data is not Array");const child=this.clone();child._baseState.implicit=null,content=this._createEncoderBuffer(data.map(function(item){var state=this._baseState;return this._getUse(state.args[0],data)._encode(item,reporter)},child))}else null!==state.use?result=this._getUse(state.use,parent)._encode(data,reporter):(content=this._encodePrimitive(state.tag,data),primitive=!0);var cls;return state.any||null!==state.choice||(parent=null!==state.implicit?state.implicit:state.tag,cls=null===state.implicit?"universal":"context",null===parent?null===state.use&&reporter.error("Tag could be omitted only for .use()"):null===state.use&&(result=this._encodeComposite(parent,primitive,cls,content))),result=null!==state.explicit?this._encodeComposite(state.explicit,!1,"context",result):result},Node.prototype._encodeChoice=function(data,reporter){var state=this._baseState;const node=state.choice[data.type];return node||assert(!1,data.type+" not found in "+JSON.stringify(Object.keys(state.choice))),node._encode(data.value,reporter)},Node.prototype._encodePrimitive=function(tag,data){var state=this._baseState;if(/str$/.test(tag))return this._encodeStr(data,tag);if("objid"===tag&&state.args)return this._encodeObjid(data,state.reverseArgs[0],state.args[1]);if("objid"===tag)return this._encodeObjid(data,null,null);if("gentime"===tag||"utctime"===tag)return this._encodeTime(data,tag);if("null_"===tag)return this._encodeNull();if("int"===tag||"enum"===tag)return this._encodeInt(data,state.args&&state.reverseArgs[0]);if("bool"===tag)return this._encodeBool(data);if("objDesc"===tag)return this._encodeStr(data,tag);throw new Error("Unsupported tag: "+tag)},Node.prototype._isNumstr=function(str){return/^[0-9 ]*$/.test(str)},Node.prototype._isPrintstr=function(str){return/^[A-Za-z0-9 '()+,-./:=?]*$/.test(str)}},{"../base/buffer":10,"../base/reporter":13,"minimalistic-assert":265}],13:[function(require,module,exports){"use strict";const inherits=require("inherits");function Reporter(options){this._reporterState={obj:null,path:[],options:options||{},errors:[]}}function ReporterError(path,msg){this.path=path,this.rethrow(msg)}(exports.Reporter=Reporter).prototype.isError=function(obj){return obj instanceof ReporterError},Reporter.prototype.save=function(){var state=this._reporterState;return{obj:state.obj,pathLen:state.path.length}},Reporter.prototype.restore=function(data){const state=this._reporterState;state.obj=data.obj,state.path=state.path.slice(0,data.pathLen)},Reporter.prototype.enterKey=function(key){return this._reporterState.path.push(key)},Reporter.prototype.exitKey=function(index){const state=this._reporterState;state.path=state.path.slice(0,index-1)},Reporter.prototype.leaveKey=function(index,key,value){const state=this._reporterState;this.exitKey(index),null!==state.obj&&(state.obj[key]=value)},Reporter.prototype.path=function(){return this._reporterState.path.join("/")},Reporter.prototype.enterObject=function(){const state=this._reporterState;var prev=state.obj;return state.obj={},prev},Reporter.prototype.leaveObject=function(prev){const state=this._reporterState;var now=state.obj;return state.obj=prev,now},Reporter.prototype.error=function(msg){let err;const state=this._reporterState;var inherited=msg instanceof ReporterError;if(err=inherited?msg:new ReporterError(state.path.map(function(elem){return"["+JSON.stringify(elem)+"]"}).join(""),msg.message||msg,msg.stack),state.options.partial)return inherited||state.errors.push(err),err;throw err},Reporter.prototype.wrapResult=function(result){var state=this._reporterState;return state.options.partial?{result:this.isError(result)?null:result,errors:state.errors}:result},inherits(ReporterError,Error),ReporterError.prototype.rethrow=function(msg){if(this.message=msg+" at: "+(this.path||"(shallow)"),Error.captureStackTrace&&Error.captureStackTrace(this,ReporterError),!this.stack)try{throw new Error(this.message)}catch(e){this.stack=e.stack}return this}},{inherits:220}],14:[function(require,module,exports){"use strict";function reverse(map){const res={};return Object.keys(map).forEach(function(key){(0|key)==key&&(key|=0);var value=map[key];res[value]=key}),res}exports.tagClass={0:"universal",1:"application",2:"context",3:"private"},exports.tagClassByName=reverse(exports.tagClass),exports.tag={0:"end",1:"bool",2:"int",3:"bitstr",4:"octstr",5:"null_",6:"objid",7:"objDesc",8:"external",9:"real",10:"enum",11:"embed",12:"utf8str",13:"relativeOid",16:"seq",17:"set",18:"numstr",19:"printstr",20:"t61str",21:"videostr",22:"ia5str",23:"utctime",24:"gentime",25:"graphstr",26:"iso646str",27:"genstr",28:"unistr",29:"charstr",30:"bmpstr"},exports.tagByName=reverse(exports.tag)},{}],15:[function(require,module,exports){"use strict";const constants=exports;constants._reverse=function(map){const res={};return Object.keys(map).forEach(function(key){(0|key)==key&&(key|=0);var value=map[key];res[value]=key}),res},constants.der=require("./der")},{"./der":14}],16:[function(require,module,exports){"use strict";const inherits=require("inherits"),bignum=require("bn.js"),DecoderBuffer=require("../base/buffer").DecoderBuffer,Node=require("../base/node"),der=require("../constants/der");function DERDecoder(entity){this.enc="der",this.name=entity.name,this.entity=entity,this.tree=new DERNode,this.tree._init(entity.body)}function DERNode(parent){Node.call(this,"der",parent)}function derDecodeTag(buf,fail){let tag=buf.readUInt8(fail);if(buf.isError(tag))return tag;var cls=der.tagClass[tag>>6],primitive=0==(32&tag);if(31==(31&tag)){let oct=tag;for(tag=0;128==(128&oct);){if(oct=buf.readUInt8(fail),buf.isError(oct))return oct;tag=(tag<<=7)|127&oct}}else tag&=31;var tagStr=der.tag[tag];return{cls:cls,primitive:primitive,tag:tag,tagStr:tagStr}}function derDecodeLen(buf,primitive,fail){let len=buf.readUInt8(fail);if(buf.isError(len))return len;if(!primitive&&128===len)return null;if(0==(128&len))return len;var num=127&len;if(4<num)return buf.error("length octect is too long");for(let i=len=0;i<num;i++){len<<=8;var j=buf.readUInt8(fail);if(buf.isError(j))return j;len|=j}return len}(module.exports=DERDecoder).prototype.decode=function(data,options){return DecoderBuffer.isDecoderBuffer(data)||(data=new DecoderBuffer(data,options)),this.tree._decode(data,options)},inherits(DERNode,Node),DERNode.prototype._peekTag=function(buffer,tag,any){if(buffer.isEmpty())return!1;var state=buffer.save(),decodedTag=derDecodeTag(buffer,'Failed to peek tag: "'+tag+'"');return buffer.isError(decodedTag)?decodedTag:(buffer.restore(state),decodedTag.tag===tag||decodedTag.tagStr===tag||decodedTag.tagStr+"of"===tag||any)},DERNode.prototype._decodeTag=function(buffer,tag,any){var decodedTag=derDecodeTag(buffer,'Failed to decode tag of "'+tag+'"');if(buffer.isError(decodedTag))return decodedTag;let len=derDecodeLen(buffer,decodedTag.primitive,'Failed to get length of "'+tag+'"');if(buffer.isError(len))return len;if(!any&&decodedTag.tag!==tag&&decodedTag.tagStr!==tag&&decodedTag.tagStr+"of"!==tag)return buffer.error('Failed to match tag: "'+tag+'"');if(decodedTag.primitive||null!==len)return buffer.skip(len,'Failed to match body of: "'+tag+'"');any=buffer.save(),decodedTag=this._skipUntilEnd(buffer,'Failed to skip indefinite length body: "'+this.tag+'"');return buffer.isError(decodedTag)?decodedTag:(len=buffer.offset-any.offset,buffer.restore(any),buffer.skip(len,'Failed to match body of: "'+tag+'"'))},DERNode.prototype._skipUntilEnd=function(buffer,fail){for(;;){var tag=derDecodeTag(buffer,fail);if(buffer.isError(tag))return tag;var len=derDecodeLen(buffer,tag.primitive,fail);if(buffer.isError(len))return len;let res;if(res=tag.primitive||null!==len?buffer.skip(len):this._skipUntilEnd(buffer,fail),buffer.isError(res))return res;if("end"===tag.tagStr)break}},DERNode.prototype._decodeList=function(buffer,tag,decoder,options){const result=[];for(;!buffer.isEmpty();){var possibleEnd=this._peekTag(buffer,"end");if(buffer.isError(possibleEnd))return possibleEnd;var res=decoder.decode(buffer,"der",options);if(buffer.isError(res)&&possibleEnd)break;result.push(res)}return result},DERNode.prototype._decodeStr=function(buffer,tag){var unused;if("bitstr"===tag)return unused=buffer.readUInt8(),buffer.isError(unused)?unused:{unused:unused,data:buffer.raw()};if("bmpstr"!==tag)return"numstr"===tag?(unused=buffer.raw().toString("ascii"),this._isNumstr(unused)?unused:buffer.error("Decoding of string type: numstr unsupported characters")):"octstr"===tag||"objDesc"===tag?buffer.raw():"printstr"===tag?(unused=buffer.raw().toString("ascii"),this._isPrintstr(unused)?unused:buffer.error("Decoding of string type: printstr unsupported characters")):/str$/.test(tag)?buffer.raw().toString():buffer.error("Decoding of string type: "+tag+" unsupported");{const raw=buffer.raw();if(raw.length%2==1)return buffer.error("Decoding of string type: bmpstr length mismatch");let str="";for(let i=0;i<raw.length/2;i++)str+=String.fromCharCode(raw.readUInt16BE(2*i));return str}},DERNode.prototype._decodeObjid=function(buffer,values,relative){let result;const identifiers=[];let ident=0,subident=0;for(;!buffer.isEmpty();)subident=buffer.readUInt8(),ident=(ident<<=7)|127&subident,0==(128&subident)&&(identifiers.push(ident),ident=0);128&subident&&identifiers.push(ident);const first=identifiers[0]/40|0,second=identifiers[0]%40;if(result=relative?identifiers:[first,second].concat(identifiers.slice(1)),values){let tmp=values[result.join(" ")];void 0!==(tmp=void 0===tmp?values[result.join(".")]:tmp)&&(result=tmp)}return result},DERNode.prototype._decodeTime=function(buffer,tag){const str=buffer.raw().toString();let year,mon,day,hour,min,sec;if("gentime"===tag)year=0|str.slice(0,4),mon=0|str.slice(4,6),day=0|str.slice(6,8),hour=0|str.slice(8,10),min=0|str.slice(10,12),sec=0|str.slice(12,14);else{if("utctime"!==tag)return buffer.error("Decoding "+tag+" time is not supported yet");year=0|str.slice(0,2),mon=0|str.slice(2,4),day=0|str.slice(4,6),hour=0|str.slice(6,8),min=0|str.slice(8,10),sec=0|str.slice(10,12),year=year<70?2e3+year:1900+year}return Date.UTC(year,mon-1,day,hour,min,sec,0)},DERNode.prototype._decodeNull=function(){return null},DERNode.prototype._decodeBool=function(buffer){var res=buffer.readUInt8();return buffer.isError(res)?res:0!==res},DERNode.prototype._decodeInt=function(buffer,values){buffer=buffer.raw();let res=new bignum(buffer);return res=values?values[res.toString(10)]||res:res},DERNode.prototype._use=function(entity,obj){return(entity="function"==typeof entity?entity(obj):entity)._getDecoder("der").tree}},{"../base/buffer":10,"../base/node":12,"../constants/der":14,"bn.js":22,inherits:220}],17:[function(require,module,exports){"use strict";const decoders=exports;decoders.der=require("./der"),decoders.pem=require("./pem")},{"./der":16,"./pem":18}],18:[function(require,module,exports){"use strict";const inherits=require("inherits"),Buffer=require("safer-buffer").Buffer,DERDecoder=require("./der");function PEMDecoder(entity){DERDecoder.call(this,entity),this.enc="pem"}inherits(PEMDecoder,DERDecoder),(module.exports=PEMDecoder).prototype.decode=function(data,options){const lines=data.toString().split(/[\r\n]+/g);var label=options.label.toUpperCase(),re=/^-----(BEGIN|END) ([^-]+)-----$/;let start=-1,end=-1;for(let i=0;i<lines.length;i++){var match=lines[i].match(re);if(null!==match&&match[2]===label){if(-1!==start){if("END"!==match[1])break;end=i;break}if("BEGIN"!==match[1])break;start=i}}if(-1===start||-1===end)throw new Error("PEM section not found for: "+label);const base64=lines.slice(start+1,end).join("");base64.replace(/[^a-z0-9+/=]+/gi,"");data=Buffer.from(base64,"base64");return DERDecoder.prototype.decode.call(this,data,options)}},{"./der":16,inherits:220,"safer-buffer":368}],19:[function(require,module,exports){"use strict";const inherits=require("inherits"),Buffer=require("safer-buffer").Buffer,Node=require("../base/node"),der=require("../constants/der");function DEREncoder(entity){this.enc="der",this.name=entity.name,this.entity=entity,this.tree=new DERNode,this.tree._init(entity.body)}function DERNode(parent){Node.call(this,"der",parent)}function two(num){return num<10?"0"+num:num}(module.exports=DEREncoder).prototype.encode=function(data,reporter){return this.tree._encode(data,reporter).join()},inherits(DERNode,Node),DERNode.prototype._encodeComposite=function(tag,primitive,cls,content){tag=function(tag,primitive,cls,reporter){let res;"seqof"===tag?tag="seq":"setof"===tag&&(tag="set");if(der.tagByName.hasOwnProperty(tag))res=der.tagByName[tag];else{if("number"!=typeof tag||(0|tag)!==tag)return reporter.error("Unknown tag: "+tag);res=tag}if(31<=res)return reporter.error("Multi-octet tag encoding unsupported");primitive||(res|=32);return res|=der.tagClassByName[cls||"universal"]<<6}(tag,primitive,cls,this.reporter);if(content.length<128){const header=Buffer.alloc(2);return header[0]=tag,header[1]=content.length,this._createEncoderBuffer([header,content])}let lenOctets=1;for(let i=content.length;256<=i;i>>=8)lenOctets++;const header=Buffer.alloc(2+lenOctets);header[0]=tag,header[1]=128|lenOctets;for(let i=1+lenOctets,j=content.length;0<j;i--,j>>=8)header[i]=255&j;return this._createEncoderBuffer([header,content])},DERNode.prototype._encodeStr=function(str,tag){if("bitstr"===tag)return this._createEncoderBuffer([0|str.unused,str.data]);if("bmpstr"!==tag)return"numstr"===tag?this._isNumstr(str)?this._createEncoderBuffer(str):this.reporter.error("Encoding of string type: numstr supports only digits and space"):"printstr"===tag?this._isPrintstr(str)?this._createEncoderBuffer(str):this.reporter.error("Encoding of string type: printstr supports only latin upper and lower case letters, digits, space, apostrophe, left and rigth parenthesis, plus sign, comma, hyphen, dot, slash, colon, equal sign, question mark"):/str$/.test(tag)||"objDesc"===tag?this._createEncoderBuffer(str):this.reporter.error("Encoding of string type: "+tag+" unsupported");{const buf=Buffer.alloc(2*str.length);for(let i=0;i<str.length;i++)buf.writeUInt16BE(str.charCodeAt(i),2*i);return this._createEncoderBuffer(buf)}},DERNode.prototype._encodeObjid=function(id,values,relative){if("string"==typeof id){if(!values)return this.reporter.error("string objid given, but no values map found");if(!values.hasOwnProperty(id))return this.reporter.error("objid not found in values map");id=values[id].split(/[\s.]+/g);for(let i=0;i<id.length;i++)id[i]|=0}else if(Array.isArray(id)){id=id.slice();for(let i=0;i<id.length;i++)id[i]|=0}if(!Array.isArray(id))return this.reporter.error("objid() should be either array or string, got: "+JSON.stringify(id));if(!relative){if(40<=id[1])return this.reporter.error("Second objid identifier OOB");id.splice(0,2,40*id[0]+id[1])}let size=0;for(let i=0;i<id.length;i++){let ident=id[i];for(size++;128<=ident;ident>>=7)size++}const objid=Buffer.alloc(size);let offset=objid.length-1;for(let i=id.length-1;0<=i;i--){let ident=id[i];for(objid[offset--]=127&ident;0<(ident>>=7);)objid[offset--]=128|127&ident}return this._createEncoderBuffer(objid)},DERNode.prototype._encodeTime=function(time,tag){let str;const date=new Date(time);return"gentime"===tag?str=[two(date.getUTCFullYear()),two(date.getUTCMonth()+1),two(date.getUTCDate()),two(date.getUTCHours()),two(date.getUTCMinutes()),two(date.getUTCSeconds()),"Z"].join(""):"utctime"===tag?str=[two(date.getUTCFullYear()%100),two(date.getUTCMonth()+1),two(date.getUTCDate()),two(date.getUTCHours()),two(date.getUTCMinutes()),two(date.getUTCSeconds()),"Z"].join(""):this.reporter.error("Encoding "+tag+" time is not supported yet"),this._encodeStr(str,"octstr")},DERNode.prototype._encodeNull=function(){return this._createEncoderBuffer("")},DERNode.prototype._encodeInt=function(num,values){if("string"==typeof num){if(!values)return this.reporter.error("String int or enum given, but no values map");if(!values.hasOwnProperty(num))return this.reporter.error("Values map doesn't contain: "+JSON.stringify(num));num=values[num]}if("number"!=typeof num&&!Buffer.isBuffer(num)){const numArray=num.toArray();!num.sign&&128&numArray[0]&&numArray.unshift(0),num=Buffer.from(numArray)}if(Buffer.isBuffer(num)){let size=num.length;0===num.length&&size++;const out=Buffer.alloc(size);return num.copy(out),0===num.length&&(out[0]=0),this._createEncoderBuffer(out)}if(num<128)return this._createEncoderBuffer(num);if(num<256)return this._createEncoderBuffer([0,num]);let size=1;for(let i=num;256<=i;i>>=8)size++;const out=new Array(size);for(let i=out.length-1;0<=i;i--)out[i]=255&num,num>>=8;return 128&out[0]&&out.unshift(0),this._createEncoderBuffer(Buffer.from(out))},DERNode.prototype._encodeBool=function(value){return this._createEncoderBuffer(value?255:0)},DERNode.prototype._use=function(entity,obj){return(entity="function"==typeof entity?entity(obj):entity)._getEncoder("der").tree},DERNode.prototype._skipDefault=function(dataBuffer,reporter,parent){const state=this._baseState;let i;if(null===state.default)return!1;var data=dataBuffer.join();if(void 0===state.defaultBuffer&&(state.defaultBuffer=this._encodeValue(state.default,reporter,parent).join()),data.length!==state.defaultBuffer.length)return!1;for(i=0;i<data.length;i++)if(data[i]!==state.defaultBuffer[i])return!1;return!0}},{"../base/node":12,"../constants/der":14,inherits:220,"safer-buffer":368}],20:[function(require,module,exports){"use strict";const encoders=exports;encoders.der=require("./der"),encoders.pem=require("./pem")},{"./der":19,"./pem":21}],21:[function(require,module,exports){"use strict";const inherits=require("inherits"),DEREncoder=require("./der");function PEMEncoder(entity){DEREncoder.call(this,entity),this.enc="pem"}inherits(PEMEncoder,DEREncoder),(module.exports=PEMEncoder).prototype.encode=function(data,options){const buf=DEREncoder.prototype.encode.call(this,data),p=buf.toString("base64"),out=["-----BEGIN "+options.label+"-----"];for(let i=0;i<p.length;i+=64)out.push(p.slice(i,i+64));return out.push("-----END "+options.label+"-----"),out.join("\n")}},{"./der":19,inherits:220}],22:[function(require,module,exports){!function(module,exports){"use strict";function assert(val,msg){if(!val)throw new Error(msg||"Assertion failed")}function inherits(ctor,superCtor){ctor.super_=superCtor;function TempCtor(){}TempCtor.prototype=superCtor.prototype,ctor.prototype=new TempCtor,ctor.prototype.constructor=ctor}function BN(number,base,endian){if(BN.isBN(number))return number;this.negative=0,this.words=null,this.length=0,(this.red=null)!==number&&("le"!==base&&"be"!==base||(endian=base,base=10),this._init(number||0,base||10,endian||"be"))}var Buffer;"object"==typeof module?module.exports=BN:exports.BN=BN,(BN.BN=BN).wordSize=26;try{Buffer=("undefined"!=typeof window&&void 0!==window.Buffer?window:require("buffer")).Buffer}catch(e){}function parseHex4Bits(string,index){string=string.charCodeAt(index);return 65<=string&&string<=70?string-55:97<=string&&string<=102?string-87:string-48&15}function parseHexByte(string,lowerBound,index){var r=parseHex4Bits(string,index);return lowerBound<=index-1&&(r|=parseHex4Bits(string,index-1)<<4),r}function parseBase(str,start,end,mul){for(var r=0,len=Math.min(str.length,end),i=start;i<len;i++)var c=str.charCodeAt(i)-48,r=r*mul+(49<=c?c-49+10:17<=c?c-17+10:c);return r}BN.isBN=function(num){return num instanceof BN||null!==num&&"object"==typeof num&&num.constructor.wordSize===BN.wordSize&&Array.isArray(num.words)},BN.max=function(left,right){return 0<left.cmp(right)?left:right},BN.min=function(left,right){return left.cmp(right)<0?left:right},BN.prototype._init=function(number,base,endian){if("number"==typeof number)return this._initNumber(number,base,endian);if("object"==typeof number)return this._initArray(number,base,endian);assert((base="hex"===base?16:base)===(0|base)&&2<=base&&base<=36);var start=0;"-"===(number=number.toString().replace(/\s+/g,""))[0]&&(start++,this.negative=1),start<number.length&&(16===base?this._parseHex(number,start,endian):(this._parseBase(number,base,start),"le"===endian&&this._initArray(this.toArray(),base,endian)))},BN.prototype._initNumber=function(number,base,endian){number<0&&(this.negative=1,number=-number),number<67108864?(this.words=[67108863&number],this.length=1):number<4503599627370496?(this.words=[67108863&number,number/67108864&67108863],this.length=2):(assert(number<9007199254740992),this.words=[67108863&number,number/67108864&67108863,1],this.length=3),"le"===endian&&this._initArray(this.toArray(),base,endian)},BN.prototype._initArray=function(number,base,endian){if(assert("number"==typeof number.length),number.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(number.length/3),this.words=new Array(this.length);for(var j,w,i=0;i<this.length;i++)this.words[i]=0;var off=0;if("be"===endian)for(i=number.length-1,j=0;0<=i;i-=3)w=number[i]|number[i-1]<<8|number[i-2]<<16,this.words[j]|=w<<off&67108863,this.words[j+1]=w>>>26-off&67108863,26<=(off+=24)&&(off-=26,j++);else if("le"===endian)for(j=i=0;i<number.length;i+=3)w=number[i]|number[i+1]<<8|number[i+2]<<16,this.words[j]|=w<<off&67108863,this.words[j+1]=w>>>26-off&67108863,26<=(off+=24)&&(off-=26,j++);return this.strip()},BN.prototype._parseHex=function(number,start,endian){this.length=Math.ceil((number.length-start)/6),this.words=new Array(this.length);for(var i=0;i<this.length;i++)this.words[i]=0;var w,off=0,j=0;if("be"===endian)for(i=number.length-1;start<=i;i-=2)w=parseHexByte(number,start,i)<<off,this.words[j]|=67108863&w,18<=off?(off-=18,this.words[j+=1]|=w>>>26):off+=8;else for(i=(number.length-start)%2==0?start+1:start;i<number.length;i+=2)w=parseHexByte(number,start,i)<<off,this.words[j]|=67108863&w,18<=off?(off-=18,this.words[j+=1]|=w>>>26):off+=8;this.strip()},BN.prototype._parseBase=function(number,base,start){this.words=[0];for(var limbLen=0,limbPow=this.length=1;limbPow<=67108863;limbPow*=base)limbLen++;for(var limbPow=limbPow/base|0,total=number.length-start,mod=total%--limbLen,end=Math.min(total,total-mod)+start,word=0,i=start;i<end;i+=limbLen)word=parseBase(number,i,i+limbLen,base),this.imuln(limbPow),this.words[0]+word<67108864?this.words[0]+=word:this._iaddn(word);if(0!=mod){for(var pow=1,word=parseBase(number,i,number.length,base),i=0;i<mod;i++)pow*=base;this.imuln(pow),this.words[0]+word<67108864?this.words[0]+=word:this._iaddn(word)}this.strip()},BN.prototype.copy=function(dest){dest.words=new Array(this.length);for(var i=0;i<this.length;i++)dest.words[i]=this.words[i];dest.length=this.length,dest.negative=this.negative,dest.red=this.red},BN.prototype.clone=function(){var r=new BN(null);return this.copy(r),r},BN.prototype._expand=function(size){for(;this.length<size;)this.words[this.length++]=0;return this},BN.prototype.strip=function(){for(;1<this.length&&0===this.words[this.length-1];)this.length--;return this._normSign()},BN.prototype._normSign=function(){return 1===this.length&&0===this.words[0]&&(this.negative=0),this},BN.prototype.inspect=function(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"};var zeros=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],groupSizes=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],groupBases=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];function smallMulTo(self,num,out){out.negative=num.negative^self.negative;var len=self.length+num.length|0,len=(out.length=len)-1|0,carry=(r=(0|self.words[0])*(0|num.words[0]))/67108864|0;out.words[0]=67108863&r;for(var k=1;k<len;k++){for(var r,ncarry=carry>>>26,rword=67108863&carry,maxJ=Math.min(k,num.length-1),j=Math.max(0,k-self.length+1);j<=maxJ;j++)ncarry+=(r=(0|self.words[k-j|0])*(0|num.words[j])+rword)/67108864|0,rword=67108863&r;out.words[k]=0|rword,carry=0|ncarry}return 0!==carry?out.words[k]=0|carry:out.length--,out.strip()}BN.prototype.toString=function(base,padding){if(padding=0|padding||1,16===(base=base||10)||"hex"===base){out="";for(var off=0,carry=0,i=0;i<this.length;i++){var w=this.words[i],word=(16777215&(w<<off|carry)).toString(16),out=0!==(carry=w>>>24-off&16777215)||i!==this.length-1?zeros[6-word.length]+word+out:word+out;26<=(off+=2)&&(off-=26,i--)}for(0!==carry&&(out=carry.toString(16)+out);out.length%padding!=0;)out="0"+out;return out=0!==this.negative?"-"+out:out}if(base===(0|base)&&2<=base&&base<=36){var groupSize=groupSizes[base],groupBase=groupBases[base];for(out="",(c=this.clone()).negative=0;!c.isZero();){var c,r=c.modn(groupBase).toString(base);out=(c=c.idivn(groupBase)).isZero()?r+out:zeros[groupSize-r.length]+r+out}for(this.isZero()&&(out="0"+out);out.length%padding!=0;)out="0"+out;return out=0!==this.negative?"-"+out:out}assert(!1,"Base should be between 2 and 36")},BN.prototype.toNumber=function(){var ret=this.words[0];return 2===this.length?ret+=67108864*this.words[1]:3===this.length&&1===this.words[2]?ret+=4503599627370496+67108864*this.words[1]:2<this.length&&assert(!1,"Number can only safely store up to 53 bits"),0!==this.negative?-ret:ret},BN.prototype.toJSON=function(){return this.toString(16)},BN.prototype.toBuffer=function(endian,length){return assert(void 0!==Buffer),this.toArrayLike(Buffer,endian,length)},BN.prototype.toArray=function(endian,length){return this.toArrayLike(Array,endian,length)},BN.prototype.toArrayLike=function(ArrayType,endian,length){var b,i,byteLength=this.byteLength(),reqLength=length||Math.max(1,byteLength),length=(assert(byteLength<=reqLength,"byte array longer than desired length"),assert(0<reqLength,"Requested array length <= 0"),this.strip(),"le"===endian),res=new ArrayType(reqLength),q=this.clone();if(length){for(i=0;!q.isZero();i++)b=q.andln(255),q.iushrn(8),res[i]=b;for(;i<reqLength;i++)res[i]=0}else{for(i=0;i<reqLength-byteLength;i++)res[i]=0;for(i=0;!q.isZero();i++)b=q.andln(255),q.iushrn(8),res[reqLength-i-1]=b}return res},Math.clz32?BN.prototype._countBits=function(w){return 32-Math.clz32(w)}:BN.prototype._countBits=function(w){var r=0;return 4096<=w&&(r+=13,w>>>=13),64<=w&&(r+=7,w>>>=7),8<=w&&(r+=4,w>>>=4),2<=w&&(r+=2,w>>>=2),r+w},BN.prototype._zeroBits=function(w){if(0===w)return 26;var r=0;return 0==(8191&w)&&(r+=13,w>>>=13),0==(127&w)&&(r+=7,w>>>=7),0==(15&w)&&(r+=4,w>>>=4),0==(3&w)&&(r+=2,w>>>=2),0==(1&w)&&r++,r},BN.prototype.bitLength=function(){var w=this.words[this.length-1],w=this._countBits(w);return 26*(this.length-1)+w},BN.prototype.zeroBits=function(){if(this.isZero())return 0;for(var r=0,i=0;i<this.length;i++){var b=this._zeroBits(this.words[i]);if(r+=b,26!==b)break}return r},BN.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},BN.prototype.toTwos=function(width){return 0!==this.negative?this.abs().inotn(width).iaddn(1):this.clone()},BN.prototype.fromTwos=function(width){return this.testn(width-1)?this.notn(width).iaddn(1).ineg():this.clone()},BN.prototype.isNeg=function(){return 0!==this.negative},BN.prototype.neg=function(){return this.clone().ineg()},BN.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},BN.prototype.iuor=function(num){for(;this.length<num.length;)this.words[this.length++]=0;for(var i=0;i<num.length;i++)this.words[i]=this.words[i]|num.words[i];return this.strip()},BN.prototype.ior=function(num){return assert(0==(this.negative|num.negative)),this.iuor(num)},BN.prototype.or=function(num){return this.length>num.length?this.clone().ior(num):num.clone().ior(this)},BN.prototype.uor=function(num){return this.length>num.length?this.clone().iuor(num):num.clone().iuor(this)},BN.prototype.iuand=function(num){for(var b=this.length>num.length?num:this,i=0;i<b.length;i++)this.words[i]=this.words[i]&num.words[i];return this.length=b.length,this.strip()},BN.prototype.iand=function(num){return assert(0==(this.negative|num.negative)),this.iuand(num)},BN.prototype.and=function(num){return this.length>num.length?this.clone().iand(num):num.clone().iand(this)},BN.prototype.uand=function(num){return this.length>num.length?this.clone().iuand(num):num.clone().iuand(this)},BN.prototype.iuxor=function(num){for(var a,b=this.length>num.length?(a=this,num):(a=num,this),i=0;i<b.length;i++)this.words[i]=a.words[i]^b.words[i];if(this!==a)for(;i<a.length;i++)this.words[i]=a.words[i];return this.length=a.length,this.strip()},BN.prototype.ixor=function(num){return assert(0==(this.negative|num.negative)),this.iuxor(num)},BN.prototype.xor=function(num){return this.length>num.length?this.clone().ixor(num):num.clone().ixor(this)},BN.prototype.uxor=function(num){return this.length>num.length?this.clone().iuxor(num):num.clone().iuxor(this)},BN.prototype.inotn=function(width){assert("number"==typeof width&&0<=width);var bytesNeeded=0|Math.ceil(width/26),width=width%26;this._expand(bytesNeeded),0<width&&bytesNeeded--;for(var i=0;i<bytesNeeded;i++)this.words[i]=67108863&~this.words[i];return 0<width&&(this.words[i]=~this.words[i]&67108863>>26-width),this.strip()},BN.prototype.notn=function(width){return this.clone().inotn(width)},BN.prototype.setn=function(bit,val){assert("number"==typeof bit&&0<=bit);var off=bit/26|0,bit=bit%26;return this._expand(1+off),this.words[off]=val?this.words[off]|1<<bit:this.words[off]&~(1<<bit),this.strip()},BN.prototype.iadd=function(num){var r,a;if(0!==this.negative&&0===num.negative)return this.negative=0,r=this.isub(num),this.negative^=1,this._normSign();if(0===this.negative&&0!==num.negative)return num.negative=0,r=this.isub(num),num.negative=1,r._normSign();for(var b=this.length>num.length?(a=this,num):(a=num,this),carry=0,i=0;i<b.length;i++)r=(0|a.words[i])+(0|b.words[i])+carry,this.words[i]=67108863&r,carry=r>>>26;for(;0!==carry&&i<a.length;i++)r=(0|a.words[i])+carry,this.words[i]=67108863&r,carry=r>>>26;if(this.length=a.length,0!==carry)this.words[this.length]=carry,this.length++;else if(a!==this)for(;i<a.length;i++)this.words[i]=a.words[i];return this},BN.prototype.add=function(num){var res;return 0!==num.negative&&0===this.negative?(num.negative=0,res=this.sub(num),num.negative^=1,res):0===num.negative&&0!==this.negative?(this.negative=0,res=num.sub(this),this.negative=1,res):this.length>num.length?this.clone().iadd(num):num.clone().iadd(this)},BN.prototype.isub=function(num){var r;if(0!==num.negative)return num.negative=0,r=this.iadd(num),num.negative=1,r._normSign();if(0!==this.negative)return this.negative=0,this.iadd(num),this.negative=1,this._normSign();var a,cmp=this.cmp(num);if(0===cmp)return this.negative=0,this.length=1,this.words[0]=0,this;for(var b=0<cmp?(a=this,num):(a=num,this),carry=0,i=0;i<b.length;i++)carry=(r=(0|a.words[i])-(0|b.words[i])+carry)>>26,this.words[i]=67108863&r;for(;0!==carry&&i<a.length;i++)carry=(r=(0|a.words[i])+carry)>>26,this.words[i]=67108863&r;if(0===carry&&i<a.length&&a!==this)for(;i<a.length;i++)this.words[i]=a.words[i];return this.length=Math.max(this.length,i),a!==this&&(this.negative=1),this.strip()},BN.prototype.sub=function(num){return this.clone().isub(num)};var comb10MulTo=function(self,num,out){var lo,a=self.words,b=num.words,o=out.words,a0=0|a[0],al0=8191&a0,a0=a0>>>13,a1=0|a[1],al1=8191&a1,a1=a1>>>13,a2=0|a[2],al2=8191&a2,a2=a2>>>13,a3=0|a[3],al3=8191&a3,a3=a3>>>13,a4=0|a[4],al4=8191&a4,a4=a4>>>13,a5=0|a[5],al5=8191&a5,a5=a5>>>13,a6=0|a[6],al6=8191&a6,a6=a6>>>13,a7=0|a[7],al7=8191&a7,a7=a7>>>13,a8=0|a[8],al8=8191&a8,a8=a8>>>13,a=0|a[9],al9=8191&a,a=a>>>13,b0=0|b[0],bl0=8191&b0,b0=b0>>>13,b1=0|b[1],bl1=8191&b1,b1=b1>>>13,b2=0|b[2],bl2=8191&b2,b2=b2>>>13,b3=0|b[3],bl3=8191&b3,b3=b3>>>13,b4=0|b[4],bl4=8191&b4,b4=b4>>>13,b5=0|b[5],bl5=8191&b5,b5=b5>>>13,b6=0|b[6],bl6=8191&b6,b6=b6>>>13,b7=0|b[7],bl7=8191&b7,b7=b7>>>13,b8=0|b[8],bl8=8191&b8,b8=b8>>>13,b=0|b[9],bl9=8191&b,b=b>>>13,num=(out.negative=self.negative^num.negative,out.length=19,(0+Math.imul(al0,bl0)|0)+((8191&(self=Math.imul(al0,b0)+Math.imul(a0,bl0)|0))<<13)|0),c=(Math.imul(a0,b0)+(self>>>13)|0)+(num>>>26)|0;num&=67108863,lo=Math.imul(al1,bl0),self=Math.imul(al1,b0)+Math.imul(a1,bl0)|0,hi=Math.imul(a1,b0);var hi,w1=(c+(lo+Math.imul(al0,bl1)|0)|0)+((8191&(self=(self+Math.imul(al0,b1)|0)+Math.imul(a0,bl1)|0))<<13)|0,w2=(c=((hi+Math.imul(a0,b1)|0)+(self>>>13)|0)+(w1>>>26)|0,w1&=67108863,lo=Math.imul(al2,bl0),self=Math.imul(al2,b0)+Math.imul(a2,bl0)|0,hi=Math.imul(a2,b0),lo=lo+Math.imul(al1,bl1)|0,self=(self+Math.imul(al1,b1)|0)+Math.imul(a1,bl1)|0,hi=hi+Math.imul(a1,b1)|0,(c+(lo+Math.imul(al0,bl2)|0)|0)+((8191&(self=(self+Math.imul(al0,b2)|0)+Math.imul(a0,bl2)|0))<<13)|0),w3=(c=((hi+Math.imul(a0,b2)|0)+(self>>>13)|0)+(w2>>>26)|0,w2&=67108863,lo=Math.imul(al3,bl0),self=Math.imul(al3,b0)+Math.imul(a3,bl0)|0,hi=Math.imul(a3,b0),lo=lo+Math.imul(al2,bl1)|0,self=(self+Math.imul(al2,b1)|0)+Math.imul(a2,bl1)|0,hi=hi+Math.imul(a2,b1)|0,lo=lo+Math.imul(al1,bl2)|0,self=(self+Math.imul(al1,b2)|0)+Math.imul(a1,bl2)|0,hi=hi+Math.imul(a1,b2)|0,(c+(lo+Math.imul(al0,bl3)|0)|0)+((8191&(self=(self+Math.imul(al0,b3)|0)+Math.imul(a0,bl3)|0))<<13)|0),w4=(c=((hi+Math.imul(a0,b3)|0)+(self>>>13)|0)+(w3>>>26)|0,w3&=67108863,lo=Math.imul(al4,bl0),self=Math.imul(al4,b0)+Math.imul(a4,bl0)|0,hi=Math.imul(a4,b0),lo=lo+Math.imul(al3,bl1)|0,self=(self+Math.imul(al3,b1)|0)+Math.imul(a3,bl1)|0,hi=hi+Math.imul(a3,b1)|0,lo=lo+Math.imul(al2,bl2)|0,self=(self+Math.imul(al2,b2)|0)+Math.imul(a2,bl2)|0,hi=hi+Math.imul(a2,b2)|0,lo=lo+Math.imul(al1,bl3)|0,self=(self+Math.imul(al1,b3)|0)+Math.imul(a1,bl3)|0,hi=hi+Math.imul(a1,b3)|0,(c+(lo+Math.imul(al0,bl4)|0)|0)+((8191&(self=(self+Math.imul(al0,b4)|0)+Math.imul(a0,bl4)|0))<<13)|0),w5=(c=((hi+Math.imul(a0,b4)|0)+(self>>>13)|0)+(w4>>>26)|0,w4&=67108863,lo=Math.imul(al5,bl0),self=Math.imul(al5,b0)+Math.imul(a5,bl0)|0,hi=Math.imul(a5,b0),lo=lo+Math.imul(al4,bl1)|0,self=(self+Math.imul(al4,b1)|0)+Math.imul(a4,bl1)|0,hi=hi+Math.imul(a4,b1)|0,lo=lo+Math.imul(al3,bl2)|0,self=(self+Math.imul(al3,b2)|0)+Math.imul(a3,bl2)|0,hi=hi+Math.imul(a3,b2)|0,lo=lo+Math.imul(al2,bl3)|0,self=(self+Math.imul(al2,b3)|0)+Math.imul(a2,bl3)|0,hi=hi+Math.imul(a2,b3)|0,lo=lo+Math.imul(al1,bl4)|0,self=(self+Math.imul(al1,b4)|0)+Math.imul(a1,bl4)|0,hi=hi+Math.imul(a1,b4)|0,(c+(lo+Math.imul(al0,bl5)|0)|0)+((8191&(self=(self+Math.imul(al0,b5)|0)+Math.imul(a0,bl5)|0))<<13)|0),w6=(c=((hi+Math.imul(a0,b5)|0)+(self>>>13)|0)+(w5>>>26)|0,w5&=67108863,lo=Math.imul(al6,bl0),self=Math.imul(al6,b0)+Math.imul(a6,bl0)|0,hi=Math.imul(a6,b0),lo=lo+Math.imul(al5,bl1)|0,self=(self+Math.imul(al5,b1)|0)+Math.imul(a5,bl1)|0,hi=hi+Math.imul(a5,b1)|0,lo=lo+Math.imul(al4,bl2)|0,self=(self+Math.imul(al4,b2)|0)+Math.imul(a4,bl2)|0,hi=hi+Math.imul(a4,b2)|0,lo=lo+Math.imul(al3,bl3)|0,self=(self+Math.imul(al3,b3)|0)+Math.imul(a3,bl3)|0,hi=hi+Math.imul(a3,b3)|0,lo=lo+Math.imul(al2,bl4)|0,self=(self+Math.imul(al2,b4)|0)+Math.imul(a2,bl4)|0,hi=hi+Math.imul(a2,b4)|0,lo=lo+Math.imul(al1,bl5)|0,self=(self+Math.imul(al1,b5)|0)+Math.imul(a1,bl5)|0,hi=hi+Math.imul(a1,b5)|0,(c+(lo+Math.imul(al0,bl6)|0)|0)+((8191&(self=(self+Math.imul(al0,b6)|0)+Math.imul(a0,bl6)|0))<<13)|0),w7=(c=((hi+Math.imul(a0,b6)|0)+(self>>>13)|0)+(w6>>>26)|0,w6&=67108863,lo=Math.imul(al7,bl0),self=Math.imul(al7,b0)+Math.imul(a7,bl0)|0,hi=Math.imul(a7,b0),lo=lo+Math.imul(al6,bl1)|0,self=(self+Math.imul(al6,b1)|0)+Math.imul(a6,bl1)|0,hi=hi+Math.imul(a6,b1)|0,lo=lo+Math.imul(al5,bl2)|0,self=(self+Math.imul(al5,b2)|0)+Math.imul(a5,bl2)|0,hi=hi+Math.imul(a5,b2)|0,lo=lo+Math.imul(al4,bl3)|0,self=(self+Math.imul(al4,b3)|0)+Math.imul(a4,bl3)|0,hi=hi+Math.imul(a4,b3)|0,lo=lo+Math.imul(al3,bl4)|0,self=(self+Math.imul(al3,b4)|0)+Math.imul(a3,bl4)|0,hi=hi+Math.imul(a3,b4)|0,lo=lo+Math.imul(al2,bl5)|0,self=(self+Math.imul(al2,b5)|0)+Math.imul(a2,bl5)|0,hi=hi+Math.imul(a2,b5)|0,lo=lo+Math.imul(al1,bl6)|0,self=(self+Math.imul(al1,b6)|0)+Math.imul(a1,bl6)|0,hi=hi+Math.imul(a1,b6)|0,(c+(lo+Math.imul(al0,bl7)|0)|0)+((8191&(self=(self+Math.imul(al0,b7)|0)+Math.imul(a0,bl7)|0))<<13)|0),w8=(c=((hi+Math.imul(a0,b7)|0)+(self>>>13)|0)+(w7>>>26)|0,w7&=67108863,lo=Math.imul(al8,bl0),self=Math.imul(al8,b0)+Math.imul(a8,bl0)|0,hi=Math.imul(a8,b0),lo=lo+Math.imul(al7,bl1)|0,self=(self+Math.imul(al7,b1)|0)+Math.imul(a7,bl1)|0,hi=hi+Math.imul(a7,b1)|0,lo=lo+Math.imul(al6,bl2)|0,self=(self+Math.imul(al6,b2)|0)+Math.imul(a6,bl2)|0,hi=hi+Math.imul(a6,b2)|0,lo=lo+Math.imul(al5,bl3)|0,self=(self+Math.imul(al5,b3)|0)+Math.imul(a5,bl3)|0,hi=hi+Math.imul(a5,b3)|0,lo=lo+Math.imul(al4,bl4)|0,self=(self+Math.imul(al4,b4)|0)+Math.imul(a4,bl4)|0,hi=hi+Math.imul(a4,b4)|0,lo=lo+Math.imul(al3,bl5)|0,self=(self+Math.imul(al3,b5)|0)+Math.imul(a3,bl5)|0,hi=hi+Math.imul(a3,b5)|0,lo=lo+Math.imul(al2,bl6)|0,self=(self+Math.imul(al2,b6)|0)+Math.imul(a2,bl6)|0,hi=hi+Math.imul(a2,b6)|0,lo=lo+Math.imul(al1,bl7)|0,self=(self+Math.imul(al1,b7)|0)+Math.imul(a1,bl7)|0,hi=hi+Math.imul(a1,b7)|0,(c+(lo+Math.imul(al0,bl8)|0)|0)+((8191&(self=(self+Math.imul(al0,b8)|0)+Math.imul(a0,bl8)|0))<<13)|0),bl0=(c=((hi+Math.imul(a0,b8)|0)+(self>>>13)|0)+(w8>>>26)|0,w8&=67108863,lo=Math.imul(al9,bl0),self=Math.imul(al9,b0)+Math.imul(a,bl0)|0,hi=Math.imul(a,b0),lo=lo+Math.imul(al8,bl1)|0,self=(self+Math.imul(al8,b1)|0)+Math.imul(a8,bl1)|0,hi=hi+Math.imul(a8,b1)|0,lo=lo+Math.imul(al7,bl2)|0,self=(self+Math.imul(al7,b2)|0)+Math.imul(a7,bl2)|0,hi=hi+Math.imul(a7,b2)|0,lo=lo+Math.imul(al6,bl3)|0,self=(self+Math.imul(al6,b3)|0)+Math.imul(a6,bl3)|0,hi=hi+Math.imul(a6,b3)|0,lo=lo+Math.imul(al5,bl4)|0,self=(self+Math.imul(al5,b4)|0)+Math.imul(a5,bl4)|0,hi=hi+Math.imul(a5,b4)|0,lo=lo+Math.imul(al4,bl5)|0,self=(self+Math.imul(al4,b5)|0)+Math.imul(a4,bl5)|0,hi=hi+Math.imul(a4,b5)|0,lo=lo+Math.imul(al3,bl6)|0,self=(self+Math.imul(al3,b6)|0)+Math.imul(a3,bl6)|0,hi=hi+Math.imul(a3,b6)|0,lo=lo+Math.imul(al2,bl7)|0,self=(self+Math.imul(al2,b7)|0)+Math.imul(a2,bl7)|0,hi=hi+Math.imul(a2,b7)|0,lo=lo+Math.imul(al1,bl8)|0,self=(self+Math.imul(al1,b8)|0)+Math.imul(a1,bl8)|0,hi=hi+Math.imul(a1,b8)|0,(c+(lo+Math.imul(al0,bl9)|0)|0)+((8191&(self=(self+Math.imul(al0,b)|0)+Math.imul(a0,bl9)|0))<<13)|0),b0=(c=((hi+Math.imul(a0,b)|0)+(self>>>13)|0)+(bl0>>>26)|0,bl0&=67108863,lo=Math.imul(al9,bl1),self=Math.imul(al9,b1)+Math.imul(a,bl1)|0,hi=Math.imul(a,b1),lo=lo+Math.imul(al8,bl2)|0,self=(self+Math.imul(al8,b2)|0)+Math.imul(a8,bl2)|0,hi=hi+Math.imul(a8,b2)|0,lo=lo+Math.imul(al7,bl3)|0,self=(self+Math.imul(al7,b3)|0)+Math.imul(a7,bl3)|0,hi=hi+Math.imul(a7,b3)|0,lo=lo+Math.imul(al6,bl4)|0,self=(self+Math.imul(al6,b4)|0)+Math.imul(a6,bl4)|0,hi=hi+Math.imul(a6,b4)|0,lo=lo+Math.imul(al5,bl5)|0,self=(self+Math.imul(al5,b5)|0)+Math.imul(a5,bl5)|0,hi=hi+Math.imul(a5,b5)|0,lo=lo+Math.imul(al4,bl6)|0,self=(self+Math.imul(al4,b6)|0)+Math.imul(a4,bl6)|0,hi=hi+Math.imul(a4,b6)|0,lo=lo+Math.imul(al3,bl7)|0,self=(self+Math.imul(al3,b7)|0)+Math.imul(a3,bl7)|0,hi=hi+Math.imul(a3,b7)|0,lo=lo+Math.imul(al2,bl8)|0,self=(self+Math.imul(al2,b8)|0)+Math.imul(a2,bl8)|0,hi=hi+Math.imul(a2,b8)|0,(c+(lo+Math.imul(al1,bl9)|0)|0)+((8191&(self=(self+Math.imul(al1,b)|0)+Math.imul(a1,bl9)|0))<<13)|0),al0=(c=((hi+Math.imul(a1,b)|0)+(self>>>13)|0)+(b0>>>26)|0,b0&=67108863,lo=Math.imul(al9,bl2),self=Math.imul(al9,b2)+Math.imul(a,bl2)|0,hi=Math.imul(a,b2),lo=lo+Math.imul(al8,bl3)|0,self=(self+Math.imul(al8,b3)|0)+Math.imul(a8,bl3)|0,hi=hi+Math.imul(a8,b3)|0,lo=lo+Math.imul(al7,bl4)|0,self=(self+Math.imul(al7,b4)|0)+Math.imul(a7,bl4)|0,hi=hi+Math.imul(a7,b4)|0,lo=lo+Math.imul(al6,bl5)|0,self=(self+Math.imul(al6,b5)|0)+Math.imul(a6,bl5)|0,hi=hi+Math.imul(a6,b5)|0,lo=lo+Math.imul(al5,bl6)|0,self=(self+Math.imul(al5,b6)|0)+Math.imul(a5,bl6)|0,hi=hi+Math.imul(a5,b6)|0,lo=lo+Math.imul(al4,bl7)|0,self=(self+Math.imul(al4,b7)|0)+Math.imul(a4,bl7)|0,hi=hi+Math.imul(a4,b7)|0,lo=lo+Math.imul(al3,bl8)|0,self=(self+Math.imul(al3,b8)|0)+Math.imul(a3,bl8)|0,hi=hi+Math.imul(a3,b8)|0,(c+(lo+Math.imul(al2,bl9)|0)|0)+((8191&(self=(self+Math.imul(al2,b)|0)+Math.imul(a2,bl9)|0))<<13)|0),a0=(c=((hi+Math.imul(a2,b)|0)+(self>>>13)|0)+(al0>>>26)|0,al0&=67108863,lo=Math.imul(al9,bl3),self=Math.imul(al9,b3)+Math.imul(a,bl3)|0,hi=Math.imul(a,b3),lo=lo+Math.imul(al8,bl4)|0,self=(self+Math.imul(al8,b4)|0)+Math.imul(a8,bl4)|0,hi=hi+Math.imul(a8,b4)|0,lo=lo+Math.imul(al7,bl5)|0,self=(self+Math.imul(al7,b5)|0)+Math.imul(a7,bl5)|0,hi=hi+Math.imul(a7,b5)|0,lo=lo+Math.imul(al6,bl6)|0,self=(self+Math.imul(al6,b6)|0)+Math.imul(a6,bl6)|0,hi=hi+Math.imul(a6,b6)|0,lo=lo+Math.imul(al5,bl7)|0,self=(self+Math.imul(al5,b7)|0)+Math.imul(a5,bl7)|0,hi=hi+Math.imul(a5,b7)|0,lo=lo+Math.imul(al4,bl8)|0,self=(self+Math.imul(al4,b8)|0)+Math.imul(a4,bl8)|0,hi=hi+Math.imul(a4,b8)|0,(c+(lo+Math.imul(al3,bl9)|0)|0)+((8191&(self=(self+Math.imul(al3,b)|0)+Math.imul(a3,bl9)|0))<<13)|0),bl1=(c=((hi+Math.imul(a3,b)|0)+(self>>>13)|0)+(a0>>>26)|0,a0&=67108863,lo=Math.imul(al9,bl4),self=Math.imul(al9,b4)+Math.imul(a,bl4)|0,hi=Math.imul(a,b4),lo=lo+Math.imul(al8,bl5)|0,self=(self+Math.imul(al8,b5)|0)+Math.imul(a8,bl5)|0,hi=hi+Math.imul(a8,b5)|0,lo=lo+Math.imul(al7,bl6)|0,self=(self+Math.imul(al7,b6)|0)+Math.imul(a7,bl6)|0,hi=hi+Math.imul(a7,b6)|0,lo=lo+Math.imul(al6,bl7)|0,self=(self+Math.imul(al6,b7)|0)+Math.imul(a6,bl7)|0,hi=hi+Math.imul(a6,b7)|0,lo=lo+Math.imul(al5,bl8)|0,self=(self+Math.imul(al5,b8)|0)+Math.imul(a5,bl8)|0,hi=hi+Math.imul(a5,b8)|0,(c+(lo+Math.imul(al4,bl9)|0)|0)+((8191&(self=(self+Math.imul(al4,b)|0)+Math.imul(a4,bl9)|0))<<13)|0),b1=(c=((hi+Math.imul(a4,b)|0)+(self>>>13)|0)+(bl1>>>26)|0,bl1&=67108863,lo=Math.imul(al9,bl5),self=Math.imul(al9,b5)+Math.imul(a,bl5)|0,hi=Math.imul(a,b5),lo=lo+Math.imul(al8,bl6)|0,self=(self+Math.imul(al8,b6)|0)+Math.imul(a8,bl6)|0,hi=hi+Math.imul(a8,b6)|0,lo=lo+Math.imul(al7,bl7)|0,self=(self+Math.imul(al7,b7)|0)+Math.imul(a7,bl7)|0,hi=hi+Math.imul(a7,b7)|0,lo=lo+Math.imul(al6,bl8)|0,self=(self+Math.imul(al6,b8)|0)+Math.imul(a6,bl8)|0,hi=hi+Math.imul(a6,b8)|0,(c+(lo+Math.imul(al5,bl9)|0)|0)+((8191&(self=(self+Math.imul(al5,b)|0)+Math.imul(a5,bl9)|0))<<13)|0),al1=(c=((hi+Math.imul(a5,b)|0)+(self>>>13)|0)+(b1>>>26)|0,b1&=67108863,lo=Math.imul(al9,bl6),self=Math.imul(al9,b6)+Math.imul(a,bl6)|0,hi=Math.imul(a,b6),lo=lo+Math.imul(al8,bl7)|0,self=(self+Math.imul(al8,b7)|0)+Math.imul(a8,bl7)|0,hi=hi+Math.imul(a8,b7)|0,lo=lo+Math.imul(al7,bl8)|0,self=(self+Math.imul(al7,b8)|0)+Math.imul(a7,bl8)|0,hi=hi+Math.imul(a7,b8)|0,(c+(lo+Math.imul(al6,bl9)|0)|0)+((8191&(self=(self+Math.imul(al6,b)|0)+Math.imul(a6,bl9)|0))<<13)|0),a1=(c=((hi+Math.imul(a6,b)|0)+(self>>>13)|0)+(al1>>>26)|0,al1&=67108863,lo=Math.imul(al9,bl7),self=Math.imul(al9,b7)+Math.imul(a,bl7)|0,hi=Math.imul(a,b7),lo=lo+Math.imul(al8,bl8)|0,self=(self+Math.imul(al8,b8)|0)+Math.imul(a8,bl8)|0,hi=hi+Math.imul(a8,b8)|0,(c+(lo+Math.imul(al7,bl9)|0)|0)+((8191&(self=(self+Math.imul(al7,b)|0)+Math.imul(a7,bl9)|0))<<13)|0),bl2=(c=((hi+Math.imul(a7,b)|0)+(self>>>13)|0)+(a1>>>26)|0,a1&=67108863,lo=Math.imul(al9,bl8),self=Math.imul(al9,b8)+Math.imul(a,bl8)|0,hi=Math.imul(a,b8),(c+(lo+Math.imul(al8,bl9)|0)|0)+((8191&(self=(self+Math.imul(al8,b)|0)+Math.imul(a8,bl9)|0))<<13)|0),b2=(c=((hi+Math.imul(a8,b)|0)+(self>>>13)|0)+(bl2>>>26)|0,bl2&=67108863,(c+Math.imul(al9,bl9)|0)+((8191&(self=Math.imul(al9,b)+Math.imul(a,bl9)|0))<<13)|0);return c=(Math.imul(a,b)+(self>>>13)|0)+(b2>>>26)|0,b2&=67108863,o[0]=num,o[1]=w1,o[2]=w2,o[3]=w3,o[4]=w4,o[5]=w5,o[6]=w6,o[7]=w7,o[8]=w8,o[9]=bl0,o[10]=b0,o[11]=al0,o[12]=a0,o[13]=bl1,o[14]=b1,o[15]=al1,o[16]=a1,o[17]=bl2,o[18]=b2,0!=c&&(o[19]=c,out.length++),out};function jumboMulTo(self,num,out){return(new FFTM).mulp(self,num,out)}function FFTM(x,y){this.x=x,this.y=y}Math.imul||(comb10MulTo=smallMulTo),BN.prototype.mulTo=function(num,out){var len=this.length+num.length,len=(10===this.length&&10===num.length?comb10MulTo:len<63?smallMulTo:len<1024?function(self,num,out){out.negative=num.negative^self.negative,out.length=self.length+num.length;for(var carry=0,hncarry=0,k=0;k<out.length-1;k++){for(var ncarry=hncarry,hncarry=0,rword=67108863&carry,maxJ=Math.min(k,num.length-1),j=Math.max(0,k-self.length+1);j<=maxJ;j++){var lo,r=(0|self.words[k-j])*(0|num.words[j]),rword=67108863&(lo=(67108863&r)+rword|0);hncarry+=(ncarry=(ncarry=ncarry+(r/67108864|0)|0)+(lo>>>26)|0)>>>26,ncarry&=67108863}out.words[k]=rword,carry=ncarry,ncarry=hncarry}return 0!==carry?out.words[k]=carry:out.length--,out.strip()}:jumboMulTo)(this,num,out);return len},FFTM.prototype.makeRBT=function(N){for(var t=new Array(N),l=BN.prototype._countBits(N)-1,i=0;i<N;i++)t[i]=this.revBin(i,l,N);return t},FFTM.prototype.revBin=function(x,l,N){if(0===x||x===N-1)return x;for(var rb=0,i=0;i<l;i++)rb|=(1&x)<<l-i-1,x>>=1;return rb},FFTM.prototype.permute=function(rbt,rws,iws,rtws,itws,N){for(var i=0;i<N;i++)rtws[i]=rws[rbt[i]],itws[i]=iws[rbt[i]]},FFTM.prototype.transform=function(rws,iws,rtws,itws,N,rbt){this.permute(rbt,rws,iws,rtws,itws,N);for(var s=1;s<N;s<<=1)for(var l=s<<1,rtwdf=Math.cos(2*Math.PI/l),itwdf=Math.sin(2*Math.PI/l),p=0;p<N;p+=l)for(var rtwdf_=rtwdf,itwdf_=itwdf,j=0;j<s;j++){var re=rtws[p+j],ie=itws[p+j],ro=rtws[p+j+s],rx=rtwdf_*ro-itwdf_*(io=itws[p+j+s]),io=rtwdf_*io+itwdf_*ro;rtws[p+j]=re+(ro=rx),itws[p+j]=ie+io,rtws[p+j+s]=re-ro,itws[p+j+s]=ie-io,j!==l&&(rx=rtwdf*rtwdf_-itwdf*itwdf_,itwdf_=rtwdf*itwdf_+itwdf*rtwdf_,rtwdf_=rx)}},FFTM.prototype.guessLen13b=function(n,m){for(var m=1&(N=1|Math.max(m,n)),i=0,N=N/2|0;N;N>>>=1)i++;return 1<<i+1+m},FFTM.prototype.conjugate=function(rws,iws,N){if(!(N<=1))for(var i=0;i<N/2;i++){var t=rws[i];rws[i]=rws[N-i-1],rws[N-i-1]=t,t=iws[i],iws[i]=-iws[N-i-1],iws[N-i-1]=-t}},FFTM.prototype.normalize13b=function(ws,N){for(var carry=0,i=0;i<N/2;i++){var w=8192*Math.round(ws[2*i+1]/N)+Math.round(ws[2*i]/N)+carry;ws[i]=67108863&w,carry=w<67108864?0:w/67108864|0}return ws},FFTM.prototype.convert13b=function(ws,len,rws,N){for(var carry=0,i=0;i<len;i++)carry+=0|ws[i],rws[2*i]=8191&carry,rws[2*i+1]=8191&(carry>>>=13),carry>>>=13;for(i=2*len;i<N;++i)rws[i]=0;assert(0===carry),assert(0==(-8192&carry))},FFTM.prototype.stub=function(N){for(var ph=new Array(N),i=0;i<N;i++)ph[i]=0;return ph},FFTM.prototype.mulp=function(x,y,out){var N=2*this.guessLen13b(x.length,y.length),rbt=this.makeRBT(N),_=this.stub(N),rws=new Array(N),rwst=new Array(N),iwst=new Array(N),nrws=new Array(N),nrwst=new Array(N),niwst=new Array(N),rmws=out.words;rmws.length=N,this.convert13b(x.words,x.length,rws,N),this.convert13b(y.words,y.length,nrws,N),this.transform(rws,_,rwst,iwst,N,rbt),this.transform(nrws,_,nrwst,niwst,N,rbt);for(var i=0;i<N;i++){var rx=rwst[i]*nrwst[i]-iwst[i]*niwst[i];iwst[i]=rwst[i]*niwst[i]+iwst[i]*nrwst[i],rwst[i]=rx}return this.conjugate(rwst,iwst,N),this.transform(rwst,iwst,rmws,_,N,rbt),this.conjugate(rmws,_,N),this.normalize13b(rmws,N),out.negative=x.negative^y.negative,out.length=x.length+y.length,out.strip()},BN.prototype.mul=function(num){var out=new BN(null);return out.words=new Array(this.length+num.length),this.mulTo(num,out)},BN.prototype.mulf=function(num){var out=new BN(null);return out.words=new Array(this.length+num.length),jumboMulTo(this,num,out)},BN.prototype.imul=function(num){return this.clone().mulTo(num,this)},BN.prototype.imuln=function(num){assert("number"==typeof num),assert(num<67108864);for(var carry=0,i=0;i<this.length;i++){var w=(0|this.words[i])*num,lo=(67108863&w)+(67108863&carry),carry=(carry>>=26)+(w/67108864|0)+(lo>>>26);this.words[i]=67108863&lo}return 0!==carry&&(this.words[i]=carry,this.length++),this},BN.prototype.muln=function(num){return this.clone().imuln(num)},BN.prototype.sqr=function(){return this.mul(this)},BN.prototype.isqr=function(){return this.imul(this.clone())},BN.prototype.pow=function(num){var w=function(num){for(var w=new Array(num.bitLength()),bit=0;bit<w.length;bit++){var wbit=bit%26;w[bit]=(num.words[bit/26|0]&1<<wbit)>>>wbit}return w}(num);if(0===w.length)return new BN(1);for(var res=this,i=0;i<w.length&&0===w[i];i++,res=res.sqr());if(++i<w.length)for(var q=res.sqr();i<w.length;i++,q=q.sqr())0!==w[i]&&(res=res.mul(q));return res},BN.prototype.iushln=function(bits){assert("number"==typeof bits&&0<=bits);var r=bits%26,s=(bits-r)/26,carryMask=67108863>>>26-r<<26-r;if(0!=r){for(var carry=0,i=0;i<this.length;i++){var newCarry=this.words[i]&carryMask,c=(0|this.words[i])-newCarry<<r;this.words[i]=c|carry,carry=newCarry>>>26-r}carry&&(this.words[i]=carry,this.length++)}if(0!=s){for(i=this.length-1;0<=i;i--)this.words[i+s]=this.words[i];for(i=0;i<s;i++)this.words[i]=0;this.length+=s}return this.strip()},BN.prototype.ishln=function(bits){return assert(0===this.negative),this.iushln(bits)},BN.prototype.iushrn=function(bits,hint,extended){assert("number"==typeof bits&&0<=bits),h=hint?(hint-hint%26)/26:0;var h,r=bits%26,s=Math.min((bits-r)/26,this.length),mask=67108863^67108863>>>r<<r,maskedWords=extended;if(h-=s,h=Math.max(0,h),maskedWords){for(var i=0;i<s;i++)maskedWords.words[i]=this.words[i];maskedWords.length=s}if(0!==s)if(this.length>s)for(this.length-=s,i=0;i<this.length;i++)this.words[i]=this.words[i+s];else this.words[0]=0,this.length=1;for(var carry=0,i=this.length-1;0<=i&&(0!==carry||h<=i);i--){var word=0|this.words[i];this.words[i]=carry<<26-r|word>>>r,carry=word&mask}return maskedWords&&0!==carry&&(maskedWords.words[maskedWords.length++]=carry),0===this.length&&(this.words[0]=0,this.length=1),this.strip()},BN.prototype.ishrn=function(bits,hint,extended){return assert(0===this.negative),this.iushrn(bits,hint,extended)},BN.prototype.shln=function(bits){return this.clone().ishln(bits)},BN.prototype.ushln=function(bits){return this.clone().iushln(bits)},BN.prototype.shrn=function(bits){return this.clone().ishrn(bits)},BN.prototype.ushrn=function(bits){return this.clone().iushrn(bits)},BN.prototype.testn=function(bit){assert("number"==typeof bit&&0<=bit);var r=bit%26,bit=(bit-r)/26;return!(this.length<=bit)&&!!(this.words[bit]&1<<r)},BN.prototype.imaskn=function(bits){assert("number"==typeof bits&&0<=bits);var r=bits%26,bits=(bits-r)/26;return assert(0===this.negative,"imaskn works only with positive numbers"),this.length<=bits?this:(0!=r&&bits++,this.length=Math.min(bits,this.length),0!=r&&(this.words[this.length-1]&=67108863^67108863>>>r<<r),this.strip())},BN.prototype.maskn=function(bits){return this.clone().imaskn(bits)},BN.prototype.iaddn=function(num){return assert("number"==typeof num),assert(num<67108864),num<0?this.isubn(-num):0!==this.negative?(1===this.length&&(0|this.words[0])<num?(this.words[0]=num-(0|this.words[0]),this.negative=0):(this.negative=0,this.isubn(num),this.negative=1),this):this._iaddn(num)},BN.prototype._iaddn=function(num){this.words[0]+=num;for(var i=0;i<this.length&&67108864<=this.words[i];i++)this.words[i]-=67108864,i===this.length-1?this.words[i+1]=1:this.words[i+1]++;return this.length=Math.max(this.length,i+1),this},BN.prototype.isubn=function(num){if(assert("number"==typeof num),assert(num<67108864),num<0)return this.iaddn(-num);if(0!==this.negative)return this.negative=0,this.iaddn(num),this.negative=1,this;if(this.words[0]-=num,1===this.length&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var i=0;i<this.length&&this.words[i]<0;i++)this.words[i]+=67108864,--this.words[i+1];return this.strip()},BN.prototype.addn=function(num){return this.clone().iaddn(num)},BN.prototype.subn=function(num){return this.clone().isubn(num)},BN.prototype.iabs=function(){return this.negative=0,this},BN.prototype.abs=function(){return this.clone().iabs()},BN.prototype._ishlnsubmul=function(num,mul,shift){for(var len=num.length+shift,carry=(this._expand(len),0),i=0;i<num.length;i++){var w=(0|this.words[i+shift])+carry,right=(0|num.words[i])*mul,carry=((w-=67108863&right)>>26)-(right/67108864|0);this.words[i+shift]=67108863&w}for(;i<this.length-shift;i++)carry=(w=(0|this.words[i+shift])+carry)>>26,this.words[i+shift]=67108863&w;if(0===carry)return this.strip();for(assert(-1===carry),i=carry=0;i<this.length;i++)carry=(w=-(0|this.words[i])+carry)>>26,this.words[i]=67108863&w;return this.negative=1,this.strip()},BN.prototype._wordDiv=function(num,mode){this.length,num.length;var q,a=this.clone(),b=num,bhi=0|b.words[b.length-1],m=(0!=(num=26-this._countBits(bhi))&&(b=b.ushln(num),a.iushln(num),bhi=0|b.words[b.length-1]),a.length-b.length);if("mod"!==mode){(q=new BN(null)).length=1+m,q.words=new Array(q.length);for(var i=0;i<q.length;i++)q.words[i]=0}var diff=a.clone()._ishlnsubmul(b,1,m);0===diff.negative&&(a=diff,q&&(q.words[m]=1));for(var j=m-1;0<=j;j--){var qj=67108864*(0|a.words[b.length+j])+(0|a.words[b.length+j-1]),qj=Math.min(qj/bhi|0,67108863);for(a._ishlnsubmul(b,qj,j);0!==a.negative;)qj--,a.negative=0,a._ishlnsubmul(b,1,j),a.isZero()||(a.negative^=1);q&&(q.words[j]=qj)}return q&&q.strip(),a.strip(),"div"!==mode&&0!=num&&a.iushrn(num),{div:q||null,mod:a}},BN.prototype.divmod=function(num,mode,positive){return assert(!num.isZero()),this.isZero()?{div:new BN(0),mod:new BN(0)}:0!==this.negative&&0===num.negative?(res=this.neg().divmod(num,mode),"mod"!==mode&&(div=res.div.neg()),"div"!==mode&&(mod=res.mod.neg(),positive&&0!==mod.negative&&mod.iadd(num)),{div:div,mod:mod}):0===this.negative&&0!==num.negative?(res=this.divmod(num.neg(),mode),{div:div="mod"!==mode?res.div.neg():div,mod:res.mod}):0!=(this.negative&num.negative)?(res=this.neg().divmod(num.neg(),mode),"div"!==mode&&(mod=res.mod.neg(),positive&&0!==mod.negative&&mod.isub(num)),{div:res.div,mod:mod}):num.length>this.length||this.cmp(num)<0?{div:new BN(0),mod:this}:1===num.length?"div"===mode?{div:this.divn(num.words[0]),mod:null}:"mod"===mode?{div:null,mod:new BN(this.modn(num.words[0]))}:{div:this.divn(num.words[0]),mod:new BN(this.modn(num.words[0]))}:this._wordDiv(num,mode);var div,mod,res},BN.prototype.div=function(num){return this.divmod(num,"div",!1).div},BN.prototype.mod=function(num){return this.divmod(num,"mod",!1).mod},BN.prototype.umod=function(num){return this.divmod(num,"mod",!0).mod},BN.prototype.divRound=function(num){var dm=this.divmod(num);if(dm.mod.isZero())return dm.div;var mod=0!==dm.div.negative?dm.mod.isub(num):dm.mod,half=num.ushrn(1),num=num.andln(1),mod=mod.cmp(half);return mod<0||1===num&&0===mod?dm.div:0!==dm.div.negative?dm.div.isubn(1):dm.div.iaddn(1)},BN.prototype.modn=function(num){assert(num<=67108863);for(var p=(1<<26)%num,acc=0,i=this.length-1;0<=i;i--)acc=(p*acc+(0|this.words[i]))%num;return acc},BN.prototype.idivn=function(num){assert(num<=67108863);for(var carry=0,i=this.length-1;0<=i;i--){var w=(0|this.words[i])+67108864*carry;this.words[i]=w/num|0,carry=w%num}return this.strip()},BN.prototype.divn=function(num){return this.clone().idivn(num)},BN.prototype.egcd=function(p){assert(0===p.negative),assert(!p.isZero());for(var x=this,y=p.clone(),x=0!==x.negative?x.umod(p):x.clone(),A=new BN(1),B=new BN(0),C=new BN(0),D=new BN(1),g=0;x.isEven()&&y.isEven();)x.iushrn(1),y.iushrn(1),++g;for(var yp=y.clone(),xp=x.clone();!x.isZero();){for(var i=0,im=1;0==(x.words[0]&im)&&i<26;++i,im<<=1);if(0<i)for(x.iushrn(i);0<i--;)(A.isOdd()||B.isOdd())&&(A.iadd(yp),B.isub(xp)),A.iushrn(1),B.iushrn(1);for(var j=0,jm=1;0==(y.words[0]&jm)&&j<26;++j,jm<<=1);if(0<j)for(y.iushrn(j);0<j--;)(C.isOdd()||D.isOdd())&&(C.iadd(yp),D.isub(xp)),C.iushrn(1),D.iushrn(1);0<=x.cmp(y)?(x.isub(y),A.isub(C),B.isub(D)):(y.isub(x),C.isub(A),D.isub(B))}return{a:C,b:D,gcd:y.iushln(g)}},BN.prototype._invmp=function(p){assert(0===p.negative),assert(!p.isZero());for(var res,a=this,b=p.clone(),a=0!==a.negative?a.umod(p):a.clone(),x1=new BN(1),x2=new BN(0),delta=b.clone();0<a.cmpn(1)&&0<b.cmpn(1);){for(var i=0,im=1;0==(a.words[0]&im)&&i<26;++i,im<<=1);if(0<i)for(a.iushrn(i);0<i--;)x1.isOdd()&&x1.iadd(delta),x1.iushrn(1);for(var j=0,jm=1;0==(b.words[0]&jm)&&j<26;++j,jm<<=1);if(0<j)for(b.iushrn(j);0<j--;)x2.isOdd()&&x2.iadd(delta),x2.iushrn(1);0<=a.cmp(b)?(a.isub(b),x1.isub(x2)):(b.isub(a),x2.isub(x1))}return(res=0===a.cmpn(1)?x1:x2).cmpn(0)<0&&res.iadd(p),res},BN.prototype.gcd=function(num){if(this.isZero())return num.abs();if(num.isZero())return this.abs();var a=this.clone(),b=num.clone();a.negative=0;for(var shift=b.negative=0;a.isEven()&&b.isEven();shift++)a.iushrn(1),b.iushrn(1);for(;;){for(;a.isEven();)a.iushrn(1);for(;b.isEven();)b.iushrn(1);var r=a.cmp(b);if(r<0)var t=a,a=b,b=t;else if(0===r||0===b.cmpn(1))break;a.isub(b)}return b.iushln(shift)},BN.prototype.invm=function(num){return this.egcd(num).a.umod(num)},BN.prototype.isEven=function(){return 0==(1&this.words[0])},BN.prototype.isOdd=function(){return 1==(1&this.words[0])},BN.prototype.andln=function(num){return this.words[0]&num},BN.prototype.bincn=function(bit){assert("number"==typeof bit);var r=bit%26,bit=(bit-r)/26,r=1<<r;if(this.length<=bit)return this._expand(1+bit),this.words[bit]|=r,this;for(var carry=r,i=bit;0!==carry&&i<this.length;i++){var w=0|this.words[i],carry=(w+=carry)>>>26;w&=67108863,this.words[i]=w}return 0!==carry&&(this.words[i]=carry,this.length++),this},BN.prototype.isZero=function(){return 1===this.length&&0===this.words[0]},BN.prototype.cmpn=function(num){var negative=num<0;return 0===this.negative||negative?0===this.negative&&negative?1:(this.strip(),negative=1<this.length?1:(assert((num=negative?-num:num)<=67108863,"Number is too big"),(negative=0|this.words[0])===num?0:negative<num?-1:1),0!==this.negative?0|-negative:negative):-1},BN.prototype.cmp=function(num){if(0!==this.negative&&0===num.negative)return-1;if(0===this.negative&&0!==num.negative)return 1;num=this.ucmp(num);return 0!==this.negative?0|-num:num},BN.prototype.ucmp=function(num){if(this.length>num.length)return 1;if(this.length<num.length)return-1;for(var res=0,i=this.length-1;0<=i;i--){var a=0|this.words[i],b=0|num.words[i];if(a!=b){a<b?res=-1:b<a&&(res=1);break}}return res},BN.prototype.gtn=function(num){return 1===this.cmpn(num)},BN.prototype.gt=function(num){return 1===this.cmp(num)},BN.prototype.gten=function(num){return 0<=this.cmpn(num)},BN.prototype.gte=function(num){return 0<=this.cmp(num)},BN.prototype.ltn=function(num){return-1===this.cmpn(num)},BN.prototype.lt=function(num){return-1===this.cmp(num)},BN.prototype.lten=function(num){return this.cmpn(num)<=0},BN.prototype.lte=function(num){return this.cmp(num)<=0},BN.prototype.eqn=function(num){return 0===this.cmpn(num)},BN.prototype.eq=function(num){return 0===this.cmp(num)},BN.red=function(num){return new Red(num)},BN.prototype.toRed=function(ctx){return assert(!this.red,"Already a number in reduction context"),assert(0===this.negative,"red works only with positives"),ctx.convertTo(this)._forceRed(ctx)},BN.prototype.fromRed=function(){return assert(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},BN.prototype._forceRed=function(ctx){return this.red=ctx,this},BN.prototype.forceRed=function(ctx){return assert(!this.red,"Already a number in reduction context"),this._forceRed(ctx)},BN.prototype.redAdd=function(num){return assert(this.red,"redAdd works only with red numbers"),this.red.add(this,num)},BN.prototype.redIAdd=function(num){return assert(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,num)},BN.prototype.redSub=function(num){return assert(this.red,"redSub works only with red numbers"),this.red.sub(this,num)},BN.prototype.redISub=function(num){return assert(this.red,"redISub works only with red numbers"),this.red.isub(this,num)},BN.prototype.redShl=function(num){return assert(this.red,"redShl works only with red numbers"),this.red.shl(this,num)},BN.prototype.redMul=function(num){return assert(this.red,"redMul works only with red numbers"),this.red._verify2(this,num),this.red.mul(this,num)},BN.prototype.redIMul=function(num){return assert(this.red,"redMul works only with red numbers"),this.red._verify2(this,num),this.red.imul(this,num)},BN.prototype.redSqr=function(){return assert(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},BN.prototype.redISqr=function(){return assert(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},BN.prototype.redSqrt=function(){return assert(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},BN.prototype.redInvm=function(){return assert(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},BN.prototype.redNeg=function(){return assert(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},BN.prototype.redPow=function(num){return assert(this.red&&!num.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,num)};var primes={k256:null,p224:null,p192:null,p25519:null};function MPrime(name,p){this.name=name,this.p=new BN(p,16),this.n=this.p.bitLength(),this.k=new BN(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}function K256(){MPrime.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}function P224(){MPrime.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}function P192(){MPrime.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}function P25519(){MPrime.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}function Red(m){var prime;"string"==typeof m?(prime=BN._prime(m),this.m=prime.p,this.prime=prime):(assert(m.gtn(1),"modulus must be greater than 1"),this.m=m,this.prime=null)}function Mont(m){Red.call(this,m),this.shift=this.m.bitLength(),this.shift%26!=0&&(this.shift+=26-this.shift%26),this.r=new BN(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}MPrime.prototype._tmp=function(){var tmp=new BN(null);return tmp.words=new Array(Math.ceil(this.n/13)),tmp},MPrime.prototype.ireduce=function(num){for(var rlen,r=num;this.split(r,this.tmp),(rlen=(r=(r=this.imulK(r)).iadd(this.tmp)).bitLength())>this.n;);num=rlen<this.n?-1:r.ucmp(this.p);return 0===num?(r.words[0]=0,r.length=1):0<num?r.isub(this.p):void 0!==r.strip?r.strip():r._strip(),r},MPrime.prototype.split=function(input,out){input.iushrn(this.n,0,out)},MPrime.prototype.imulK=function(num){return num.imul(this.k)},inherits(K256,MPrime),K256.prototype.split=function(input,output){for(var outLen=Math.min(input.length,9),i=0;i<outLen;i++)output.words[i]=input.words[i];if(output.length=outLen,input.length<=9)return input.words[0]=0,void(input.length=1);var prev=input.words[9];for(output.words[output.length++]=4194303&prev,i=10;i<input.length;i++){var next=0|input.words[i];input.words[i-10]=(4194303&next)<<4|prev>>>22,prev=next}0===(input.words[i-10]=prev>>>=22)&&10<input.length?input.length-=10:input.length-=9},K256.prototype.imulK=function(num){num.words[num.length]=0,num.words[num.length+1]=0,num.length+=2;for(var lo=0,i=0;i<num.length;i++){var w=0|num.words[i];lo+=977*w,num.words[i]=67108863&lo,lo=64*w+(lo/67108864|0)}return 0===num.words[num.length-1]&&(num.length--,0===num.words[num.length-1]&&num.length--),num},inherits(P224,MPrime),inherits(P192,MPrime),inherits(P25519,MPrime),P25519.prototype.imulK=function(num){for(var carry=0,i=0;i<num.length;i++){var hi=19*(0|num.words[i])+carry,lo=67108863&hi;hi>>>=26,num.words[i]=lo,carry=hi}return 0!==carry&&(num.words[num.length++]=carry),num},BN._prime=function(name){if(primes[name])return primes[name];var prime;if("k256"===name)prime=new K256;else if("p224"===name)prime=new P224;else if("p192"===name)prime=new P192;else{if("p25519"!==name)throw new Error("Unknown prime "+name);prime=new P25519}return primes[name]=prime},Red.prototype._verify1=function(a){assert(0===a.negative,"red works only with positives"),assert(a.red,"red works only with red numbers")},Red.prototype._verify2=function(a,b){assert(0==(a.negative|b.negative),"red works only with positives"),assert(a.red&&a.red===b.red,"red works only with red numbers")},Red.prototype.imod=function(a){return(this.prime?this.prime.ireduce(a):a.umod(this.m))._forceRed(this)},Red.prototype.neg=function(a){return a.isZero()?a.clone():this.m.sub(a)._forceRed(this)},Red.prototype.add=function(a,b){this._verify2(a,b);a=a.add(b);return 0<=a.cmp(this.m)&&a.isub(this.m),a._forceRed(this)},Red.prototype.iadd=function(a,b){this._verify2(a,b);a=a.iadd(b);return 0<=a.cmp(this.m)&&a.isub(this.m),a},Red.prototype.sub=function(a,b){this._verify2(a,b);a=a.sub(b);return a.cmpn(0)<0&&a.iadd(this.m),a._forceRed(this)},Red.prototype.isub=function(a,b){this._verify2(a,b);a=a.isub(b);return a.cmpn(0)<0&&a.iadd(this.m),a},Red.prototype.shl=function(a,num){return this._verify1(a),this.imod(a.ushln(num))},Red.prototype.imul=function(a,b){return this._verify2(a,b),this.imod(a.imul(b))},Red.prototype.mul=function(a,b){return this._verify2(a,b),this.imod(a.mul(b))},Red.prototype.isqr=function(a){return this.imul(a,a.clone())},Red.prototype.sqr=function(a){return this.mul(a,a)},Red.prototype.sqrt=function(a){if(a.isZero())return a.clone();var mod3=this.m.andln(3);if(assert(mod3%2==1),3===mod3)return mod3=this.m.add(new BN(1)).iushrn(2),this.pow(a,mod3);for(var q=this.m.subn(1),s=0;!q.isZero()&&0===q.andln(1);)s++,q.iushrn(1);assert(!q.isZero());for(var one=new BN(1).toRed(this),nOne=one.redNeg(),lpow=this.m.subn(1).iushrn(1),z=new BN(2*(z=this.m.bitLength())*z).toRed(this);0!==this.pow(z,lpow).cmp(nOne);)z.redIAdd(nOne);for(var c=this.pow(z,q),r=this.pow(a,q.addn(1).iushrn(1)),t=this.pow(a,q),m=s;0!==t.cmp(one);){for(var tmp=t,i=0;0!==tmp.cmp(one);i++)tmp=tmp.redSqr();assert(i<m);var b=this.pow(c,new BN(1).iushln(m-i-1)),r=r.redMul(b),c=b.redSqr(),t=t.redMul(c),m=i}return r},Red.prototype.invm=function(a){a=a._invmp(this.m);return 0!==a.negative?(a.negative=0,this.imod(a).redNeg()):this.imod(a)},Red.prototype.pow=function(a,num){if(num.isZero())return new BN(1).toRed(this);if(0===num.cmpn(1))return a.clone();var wnd=new Array(16);wnd[0]=new BN(1).toRed(this),wnd[1]=a;for(var i=2;i<wnd.length;i++)wnd[i]=this.mul(wnd[i-1],a);var res=wnd[0],current=0,currentLen=0,start=num.bitLength()%26;for(0===start&&(start=26),i=num.length-1;0<=i;i--){for(var word=num.words[i],j=start-1;0<=j;j--){var bit=word>>j&1;res!==wnd[0]&&(res=this.sqr(res)),0==bit&&0===current?currentLen=0:(current=current<<1|bit,(4===++currentLen||0===i&&0===j)&&(res=this.mul(res,wnd[current]),current=currentLen=0))}start=26}return res},Red.prototype.convertTo=function(num){var r=num.umod(this.m);return r===num?r.clone():r},Red.prototype.convertFrom=function(num){num=num.clone();return num.red=null,num},BN.mont=function(num){return new Mont(num)},inherits(Mont,Red),Mont.prototype.convertTo=function(num){return this.imod(num.ushln(this.shift))},Mont.prototype.convertFrom=function(num){num=this.imod(num.mul(this.rinv));return num.red=null,num},Mont.prototype.imul=function(a,b){if(a.isZero()||b.isZero())return a.words[0]=0,a.length=1,a;a=a.imul(b),b=a.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),a=a.isub(b).iushrn(this.shift),b=a;return 0<=a.cmp(this.m)?b=a.isub(this.m):a.cmpn(0)<0&&(b=a.iadd(this.m)),b._forceRed(this)},Mont.prototype.mul=function(a,b){if(a.isZero()||b.isZero())return new BN(0)._forceRed(this);a=a.mul(b),b=a.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),a=a.isub(b).iushrn(this.shift),b=a;return 0<=a.cmp(this.m)?b=a.isub(this.m):a.cmpn(0)<0&&(b=a.iadd(this.m)),b._forceRed(this)},Mont.prototype.invm=function(a){return this.imod(a._invmp(this.m).mul(this.r2))._forceRed(this)}}(void 0===module||module,this)},{buffer:68}],23:[function(require,module,exports){const encodeChange=require("./columnar")["encodeChange"],BackendDoc=require("./new")["BackendDoc"],backendState=require("./util")["backendState"];function hashByActor(state,actorId,index){if(state.hashesByActor[actorId]&&state.hashesByActor[actorId][index])return state.hashesByActor[actorId][index];if(!state.haveHashGraph&&(state.computeHashGraph(),state.hashesByActor[actorId]&&state.hashesByActor[actorId][index]))return state.hashesByActor[actorId][index];throw new RangeError(`Unknown change: actorId = ${actorId}, seq = `+(index+1))}function getChanges(backend,haveDeps){if(Array.isArray(haveDeps))return backendState(backend).getChanges(haveDeps);throw new TypeError("Pass an array of hashes to Backend.getChanges()")}module.exports={init:function(){return{state:new BackendDoc,heads:[]}},clone:function(backend){return{state:backendState(backend).clone(),heads:backend.heads}},free:function(backend){backend.state=null,backend.frozen=!0},applyChanges:function(backend,changes){const state=backendState(backend);return changes=state.applyChanges(changes),backend.frozen=!0,[{state:state,heads:state.heads},changes]},applyLocalChange:function(backend,change){const state=backendState(backend);if(change.seq<=state.clock[change.actor])throw new RangeError("Change request has already been applied");if(1<change.seq){const lastHash=hashByActor(state,change.actor,change.seq-2);if(!lastHash)throw new RangeError("Cannot find hash of localChange before seq="+change.seq);let deps={[lastHash]:!0};for(var hash of change.deps)deps[hash]=!0;change.deps=Object.keys(deps).sort()}var binaryChange=encodeChange(change);const patch=state.applyChanges([binaryChange],!0),lastHash=(backend.frozen=!0,hashByActor(state,change.actor,change.seq-1));return patch.deps=patch.deps.filter(head=>head!==lastHash),[{state:state,heads:state.heads},patch,binaryChange]},save:function(backend){return backendState(backend).save()},load:function(data){return{state:data=new BackendDoc(data),heads:data.heads}},loadChanges:function(backend,changes){const state=backendState(backend);return state.applyChanges(changes),backend.frozen=!0,{state:state,heads:state.heads}},getPatch:function(backend){return backendState(backend).getPatch()},getHeads:function(backend){return backend.heads},getAllChanges:function(backend){return getChanges(backend,[])},getChanges:getChanges,getChangesAdded:function(backend1,backend2){return backendState(backend2).getChangesAdded(backendState(backend1))},getChangeByHash:function(backend,hash){return backendState(backend).getChangeByHash(hash)},getMissingDeps:function(backend,heads=[]){return backendState(backend).getMissingDeps(heads)}}},{"./columnar":24,"./new":27,"./util":29}],24:[function(require,module,exports){const pako=require("pako"),{copyObject,parseOpId,equalBytes}=require("../src/common"),{utf8ToString,hexStringToBytes,bytesToHexString,Encoder,Decoder,RLEEncoder,RLEDecoder,DeltaEncoder,DeltaDecoder,BooleanEncoder,BooleanDecoder}=require("./encoding"),Hash=require("fast-sha256")["Hash"],MAGIC_BYTES=new Uint8Array([133,111,74,131]),CHUNK_TYPE_DOCUMENT=0,CHUNK_TYPE_CHANGE=1,CHUNK_TYPE_DEFLATE=2,DEFLATE_MIN_SIZE=256,COLUMN_TYPE={GROUP_CARD:0,ACTOR_ID:1,INT_RLE:2,INT_DELTA:3,BOOLEAN:4,STRING_RLE:5,VALUE_LEN:6,VALUE_RAW:7},COLUMN_TYPE_DEFLATE=8,VALUE_TYPE={NULL:0,FALSE:1,TRUE:2,LEB128_UINT:3,LEB128_INT:4,IEEE754:5,UTF8:6,BYTES:7,COUNTER:8,TIMESTAMP:9,MIN_UNKNOWN:10,MAX_UNKNOWN:15},ACTIONS=["makeMap","set","makeList","del","makeText","inc","makeTable","link"];const COMMON_COLUMNS=[{columnName:"objActor",columnId:0|COLUMN_TYPE.ACTOR_ID},{columnName:"objCtr",columnId:0|COLUMN_TYPE.INT_RLE},{columnName:"keyActor",columnId:16|COLUMN_TYPE.ACTOR_ID},{columnName:"keyCtr",columnId:16|COLUMN_TYPE.INT_DELTA},{columnName:"keyStr",columnId:16|COLUMN_TYPE.STRING_RLE},{columnName:"idActor",columnId:32|COLUMN_TYPE.ACTOR_ID},{columnName:"idCtr",columnId:32|COLUMN_TYPE.INT_DELTA},{columnName:"insert",columnId:48|COLUMN_TYPE.BOOLEAN},{columnName:"action",columnId:64|COLUMN_TYPE.INT_RLE},{columnName:"valLen",columnId:80|COLUMN_TYPE.VALUE_LEN},{columnName:"valRaw",columnId:80|COLUMN_TYPE.VALUE_RAW},{columnName:"chldActor",columnId:96|COLUMN_TYPE.ACTOR_ID},{columnName:"chldCtr",columnId:96|COLUMN_TYPE.INT_DELTA}],CHANGE_COLUMNS=COMMON_COLUMNS.concat([{columnName:"predNum",columnId:112|COLUMN_TYPE.GROUP_CARD},{columnName:"predActor",columnId:112|COLUMN_TYPE.ACTOR_ID},{columnName:"predCtr",columnId:112|COLUMN_TYPE.INT_DELTA}]),DOC_OPS_COLUMNS=COMMON_COLUMNS.concat([{columnName:"succNum",columnId:128|COLUMN_TYPE.GROUP_CARD},{columnName:"succActor",columnId:128|COLUMN_TYPE.ACTOR_ID},{columnName:"succCtr",columnId:128|COLUMN_TYPE.INT_DELTA}]),DOCUMENT_COLUMNS=[{columnName:"actor",columnId:0|COLUMN_TYPE.ACTOR_ID},{columnName:"seq",columnId:0|COLUMN_TYPE.INT_DELTA},{columnName:"maxOp",columnId:16|COLUMN_TYPE.INT_DELTA},{columnName:"time",columnId:32|COLUMN_TYPE.INT_DELTA},{columnName:"message",columnId:48|COLUMN_TYPE.STRING_RLE},{columnName:"depsNum",columnId:64|COLUMN_TYPE.GROUP_CARD},{columnName:"depsIndex",columnId:64|COLUMN_TYPE.INT_DELTA},{columnName:"extraLen",columnId:80|COLUMN_TYPE.VALUE_LEN},{columnName:"extraRaw",columnId:80|COLUMN_TYPE.VALUE_RAW}];function actorIdToActorNum(opId,actorIds){if(!opId||!opId.actorId)return opId;var counter=opId.counter,actorIds=actorIds.indexOf(opId.actorId);if(actorIds<0)throw new RangeError("missing actorId");return{counter:counter,actorNum:actorIds,actorId:opId.actorId}}function compareParsedOpIds(id1,id2){return id1.counter<id2.counter?-1:id1.counter>id2.counter?1:id1.actorId<id2.actorId?-1:id1.actorId>id2.actorId?1:0}function parseAllOpIds(changes,single){const actors={},newChanges=[];for(var change of changes)change=copyObject(change),actors[change.actor]=!0,change.ops=function(ops,startOp,actor){let opNum=startOp,expandedOps=[];for(const op of ops)if("set"===op.action&&op.values&&op.insert){if(0!==op.pred.length)throw new RangeError("multi-insert pred must be empty");let lastElemId=op.elemId;var datatype=op.datatype;for(const value of op.values){if(!function(value,datatype){return void 0===datatype?"string"==typeof value||"boolean"==typeof value||null===value:"number"==typeof value}(value,datatype))throw new RangeError(`Decode failed: bad value/datatype association (${value},${datatype})`);expandedOps.push({action:"set",obj:op.obj,elemId:lastElemId,datatype:datatype,value:value,pred:[],insert:!0}),lastElemId=opNum+"@"+actor,opNum+=1}}else if("del"===op.action&&1<op.multiOp){if(1!==op.pred.length)throw new RangeError("multiOp deletion must have exactly one pred");var startElemId=parseOpId(op.elemId),startPred=parseOpId(op.pred[0]);for(let i=0;i<op.multiOp;i++){var elemId=startElemId.counter+i+"@"+startElemId.actorId,pred=[startPred.counter+i+"@"+startPred.actorId];expandedOps.push({action:"del",obj:op.obj,elemId:elemId,pred:pred}),opNum+=1}}else expandedOps.push(op),opNum+=1;return expandedOps}(change.ops,change.startOp,change.actor),change.ops=change.ops.map(op=>{"_root"!==(op=copyObject(op)).obj&&(op.obj=parseOpId(op.obj)),op.elemId&&"_head"!==op.elemId&&(op.elemId=parseOpId(op.elemId)),op.child&&(op.child=parseOpId(op.child)),op.pred&&(op.pred=op.pred.map(parseOpId)),op.obj.actorId&&(actors[op.obj.actorId]=!0),op.elemId&&op.elemId.actorId&&(actors[op.elemId.actorId]=!0),op.child&&op.child.actorId&&(actors[op.child.actorId]=!0);for(var pred of op.pred)actors[pred.actorId]=!0;return op}),newChanges.push(change);let actorIds=Object.keys(actors).sort();single&&(actorIds=[changes[0].actor].concat(actorIds.filter(actor=>actor!==changes[0].actor)));for(let change of newChanges){change.actorNum=actorIds.indexOf(change.actor);for(let i=0;i<change.ops.length;i++){let op=change.ops[i];op.id={counter:change.startOp+i,actorNum:change.actorNum,actorId:change.actor},op.obj=actorIdToActorNum(op.obj,actorIds),op.elemId=actorIdToActorNum(op.elemId,actorIds),op.child=actorIdToActorNum(op.child,actorIds),op.pred=op.pred.map(pred=>actorIdToActorNum(pred,actorIds))}}return{changes:newChanges,actorIds:actorIds}}function encodeValue(op,columns){if("set"!==op.action&&"inc"!==op.action||null===op.value)columns.valLen.appendValue(VALUE_TYPE.NULL);else if(!1===op.value)columns.valLen.appendValue(VALUE_TYPE.FALSE);else if(!0===op.value)columns.valLen.appendValue(VALUE_TYPE.TRUE);else if("string"==typeof op.value){var numBytes=columns.valRaw.appendRawString(op.value);columns.valLen.appendValue(numBytes<<4|VALUE_TYPE.UTF8)}else if(ArrayBuffer.isView(op.value)){const numBytes=columns.valRaw.appendRawBytes(new Uint8Array(op.value.buffer));columns.valLen.appendValue(numBytes<<4|VALUE_TYPE.BYTES)}else if("number"==typeof op.value){var[typeTag,value]=function(op){switch(op.datatype){case"counter":return[VALUE_TYPE.COUNTER,op.value];case"timestamp":return[VALUE_TYPE.TIMESTAMP,op.value];case"uint":return[VALUE_TYPE.LEB128_UINT,op.value];case"int":return[VALUE_TYPE.LEB128_INT,op.value];case"float64":{const buf64=new ArrayBuffer(8),view64=new DataView(buf64);return view64.setFloat64(0,op.value,!0),[VALUE_TYPE.IEEE754,new Uint8Array(buf64)]}default:if(Number.isInteger(op.value)&&op.value<=Number.MAX_SAFE_INTEGER&&op.value>=Number.MIN_SAFE_INTEGER)return[VALUE_TYPE.LEB128_INT,op.value];{const buf64=new ArrayBuffer(8),view64=new DataView(buf64);return view64.setFloat64(0,op.value,!0),[VALUE_TYPE.IEEE754,new Uint8Array(buf64)]}}}(op);let numBytes;numBytes=typeTag===VALUE_TYPE.LEB128_UINT?columns.valRaw.appendUint53(value):typeTag===VALUE_TYPE.IEEE754?columns.valRaw.appendRawBytes(value):columns.valRaw.appendInt53(value),columns.valLen.appendValue(numBytes<<4|typeTag)}else{if(!("number"==typeof op.datatype&&op.datatype>=VALUE_TYPE.MIN_UNKNOWN&&op.datatype<=VALUE_TYPE.MAX_UNKNOWN&&op.value instanceof Uint8Array))throw op.datatype?new RangeError(`Unknown datatype ${op.datatype} for value `+op.value):new RangeError("Unsupported value in operation: "+op.value);{const numBytes=columns.valRaw.appendRawBytes(op.value);columns.valLen.appendValue(numBytes<<4|op.datatype)}}}function decodeValue(sizeTag,bytes){if(sizeTag===VALUE_TYPE.NULL)return{value:null};if(sizeTag===VALUE_TYPE.FALSE)return{value:!1};if(sizeTag===VALUE_TYPE.TRUE)return{value:!0};if(sizeTag%16===VALUE_TYPE.UTF8)return{value:utf8ToString(bytes)};if(sizeTag%16===VALUE_TYPE.LEB128_UINT)return{value:new Decoder(bytes).readUint53(),datatype:"uint"};if(sizeTag%16===VALUE_TYPE.LEB128_INT)return{value:new Decoder(bytes).readInt53(),datatype:"int"};if(sizeTag%16!==VALUE_TYPE.IEEE754)return sizeTag%16===VALUE_TYPE.COUNTER?{value:new Decoder(bytes).readInt53(),datatype:"counter"}:sizeTag%16===VALUE_TYPE.TIMESTAMP?{value:new Decoder(bytes).readInt53(),datatype:"timestamp"}:{value:bytes,datatype:sizeTag%16};{const view=new DataView(bytes.buffer,bytes.byteOffset,bytes.byteLength);if(8===bytes.byteLength)return{value:view.getFloat64(0,!0),datatype:"float64"};throw new RangeError("Invalid length for floating point number: "+bytes.byteLength)}}function decodeValueColumns(columns,colIndex,actorIds,result){const{columnId,columnName,decoder}=columns[colIndex];if(columnId%8===COLUMN_TYPE.VALUE_LEN&&colIndex+1<columns.length&&columns[colIndex+1].columnId===columnId+1)return{value:columns,datatype:colIndex}=decodeValue(sizeTag=decoder.readValue(),columns[colIndex+1].decoder.readRawBytes(sizeTag>>4)),result[columnName]=columns,colIndex&&(result[columnName+"_datatype"]=colIndex),2;if(columnId%8===COLUMN_TYPE.ACTOR_ID){var sizeTag=decoder.readValue();if(null===sizeTag)result[columnName]=null;else{if(!actorIds[sizeTag])throw new RangeError("No actor index "+sizeTag);result[columnName]=actorIds[sizeTag]}}else result[columnName]=decoder.readValue();return 1}function encodeOps(ops,forDocument){const columns={objActor:new RLEEncoder("uint"),objCtr:new RLEEncoder("uint"),keyActor:new RLEEncoder("uint"),keyCtr:new DeltaEncoder,keyStr:new RLEEncoder("utf8"),insert:new BooleanEncoder,action:new RLEEncoder("uint"),valLen:new RLEEncoder("uint"),valRaw:new Encoder,chldActor:new RLEEncoder("uint"),chldCtr:new DeltaEncoder};forDocument?(columns.idActor=new RLEEncoder("uint"),columns.idCtr=new DeltaEncoder,columns.succNum=new RLEEncoder("uint"),columns.succActor=new RLEEncoder("uint"),columns.succCtr=new DeltaEncoder):(columns.predNum=new RLEEncoder("uint"),columns.predCtr=new DeltaEncoder,columns.predActor=new RLEEncoder("uint"));for(var op of ops)if(!function(op,columns){if("_root"===op.obj)columns.objActor.appendValue(null),columns.objCtr.appendValue(null);else{if(!(0<=op.obj.actorNum&&0<op.obj.counter))throw new RangeError("Unexpected objectId reference: "+JSON.stringify(op.obj));columns.objActor.appendValue(op.obj.actorNum),columns.objCtr.appendValue(op.obj.counter)}}(op,columns),!function(op,columns){if(op.key)columns.keyActor.appendValue(null),columns.keyCtr.appendValue(null),columns.keyStr.appendValue(op.key);else if("_head"===op.elemId&&op.insert)columns.keyActor.appendValue(null),columns.keyCtr.appendValue(0),columns.keyStr.appendValue(null);else{if(!(op.elemId&&0<=op.elemId.actorNum&&0<op.elemId.counter))throw new RangeError("Unexpected operation key: "+JSON.stringify(op));columns.keyActor.appendValue(op.elemId.actorNum),columns.keyCtr.appendValue(op.elemId.counter),columns.keyStr.appendValue(null)}}(op,columns),columns.insert.appendValue(!!op.insert),!function(op,columns){var actionCode=ACTIONS.indexOf(op.action);if(0<=actionCode)columns.action.appendValue(actionCode);else{if("number"!=typeof op.action)throw new RangeError("Unexpected operation action: "+op.action);columns.action.appendValue(op.action)}}(op,columns),encodeValue(op,columns),op.child&&op.child.counter?(columns.chldActor.appendValue(op.child.actorNum),columns.chldCtr.appendValue(op.child.counter)):(columns.chldActor.appendValue(null),columns.chldCtr.appendValue(null)),forDocument){columns.idActor.appendValue(op.id.actorNum),columns.idCtr.appendValue(op.id.counter),columns.succNum.appendValue(op.succ.length),op.succ.sort(compareParsedOpIds);for(let i=0;i<op.succ.length;i++)columns.succActor.appendValue(op.succ[i].actorNum),columns.succCtr.appendValue(op.succ[i].counter)}else{columns.predNum.appendValue(op.pred.length),op.pred.sort(compareParsedOpIds);for(let i=0;i<op.pred.length;i++)columns.predActor.appendValue(op.pred[i].actorNum),columns.predCtr.appendValue(op.pred[i].counter)}let columnList=[];for(var{columnName,columnId}of forDocument?DOC_OPS_COLUMNS:CHANGE_COLUMNS)columns[columnName]&&columnList.push({columnId:columnId,columnName:columnName,encoder:columns[columnName]});return columnList.sort((a,b)=>a.columnId-b.columnId)}function decodeOps(ops,forDocument){const newOps=[];for(var op of ops){var obj=null===op.objCtr?"_root":op.objCtr+"@"+op.objActor,elemId=op.keyStr?void 0:0===op.keyCtr?"_head":op.keyCtr+"@"+op.keyActor,action=ACTIONS[op.action]||op.action;const newOp=elemId?{obj:obj,elemId:elemId,action:action}:{obj:obj,key:op.keyStr,action:action};if(newOp.insert=!!op.insert,"set"!==ACTIONS[op.action]&&"inc"!==ACTIONS[op.action]||(newOp.value=op.valLen,op.valLen_datatype&&(newOp.datatype=op.valLen_datatype)),!!op.chldCtr!=!!op.chldActor)throw new RangeError(`Mismatched child columns: ${op.chldCtr} and `+op.chldActor);null!==op.chldCtr&&(newOp.child=op.chldCtr+"@"+op.chldActor),forDocument?(newOp.id=op.idCtr+"@"+op.idActor,newOp.succ=op.succNum.map(succ=>succ.succCtr+"@"+succ.succActor),checkSortedOpIds(op.succNum.map(succ=>({counter:succ.succCtr,actorId:succ.succActor})))):(newOp.pred=op.predNum.map(pred=>pred.predCtr+"@"+pred.predActor),checkSortedOpIds(op.predNum.map(pred=>({counter:pred.predCtr,actorId:pred.predActor})))),newOps.push(newOp)}return newOps}function checkSortedOpIds(opIds){let last=null;for(var opId of opIds){if(last&&-1!==compareParsedOpIds(last,opId))throw new RangeError("operation IDs are not in ascending order");last=opId}}function decoderByColumnId(columnId,buffer){return(7&columnId)===COLUMN_TYPE.INT_DELTA?new DeltaDecoder(buffer):(7&columnId)===COLUMN_TYPE.BOOLEAN?new BooleanDecoder(buffer):(7&columnId)===COLUMN_TYPE.STRING_RLE?new RLEDecoder("utf8",buffer):(7&columnId)===COLUMN_TYPE.VALUE_RAW?new Decoder(buffer):new RLEDecoder("uint",buffer)}function makeDecoders(columns,columnSpec){var emptyBuf=new Uint8Array(0);let decoders=[],columnIndex=0,specIndex=0;for(;columnIndex<columns.length||specIndex<columnSpec.length;)if(columnIndex===columns.length||specIndex<columnSpec.length&&columnSpec[specIndex].columnId<columns[columnIndex].columnId){var{columnId,columnName}=columnSpec[specIndex];decoders.push({columnId:columnId,columnName:columnName,decoder:decoderByColumnId(columnId,emptyBuf)}),specIndex++}else if(specIndex===columnSpec.length||columns[columnIndex].columnId<columnSpec[specIndex].columnId){const{columnId,buffer}=columns[columnIndex];decoders.push({columnId:columnId,decoder:decoderByColumnId(columnId,buffer)}),columnIndex++}else{const{columnId,buffer}=columns[columnIndex],columnName=columnSpec[specIndex]["columnName"];decoders.push({columnId:columnId,columnName:columnName,decoder:decoderByColumnId(columnId,buffer)}),columnIndex++,specIndex++}return decoders}function decodeColumns(columns,actorIds,columnSpec){columns=makeDecoders(columns,columnSpec);let parsedRows=[];for(;columns.some(col=>!col.decoder.done);){let row={},col=0;for(;col<columns.length;){var columnId=columns[col].columnId;let groupId=columnId>>4,groupCols=1;for(;col+groupCols<columns.length&&columns[col+groupCols].columnId>>4==groupId;)groupCols++;if(columnId%8===COLUMN_TYPE.GROUP_CARD){const values=[],count=columns[col].decoder.readValue();for(let i=0;i<count;i++){var value={};for(let colOffset=1;colOffset<groupCols;colOffset++)decodeValueColumns(columns,col+colOffset,actorIds,value);values.push(value)}row[columns[col].columnName]=values,col+=groupCols}else col+=decodeValueColumns(columns,col,actorIds,row)}parsedRows.push(row)}return parsedRows}function decodeColumnInfo(decoder){var COLUMN_ID_MASK=(-1^COLUMN_TYPE_DEFLATE)>>>0;let lastColumnId=-1,columns=[],numColumns=decoder.readUint53();for(let i=0;i<numColumns;i++){var columnId=decoder.readUint53(),bufferLen=decoder.readUint53();if((columnId&COLUMN_ID_MASK)<=(lastColumnId&COLUMN_ID_MASK))throw new RangeError("Columns must be in ascending order");lastColumnId=columnId,columns.push({columnId:columnId,bufferLen:bufferLen})}return columns}function encodeColumnInfo(encoder,columns){var column,columns=columns.filter(column=>0<column.encoder.buffer.byteLength);encoder.appendUint53(columns.length);for(column of columns)encoder.appendUint53(column.columnId),encoder.appendUint53(column.encoder.buffer.byteLength)}function decodeChangeHeader(decoder){const numDeps=decoder.readUint53(),deps=[];for(let i=0;i<numDeps;i++)deps.push(bytesToHexString(decoder.readRawBytes(32)));let change={actor:decoder.readHexString(),seq:decoder.readUint53(),startOp:decoder.readUint53(),time:decoder.readInt53(),message:decoder.readPrefixedString(),deps:deps};const actorIds=[change.actor],numActorIds=decoder.readUint53();for(let i=0;i<numActorIds;i++)actorIds.push(decoder.readHexString());return change.actorIds=actorIds,change}function encodeContainer(chunkType,encodeContentsCallback){var HEADER_SPACE=MAGIC_BYTES.byteLength+4+1+5;const body=new Encoder,bodyBuf=(body.appendRawBytes(new Uint8Array(HEADER_SPACE)),encodeContentsCallback(body),body.buffer),header=new Encoder;header.appendByte(chunkType),header.appendUint53(bodyBuf.byteLength-HEADER_SPACE);encodeContentsCallback=header.buffer;const sha256=new Hash,hash=(sha256.update(encodeContentsCallback),sha256.update(bodyBuf.subarray(HEADER_SPACE)),sha256.digest()),checksum=hash.subarray(0,4);return bodyBuf.set(MAGIC_BYTES,HEADER_SPACE-encodeContentsCallback.byteLength-4-MAGIC_BYTES.byteLength),bodyBuf.set(checksum,HEADER_SPACE-encodeContentsCallback.byteLength-4),bodyBuf.set(encodeContentsCallback,HEADER_SPACE-encodeContentsCallback.byteLength),{hash:hash,bytes:bodyBuf.subarray(HEADER_SPACE-encodeContentsCallback.byteLength-4-MAGIC_BYTES.byteLength)}}function decodeContainerHeader(decoder,computeHash){if(!equalBytes(decoder.readRawBytes(MAGIC_BYTES.byteLength),MAGIC_BYTES))throw new RangeError("Data does not begin with magic bytes 85 6f 4a 83");var expectedHash=decoder.readRawBytes(4),hashStartOffset=decoder.offset,chunkType=decoder.readByte(),chunkLength=decoder.readUint53();const header={chunkType:chunkType,chunkLength:chunkLength,chunkData:decoder.readRawBytes(chunkLength)};if(computeHash){const sha256=new Hash,binaryHash=(sha256.update(decoder.buf.subarray(hashStartOffset,decoder.offset)),sha256.digest());if(!equalBytes(binaryHash.subarray(0,4),expectedHash))throw new RangeError("checksum does not match data");header.hash=bytesToHexString(binaryHash)}return header}function encodeChange(changeObj){const{changes,actorIds}=parseAllOpIds([changeObj],!0),change=changes[0];var{hash,bytes}=encodeContainer(CHUNK_TYPE_CHANGE,encoder=>{if(!Array.isArray(change.deps))throw new TypeError("deps is not an array");encoder.appendUint53(change.deps.length);for(var hash of change.deps.slice().sort())encoder.appendRawBytes(hexStringToBytes(hash));encoder.appendHexString(change.actor),encoder.appendUint53(change.seq),encoder.appendUint53(change.startOp),encoder.appendInt53(change.time),encoder.appendPrefixedString(change.message||""),encoder.appendUint53(actorIds.length-1);for(var actor of actorIds.slice(1))encoder.appendHexString(actor);var column,columns=encodeOps(change.ops,!1);encodeColumnInfo(encoder,columns);for(column of columns)encoder.appendRawBytes(column.encoder.buffer);change.extraBytes&&encoder.appendRawBytes(change.extraBytes)}),hash=bytesToHexString(hash);if(changeObj.hash&&changeObj.hash!==hash)throw new RangeError(`Change hash does not match encoding: ${changeObj.hash} != `+hash);if(bytes.byteLength>=DEFLATE_MIN_SIZE){changeObj=bytes,hash=decodeContainerHeader(new Decoder(changeObj),!1);if(hash.chunkType!==CHUNK_TYPE_CHANGE)throw new RangeError("Unexpected chunk type: "+hash.chunkType);const compressed=pako.deflateRaw(hash.chunkData),encoder=new Encoder;return encoder.appendRawBytes(changeObj.subarray(0,8)),encoder.appendByte(CHUNK_TYPE_DEFLATE),encoder.appendUint53(compressed.byteLength),encoder.appendRawBytes(compressed),encoder.buffer}return bytes}function decodeChangeColumns(buffer){buffer[8]===CHUNK_TYPE_DEFLATE&&(buffer=inflateChange(buffer));var buffer=new Decoder(buffer),header=decodeContainerHeader(buffer,!0);const chunkDecoder=new Decoder(header.chunkData);if(!buffer.done)throw new RangeError("Encoded change has trailing data");if(header.chunkType!==CHUNK_TYPE_CHANGE)throw new RangeError("Unexpected chunk type: "+header.chunkType);const change=decodeChangeHeader(chunkDecoder),columns=decodeColumnInfo(chunkDecoder);for(let i=0;i<columns.length;i++){if(0!=(columns[i].columnId&COLUMN_TYPE_DEFLATE))throw new RangeError("change must not contain deflated columns");columns[i].buffer=chunkDecoder.readRawBytes(columns[i].bufferLen)}return chunkDecoder.done||(buffer=chunkDecoder.buf.byteLength-chunkDecoder.offset,change.extraBytes=chunkDecoder.readRawBytes(buffer)),change.columns=columns,change.hash=header.hash,change}function decodeChange(buffer){const change=decodeChangeColumns(buffer);return change.ops=decodeOps(decodeColumns(change.columns,change.actorIds,CHANGE_COLUMNS),!1),delete change.actorIds,delete change.columns,change}function inflateChange(buffer){var header=decodeContainerHeader(new Decoder(buffer),!1);if(header.chunkType!==CHUNK_TYPE_DEFLATE)throw new RangeError("Unexpected chunk type: "+header.chunkType);header=pako.inflateRaw(header.chunkData);const encoder=new Encoder;return encoder.appendRawBytes(buffer.subarray(0,8)),encoder.appendByte(CHUNK_TYPE_CHANGE),encoder.appendUint53(header.byteLength),encoder.appendRawBytes(header),encoder.buffer}function splitContainers(buffer){let decoder=new Decoder(buffer),chunks=[],startOffset=0;for(;!decoder.done;)decodeContainerHeader(decoder,!1),chunks.push(buffer.subarray(startOffset,decoder.offset)),startOffset=decoder.offset;return chunks}function groupChangeOps(changes,ops){let changesByActor={};for(var change of changes){if(change.ops=[],changesByActor[change.actor]||(changesByActor[change.actor]=[]),change.seq!==changesByActor[change.actor].length+1)throw new RangeError(`Expected seq = ${changesByActor[change.actor].length+1}, got `+change.seq);if(1<change.seq&&changesByActor[change.actor][change.seq-2].maxOp>change.maxOp)throw new RangeError("maxOp must increase monotonically per actor");changesByActor[change.actor].push(change)}let opsById={};for(var op of ops){if("del"===op.action)throw new RangeError("document should not contain del operations");op.pred=opsById[op.id]?opsById[op.id].pred:[];for(var succ of(opsById[op.id]=op).succ){var elemId;opsById[succ]||(op.elemId?(elemId=op.insert?op.id:op.elemId,opsById[succ]={id:succ,action:"del",obj:op.obj,elemId:elemId,pred:[]}):opsById[succ]={id:succ,action:"del",obj:op.obj,key:op.key,pred:[]}),opsById[succ].pred.push(op.id)}delete op.succ}for(let op of Object.values(opsById))"del"===op.action&&ops.push(op);for(let op of ops){var{counter,actorId}=parseOpId(op.id);const actorChanges=changesByActor[actorId];let left=0,right=actorChanges.length;for(;left<right;){var index=Math.floor((left+right)/2);actorChanges[index].maxOp<counter?left=index+1:right=index}if(left>=actorChanges.length)throw new RangeError(`Operation ID ${op.id} outside of allowed range`);actorChanges[left].ops.push(op)}for(let change of changes){change.ops.sort((op1,op2)=>{op1=op1.id,op2=op2.id;return op1===op2?0:"_root"===op1?-1:"_root"===op2?1:(op1=parseOpId(op1),op2=parseOpId(op2),op1.counter<op2.counter?-1:op1.counter>op2.counter?1:op1.actorId<op2.actorId?-1:op1.actorId>op2.actorId?1:0)}),change.startOp=change.maxOp-change.ops.length+1,delete change.maxOp;for(let i=0;i<change.ops.length;i++){const op=change.ops[i],expectedId=change.startOp+i+"@"+change.actor;if(op.id!==expectedId)throw new RangeError(`Expected opId ${expectedId}, got `+op.id);delete op.id}}}function decodeDocumentHeader(buffer){var buffer=new Decoder(buffer),header=decodeContainerHeader(buffer,!0);const decoder=new Decoder(header.chunkData);if(!buffer.done)throw new RangeError("Encoded document has trailing data");if(header.chunkType!==CHUNK_TYPE_DOCUMENT)throw new RangeError("Unexpected chunk type: "+header.chunkType);const actorIds=[],numActors=decoder.readUint53();for(let i=0;i<numActors;i++)actorIds.push(decoder.readHexString());const heads=[],headsIndexes=[],numHeads=decoder.readUint53();for(let i=0;i<numHeads;i++)heads.push(bytesToHexString(decoder.readRawBytes(32)));const changesColumns=decodeColumnInfo(decoder),opsColumns=decodeColumnInfo(decoder);for(let i=0;i<changesColumns.length;i++)changesColumns[i].buffer=decoder.readRawBytes(changesColumns[i].bufferLen),inflateColumn(changesColumns[i]);for(let i=0;i<opsColumns.length;i++)opsColumns[i].buffer=decoder.readRawBytes(opsColumns[i].bufferLen),inflateColumn(opsColumns[i]);if(!decoder.done)for(let i=0;i<numHeads;i++)headsIndexes.push(decoder.readUint53());buffer=decoder.readRawBytes(decoder.buf.byteLength-decoder.offset);return{changesColumns:changesColumns,opsColumns:opsColumns,actorIds:actorIds,heads:heads,headsIndexes:headsIndexes,extraBytes:buffer}}function decodeDocument(buffer){var{changesColumns:buffer,opsColumns,actorIds,heads}=decodeDocumentHeader(buffer),buffer=decodeColumns(buffer,actorIds,DOCUMENT_COLUMNS);return groupChangeOps(buffer,decodeOps(decodeColumns(opsColumns,actorIds,DOC_OPS_COLUMNS),!0)),function(changes,expectedHeads){let heads={};for(let i=0;i<changes.length;i++){let change=changes[i];change.deps=[];for(var index of change.depsNum.map(d=>d.depsIndex)){if(!changes[index]||!changes[index].hash)throw new RangeError(`No hash for index ${index} while processing index `+i);index=changes[index].hash;change.deps.push(index),heads[index]&&delete heads[index]}if(change.deps.sort(),delete change.depsNum,change.extraLen_datatype!==VALUE_TYPE.BYTES)throw new RangeError("Bad datatype for extra bytes: "+VALUE_TYPE.BYTES);change.extraBytes=change.extraLen,delete change.extraLen_datatype,changes[i]=decodeChange(encodeChange(change)),heads[changes[i].hash]=!0}const actualHeads=Object.keys(heads).sort();let headsEqual=actualHeads.length===expectedHeads.length,i=0;for(;headsEqual&&i<actualHeads.length;)headsEqual=actualHeads[i]===expectedHeads[i],i++;if(!headsEqual)throw new RangeError(`Mismatched heads hashes: expected ${expectedHeads.join(", ")}, got `+actualHeads.join(", "))}(buffer,heads),buffer}function deflateColumn(column){column.encoder.buffer.byteLength>=DEFLATE_MIN_SIZE&&(column.encoder={buffer:pako.deflateRaw(column.encoder.buffer)},column.columnId|=COLUMN_TYPE_DEFLATE)}function inflateColumn(column){0!=(column.columnId&COLUMN_TYPE_DEFLATE)&&(column.buffer=pako.inflateRaw(column.buffer),column.columnId^=COLUMN_TYPE_DEFLATE)}module.exports={COLUMN_TYPE:COLUMN_TYPE,VALUE_TYPE:VALUE_TYPE,ACTIONS:ACTIONS,OBJECT_TYPE:{makeMap:"map",makeList:"list",makeText:"text",makeTable:"table"},DOC_OPS_COLUMNS:DOC_OPS_COLUMNS,CHANGE_COLUMNS:CHANGE_COLUMNS,DOCUMENT_COLUMNS:DOCUMENT_COLUMNS,encoderByColumnId:function(columnId){return(7&columnId)===COLUMN_TYPE.INT_DELTA?new DeltaEncoder:(7&columnId)===COLUMN_TYPE.BOOLEAN?new BooleanEncoder:(7&columnId)===COLUMN_TYPE.STRING_RLE?new RLEEncoder("utf8"):(7&columnId)===COLUMN_TYPE.VALUE_RAW?new Encoder:new RLEEncoder("uint")},decoderByColumnId:decoderByColumnId,makeDecoders:makeDecoders,decodeValue:decodeValue,splitContainers:splitContainers,encodeChange:encodeChange,decodeChangeColumns:decodeChangeColumns,decodeChange:decodeChange,decodeChangeMeta:function(buffer,computeHash){buffer[8]===CHUNK_TYPE_DEFLATE&&(buffer=inflateChange(buffer));var header=decodeContainerHeader(new Decoder(buffer),computeHash);if(header.chunkType!==CHUNK_TYPE_CHANGE)throw new RangeError("Buffer chunk type is not a change");const meta=decodeChangeHeader(new Decoder(header.chunkData));return meta.change=buffer,computeHash&&(meta.hash=header.hash),meta},decodeChanges:function(binaryChanges){let decoded=[];for(var binaryChange of binaryChanges)for(var chunk of splitContainers(binaryChange))chunk[8]===CHUNK_TYPE_DOCUMENT?decoded=decoded.concat(decodeDocument(chunk)):chunk[8]!==CHUNK_TYPE_CHANGE&&chunk[8]!==CHUNK_TYPE_DEFLATE||decoded.push(decodeChange(chunk));return decoded},encodeDocumentHeader:function(doc){const{changesColumns,opsColumns,actorIds,heads,headsIndexes,extraBytes}=doc;for(var column of changesColumns)deflateColumn(column);for(let column of opsColumns)deflateColumn(column);return encodeContainer(CHUNK_TYPE_DOCUMENT,encoder=>{encoder.appendUint53(actorIds.length);for(var actor of actorIds)encoder.appendHexString(actor);encoder.appendUint53(heads.length);for(var head of heads.sort())encoder.appendRawBytes(hexStringToBytes(head));encodeColumnInfo(encoder,changesColumns),encodeColumnInfo(encoder,opsColumns);for(var column of changesColumns)encoder.appendRawBytes(column.encoder.buffer);for(let column of opsColumns)encoder.appendRawBytes(column.encoder.buffer);for(var index of headsIndexes)encoder.appendUint53(index);extraBytes&&encoder.appendRawBytes(extraBytes)}).bytes},decodeDocumentHeader:decodeDocumentHeader,decodeDocument:decodeDocument}},{"../src/common":62,"./encoding":25,"fast-sha256":180,pako:40}],25:[function(require,module,exports){const utf8encoder=new TextEncoder,utf8decoder=new TextDecoder("utf-8");function stringToUtf8(string){return utf8encoder.encode(string)}function utf8ToString(buffer){return utf8decoder.decode(buffer)}function hexStringToBytes(value){if("string"!=typeof value)throw new TypeError("value is not a string");if(/^([0-9a-f][0-9a-f])*$/.test(value))return""===value?new Uint8Array(0):new Uint8Array(value.match(/../g).map(b=>parseInt(b,16)));throw new RangeError("value is not hexadecimal")}var NIBBLE_TO_HEX=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"];const BYTE_TO_HEX=new Array(256);for(let i=0;i<256;i++)BYTE_TO_HEX[i]=""+NIBBLE_TO_HEX[i>>>4&15]+NIBBLE_TO_HEX[15&i];function bytesToHexString(bytes){let hex="",len=bytes.byteLength;for(let i=0;i<len;i++)hex+=BYTE_TO_HEX[bytes[i]];return hex}class Encoder{constructor(){this.buf=new Uint8Array(16),this.offset=0}get buffer(){return this.finish(),this.buf.subarray(0,this.offset)}grow(minSize=0){let newSize=4*this.buf.byteLength;for(;newSize<minSize;)newSize*=2;const newBuf=new Uint8Array(newSize);return newBuf.set(this.buf,0),this.buf=newBuf,this}appendByte(value){this.offset>=this.buf.byteLength&&this.grow(),this.buf[this.offset]=value,this.offset+=1}appendUint32(value){if(!Number.isInteger(value))throw new RangeError("value is not an integer");if(value<0||4294967295<value)throw new RangeError("number out of range");var numBytes=Math.max(1,Math.ceil((32-Math.clz32(value))/7));this.offset+numBytes>this.buf.byteLength&&this.grow();for(let i=0;i<numBytes;i++)this.buf[this.offset+i]=127&value|(i===numBytes-1?0:128),value>>>=7;return this.offset+=numBytes,numBytes}appendInt32(value){if(!Number.isInteger(value))throw new RangeError("value is not an integer");if(value<-2147483648||2147483647<value)throw new RangeError("number out of range");var numBytes=Math.ceil((33-Math.clz32(0<=value?value:-value-1))/7);this.offset+numBytes>this.buf.byteLength&&this.grow();for(let i=0;i<numBytes;i++)this.buf[this.offset+i]=127&value|(i===numBytes-1?0:128),value>>=7;return this.offset+=numBytes,numBytes}appendUint53(value){if(!Number.isInteger(value))throw new RangeError("value is not an integer");if(value<0||value>Number.MAX_SAFE_INTEGER)throw new RangeError("number out of range");var high32=Math.floor(value/4294967296);return this.appendUint64(high32,(4294967295&value)>>>0)}appendInt53(value){if(!Number.isInteger(value))throw new RangeError("value is not an integer");if(value<Number.MIN_SAFE_INTEGER||value>Number.MAX_SAFE_INTEGER)throw new RangeError("number out of range");var high32=Math.floor(value/4294967296);return this.appendInt64(high32,(4294967295&value)>>>0)}appendUint64(high32,low32){if(!Number.isInteger(high32)||!Number.isInteger(low32))throw new RangeError("value is not an integer");if(high32<0||4294967295<high32||low32<0||4294967295<low32)throw new RangeError("number out of range");if(0===high32)return this.appendUint32(low32);var numBytes=Math.ceil((64-Math.clz32(high32))/7);this.offset+numBytes>this.buf.byteLength&&this.grow();for(let i=0;i<4;i++)this.buf[this.offset+i]=127&low32|128,low32>>>=7;this.buf[this.offset+4]=15&low32|(7&high32)<<4|(5===numBytes?0:128),high32>>>=3;for(let i=5;i<numBytes;i++)this.buf[this.offset+i]=127&high32|(i===numBytes-1?0:128),high32>>>=7;return this.offset+=numBytes,numBytes}appendInt64(high32,low32){if(!Number.isInteger(high32)||!Number.isInteger(low32))throw new RangeError("value is not an integer");if(high32<-2147483648||2147483647<high32||low32<-2147483648||4294967295<low32)throw new RangeError("number out of range");if(low32>>>=0,0===high32&&low32<=2147483647)return this.appendInt32(low32);if(-1===high32&&2147483648<=low32)return this.appendInt32(low32-4294967296);var numBytes=Math.ceil((65-Math.clz32(0<=high32?high32:-high32-1))/7);this.offset+numBytes>this.buf.byteLength&&this.grow();for(let i=0;i<4;i++)this.buf[this.offset+i]=127&low32|128,low32>>>=7;this.buf[this.offset+4]=15&low32|(7&high32)<<4|(5===numBytes?0:128),high32>>=3;for(let i=5;i<numBytes;i++)this.buf[this.offset+i]=127&high32|(i===numBytes-1?0:128),high32>>=7;return this.offset+=numBytes,numBytes}appendRawBytes(data){return this.offset+data.byteLength>this.buf.byteLength&&this.grow(this.offset+data.byteLength),this.buf.set(data,this.offset),this.offset+=data.byteLength,data.byteLength}appendRawString(value){if("string"!=typeof value)throw new TypeError("value is not a string");return this.appendRawBytes(stringToUtf8(value))}appendPrefixedBytes(data){return this.appendUint53(data.byteLength),this.appendRawBytes(data),this}appendPrefixedString(value){if("string"!=typeof value)throw new TypeError("value is not a string");return this.appendPrefixedBytes(stringToUtf8(value)),this}appendHexString(value){return this.appendPrefixedBytes(hexStringToBytes(value)),this}finish(){}}class Decoder{constructor(buffer){if(!(buffer instanceof Uint8Array))throw new TypeError("Not a byte array: "+buffer);this.buf=buffer,this.offset=0}get done(){return this.offset===this.buf.byteLength}reset(){this.offset=0}skip(bytes){if(this.offset+bytes>this.buf.byteLength)throw new RangeError("cannot skip beyond end of buffer");this.offset+=bytes}readByte(){return this.offset+=1,this.buf[this.offset-1]}readUint32(){let result=0,shift=0;for(;this.offset<this.buf.byteLength;){var nextByte=this.buf[this.offset];if(28===shift&&0!=(240&nextByte))throw new RangeError("number out of range");if(result=(result|(127&nextByte)<<shift)>>>0,shift+=7,this.offset++,0==(128&nextByte))return result}throw new RangeError("buffer ended with incomplete number")}readInt32(){let result=0,shift=0;for(;this.offset<this.buf.byteLength;){var nextByte=this.buf[this.offset];if(28===shift&&0!=(128&nextByte)||28===shift&&0==(64&nextByte)&&0!=(56&nextByte)||28===shift&&0!=(64&nextByte)&&56!=(56&nextByte))throw new RangeError("number out of range");if(result|=(127&nextByte)<<shift,shift+=7,this.offset++,0==(128&nextByte))return 0==(64&nextByte)||28<shift?result:result|-1<<shift}throw new RangeError("buffer ended with incomplete number")}readUint53(){var{low32,high32}=this.readUint64();if(high32<0||2097151<high32)throw new RangeError("number out of range");return 4294967296*high32+low32}readInt53(){var{low32,high32}=this.readInt64();if(high32<-2097152||-2097152===high32&&0===low32||2097151<high32)throw new RangeError("number out of range");return 4294967296*high32+low32}readUint64(){let low32=0,high32=0,shift=0;for(;this.offset<this.buf.byteLength&&shift<=28;){var nextByte=this.buf[this.offset];if(low32=(low32|(127&nextByte)<<shift)>>>0,28===shift&&(high32=(112&nextByte)>>>4),shift+=7,this.offset++,0==(128&nextByte))return{high32:high32,low32:low32}}for(shift=3;this.offset<this.buf.byteLength;){const nextByte=this.buf[this.offset];if(31===shift&&0!=(254&nextByte))throw new RangeError("number out of range");if(high32=(high32|(127&nextByte)<<shift)>>>0,shift+=7,this.offset++,0==(128&nextByte))return{high32:high32,low32:low32}}throw new RangeError("buffer ended with incomplete number")}readInt64(){let low32=0,high32=0,shift=0;for(;this.offset<this.buf.byteLength&&shift<=28;){var nextByte=this.buf[this.offset];if(low32=(low32|(127&nextByte)<<shift)>>>0,28===shift&&(high32=(112&nextByte)>>>4),shift+=7,this.offset++,0==(128&nextByte))return 0!=(64&nextByte)&&(shift<32&&(low32=(low32|-1<<shift)>>>0),high32|=-1<<Math.max(shift-32,0)),{high32:high32,low32:low32}}for(shift=3;this.offset<this.buf.byteLength;){const nextByte=this.buf[this.offset];if(31===shift&&0!==nextByte&&127!==nextByte)throw new RangeError("number out of range");if(high32|=(127&nextByte)<<shift,shift+=7,this.offset++,0==(128&nextByte))return 0!=(64&nextByte)&&shift<32&&(high32|=-1<<shift),{high32:high32,low32:low32}}throw new RangeError("buffer ended with incomplete number")}readRawBytes(length){var start=this.offset;if(start+length>this.buf.byteLength)throw new RangeError("subarray exceeds buffer size");return this.offset+=length,this.buf.subarray(start,this.offset)}readRawString(length){return utf8ToString(this.readRawBytes(length))}readPrefixedBytes(){return this.readRawBytes(this.readUint53())}readPrefixedString(){return utf8ToString(this.readPrefixedBytes())}readHexString(){return bytesToHexString(this.readPrefixedBytes())}}class RLEEncoder extends Encoder{constructor(type){super(),this.type=type,this.state="empty",this.lastValue=void 0,this.count=0,this.literal=[]}appendValue(value,repetitions=1){this._appendValue(value,repetitions)}_appendValue(value,repetitions=1){repetitions<=0||("empty"===this.state?(this.state=null===value?"nulls":1===repetitions?"loneValue":"repetition",this.lastValue=value,this.count=repetitions):"loneValue"===this.state?null===value?(this.flush(),this.state="nulls",this.count=repetitions):value===this.lastValue?(this.state="repetition",this.count=1+repetitions):(1<repetitions?(this.flush(),this.state="repetition",this.count=repetitions):(this.state="literal",this.literal=[this.lastValue]),this.lastValue=value):"repetition"===this.state?null===value?(this.flush(),this.state="nulls",this.count=repetitions):value===this.lastValue?this.count+=repetitions:(1<repetitions?(this.flush(),this.state="repetition",this.count=repetitions):(this.flush(),this.state="loneValue"),this.lastValue=value):"literal"===this.state?null===value?(this.literal.push(this.lastValue),this.flush(),this.state="nulls",this.count=repetitions):value===this.lastValue?(this.flush(),this.state="repetition",this.count=1+repetitions):(1<repetitions?(this.literal.push(this.lastValue),this.flush(),this.state="repetition",this.count=repetitions):this.literal.push(this.lastValue),this.lastValue=value):"nulls"===this.state&&(null===value?this.count+=repetitions:(1<repetitions?(this.flush(),this.state="repetition",this.count=repetitions):(this.flush(),this.state="loneValue"),this.lastValue=value)))}copyFrom(decoder,options={}){var{count:options,sumValues,sumShift}=options;if(!(decoder instanceof RLEDecoder)||decoder.type!==this.type)throw new TypeError("incompatible type of decoder");let remaining="number"==typeof options?options:Number.MAX_SAFE_INTEGER,nonNullValues=0,sum=0;if(options&&0<remaining&&decoder.done)throw new RangeError(`cannot copy ${options} values`);if(0===remaining||decoder.done)return sumValues?{nonNullValues:nonNullValues,sum:sum}:{nonNullValues:nonNullValues};let firstValue=decoder.readValue();if(null===firstValue){var numNulls=Math.min(decoder.count+1,remaining);if(remaining-=numNulls,decoder.count-=numNulls-1,this.appendValue(null,numNulls),options&&0<remaining&&decoder.done)throw new RangeError(`cannot copy ${options} values`);if(0===remaining||decoder.done)return sumValues?{nonNullValues:nonNullValues,sum:sum}:{nonNullValues:nonNullValues};if(null===(firstValue=decoder.readValue()))throw new RangeError("null run must be followed by non-null value")}if(this.appendValue(firstValue),remaining--,nonNullValues++,sumValues&&(sum+=sumShift?firstValue>>>sumShift:firstValue),options&&0<remaining&&decoder.done)throw new RangeError(`cannot copy ${options} values`);if(0===remaining||decoder.done)return sumValues?{nonNullValues:nonNullValues,sum:sum}:{nonNullValues:nonNullValues};let firstRun=0<decoder.count;for(;0<remaining&&!decoder.done;){firstRun||decoder.readRecord();var numValues=Math.min(decoder.count,remaining);if(decoder.count-=numValues,"literal"===decoder.state){nonNullValues+=numValues;for(let i=0;i<numValues;i++){if(decoder.done)throw new RangeError("incomplete literal");var value=decoder.readRawValue();if(value===decoder.lastValue)throw new RangeError("Repetition of values is not allowed in literal");decoder.lastValue=value,this._appendValue(value),sumValues&&(sum+=sumShift?value>>>sumShift:value)}}else if("repetition"===decoder.state){nonNullValues+=numValues,sumValues&&(sum+=numValues*(sumShift?decoder.lastValue>>>sumShift:decoder.lastValue));const value=decoder.lastValue;if(this._appendValue(value),1<numValues){if(this._appendValue(value),"repetition"!==this.state)throw new RangeError("Unexpected state "+this.state);this.count+=numValues-2}}else if("nulls"===decoder.state){if(this._appendValue(null),"nulls"!==this.state)throw new RangeError("Unexpected state "+this.state);this.count+=numValues-1}firstRun=!1,remaining-=numValues}if(options&&0<remaining&&decoder.done)throw new RangeError(`cannot copy ${options} values`);return sumValues?{nonNullValues:nonNullValues,sum:sum}:{nonNullValues:nonNullValues}}flush(){if("loneValue"===this.state)this.appendInt32(-1),this.appendRawValue(this.lastValue);else if("repetition"===this.state)this.appendInt53(this.count),this.appendRawValue(this.lastValue);else if("literal"===this.state){this.appendInt53(-this.literal.length);for(var v of this.literal)this.appendRawValue(v)}else"nulls"===this.state&&(this.appendInt32(0),this.appendUint53(this.count));this.state="empty"}appendRawValue(value){if("int"===this.type)this.appendInt53(value);else if("uint"===this.type)this.appendUint53(value);else{if("utf8"!==this.type)throw new RangeError("Unknown RLEEncoder datatype: "+this.type);this.appendPrefixedString(value)}}finish(){"literal"===this.state&&this.literal.push(this.lastValue),("nulls"!==this.state||0<this.offset)&&this.flush()}}class RLEDecoder extends Decoder{constructor(type,buffer){super(buffer),this.type=type,this.lastValue=void 0,this.count=0,this.state=void 0}get done(){return 0===this.count&&this.offset===this.buf.byteLength}reset(){this.offset=0,this.lastValue=void 0,this.count=0,this.state=void 0}readValue(){if(this.done)return null;if(0===this.count&&this.readRecord(),--this.count,"literal"!==this.state)return this.lastValue;var value=this.readRawValue();if(value===this.lastValue)throw new RangeError("Repetition of values is not allowed in literal");return this.lastValue=value}skipValues(numSkip){for(;0<numSkip&&!this.done;){0===this.count&&(this.count=this.readInt53(),0<this.count?(this.lastValue=this.count<=numSkip?this.skipRawValues(1):this.readRawValue(),this.state="repetition"):this.count<0?(this.count=-this.count,this.state="literal"):(this.count=this.readUint53(),this.lastValue=null,this.state="nulls"));var consume=Math.min(numSkip,this.count);"literal"===this.state&&this.skipRawValues(consume),numSkip-=consume,this.count-=consume}}readRecord(){if(this.count=this.readInt53(),1<this.count){var value=this.readRawValue();if(("repetition"===this.state||"literal"===this.state)&&this.lastValue===value)throw new RangeError("Successive repetitions with the same value are not allowed");this.state="repetition",this.lastValue=value}else{if(1===this.count)throw new RangeError("Repetition count of 1 is not allowed, use a literal instead");if(this.count<0){if(this.count=-this.count,"literal"===this.state)throw new RangeError("Successive literals are not allowed");this.state="literal"}else{if("nulls"===this.state)throw new RangeError("Successive null runs are not allowed");if(this.count=this.readUint53(),0===this.count)throw new RangeError("Zero-length null runs are not allowed");this.lastValue=null,this.state="nulls"}}}readRawValue(){if("int"===this.type)return this.readInt53();if("uint"===this.type)return this.readUint53();if("utf8"===this.type)return this.readPrefixedString();throw new RangeError("Unknown RLEDecoder datatype: "+this.type)}skipRawValues(num){if("utf8"===this.type)for(let i=0;i<num;i++)this.skip(this.readUint53());else{for(;0<num&&this.offset<this.buf.byteLength;)0==(128&this.buf[this.offset])&&num--,this.offset++;if(0<num)throw new RangeError("cannot skip beyond end of buffer")}}}class DeltaDecoder extends RLEDecoder{constructor(buffer){super("int",buffer),this.absoluteValue=0}reset(){this.offset=0,this.lastValue=void 0,this.count=0,this.state=void 0,this.absoluteValue=0}readValue(){var value=super.readValue();return null===value?null:(this.absoluteValue+=value,this.absoluteValue)}skipValues(numSkip){for(;0<numSkip&&!this.done;){0===this.count&&this.readRecord();var consume=Math.min(numSkip,this.count);if("literal"===this.state)for(let i=0;i<consume;i++)this.lastValue=this.readRawValue(),this.absoluteValue+=this.lastValue;else"repetition"===this.state&&(this.absoluteValue+=consume*this.lastValue);numSkip-=consume,this.count-=consume}}}class BooleanDecoder extends Decoder{constructor(buffer){super(buffer),this.lastValue=!0,this.firstRun=!0,this.count=0}get done(){return 0===this.count&&this.offset===this.buf.byteLength}reset(){this.offset=0,this.lastValue=!0,this.firstRun=!0,this.count=0}readValue(){if(this.done)return!1;for(;0===this.count;){if(this.count=this.readUint53(),this.lastValue=!this.lastValue,0===this.count&&!this.firstRun)throw new RangeError("Zero-length runs are not allowed");this.firstRun=!1}return--this.count,this.lastValue}skipValues(numSkip){for(;0<numSkip&&!this.done;){if(0===this.count&&(this.count=this.readUint53(),this.lastValue=!this.lastValue,0===this.count))throw new RangeError("Zero-length runs are not allowed");this.count<numSkip?(numSkip-=this.count,this.count=0):(this.count-=numSkip,numSkip=0)}}}module.exports={stringToUtf8:stringToUtf8,utf8ToString:utf8ToString,hexStringToBytes:hexStringToBytes,bytesToHexString:bytesToHexString,Encoder:Encoder,Decoder:Decoder,RLEEncoder:RLEEncoder,RLEDecoder:RLEDecoder,DeltaEncoder:class extends RLEEncoder{constructor(){super("int"),this.absoluteValue=0}appendValue(value,repetitions=1){repetitions<=0||("number"==typeof value?(super.appendValue(value-this.absoluteValue,1),this.absoluteValue=value,1<repetitions&&super.appendValue(0,repetitions-1)):super.appendValue(value,repetitions))}copyFrom(decoder,options={}){if(options.sumValues)throw new RangeError("unsupported options for DeltaEncoder.copyFrom()");if(!(decoder instanceof DeltaDecoder))throw new TypeError("incompatible type of decoder");let remaining=options.count;if(0<remaining&&decoder.done)throw new RangeError(`cannot copy ${remaining} values`);if(0!==remaining&&!decoder.done){let value=decoder.readValue(),nulls=0;if(this.appendValue(value),null===value){if(nulls=decoder.count+1,void 0!==remaining&&remaining<nulls&&(nulls=remaining),decoder.count-=nulls-1,this.count+=nulls-1,remaining>nulls&&decoder.done)throw new RangeError(`cannot copy ${remaining} values`);if(remaining===nulls||decoder.done)return;0===decoder.count&&this.appendValue(decoder.readValue())}void 0!==remaining&&(remaining-=nulls+1);var{nonNullValues:options,sum}=super.copyFrom(decoder,{count:remaining,sumValues:!0});0<options&&(this.absoluteValue=sum,decoder.absoluteValue=sum)}}},DeltaDecoder:DeltaDecoder,BooleanEncoder:class extends Encoder{constructor(){super(),this.lastValue=!1,this.count=0}appendValue(value,repetitions=1){if(!1!==value&&!0!==value)throw new RangeError("Unsupported value for BooleanEncoder: "+value);repetitions<=0||(this.lastValue===value?this.count+=repetitions:(this.appendUint53(this.count),this.lastValue=value,this.count=repetitions))}copyFrom(decoder,options={}){if(!(decoder instanceof BooleanDecoder))throw new TypeError("incompatible type of decoder");options=options.count;let remaining="number"==typeof options?options:Number.MAX_SAFE_INTEGER;if(options&&0<remaining&&decoder.done)throw new RangeError(`cannot copy ${options} values`);if(0!==remaining&&!decoder.done){this.appendValue(decoder.readValue()),remaining--;var firstCopy=Math.min(decoder.count,remaining);for(this.count+=firstCopy,decoder.count-=firstCopy,remaining-=firstCopy;0<remaining&&!decoder.done;){if(decoder.count=decoder.readUint53(),0===decoder.count)throw new RangeError("Zero-length runs are not allowed");decoder.lastValue=!decoder.lastValue,this.appendUint53(this.count);var numCopied=Math.min(decoder.count,remaining);this.count=numCopied,this.lastValue=decoder.lastValue,decoder.count-=numCopied,remaining-=numCopied}if(options&&0<remaining&&decoder.done)throw new RangeError(`cannot copy ${options} values`)}}finish(){0<this.count&&(this.appendUint53(this.count),this.count=0)}},BooleanDecoder:BooleanDecoder}},{}],26:[function(require,module,exports){var{init,clone,free,applyChanges,applyLocalChange,save,load,loadChanges,getPatch,getHeads,getAllChanges,getChanges,getChangesAdded,getChangeByHash,getMissingDeps}=require("./backend"),{receiveSyncMessage:require,generateSyncMessage,encodeSyncMessage,decodeSyncMessage,encodeSyncState,decodeSyncState,initSyncState}=require("./sync");module.exports={init:init,clone:clone,free:free,applyChanges:applyChanges,applyLocalChange:applyLocalChange,save:save,load:load,loadChanges:loadChanges,getPatch:getPatch,getHeads:getHeads,getAllChanges:getAllChanges,getChanges:getChanges,getChangesAdded:getChangesAdded,getChangeByHash:getChangeByHash,getMissingDeps:getMissingDeps,receiveSyncMessage:require,generateSyncMessage:generateSyncMessage,encodeSyncMessage:encodeSyncMessage,decodeSyncMessage:decodeSyncMessage,encodeSyncState:encodeSyncState,decodeSyncState:decodeSyncState,initSyncState:initSyncState}},{"./backend":23,"./sync":28}],27:[function(require,module,exports){const{parseOpId,copyObject}=require("../src/common"),{COLUMN_TYPE,VALUE_TYPE,ACTIONS,OBJECT_TYPE,DOC_OPS_COLUMNS,CHANGE_COLUMNS,DOCUMENT_COLUMNS,encoderByColumnId,decoderByColumnId,makeDecoders,decodeValue,encodeChange,decodeChangeColumns,decodeChangeMeta,decodeChanges,decodeDocumentHeader,encodeDocumentHeader}=require("./columnar"),MAX_BLOCK_SIZE=600,BLOOM_NUM_PROBES=7,BLOOM_FILTER_SIZE=Math.floor(10*MAX_BLOCK_SIZE/8),objActorIdx=0,objCtrIdx=1,keyActorIdx=2,keyCtrIdx=3,keyStrIdx=4,idActorIdx=5,idCtrIdx=6,insertIdx=7,actionIdx=8,valLenIdx=9,valRawIdx=10,predNumIdx=13,predActorIdx=14,predCtrIdx=15,succNumIdx=13,succActorIdx=14,succCtrIdx=15,PRED_COLUMN_IDS=CHANGE_COLUMNS.filter(column=>["predNum","predActor","predCtr"].includes(column.columnName)).map(column=>column.columnId);function deepCopyUpdate(objectTree,path,value){var child;1===path.length?objectTree[path[0]]=value:(deepCopyUpdate(child=Object.assign({},objectTree[path[0]]),path.slice(1),value),objectTree[path[0]]=child)}function seekWithinBlock(ops,docCols,actorIds,resumeInsertion){for(var col of docCols)col.decoder.reset();var{objActor,objCtr,keyActor,keyCtr,keyStr,idActor,idCtr,insert:ops}=ops;const[objActorD,objCtrD,,,keyStrD,idActorD,idCtrD,insertD,actionD,,,,,succNumD]=docCols.map(col=>col.decoder);let skipCount=0,visibleCount=0,elemVisible=!1,nextObjActor=null,nextObjCtr=null,nextIdActor=null,nextIdCtr=null,nextKeyStr,nextInsert=null,nextSuccNum=0;if(null!==objCtr&&!resumeInsertion)for(;(!objCtrD.done||!objActorD.done||!actionD.done)&&(nextObjCtr=objCtrD.readValue(),nextObjActor=actorIds[objActorD.readValue()],actionD.skipValues(1),null===nextObjCtr||!nextObjActor||nextObjCtr<objCtr||nextObjCtr===objCtr&&nextObjActor<objActor);)skipCount+=1;if((nextObjCtr!==objCtr||nextObjActor!==objActor)&&!resumeInsertion)return{found:!0,skipCount:skipCount,visibleCount:visibleCount};if(null!==keyStr){for(keyStrD.skipValues(skipCount);!keyStrD.done;){var objActorIndex=objActorD.readValue();if(nextObjActor=null===objActorIndex?null:actorIds[objActorIndex],nextObjCtr=objCtrD.readValue(),!(null!==(nextKeyStr=keyStrD.readValue())&&nextKeyStr<keyStr&&nextObjCtr===objCtr&&nextObjActor===objActor))break;skipCount+=1}return{found:!0,skipCount:skipCount,visibleCount:visibleCount}}if(idCtrD.skipValues(skipCount),idActorD.skipValues(skipCount),insertD.skipValues(skipCount),succNumD.skipValues(skipCount),nextIdCtr=idCtrD.readValue(),nextIdActor=actorIds[idActorD.readValue()],nextInsert=insertD.readValue(),nextSuccNum=succNumD.readValue(),ops){if(!resumeInsertion&&null!==keyCtr&&0<keyCtr&&null!==keyActor){for(skipCount+=1;!(idCtrD.done||idActorD.done||nextIdCtr===keyCtr&&nextIdActor===keyActor)&&(nextInsert&&(elemVisible=!1),0!==nextSuccNum||elemVisible||(visibleCount+=1,elemVisible=!0),nextIdCtr=idCtrD.readValue(),nextIdActor=actorIds[idActorD.readValue()],nextObjCtr=objCtrD.readValue(),nextObjActor=actorIds[objActorD.readValue()],nextInsert=insertD.readValue(),nextSuccNum=succNumD.readValue(),nextObjCtr===objCtr&&nextObjActor===objActor);)skipCount+=1;if(nextObjCtr!==objCtr||nextObjActor!==objActor||nextIdCtr!==keyCtr||nextIdActor!==keyActor||!nextInsert)return{found:!1,skipCount:skipCount,visibleCount:visibleCount};if(nextInsert&&(elemVisible=!1),0!==nextSuccNum||elemVisible||(visibleCount+=1,elemVisible=!0),idCtrD.done||idActorD.done)return{found:!0,skipCount:skipCount,visibleCount:visibleCount};nextIdCtr=idCtrD.readValue(),nextIdActor=actorIds[idActorD.readValue()],nextObjCtr=objCtrD.readValue(),nextObjActor=actorIds[objActorD.readValue()],nextInsert=insertD.readValue(),nextSuccNum=succNumD.readValue()}for(;(!nextInsert||nextIdCtr>idCtr||nextIdCtr===idCtr&&nextIdActor>idActor)&&nextObjCtr===objCtr&&nextObjActor===objActor&&(skipCount+=1,nextInsert&&(elemVisible=!1),0!==nextSuccNum||elemVisible||(visibleCount+=1,elemVisible=!0),!idCtrD.done&&!idActorD.done);)nextIdCtr=idCtrD.readValue(),nextIdActor=actorIds[idActorD.readValue()],nextObjCtr=objCtrD.readValue(),nextObjActor=actorIds[objActorD.readValue()],nextInsert=insertD.readValue(),nextSuccNum=succNumD.readValue()}else if(null!==keyCtr&&0<keyCtr&&null!==keyActor){for(;!(nextInsert&&nextIdCtr===keyCtr&&nextIdActor===keyActor||nextObjCtr!==objCtr||nextObjActor!==objActor||(skipCount+=1,nextInsert&&(elemVisible=!1),0!==nextSuccNum||elemVisible||(visibleCount+=1,elemVisible=!0),idCtrD.done||idActorD.done));)nextIdCtr=idCtrD.readValue(),nextIdActor=actorIds[idActorD.readValue()],nextObjCtr=objCtrD.readValue(),nextObjActor=actorIds[objActorD.readValue()],nextInsert=insertD.readValue(),nextSuccNum=succNumD.readValue();if(nextObjCtr!==objCtr||nextObjActor!==objActor||nextIdCtr!==keyCtr||nextIdActor!==keyActor||!nextInsert)return{found:!1,skipCount:skipCount,visibleCount:visibleCount}}return{found:!0,skipCount:skipCount,visibleCount:visibleCount}}function visibleListElements(docState,blockIndex,objectId){var thisBlock=docState.blocks[blockIndex],docState=docState.blocks[blockIndex+1];let blockVisible=thisBlock.numVisible[objectId];return void 0!==blockVisible?(thisBlock.lastVisibleActor===docState.firstVisibleActor&&void 0!==thisBlock.lastVisibleActor&&thisBlock.lastVisibleCtr===docState.firstVisibleCtr&&void 0!==thisBlock.lastVisibleCtr&&--blockVisible,blockVisible):0}function seekToOp(docState,ops){var{objActor,objCtr,keyActor,keyCtr,keyStr}=ops;let blockIndex=0,totalVisible=0;if(null!==objCtr)for(;blockIndex<docState.blocks.length-1;){var blockActor=void 0===docState.blocks[blockIndex].lastObjectActor?void 0:docState.actorIds[docState.blocks[blockIndex].lastObjectActor],blockCtr=docState.blocks[blockIndex].lastObjectCtr;if(!(void 0===blockCtr||blockCtr<objCtr||blockCtr===objCtr&&blockActor<objActor))break;blockIndex++}if(null!==keyStr){for(;blockIndex<docState.blocks.length-1;){var blockLastKey=docState.blocks[blockIndex].lastKey[ops.objId];if(!(void 0!==blockLastKey&&blockLastKey<keyStr))break;blockIndex++}var skipCount=seekWithinBlock(ops,docState.blocks[blockIndex].columns,docState.actorIds,!1)["skipCount"];return{blockIndex:blockIndex,skipCount:skipCount,visibleCount:0}}{var insertAtHead=null===keyCtr||0===keyCtr||null===keyActor,keyActorNum=null===keyActor?null:docState.actorIds.indexOf(keyActor);let resumeInsertion=!1;for(;;){if(!insertAtHead&&!resumeInsertion)for(;blockIndex<docState.blocks.length-1&&!bloomFilterContains(docState.blocks[blockIndex].bloom,keyActorNum,keyCtr);){if(docState.blocks[blockIndex].lastObjectCtr>objCtr)throw new RangeError(`Reference element not found: ${keyCtr}@`+keyActor);totalVisible+=visibleListElements(docState,blockIndex,ops.objId),blockIndex++}const{found,skipCount,visibleCount}=seekWithinBlock(ops,docState.blocks[blockIndex].columns,docState.actorIds,resumeInsertion);if(blockIndex===docState.blocks.length-1){if(found)return{blockIndex:blockIndex,skipCount:skipCount,visibleCount:totalVisible+visibleCount};throw new RangeError(`Reference element not found: ${keyCtr}@`+keyActor)}if(found&&skipCount<docState.blocks[blockIndex].numOps)return{blockIndex:blockIndex,skipCount:skipCount,visibleCount:totalVisible+visibleCount};resumeInsertion=found&&ops.insert,totalVisible+=visibleListElements(docState,blockIndex,ops.objId),blockIndex++}}}function bloomFilterAdd(bloom,elemIdActor,elemIdCtr){let modulo=8*bloom.byteLength,x=elemIdCtr%modulo,y=elemIdActor%modulo;var z=(16777619*(elemIdCtr^elemIdActor)>>>0)%modulo;for(let i=0;i<BLOOM_NUM_PROBES;i++)bloom[x>>>3]|=1<<(7&x),x=(x+y)%modulo,y=(y+z)%modulo}function bloomFilterContains(bloom,elemIdActor,elemIdCtr){let modulo=8*bloom.byteLength,x=elemIdCtr%modulo,y=elemIdActor%modulo;var z=(16777619*(elemIdCtr^elemIdActor)>>>0)%modulo;for(let i=0;i<BLOOM_NUM_PROBES;i++){if(0==(bloom[x>>>3]&1<<(7&x)))return!1;x=(x+y)%modulo,y=(y+z)%modulo}return!0}function updateBlockMetadata(block,actorIds){block.bloom=new Uint8Array(BLOOM_FILTER_SIZE),block.lastKey={},block.numVisible={},block.numOps=0,block.lastObjectActor=void 0,block.lastObjectCtr=void 0,block.firstVisibleActor=void 0,block.firstVisibleCtr=void 0,block.lastVisibleActor=void 0,block.lastVisibleCtr=void 0;for(var col of block.columns)col.decoder.reset();const[objActorD,objCtrD,keyActorD,keyCtrD,keyStrD,idActorD,idCtrD,insertD,,,,,,succNumD]=block.columns.map(col=>col.decoder);for(;!idCtrD.done;){block.numOps+=1;var objActor=objActorD.readValue(),objCtr=objCtrD.readValue(),keyActor=keyActorD.readValue(),keyCtr=keyCtrD.readValue(),keyStr=keyStrD.readValue(),idActor=idActorD.readValue(),idCtr=idCtrD.readValue(),insert=insertD.readValue(),succNum=succNumD.readValue(),objectId=null===objActor?"_root":objCtr+"@"+actorIds[objActor];null!==objActor&&null!==objCtr&&(block.lastObjectActor=objActor,block.lastObjectCtr=objCtr),null!==keyStr?block.lastKey[objectId]=keyStr:!insert&&null===keyCtr||(void 0===block.numVisible[objectId]&&(block.numVisible[objectId]=0),bloomFilterAdd(block.bloom,objActor=insert?idActor:keyActor,objCtr=insert?idCtr:keyCtr),0===succNum&&(void 0===block.firstVisibleActor&&(block.firstVisibleActor=objActor),void 0===block.firstVisibleCtr&&(block.firstVisibleCtr=objCtr),block.lastVisibleActor===objActor&&block.lastVisibleCtr===objCtr||(block.numVisible[objectId]+=1),block.lastVisibleActor=objActor,block.lastVisibleCtr=objCtr))}}function addBlockOperation(block,op,objectId,actorIds,isChangeOp){null!==op[objActorIdx]&&null!==op[objCtrIdx]&&(void 0===block.lastObjectCtr||block.lastObjectCtr<op[objCtrIdx]||block.lastObjectCtr===op[objCtrIdx]&&actorIds[block.lastObjectActor]<actorIds[op[objActorIdx]])&&(block.lastObjectActor=op[objActorIdx],block.lastObjectCtr=op[objCtrIdx]),null!==op[keyStrIdx]?(void 0===block.lastKey[objectId]||block.lastKey[objectId]<op[keyStrIdx])&&(block.lastKey[objectId]=op[keyStrIdx]):(actorIds=op[insertIdx]?op[idActorIdx]:op[keyActorIdx],objectId=op[insertIdx]?op[idCtrIdx]:op[keyCtrIdx],bloomFilterAdd(block.bloom,actorIds,objectId),0!==op[succNumIdx]&&!isChangeOp||(void 0===block.firstVisibleActor&&(block.firstVisibleActor=actorIds),void 0===block.firstVisibleCtr&&(block.firstVisibleCtr=objectId),block.lastVisibleActor=actorIds,block.lastVisibleCtr=objectId))}function splitBlock(block,actorIds){for(var col of block.columns)col.decoder.reset();var numBlocks=Math.ceil(block.numOps/(.8*MAX_BLOCK_SIZE));let blocks=[],opsSoFar=0;for(let i=1;i<=numBlocks;i++){var opsToCopy=Math.ceil(i*block.numOps/numBlocks)-opsSoFar;const encoders=block.columns.map(col=>({columnId:col.columnId,encoder:encoderByColumnId(col.columnId)}));copyColumns(encoders,block.columns,opsToCopy);var newBlock={columns:encoders.map(col=>{var decoder=decoderByColumnId(col.columnId,col.encoder.buffer);return{columnId:col.columnId,decoder:decoder}})};updateBlockMetadata(newBlock,actorIds),blocks.push(newBlock),opsSoFar+=opsToCopy}return blocks}function copyColumns(outCols,inCols,count){if(0!==count){let inIndex=0,lastGroup=-1,lastCardinality=0,valueColumn=-1,valueBytes=0;for(var outCol of outCols){for(;inIndex<inCols.length&&inCols[inIndex].columnId<outCol.columnId;)inIndex++;let inCol=null;inIndex<inCols.length&&inCols[inIndex].columnId===outCol.columnId&&0<inCols[inIndex].decoder.buf.byteLength&&(inCol=inCols[inIndex].decoder);var blankValue,colCount=outCol.columnId>>4===lastGroup?lastCardinality:count;if(outCol.columnId%8===COLUMN_TYPE.GROUP_CARD)lastGroup=outCol.columnId>>4,lastCardinality=inCol?outCol.encoder.copyFrom(inCol,{count:count,sumValues:!0}).sum:(outCol.encoder.appendValue(0,count),0);else if(outCol.columnId%8===COLUMN_TYPE.VALUE_LEN)if(inCol){if(inIndex+1===inCols.length||inCols[inIndex+1].columnId!==outCol.columnId+1)throw new RangeError("VALUE_LEN column without accompanying VALUE_RAW column");valueColumn=outCol.columnId+1,valueBytes=outCol.encoder.copyFrom(inCol,{count:colCount,sumValues:!0,sumShift:4}).sum}else outCol.encoder.appendValue(null,colCount),valueColumn=outCol.columnId+1,valueBytes=0;else if(outCol.columnId%8===COLUMN_TYPE.VALUE_RAW){if(outCol.columnId!==valueColumn)throw new RangeError("VALUE_RAW column without accompanying VALUE_LEN column");0<valueBytes&&outCol.encoder.appendRawBytes(inCol.readRawBytes(valueBytes))}else inCol?outCol.encoder.copyFrom(inCol,{count:colCount}):(blankValue=outCol.columnId%8!==COLUMN_TYPE.BOOLEAN&&null,outCol.encoder.appendValue(blankValue,colCount))}}}function readOperation(columns,actorTable){let operation=[],colValue,lastGroup=-1,lastCardinality=0,valueColumn=-1,valueBytes=0;for(var col of columns){if(col.columnId%8===COLUMN_TYPE.VALUE_RAW){if(col.columnId!==valueColumn)throw new RangeError("unexpected VALUE_RAW column");colValue=col.decoder.readRawBytes(valueBytes)}else if(col.columnId%8===COLUMN_TYPE.GROUP_CARD)lastGroup=col.columnId>>4,lastCardinality=col.decoder.readValue()||0,colValue=lastCardinality;else if(col.columnId>>4===lastGroup){colValue=[],col.columnId%8===COLUMN_TYPE.VALUE_LEN&&(valueColumn=col.columnId+1,valueBytes=0);for(let i=0;i<lastCardinality;i++){let value=col.decoder.readValue();col.columnId%8===COLUMN_TYPE.ACTOR_ID&&actorTable&&"number"==typeof value&&(value=actorTable[value]),col.columnId%8===COLUMN_TYPE.VALUE_LEN&&(valueBytes+=colValue>>>4),colValue.push(value)}}else colValue=col.decoder.readValue(),col.columnId%8===COLUMN_TYPE.ACTOR_ID&&actorTable&&"number"==typeof colValue&&(colValue=actorTable[colValue]),col.columnId%8===COLUMN_TYPE.VALUE_LEN&&(valueColumn=col.columnId+1,valueBytes=colValue>>>4);operation.push(colValue)}return operation}function appendOperation(outCols,inCols,operation){let inIndex=0,lastGroup=-1,lastCardinality=0;for(var outCol of outCols){for(;inIndex<inCols.length&&inCols[inIndex].columnId<outCol.columnId;)inIndex++;if(inIndex<inCols.length&&inCols[inIndex].columnId===outCol.columnId){var colValue=operation[inIndex];if(outCol.columnId%8===COLUMN_TYPE.GROUP_CARD)lastGroup=outCol.columnId>>4,lastCardinality=colValue,outCol.encoder.appendValue(colValue);else if(outCol.columnId>>4===lastGroup){if(!Array.isArray(colValue)||colValue.length!==lastCardinality)throw new RangeError("bad group value");for(var v of colValue)outCol.encoder.appendValue(v)}else outCol.columnId%8===COLUMN_TYPE.VALUE_RAW?colValue&&outCol.encoder.appendRawBytes(colValue):outCol.encoder.appendValue(colValue)}else if(outCol.columnId%8===COLUMN_TYPE.GROUP_CARD)lastGroup=outCol.columnId>>4,lastCardinality=0,outCol.encoder.appendValue(0);else if(outCol.columnId%8!==COLUMN_TYPE.VALUE_RAW){colValue=outCol.columnId>>4===lastGroup?lastCardinality:1;let blankValue=null;outCol.columnId%8===COLUMN_TYPE.BOOLEAN&&(blankValue=!1),outCol.columnId%8===COLUMN_TYPE.VALUE_LEN&&(blankValue=0),outCol.encoder.appendValue(blankValue,colValue)}}}function readNextDocOp(docState,blockIndex){let block=docState.blocks[blockIndex];if(block.columns[actionIdx].decoder.done){if(blockIndex===docState.blocks.length-1)return{docOp:null,blockIndex:blockIndex};blockIndex+=1;for(var col of(block=docState.blocks[blockIndex]).columns)col.decoder.reset();return{docOp:readOperation(block.columns),blockIndex:blockIndex}}return{docOp:readOperation(block.columns),blockIndex:blockIndex}}function readNextChangeOp(docState,changeState){for(;changeState.changeIndex<changeState.changes.length-1&&(!changeState.columns||changeState.columns[actionIdx].decoder.done);){changeState.changeIndex+=1;var change=changeState.changes[changeState.changeIndex],{actorIds,actorTable}=(changeState.columns=makeDecoders(change.columns,CHANGE_COLUMNS),changeState.opCtr=change.startOp,!function(docState,changeCols){if(changeCols[objActorIdx].columnId!==CHANGE_COLUMNS[objActorIdx].columnId||"objActor"!==CHANGE_COLUMNS[objActorIdx].columnName||changeCols[objCtrIdx].columnId!==CHANGE_COLUMNS[objCtrIdx].columnId||"objCtr"!==CHANGE_COLUMNS[objCtrIdx].columnName||changeCols[keyActorIdx].columnId!==CHANGE_COLUMNS[keyActorIdx].columnId||"keyActor"!==CHANGE_COLUMNS[keyActorIdx].columnName||changeCols[keyCtrIdx].columnId!==CHANGE_COLUMNS[keyCtrIdx].columnId||"keyCtr"!==CHANGE_COLUMNS[keyCtrIdx].columnName||changeCols[keyStrIdx].columnId!==CHANGE_COLUMNS[keyStrIdx].columnId||"keyStr"!==CHANGE_COLUMNS[keyStrIdx].columnName||changeCols[idActorIdx].columnId!==CHANGE_COLUMNS[idActorIdx].columnId||"idActor"!==CHANGE_COLUMNS[idActorIdx].columnName||changeCols[idCtrIdx].columnId!==CHANGE_COLUMNS[idCtrIdx].columnId||"idCtr"!==CHANGE_COLUMNS[idCtrIdx].columnName||changeCols[insertIdx].columnId!==CHANGE_COLUMNS[insertIdx].columnId||"insert"!==CHANGE_COLUMNS[insertIdx].columnName||changeCols[actionIdx].columnId!==CHANGE_COLUMNS[actionIdx].columnId||"action"!==CHANGE_COLUMNS[actionIdx].columnName||changeCols[valLenIdx].columnId!==CHANGE_COLUMNS[valLenIdx].columnId||"valLen"!==CHANGE_COLUMNS[valLenIdx].columnName||changeCols[valRawIdx].columnId!==CHANGE_COLUMNS[valRawIdx].columnId||"valRaw"!==CHANGE_COLUMNS[valRawIdx].columnName||changeCols[predNumIdx].columnId!==CHANGE_COLUMNS[predNumIdx].columnId||"predNum"!==CHANGE_COLUMNS[predNumIdx].columnName||changeCols[predActorIdx].columnId!==CHANGE_COLUMNS[predActorIdx].columnId||"predActor"!==CHANGE_COLUMNS[predActorIdx].columnName||changeCols[predCtrIdx].columnId!==CHANGE_COLUMNS[predCtrIdx].columnId||"predCtr"!==CHANGE_COLUMNS[predCtrIdx].columnName)throw new RangeError("unexpected columnId");const docCols=docState.blocks[0].columns;if(!changeCols.every(changeCol=>PRED_COLUMN_IDS.includes(changeCol.columnId)||docCols.find(docCol=>docCol.columnId===changeCol.columnId))){let allCols=docCols.map(docCol=>({columnId:docCol.columnId}));for(var changeCol of changeCols){const columnId=changeCol["columnId"];PRED_COLUMN_IDS.includes(columnId)||docCols.find(docCol=>docCol.columnId===columnId)||allCols.push({columnId:columnId})}allCols.sort((a,b)=>a.columnId-b.columnId);for(let blockIndex=0;blockIndex<docState.blocks.length;blockIndex++){let block=copyObject(docState.blocks[blockIndex]);block.columns=makeDecoders(block.columns.map(col=>({columnId:col.columnId,buffer:col.decoder.buf})),allCols),docState.blocks[blockIndex]=block}}}(docState,changeState.columns),function(actorIds,change){if(actorIds.indexOf(change.actorIds[0])<0){if(1!==change.seq)throw new RangeError(`Seq ${change.seq} is the first change for actor `+change.actorIds[0]);actorIds=actorIds.concat([change.actorIds[0]])}const actorTable=[];for(var actorId of change.actorIds){var index=actorIds.indexOf(actorId);if(index<0)throw new RangeError(`actorId ${actorId} is not known to document`);actorTable.push(index)}return{actorIds:actorIds,actorTable:actorTable}}(docState.actorIds,change));docState.actorIds=actorIds,changeState.actorTable=actorTable,changeState.actorIndex=docState.actorIds.indexOf(change.actorIds[0])}if(changeState.columns[actionIdx].decoder.done)return changeState.done=!0,void(changeState.nextOp=null);changeState.nextOp=readOperation(changeState.columns,changeState.actorTable),changeState.nextOp[idActorIdx]=changeState.actorIndex,changeState.nextOp[idCtrIdx]=changeState.opCtr,changeState.changes[changeState.changeIndex].maxOp=changeState.opCtr,changeState.opCtr>docState.maxOp&&(docState.maxOp=changeState.opCtr),changeState.opCtr+=1;var op=changeState.nextOp;if(null===op[objCtrIdx]&&null!==op[objActorIdx]||null!==op[objCtrIdx]&&null===op[objActorIdx])throw new RangeError(`Mismatched object reference: (${op[objCtrIdx]}, ${op[objActorIdx]})`);if(null===op[keyCtrIdx]&&null!==op[keyActorIdx]||0===op[keyCtrIdx]&&null!==op[keyActorIdx]||0<op[keyCtrIdx]&&null===op[keyActorIdx])throw new RangeError(`Mismatched operation key: (${op[keyCtrIdx]}, ${op[keyActorIdx]})`)}function emptyObjectPatch(objectId,type){return"list"===type||"text"===type?{objectId:objectId,type:type,edits:[]}:{objectId:objectId,type:type,props:{}}}function opIdDelta(id1,id2,delta=1){id1=parseOpId(id1),id2=parseOpId(id2);return id1.actorId===id2.actorId&&id1.counter+delta===id2.counter}function appendEdit(existingEdits,nextEdit){if(0===existingEdits.length)existingEdits.push(nextEdit);else{let lastEdit=existingEdits[existingEdits.length-1];"insert"===lastEdit.action&&"insert"===nextEdit.action&&lastEdit.index===nextEdit.index-1&&"value"===lastEdit.value.type&&"value"===nextEdit.value.type&&lastEdit.elemId===lastEdit.opId&&nextEdit.elemId===nextEdit.opId&&opIdDelta(lastEdit.elemId,nextEdit.elemId,1)&&lastEdit.value.datatype===nextEdit.value.datatype&&typeof lastEdit.value.value==typeof nextEdit.value.value?(lastEdit.action="multi-insert",nextEdit.value.datatype&&(lastEdit.datatype=nextEdit.value.datatype),lastEdit.values=[lastEdit.value.value,nextEdit.value.value],delete lastEdit.value,delete lastEdit.opId):"multi-insert"===lastEdit.action&&"insert"===nextEdit.action&&lastEdit.index+lastEdit.values.length===nextEdit.index&&"value"===nextEdit.value.type&&nextEdit.elemId===nextEdit.opId&&opIdDelta(lastEdit.elemId,nextEdit.elemId,lastEdit.values.length)&&lastEdit.datatype===nextEdit.value.datatype&&typeof lastEdit.values[0]==typeof nextEdit.value.value?lastEdit.values.push(nextEdit.value.value):"remove"===lastEdit.action&&"remove"===nextEdit.action&&lastEdit.index===nextEdit.index?lastEdit.count+=nextEdit.count:existingEdits.push(nextEdit)}}function appendUpdate(edits,index,elemId,opId,value,firstUpdate){let insert=!1;if(firstUpdate)for(;!insert&&0<edits.length;){const lastEdit=edits[edits.length-1];if("insert"!==lastEdit.action&&"update"!==lastEdit.action||lastEdit.index!==index){if("multi-insert"!==lastEdit.action||lastEdit.index+lastEdit.values.length-1!==index)break;lastEdit.values.pop(),insert=!0}else edits.pop(),insert="insert"===lastEdit.action}insert?appendEdit(edits,{action:"insert",index:index,elemId:elemId,opId:opId,value:value}):appendEdit(edits,{action:"update",index:index,opId:opId,value:value})}function updatePatchProperty(patches,newBlock,objectId,op,docState,propState,listIndex,oldSuccNum){var isWholeDoc=!newBlock,type=op[actionIdx]<ACTIONS.length?OBJECT_TYPE[ACTIONS[op[actionIdx]]]:null;const opId=op[idCtrIdx]+"@"+docState.actorIds[op[idActorIdx]];var elemIdActor=op[insertIdx]?op[idActorIdx]:op[keyActorIdx],elemIdCtr=op[insertIdx]?op[idCtrIdx]:op[keyCtrIdx],elemIdCtr=op[keyStrIdx]||elemIdCtr+"@"+docState.actorIds[elemIdActor],elemIdActor=(op[actionIdx]%2!=0||docState.objectMeta[opId]||(docState.objectMeta[opId]={parentObj:objectId,parentKey:elemIdCtr,opId:opId,type:type,children:{}},deepCopyUpdate(docState.objectMeta,[objectId,"children",elemIdCtr,opId],{objectId:opId,type:type,props:{}})),!propState[elemIdCtr]),isOverwritten=(propState[elemIdCtr]||(propState[elemIdCtr]={visibleOps:[],hasChild:!1}),void 0!==oldSuccNum&&0<op[succNumIdx]),prevChildren=(isOverwritten||(propState[elemIdCtr].visibleOps.push(op),propState[elemIdCtr].hasChild=propState[elemIdCtr].hasChild||op[actionIdx]%2==0),docState.objectMeta[objectId].children[elemIdCtr]);if(propState[elemIdCtr].hasChild||prevChildren&&0<Object.keys(prevChildren).length){let values={};for(var visible of propState[elemIdCtr].visibleOps){const opId=visible[idCtrIdx]+"@"+docState.actorIds[visible[idActorIdx]];"set"===ACTIONS[visible[actionIdx]]?values[opId]=Object.assign({type:"value"},decodeValue(visible[valLenIdx],visible[valRawIdx])):visible[actionIdx]%2==0&&(visible=visible[actionIdx]<ACTIONS.length?OBJECT_TYPE[ACTIONS[visible[actionIdx]]]:null,values[opId]=emptyObjectPatch(opId,visible))}deepCopyUpdate(docState.objectMeta,[objectId,"children",elemIdCtr],values)}let patchKey,patchValue;if(isOverwritten&&"set"===ACTIONS[op[actionIdx]]&&(15&op[valLenIdx])===VALUE_TYPE.COUNTER){propState[elemIdCtr]||(propState[elemIdCtr]={visibleOps:[],hasChild:!1}),propState[elemIdCtr].counterStates||(propState[elemIdCtr].counterStates={});let counterStates=propState[elemIdCtr].counterStates,counterState={opId:opId,value:decodeValue(op[valLenIdx],op[valRawIdx]).value,succs:{}};for(let i=0;i<op[succNumIdx];i++){var succOp=op[succCtrIdx][i]+"@"+docState.actorIds[op[succActorIdx][i]];(counterStates[succOp]=counterState).succs[succOp]=!0}}else if("inc"===ACTIONS[op[actionIdx]]){if(!propState[elemIdCtr]||!propState[elemIdCtr].counterStates||!propState[elemIdCtr].counterStates[opId])throw new RangeError(`increment operation ${opId} for unknown counter`);let counterState=propState[elemIdCtr].counterStates[opId];counterState.value+=decodeValue(op[valLenIdx],op[valRawIdx]).value,delete counterState.succs[opId],0===Object.keys(counterState.succs).length&&(patchKey=counterState.opId,patchValue={type:"value",datatype:"counter",value:counterState.value})}else isOverwritten||("set"===ACTIONS[op[actionIdx]]?(patchKey=opId,patchValue=Object.assign({type:"value"},decodeValue(op[valLenIdx],op[valRawIdx]))):op[actionIdx]%2==0&&(patches[opId]||(patches[opId]=emptyObjectPatch(opId,type)),patchKey=opId,patchValue=patches[opId]));patches[objectId]||(patches[objectId]=emptyObjectPatch(objectId,docState.objectMeta[objectId].type));const patch=patches[objectId];if(null===op[keyStrIdx])if(0!==oldSuccNum||isWholeDoc||"insert"!==propState[elemIdCtr].action||(propState[elemIdCtr].action="update",function(edits,index,elemId){let updates=[];for(;0<edits.length;){var lastEdit=edits[edits.length-1];if("insert"===lastEdit.action){if(lastEdit.index!==index)throw new RangeError("last edit has unexpected index");updates.unshift(edits.pop());break}if("update"!==lastEdit.action)throw new RangeError("last edit has unexpected action");if(lastEdit.index!==index)throw new RangeError("last edit has unexpected index");updates.unshift(edits.pop())}let firstUpdate=!0;for(var update of updates)appendUpdate(edits,index,elemId,update.opId,update.value,firstUpdate),firstUpdate=!1}(patch.edits,listIndex,elemIdCtr),newBlock&&--newBlock.numVisible[objectId]),patchValue)if(propState[elemIdCtr].action||void 0!==oldSuccNum&&!isWholeDoc)if("remove"===propState[elemIdCtr].action){let lastEdit=patch.edits[patch.edits.length-1];if("remove"!==lastEdit.action)throw new RangeError("last edit has unexpected type");1<lastEdit.count?--lastEdit.count:patch.edits.pop(),propState[elemIdCtr].action="update",appendUpdate(patch.edits,listIndex,elemIdCtr,patchKey,patchValue,!0),newBlock&&(newBlock.numVisible[objectId]+=1)}else appendUpdate(patch.edits,listIndex,elemIdCtr,patchKey,patchValue,!propState[elemIdCtr].action),propState[elemIdCtr].action||(propState[elemIdCtr].action="update");else propState[elemIdCtr].action="insert",appendEdit(patch.edits,{action:"insert",index:listIndex,elemId:elemIdCtr,opId:patchKey,value:patchValue}),newBlock&&(void 0===newBlock.numVisible[objectId]&&(newBlock.numVisible[objectId]=0),newBlock.numVisible[objectId]+=1);else 0!==oldSuccNum||propState[elemIdCtr].action||(propState[elemIdCtr].action="remove",appendEdit(patch.edits,{action:"remove",index:listIndex,count:1}),newBlock&&--newBlock.numVisible[objectId]);else!patchValue&&isWholeDoc||(!elemIdActor&&patch.props[op[keyStrIdx]]||(patch.props[op[keyStrIdx]]={}),patchValue&&(patch.props[op[keyStrIdx]][patchKey]=patchValue))}function applyOps(patches,changeState,docState){var col,[objActorNum,objCtr,keyActorNum,keyCtr,keyStr,idActorNum,idCtr,insert]=changeState.nextOp,objActorNum=null===objActorNum?null:docState.actorIds[objActorNum],{blockIndex:keyStr,skipCount:idActorNum,visibleCount:idCtr}=seekToOp(docState,{objActor:objActorNum,objCtr:objCtr,keyActor:null===keyActorNum?null:docState.actorIds[keyActorNum],keyCtr:keyCtr,keyStr:keyStr,idActor:docState.actorIds[idActorNum],idCtr:idCtr,insert:insert,objId:null===objActorNum?"_root":objCtr+"@"+objActorNum});const block=docState.blocks[keyStr];for(col of block.columns)col.decoder.reset();objCtr=0===idActorNum||void 0===block.firstVisibleActor||!insert&&block.firstVisibleActor===keyActorNum&&block.firstVisibleCtr===keyCtr;const newBlock={columns:void 0,bloom:new Uint8Array(block.bloom),lastKey:copyObject(block.lastKey),numVisible:copyObject(block.numVisible),numOps:idActorNum,lastObjectActor:block.lastObjectActor,lastObjectCtr:block.lastObjectCtr,firstVisibleActor:objCtr?void 0:block.firstVisibleActor,firstVisibleCtr:objCtr?void 0:block.firstVisibleCtr,lastVisibleActor:void 0,lastVisibleCtr:void 0},outCols=block.columns.map(col=>({columnId:col.columnId,encoder:encoderByColumnId(col.columnId)}));copyColumns(outCols,block.columns,idActorNum);var{blockIndex:lastBlockIndex,docOpsConsumed:objActorNum}=function(patches,newBlock,outCols,changeState,docState,listIndex,blockIndex){var firstOp=changeState.nextOp,insert=firstOp[insertIdx],objActor=firstOp[objActorIdx],objCtr=firstOp[objCtrIdx],objectId=null===objActor?"_root":objCtr+"@"+docState.actorIds[objActor],idActorIndex=changeState.actorIndex,idActor=docState.actorIds[idActorIndex];let foundListElem=!1,elemVisible=!1,propState={},docOp,docOpsConsumed=({docOp,blockIndex}=readNextDocOp(docState,blockIndex),null===docOp?0:1),docOpOldSuccNum=null===docOp?0:docOp[succNumIdx],changeOp=null,changeOps=[],changeCols=[],predSeen=[],lastChangeKey=null;for(changeState.objectIds.add(objectId);;){if(0===changeOps.length){foundListElem=!1;let nextOp=changeState.nextOp;for(;!changeState.done&&nextOp[idActorIdx]===idActorIndex&&nextOp[insertIdx]===insert&&nextOp[objActorIdx]===firstOp[objActorIdx]&&nextOp[objCtrIdx]===firstOp[objCtrIdx];){var lastOp=0<changeOps.length?changeOps[changeOps.length-1]:null;let isOverwrite=!1;for(let i=0;i<nextOp[predNumIdx];i++)for(var prevOp of changeOps)nextOp[predActorIdx][i]===prevOp[idActorIdx]&&nextOp[predCtrIdx][i]===prevOp[idCtrIdx]&&(isOverwrite=!0);if(nextOp!==firstOp&&(!insert||null===lastOp||null!==nextOp[keyStrIdx]||nextOp[keyActorIdx]!==lastOp[idActorIdx]||nextOp[keyCtrIdx]!==lastOp[idCtrIdx])&&(insert||null===lastOp||null===nextOp[keyStrIdx]||nextOp[keyStrIdx]!==lastOp[keyStrIdx]||isOverwrite)&&(insert||null===lastOp||null!==nextOp[keyStrIdx]||null!==lastOp[keyStrIdx]||nextOp[keyActorIdx]!==lastOp[keyActorIdx]||nextOp[keyCtrIdx]!==lastOp[keyCtrIdx]||isOverwrite)&&(insert||null!==lastOp||null!==nextOp[keyStrIdx]||!docOp||!docOp[insertIdx]||null!==docOp[keyStrIdx]||docOp[idActorIdx]!==nextOp[keyActorIdx]||docOp[idCtrIdx]!==nextOp[keyCtrIdx])&&(insert||null!==lastOp||null===nextOp[keyStrIdx]||null===lastChangeKey||!(lastChangeKey<nextOp[keyStrIdx])))break;lastChangeKey=null!==nextOp?nextOp[keyStrIdx]:null,changeOps.push(changeState.nextOp),changeCols.push(changeState.columns),predSeen.push(new Array(changeState.nextOp[predNumIdx])),readNextChangeOp(docState,changeState),nextOp=changeState.nextOp}}0<changeOps.length&&(changeOp=changeOps[0]);var inCorrectObject=docOp&&docOp[objActorIdx]===changeOp[objActorIdx]&&docOp[objCtrIdx]===changeOp[objCtrIdx],keyMatches=docOp&&null!==docOp[keyStrIdx]&&docOp[keyStrIdx]===changeOp[keyStrIdx],listElemMatches=docOp&&null===docOp[keyStrIdx]&&null===changeOp[keyStrIdx]&&(!docOp[insertIdx]&&docOp[keyActorIdx]===changeOp[keyActorIdx]&&docOp[keyCtrIdx]===changeOp[keyCtrIdx]||docOp[insertIdx]&&docOp[idActorIdx]===changeOp[keyActorIdx]&&docOp[idCtrIdx]===changeOp[keyCtrIdx]);if(0===changeOps.length&&(!inCorrectObject||!keyMatches&&!listElemMatches))break;let takeDocOp=!1,takeChangeOps=0;if(insert||!inCorrectObject||null===docOp[keyStrIdx]&&null!==changeOp[keyStrIdx]||null!==docOp[keyStrIdx]&&null!==changeOp[keyStrIdx]&&changeOp[keyStrIdx]<docOp[keyStrIdx]){if(takeChangeOps=changeOps.length,!inCorrectObject&&!foundListElem&&null===changeOp[keyStrIdx]&&!changeOp[insertIdx])throw new RangeError("could not find list element with ID: "+changeOp[keyCtrIdx]+"@"+docState.actorIds[changeOp[keyActorIdx]])}else if(keyMatches||listElemMatches||foundListElem){for(let opIndex=0;opIndex<changeOps.length;opIndex++){var op=changeOps[opIndex];for(let i=0;i<op[predNumIdx];i++)if(op[predActorIdx][i]===docOp[idActorIdx]&&op[predCtrIdx][i]===docOp[idCtrIdx]){let j=0;for(;j<docOp[succNumIdx]&&(docOp[succCtrIdx][j]<op[idCtrIdx]||docOp[succCtrIdx][j]===op[idCtrIdx]&&docState.actorIds[docOp[succActorIdx][j]]<idActor);)j++;docOp[succCtrIdx].splice(j,0,op[idCtrIdx]),docOp[succActorIdx].splice(j,0,idActorIndex),docOp[succNumIdx]++,predSeen[opIndex][i]=!0;break}}if((foundListElem=listElemMatches?!0:foundListElem)&&!listElemMatches)takeChangeOps=changeOps.length;else if(0===changeOps.length||docOp[idCtrIdx]<changeOp[idCtrIdx]||docOp[idCtrIdx]===changeOp[idCtrIdx]&&docState.actorIds[docOp[idActorIdx]]<idActor){takeDocOp=!0,updatePatchProperty(patches,newBlock,objectId,docOp,docState,propState,listIndex,docOpOldSuccNum);for(let i=changeOps.length-1;0<=i;i--){let deleted=!0;for(let j=0;j<changeOps[i][predNumIdx];j++)predSeen[i][j]||(deleted=!1);"del"===ACTIONS[changeOps[i][actionIdx]]&&deleted&&(changeOps.splice(i,1),changeCols.splice(i,1),predSeen.splice(i,1))}}else{if(docOp[idCtrIdx]===changeOp[idCtrIdx]&&docState.actorIds[docOp[idActorIdx]]===idActor)throw new RangeError(`duplicate operation ID: ${changeOp[idCtrIdx]}@`+idActor);takeChangeOps=1}}else takeDocOp=!0;if(takeDocOp&&(appendOperation(outCols,docState.blocks[blockIndex].columns,docOp),addBlockOperation(newBlock,docOp,objectId,docState.actorIds,!1),docOp[insertIdx]&&elemVisible&&(elemVisible=!1,listIndex++),0===docOp[succNumIdx]&&(elemVisible=!0),newBlock.numOps++,{docOp,blockIndex}=readNextDocOp(docState,blockIndex),null!==docOp&&(docOpsConsumed++,docOpOldSuccNum=docOp[succNumIdx])),0<takeChangeOps){for(let i=0;i<takeChangeOps;i++){let op=changeOps[i];for(let j=0;j<op[predNumIdx];j++)if(!predSeen[i][j])throw new RangeError(`no matching operation for pred: ${op[predCtrIdx][j]}@`+docState.actorIds[op[predActorIdx][j]]);updatePatchProperty(patches,newBlock,objectId,op,docState,propState,listIndex),appendOperation(outCols,changeCols[i],op),addBlockOperation(newBlock,op,objectId,docState.actorIds,!0),op[insertIdx]?(elemVisible=!1,listIndex++):elemVisible=!0}takeChangeOps===changeOps.length?(changeOps.length=0,changeCols.length=0,predSeen.length=0):(changeOps.splice(0,takeChangeOps),changeCols.splice(0,takeChangeOps),predSeen.splice(0,takeChangeOps)),newBlock.numOps+=takeChangeOps}}return docOp&&(appendOperation(outCols,docState.blocks[blockIndex].columns,docOp),newBlock.numOps++,docOp[objActorIdx]===objActor&&docOp[objCtrIdx]===objCtr&&addBlockOperation(newBlock,docOp,objectId,docState.actorIds,!1)),{docOpsConsumed:docOpsConsumed,blockIndex:blockIndex}}(patches,newBlock,outCols,changeState,docState,idCtr,keyStr),insert=docState.blocks[lastBlockIndex];let copyAfterMerge=-idActorNum-objActorNum;for(let i=keyStr;i<=lastBlockIndex;i++)copyAfterMerge+=docState.blocks[i].numOps;copyColumns(outCols,insert.columns,copyAfterMerge),newBlock.numOps+=copyAfterMerge;for(let col of insert.columns)if(!col.decoder.done)throw new RangeError("excess ops in column "+col.columnId);newBlock.columns=outCols.map(col=>{var decoder=decoderByColumnId(col.columnId,col.encoder.buffer);return{columnId:col.columnId,decoder:decoder}}),keyStr===lastBlockIndex&&newBlock.numOps<=MAX_BLOCK_SIZE?(0<copyAfterMerge&&void 0!==block.lastVisibleActor&&void 0!==block.lastVisibleCtr&&(newBlock.lastVisibleActor=block.lastVisibleActor,newBlock.lastVisibleCtr=block.lastVisibleCtr),docState.blocks[keyStr]=newBlock):(keyActorNum=splitBlock(newBlock,docState.actorIds),docState.blocks.splice(keyStr,lastBlockIndex-keyStr+1,...keyActorNum))}function applyChanges(patches,decodedChanges,docState,objectIds){let heads=new Set(docState.heads),changeHashes=new Set,clock=copyObject(docState.clock),applied=[],enqueued=[];for(var change of decodedChanges)if(void 0===docState.changeIndexByHash[change.hash]&&!changeHashes.has(change.hash)){let causallyReady=!0;for(var dep of change.deps){var depIndex=docState.changeIndexByHash[dep];void 0!==depIndex&&-1!==depIndex||changeHashes.has(dep)||(causallyReady=!1)}if(causallyReady){var expectedSeq=(clock[change.actor]||0)+1;if(change.seq!==expectedSeq)throw new RangeError(`Expected seq ${expectedSeq}, got seq ${change.seq} from actor `+change.actor);clock[change.actor]=change.seq,changeHashes.add(change.hash);for(let dep of change.deps)heads.delete(dep);heads.add(change.hash),applied.push(change)}else enqueued.push(change)}if(0<applied.length){var changeState={changes:applied,changeIndex:-1,objectIds:objectIds};for(readNextChangeOp(docState,changeState);!changeState.done;)applyOps(patches,changeState,docState);docState.heads=[...heads].sort(),docState.clock=clock}return[applied,enqueued]}function documentPatch(docState){for(var col of docState.blocks[0].columns)col.decoder.reset();let propState={},docOp=null,blockIndex=0;var patches={_root:{objectId:"_root",type:"map",props:{}}};let lastObjActor=null,lastObjCtr=null,objectId="_root",elemVisible=!1,listIndex=0;for(;;){if({docOp,blockIndex}=readNextDocOp(docState,blockIndex),null===docOp)break;docOp[objActorIdx]===lastObjActor&&docOp[objCtrIdx]===lastObjCtr||(objectId=docOp[objCtrIdx]+"@"+docState.actorIds[docOp[objActorIdx]],lastObjActor=docOp[objActorIdx],lastObjCtr=docOp[objCtrIdx],propState={},listIndex=0,elemVisible=!1),docOp[insertIdx]&&elemVisible&&(elemVisible=!1,listIndex++),0===docOp[succNumIdx]&&(elemVisible=!0),docOp[idCtrIdx]>docState.maxOp&&(docState.maxOp=docOp[idCtrIdx]);for(let i=0;i<docOp[succNumIdx];i++)docOp[succCtrIdx][i]>docState.maxOp&&(docState.maxOp=docOp[succCtrIdx][i]);updatePatchProperty(patches,null,objectId,docOp,docState,propState,listIndex,docOp[succNumIdx])}return patches._root}module.exports={MAX_BLOCK_SIZE:MAX_BLOCK_SIZE,BackendDoc:class BackendDoc{constructor(buffer){if(this.maxOp=0,this.haveHashGraph=!1,this.changes=[],this.changeIndexByHash={},this.dependenciesByHash={},this.dependentsByHash={},this.hashesByActor={},this.actorIds=[],this.heads=[],this.clock={},this.queue=[],this.objectMeta={_root:{parentObj:null,parentKey:null,opId:null,type:"map",children:{}}},buffer){var doc=decodeDocumentHeader(buffer),{clock,headActors,encoders,numChanges}=function(doc){const columns=makeDecoders(doc.changesColumns,DOCUMENT_COLUMNS),actorD=columns[0].decoder,seqD=columns[1].decoder,depsNumD=columns[5].decoder,depsIndexD=columns[6].decoder;if(columns[0].columnId!==DOCUMENT_COLUMNS[0].columnId||"actor"!==DOCUMENT_COLUMNS[0].columnName||columns[1].columnId!==DOCUMENT_COLUMNS[1].columnId||"seq"!==DOCUMENT_COLUMNS[1].columnName||columns[5].columnId!==DOCUMENT_COLUMNS[5].columnId||"depsNum"!==DOCUMENT_COLUMNS[5].columnName||columns[6].columnId!==DOCUMENT_COLUMNS[6].columnId||"depsIndex"!==DOCUMENT_COLUMNS[6].columnName)throw new RangeError("unexpected columnId");let numChanges=0,clock={},actorNums=[],headIndexes=new Set;for(;!actorD.done;){var actorNum=actorD.readValue(),seq=seqD.readValue(),depsNum=depsNumD.readValue(),actorId=doc.actorIds[actorNum];if(1!==seq&&seq!==clock[actorId]+1)throw new RangeError(`Expected seq ${clock[actorId]+1}, got ${seq} for actor `+actorId);actorNums.push(actorNum),clock[actorId]=seq,headIndexes.add(numChanges);for(let j=0;j<depsNum;j++)headIndexes.delete(depsIndexD.readValue());numChanges++}var col,headActors=[...headIndexes].map(index=>doc.actorIds[actorNums[index]]).sort();for(col of columns)col.decoder.reset();var encoders=columns.map(col=>({columnId:col.columnId,encoder:encoderByColumnId(col.columnId)}));return copyColumns(encoders,columns,numChanges),{clock:clock,headActors:headActors,encoders:encoders,numChanges:numChanges}}(doc);if(this.binaryDoc=buffer,this.changes=new Array(numChanges),this.actorIds=doc.actorIds,this.heads=doc.heads,this.clock=clock,this.changesEncoders=encoders,this.extraBytes=doc.extraBytes,1===doc.heads.length&&1===headActors.length&&(this.hashesByActor[headActors[0]]=[],this.hashesByActor[headActors[0]][clock[headActors[0]]-1]=doc.heads[0]),doc.heads.length===doc.headsIndexes.length)for(let i=0;i<doc.heads.length;i++)this.changeIndexByHash[doc.heads[i]]=doc.headsIndexes[i];else if(1===doc.heads.length)this.changeIndexByHash[doc.heads[0]]=numChanges-1;else for(var head of doc.heads)this.changeIndexByHash[head]=-1;this.blocks=[{columns:makeDecoders(doc.opsColumns,DOC_OPS_COLUMNS)}],updateBlockMetadata(this.blocks[0],this.actorIds),this.blocks[0].numOps>MAX_BLOCK_SIZE&&(this.blocks=splitBlock(this.blocks[0],this.actorIds)),buffer={blocks:this.blocks,actorIds:this.actorIds,objectMeta:this.objectMeta,maxOp:0},this.initPatch=documentPatch(buffer),this.maxOp=buffer.maxOp}else this.haveHashGraph=!0,this.changesEncoders=DOCUMENT_COLUMNS.map(col=>({columnId:col.columnId,encoder:encoderByColumnId(col.columnId)})),this.blocks=[{columns:makeDecoders([],DOC_OPS_COLUMNS),bloom:new Uint8Array(BLOOM_FILTER_SIZE),lastKey:{},numVisible:{},numOps:0,lastObjectActor:void 0,lastObjectCtr:void 0,firstVisibleActor:void 0,firstVisibleCtr:void 0,lastVisibleActor:void 0,lastVisibleCtr:void 0}]}clone(){let copy=new BackendDoc;return copy.maxOp=this.maxOp,copy.haveHashGraph=this.haveHashGraph,copy.changes=this.changes.slice(),copy.changeIndexByHash=copyObject(this.changeIndexByHash),copy.dependenciesByHash=copyObject(this.dependenciesByHash),copy.dependentsByHash=Object.entries(this.dependentsByHash).reduce((acc,[k,v])=>(acc[k]=v.slice(),acc),{}),copy.hashesByActor=Object.entries(this.hashesByActor).reduce((acc,[k,v])=>(acc[k]=v.slice(),acc),{}),copy.actorIds=this.actorIds,copy.heads=this.heads,copy.clock=this.clock,copy.blocks=this.blocks,copy.objectMeta=this.objectMeta,copy.queue=this.queue,copy}applyChanges(changeBuffers,isLocal=!1){let decodedChanges=changeBuffers.map(buffer=>{const decoded=decodeChangeColumns(buffer);return decoded.buffer=buffer,decoded});var change,patches={_root:{objectId:"_root",type:"map",props:{}}},docState={maxOp:this.maxOp,changeIndexByHash:this.changeIndexByHash,actorIds:this.actorIds,heads:this.heads,clock:this.clock,blocks:this.blocks.slice(),objectMeta:Object.assign({},this.objectMeta)};let queue=0===this.queue.length?decodedChanges:decodedChanges.concat(this.queue),allApplied=[],objectIds=new Set;for(;;){var[applied,enqueued]=applyChanges(patches,queue,docState,objectIds);if(queue=enqueued,0<applied.length&&(allApplied=allApplied.concat(applied)),0===queue.length)break;if(0===applied.length){if(this.haveHashGraph)break;this.computeHashGraph()}}!function(patches,objectIds,docState){for(var objectId of objectIds){let meta=docState.objectMeta[objectId],childMeta=null,patchExists=!1;for(;;){var hasChildren=childMeta&&0<Object.keys(meta.children[childMeta.parentKey]).length;if(patches[objectId]||(patches[objectId]=emptyObjectPatch(objectId,meta.type)),childMeta&&hasChildren)if("list"===meta.type||"text"===meta.type){for(var edit of patches[objectId].edits)edit.opId&&meta.children[childMeta.parentKey][edit.opId]&&(patchExists=!0);if(!patchExists){var opId,value,obj=parseOpId(objectId),elem=parseOpId(childMeta.parentKey),visibleCount=seekToOp(docState,{objActor:obj.actorId,objCtr:obj.counter,keyActor:elem.actorId,keyCtr:elem.counter,keyStr:null,insert:!1,objId:objectId}).visibleCount;for([opId,value]of Object.entries(meta.children[childMeta.parentKey])){let patchValue=value;value.objectId&&(patches[value.objectId]||(patches[value.objectId]=emptyObjectPatch(value.objectId,value.type)),patchValue=patches[value.objectId]);const edit={action:"update",index:visibleCount,opId:opId,value:patchValue};appendEdit(patches[objectId].edits,edit)}}}else{patches[objectId].props[childMeta.parentKey]||(patches[objectId].props[childMeta.parentKey]={});let values=patches[objectId].props[childMeta.parentKey];for(let[opId,value]of Object.entries(meta.children[childMeta.parentKey]))values[opId]?patchExists=!0:value.objectId?(patches[value.objectId]||(patches[value.objectId]=emptyObjectPatch(value.objectId,value.type)),values[opId]=patches[value.objectId]):values[opId]=value}if(patchExists||!meta.parentObj||childMeta&&!hasChildren)break;childMeta=meta,objectId=meta.parentObj,meta=docState.objectMeta[objectId]}}}(patches,objectIds,docState);for(change of allApplied){this.changes.push(change.buffer),this.hashesByActor[change.actor]||(this.hashesByActor[change.actor]=[]),this.hashesByActor[change.actor][change.seq-1]=change.hash,this.changeIndexByHash[change.hash]=this.changes.length-1,this.dependenciesByHash[change.hash]=change.deps,this.dependentsByHash[change.hash]=[];for(var dep of change.deps)this.dependentsByHash[dep]||(this.dependentsByHash[dep]=[]),this.dependentsByHash[dep].push(change.hash);!function(columns,change,actorIds,changeIndexByHash){appendOperation(columns,DOCUMENT_COLUMNS,[actorIds.indexOf(change.actor),change.seq,change.maxOp,change.time,change.message,change.deps.length,change.deps.map(dep=>changeIndexByHash[dep]),change.extraBytes?change.extraBytes.byteLength<<4|VALUE_TYPE.BYTES:VALUE_TYPE.BYTES,change.extraBytes])}(this.changesEncoders,change,docState.actorIds,this.changeIndexByHash)}this.maxOp=docState.maxOp,this.actorIds=docState.actorIds,this.heads=docState.heads,this.clock=docState.clock,this.blocks=docState.blocks,this.objectMeta=docState.objectMeta,this.queue=queue,this.binaryDoc=null,this.initPatch=null;let patch={maxOp:this.maxOp,clock:this.clock,deps:this.heads,pendingChanges:this.queue.length,diffs:patches._root};return isLocal&&1===decodedChanges.length&&(patch.actor=decodedChanges[0].actor,patch.seq=decodedChanges[0].seq),patch}computeHashGraph(){var change,binaryDoc=this.save();this.haveHashGraph=!0,this.changes=[],this.changeIndexByHash={},this.dependenciesByHash={},this.dependentsByHash={},this.hashesByActor={},this.clock={};for(change of decodeChanges([binaryDoc])){var dep,binaryChange=encodeChange(change);this.changes.push(binaryChange),this.changeIndexByHash[change.hash]=this.changes.length-1,this.dependenciesByHash[change.hash]=change.deps,this.dependentsByHash[change.hash]=[];for(dep of change.deps)this.dependentsByHash[dep].push(change.hash);if(1===change.seq&&(this.hashesByActor[change.actor]=[]),this.hashesByActor[change.actor].push(change.hash),binaryChange=(this.clock[change.actor]||0)+1,change.seq!==binaryChange)throw new RangeError(`Expected seq ${binaryChange}, got seq ${change.seq} from actor `+change.actor);this.clock[change.actor]=change.seq}}getChanges(haveDeps){if(this.haveHashGraph||this.computeHashGraph(),0===haveDeps.length)return this.changes.slice();let stack=[],seenHashes={},toReturn=[];for(var hash of haveDeps){seenHashes[hash]=!0;var successors=this.dependentsByHash[hash];if(!successors)throw new RangeError("hash not found: "+hash);stack.push(...successors)}for(;0<stack.length;){const hash=stack.pop();if(seenHashes[hash]=!0,toReturn.push(hash),!this.dependenciesByHash[hash].every(dep=>seenHashes[dep]))break;stack.push(...this.dependentsByHash[hash])}if(0===stack.length&&this.heads.every(head=>seenHashes[head]))return toReturn.map(hash=>this.changes[this.changeIndexByHash[hash]]);for(stack=haveDeps.slice(),seenHashes={};0<stack.length;){const hash=stack.pop();if(!seenHashes[hash]){var deps=this.dependenciesByHash[hash];if(!deps)throw new RangeError("hash not found: "+hash);stack.push(...deps),seenHashes[hash]=!0}}return this.changes.filter(change=>!seenHashes[decodeChangeMeta(change,!0).hash])}getChangesAdded(other){this.haveHashGraph||this.computeHashGraph();let stack=this.heads.slice(),seenHashes={},toReturn=[];for(;0<stack.length;){var hash=stack.pop();seenHashes[hash]||void 0!==other.changeIndexByHash[hash]||(seenHashes[hash]=!0,toReturn.push(hash),stack.push(...this.dependenciesByHash[hash]))}return toReturn.reverse().map(hash=>this.changes[this.changeIndexByHash[hash]])}getChangeByHash(hash){return this.haveHashGraph||this.computeHashGraph(),this.changes[this.changeIndexByHash[hash]]}getMissingDeps(heads=[]){this.haveHashGraph||this.computeHashGraph();let allDeps=new Set(heads),inQueue=new Set;for(var change of this.queue){inQueue.add(change.hash);for(var dep of change.deps)allDeps.add(dep)}let missing=[];for(var hash of allDeps)void 0!==this.changeIndexByHash[hash]||inQueue.has(hash)||missing.push(hash);return missing.sort()}save(){if(this.binaryDoc)return this.binaryDoc;var newEncoders=this.changesEncoders.map(col=>({columnId:col.columnId,encoder:encoderByColumnId(col.columnId)}));return copyColumns(newEncoders,this.changesEncoders.map(col=>{var decoder=decoderByColumnId(col.columnId,col.encoder.buffer);return{columnId:col.columnId,decoder:decoder}}),this.changes.length),this.binaryDoc=encodeDocumentHeader({changesColumns:this.changesEncoders,opsColumns:function(blocks){var block,encoders=blocks[0].columns.map(col=>({columnId:col.columnId,encoder:encoderByColumnId(col.columnId)}));for(block of blocks){for(var col of block.columns)col.decoder.reset();copyColumns(encoders,block.columns,block.numOps)}return encoders}(this.blocks),actorIds:this.actorIds,heads:this.heads,headsIndexes:this.heads.map(hash=>this.changeIndexByHash[hash]),extraBytes:this.extraBytes}),this.changesEncoders=newEncoders,this.binaryDoc}getPatch(){var docState={blocks:this.blocks,actorIds:this.actorIds,objectMeta:{_root:{parentObj:null,parentKey:null,opId:null,type:"map",children:{}}},maxOp:0},docState=this.initPatch||documentPatch(docState);return{maxOp:this.maxOp,clock:this.clock,deps:this.heads,pendingChanges:this.queue.length,diffs:docState}}},bloomFilterContains:bloomFilterContains}},{"../src/common":62,"./columnar":24}],28:[function(require,module,exports){const Backend=require("./backend"),{hexStringToBytes,bytesToHexString,Encoder,Decoder}=require("./encoding"),decodeChangeMeta=require("./columnar")["decodeChangeMeta"],copyObject=require("../src/common")["copyObject"],HASH_SIZE=32,MESSAGE_TYPE_SYNC=66;class BloomFilter{constructor(arg){if(Array.isArray(arg)){this.numEntries=arg.length,this.numBitsPerEntry=10,this.numProbes=7,this.bits=new Uint8Array(Math.ceil(this.numEntries*this.numBitsPerEntry/8));for(var hash of arg)this.addHash(hash)}else{if(!(arg instanceof Uint8Array))throw new TypeError("invalid argument");if(0===arg.byteLength)this.numEntries=0,this.numBitsPerEntry=0,this.numProbes=0,this.bits=arg;else{const decoder=new Decoder(arg);this.numEntries=decoder.readUint32(),this.numBitsPerEntry=decoder.readUint32(),this.numProbes=decoder.readUint32(),this.bits=decoder.readRawBytes(Math.ceil(this.numEntries*this.numBitsPerEntry/8))}}}get bytes(){if(0===this.numEntries)return new Uint8Array(0);const encoder=new Encoder;return encoder.appendUint32(this.numEntries),encoder.appendUint32(this.numBitsPerEntry),encoder.appendUint32(this.numProbes),encoder.appendRawBytes(this.bits),encoder.buffer}getProbes(hash){var hashBytes=hexStringToBytes(hash),modulo=8*this.bits.byteLength;if(32!==hashBytes.byteLength)throw new RangeError("Not a 256-bit hash: "+hash);let x=((hashBytes[0]|hashBytes[1]<<8|hashBytes[2]<<16|hashBytes[3]<<24)>>>0)%modulo,y=((hashBytes[4]|hashBytes[5]<<8|hashBytes[6]<<16|hashBytes[7]<<24)>>>0)%modulo;var z=((hashBytes[8]|hashBytes[9]<<8|hashBytes[10]<<16|hashBytes[11]<<24)>>>0)%modulo;const probes=[x];for(let i=1;i<this.numProbes;i++)x=(x+y)%modulo,y=(y+z)%modulo,probes.push(x);return probes}addHash(hash){for(var probe of this.getProbes(hash))this.bits[probe>>>3]|=1<<(7&probe)}containsHash(hash){if(0===this.numEntries)return!1;for(var probe of this.getProbes(hash))if(0==(this.bits[probe>>>3]&1<<(7&probe)))return!1;return!0}}function encodeHashes(encoder,hashes){if(!Array.isArray(hashes))throw new TypeError("hashes must be an array");encoder.appendUint32(hashes.length);for(let i=0;i<hashes.length;i++){if(0<i&&hashes[i-1]>=hashes[i])throw new RangeError("hashes must be sorted");var bytes=hexStringToBytes(hashes[i]);if(bytes.byteLength!==HASH_SIZE)throw new TypeError("heads hashes must be 256 bits");encoder.appendRawBytes(bytes)}}function decodeHashes(decoder){let length=decoder.readUint32(),hashes=[];for(let i=0;i<length;i++)hashes.push(bytesToHexString(decoder.readRawBytes(HASH_SIZE)));return hashes}function encodeSyncMessage(message){const encoder=new Encoder;encoder.appendByte(MESSAGE_TYPE_SYNC),encodeHashes(encoder,message.heads),encodeHashes(encoder,message.need),encoder.appendUint32(message.have.length);for(var have of message.have)encodeHashes(encoder,have.lastSync),encoder.appendPrefixedBytes(have.bloom);encoder.appendUint32(message.changes.length);for(var change of message.changes)encoder.appendPrefixedBytes(change);return encoder.buffer}function decodeSyncMessage(bytes){const decoder=new Decoder(bytes);bytes=decoder.readByte();if(bytes!==MESSAGE_TYPE_SYNC)throw new RangeError("Unexpected message type: "+bytes);var bytes=decodeHashes(decoder),need=decodeHashes(decoder),haveCount=decoder.readUint32();let message={heads:bytes,need:need,have:[],changes:[]};for(let i=0;i<haveCount;i++){var lastSync=decodeHashes(decoder),bloom=decoder.readPrefixedBytes(decoder);message.have.push({lastSync:lastSync,bloom:bloom})}var changeCount=decoder.readUint32();for(let i=0;i<changeCount;i++){var change=decoder.readPrefixedBytes();message.changes.push(change)}return message}function initSyncState(){return{sharedHeads:[],lastSentHeads:[],theirHeads:null,theirNeed:null,theirHave:null,sentHashes:{}}}function compareArrays(a,b){return a.length===b.length&&a.every((v,i)=>v===b[i])}module.exports={receiveSyncMessage:function(backend,oldSyncState,binaryMessage){if(!backend)throw new Error("generateSyncMessage called with no Automerge document");if(!oldSyncState)throw new Error("generateSyncMessage requires a syncState, which can be created with initSyncState()");let{sharedHeads,lastSentHeads,sentHashes}=oldSyncState,patch=null;const message=decodeSyncMessage(binaryMessage);var myOldHeads,myNewHeads,oldSyncState=Backend.getHeads(backend);0<message.changes.length&&([backend,patch]=Backend.applyChanges(backend,message.changes),sharedHeads=(myOldHeads=oldSyncState,myNewHeads=Backend.getHeads(backend),binaryMessage=sharedHeads,newHeads=myNewHeads.filter(head=>!myOldHeads.includes(head)),binaryMessage=binaryMessage.filter(head=>myNewHeads.includes(head)),[...new Set([...newHeads,...binaryMessage])].sort())),0===message.changes.length&&compareArrays(message.heads,oldSyncState)&&(lastSentHeads=message.heads);const knownHeads=message.heads.filter(head=>Backend.getChangeByHash(backend,head));knownHeads.length===message.heads.length?(sharedHeads=message.heads,0===message.heads.length&&(lastSentHeads=[],sentHashes=[])):sharedHeads=[...new Set(knownHeads.concat(sharedHeads))].sort();var newHeads={sharedHeads:sharedHeads,lastSentHeads:lastSentHeads,theirHave:message.have,theirHeads:message.heads,theirNeed:message.need,sentHashes:sentHashes};return[backend,newHeads,patch]},generateSyncMessage:function(backend,syncState){if(!backend)throw new Error("generateSyncMessage called with no Automerge document");if(!syncState)throw new Error("generateSyncMessage requires a syncState, which can be created with initSyncState()");let{sharedHeads,lastSentHeads,theirHeads,theirNeed,theirHave,sentHashes}=syncState;var ourHeads=Backend.getHeads(backend);const ourNeed=Backend.getMissingDeps(backend,theirHeads||[]);let ourHave=[];if(theirHeads&&!ourNeed.every(hash=>theirHeads.includes(hash))||(ourHave=[function(backend,lastSync){const newChanges=Backend.getChanges(backend,lastSync);return backend=newChanges.map(change=>decodeChangeMeta(change,!0).hash),{lastSync:lastSync,bloom:new BloomFilter(backend).bytes}}(backend,sharedHeads)]),theirHave&&0<theirHave.length){const lastSync=theirHave[0].lastSync;if(!lastSync.every(hash=>Backend.getChangeByHash(backend,hash)))return[syncState,encodeSyncMessage({heads:ourHeads,need:[],have:[{lastSync:[],bloom:new Uint8Array(0)}],changes:[]})]}let changesToSend=Array.isArray(theirHave)&&Array.isArray(theirNeed)?function(backend,have,need){if(0===have.length)return need.map(hash=>Backend.getChangeByHash(backend,hash)).filter(change=>void 0!==change);let lastSyncHashes={},bloomFilters=[];for(var h of have){for(var hash of h.lastSync)lastSyncHashes[hash]=!0;bloomFilters.push(new BloomFilter(h.bloom))}var change,have=Backend.getChanges(backend,Object.keys(lastSyncHashes)).map(change=>decodeChangeMeta(change,!0));let changeHashes={},dependents={},hashesToSend={};for(let change of have){changeHashes[change.hash]=!0;for(var dep of change.deps)dependents[dep]||(dependents[dep]=[]),dependents[dep].push(change.hash);bloomFilters.every(bloom=>!bloom.containsHash(change.hash))&&(hashesToSend[change.hash]=!0)}let stack=Object.keys(hashesToSend);for(;0<stack.length;){const hash=stack.pop();if(dependents[hash])for(let dep of dependents[hash])hashesToSend[dep]||(hashesToSend[dep]=!0,stack.push(dep))}let changesToSend=[];for(let hash of need)hashesToSend[hash]=!0,changeHashes[hash]||(change=Backend.getChangeByHash(backend,hash))&&changesToSend.push(change);for(let change of have)hashesToSend[change.hash]&&changesToSend.push(change.change);return changesToSend}(backend,theirHave,theirNeed):[];var headsUnchanged=Array.isArray(lastSentHeads)&&compareArrays(ourHeads,lastSentHeads),headsEqual=Array.isArray(theirHeads)&&compareArrays(ourHeads,theirHeads);if(headsUnchanged&&headsEqual&&0===changesToSend.length)return[syncState,null];if(changesToSend=changesToSend.filter(change=>!sentHashes[decodeChangeMeta(change,!0).hash]),headsUnchanged={heads:ourHeads,have:ourHave,need:ourNeed,changes:changesToSend},0<changesToSend.length){sentHashes=copyObject(sentHashes);for(const change of changesToSend)sentHashes[decodeChangeMeta(change,!0).hash]=!0}return[syncState=Object.assign({},syncState,{lastSentHeads:ourHeads,sentHashes:sentHashes}),encodeSyncMessage(headsUnchanged)]},encodeSyncMessage:encodeSyncMessage,decodeSyncMessage:decodeSyncMessage,initSyncState:initSyncState,encodeSyncState:function(syncState){const encoder=new Encoder;return encoder.appendByte(67),encodeHashes(encoder,syncState.sharedHeads),encoder.buffer},decodeSyncState:function(bytes){const decoder=new Decoder(bytes);if(67!==(bytes=decoder.readByte()))throw new RangeError("Unexpected record type: "+bytes);return bytes=decodeHashes(decoder),Object.assign(initSyncState(),{sharedHeads:bytes})},BloomFilter:BloomFilter}},{"../src/common":62,"./backend":23,"./columnar":24,"./encoding":25}],29:[function(require,module,exports){module.exports={backendState:function(backend){if(backend.frozen)throw new Error("Attempting to use an outdated Automerge document that has already been updated. Please use the latest document state, or call Automerge.clone() if you really need to use this old document state.");return backend.state}}},{}],30:[function(require,module,exports){const{isObject,copyObject,parseOpId}=require("../src/common"),{OBJECT_ID,CONFLICTS,ELEM_IDS}=require("./constants"),instantiateText=require("./text")["instantiateText"],instantiateTable=require("./table")["instantiateTable"],Counter=require("./counter")["Counter"];function getValue(patch,object,updated){return patch.objectId?interpretPatch(patch,object=object&&object[OBJECT_ID]!==patch.objectId?void 0:object,updated):"timestamp"===patch.datatype?new Date(patch.value):"counter"===patch.datatype?new Counter(patch.value):patch.value}function lamportCompare(ts1,ts2){const regex=/^(\d+)@(.*)$/;ts1=regex.test(ts1)?parseOpId(ts1):{counter:0,actorId:ts1},ts2=regex.test(ts2)?parseOpId(ts2):{counter:0,actorId:ts2};return ts1.counter<ts2.counter?-1:ts1.counter>ts2.counter?1:ts1.actorId<ts2.actorId?-1:ts1.actorId>ts2.actorId?1:0}function cloneMapObject(originalObject,objectId){var object=copyObject(originalObject),originalObject=copyObject(originalObject?originalObject[CONFLICTS]:void 0);return Object.defineProperty(object,OBJECT_ID,{value:objectId}),Object.defineProperty(object,CONFLICTS,{value:originalObject}),object}function updateMapObject(patch,obj,updated){var objectId=patch.objectId,obj=(updated[objectId]||(updated[objectId]=cloneMapObject(obj,objectId)),updated[objectId]);return function(props,object,conflicts,updated){if(props)for(var key of Object.keys(props)){const values={},opIds=Object.keys(props[key]).sort(lamportCompare).reverse();for(var opId of opIds){var subpatch=props[key][opId];conflicts[key]&&conflicts[key][opId]?values[opId]=getValue(subpatch,conflicts[key][opId],updated):values[opId]=getValue(subpatch,void 0,updated)}0===opIds.length?(delete object[key],delete conflicts[key]):(object[key]=values[opIds[0]],conflicts[key]=values)}}(patch.props,obj,obj[CONFLICTS],updated),obj}function updateListObject(patch,obj,updated){var objectId=patch.objectId;updated[objectId]||(updated[objectId]=function(originalList,objectId){var list=originalList?originalList.slice():[],conflicts=originalList&&originalList[CONFLICTS]?originalList[CONFLICTS].slice():[],originalList=originalList&&originalList[ELEM_IDS]?originalList[ELEM_IDS].slice():[];return Object.defineProperty(list,OBJECT_ID,{value:objectId}),Object.defineProperty(list,CONFLICTS,{value:conflicts}),Object.defineProperty(list,ELEM_IDS,{value:originalList}),list}(obj,objectId));const list=updated[objectId],conflicts=list[CONFLICTS],elemIds=list[ELEM_IDS];for(let i=0;i<patch.edits.length;i++){const edit=patch.edits[i];if("insert"===edit.action||"update"===edit.action){var oldValue=conflicts[edit.index]&&conflicts[edit.index][edit.opId];let lastValue=getValue(edit.value,oldValue,updated),values={[edit.opId]:lastValue};for(;i<patch.edits.length-1&&patch.edits[i+1].index===edit.index&&"update"===patch.edits[i+1].action;){i++;var conflict=patch.edits[i],oldValue2=conflicts[conflict.index]&&conflicts[conflict.index][conflict.opId];lastValue=getValue(conflict.value,oldValue2,updated),values[conflict.opId]=lastValue}"insert"===edit.action?(list.splice(edit.index,0,lastValue),conflicts.splice(edit.index,0,values),elemIds.splice(edit.index,0,edit.elemId)):(list[edit.index]=lastValue,conflicts[edit.index]=values)}else if("multi-insert"===edit.action){const startElemId=parseOpId(edit.elemId),newElems=[],newValues=[],newConflicts=[],datatype=edit.datatype;edit.values.forEach((value,index)=>{index=startElemId.counter+index+"@"+startElemId.actorId;value=getValue({value:value,datatype:datatype},void 0,updated),newValues.push(value),newConflicts.push({[index]:{value:value,datatype:datatype,type:"value"}}),newElems.push(index)}),list.splice(edit.index,0,...newValues),conflicts.splice(edit.index,0,...newConflicts),elemIds.splice(edit.index,0,...newElems)}else"remove"===edit.action&&(list.splice(edit.index,edit.count),conflicts.splice(edit.index,edit.count),elemIds.splice(edit.index,edit.count))}return list}function interpretPatch(patch,obj,updated){if(isObject(obj)&&(!patch.props||0===Object.keys(patch.props).length)&&(!patch.edits||0===patch.edits.length)&&!updated[patch.objectId])return obj;if("map"===patch.type)return updateMapObject(patch,obj,updated);if("table"===patch.type)return function(patch,obj,updated){var key,objectId=patch.objectId;updated[objectId]||(updated[objectId]=obj?obj._clone():instantiateTable(objectId));const object=updated[objectId];for(key of Object.keys(patch.props||{})){var opIds=Object.keys(patch.props[key]);if(0===opIds.length)object.remove(key);else{if(1!==opIds.length)throw new RangeError("Conflicts are not supported on properties of a table");var subpatch=patch.props[key][opIds[0]];object._set(key,getValue(subpatch,object.byId(key),updated),opIds[0])}}return object}(patch,obj,updated);if("list"===patch.type)return updateListObject(patch,obj,updated);if("text"===patch.type)return function(patch,obj,updated){var objectId=patch.objectId;let elems;elems=updated[objectId]?updated[objectId].elems:obj?obj.elems.slice():[];for(const edit of patch.edits)if("insert"===edit.action){var value=getValue(edit.value,void 0,updated),value={elemId:edit.elemId,pred:[edit.opId],value:value};elems.splice(edit.index,0,value)}else if("multi-insert"===edit.action){const startElemId=parseOpId(edit.elemId),datatype=edit.datatype;value=edit.values.map((value,index)=>{value=getValue({datatype:datatype,value:value},void 0,updated);index=startElemId.counter+index+"@"+startElemId.actorId;return{elemId:index,pred:[index],value:value}});elems.splice(edit.index,0,...value)}else if("update"===edit.action){var elemId=elems[edit.index].elemId;const value=getValue(edit.value,elems[edit.index].value,updated);elems[edit.index]={elemId:elemId,pred:[edit.opId],value:value}}else"remove"===edit.action&&elems.splice(edit.index,edit.count);return updated[objectId]=instantiateText(objectId,elems),updated[objectId]}(patch,obj,updated);throw new TypeError("Unknown object type: "+patch.type)}module.exports={interpretPatch:interpretPatch,cloneRootObject:function(root){if("_root"!==root[OBJECT_ID])throw new RangeError("Not the root object: "+root[OBJECT_ID]);return cloneMapObject(root,"_root")}}},{"../src/common":62,"./constants":31,"./counter":33,"./table":38,"./text":39}],31:[function(require,module,exports){var OPTIONS=Symbol("_options"),CACHE=Symbol("_cache"),STATE=Symbol("_state"),OBJECT_ID=Symbol("_objectId"),CONFLICTS=Symbol("_conflicts"),CHANGE=Symbol("_change"),ELEM_IDS=Symbol("_elemIds");module.exports={OPTIONS:OPTIONS,CACHE:CACHE,STATE:STATE,OBJECT_ID:OBJECT_ID,CONFLICTS:CONFLICTS,CHANGE:CHANGE,ELEM_IDS:ELEM_IDS}},{}],32:[function(require,module,exports){const{CACHE,OBJECT_ID,CONFLICTS,ELEM_IDS,STATE}=require("./constants"),interpretPatch=require("./apply_patch")["interpretPatch"],Text=require("./text")["Text"],Table=require("./table")["Table"],{Counter,getWriteableCounter}=require("./counter"),{Int,Uint,Float64}=require("./numbers"),{isObject,parseOpId,createArrayOfNulls}=require("../src/common"),uuid=require("../src/uuid");function getPred(object,key){return object instanceof Table?[object.opIds[key]]:object instanceof Text?object.elems[key].pred:object[CONFLICTS]&&object[CONFLICTS][key]?Object.keys(object[CONFLICTS][key]):[]}function getElemId(list,index,insert=!1){if(insert){if(0===index)return"_head";--index}if(list[ELEM_IDS])return list[ELEM_IDS][index];if(list.getElemId)return list.getElemId(index);throw new RangeError("Cannot find elemId at list index "+index)}module.exports={Context:class{constructor(doc,actorId,applyPatch){this.actorId=actorId,this.nextOpNum=doc[STATE].maxOp+1,this.cache=doc[CACHE],this.updated={},this.ops=[],this.applyPatch=applyPatch||interpretPatch}addOp(operation){this.ops.push(operation),"set"===operation.action&&operation.values?this.nextOpNum+=operation.values.length:"del"===operation.action&&operation.multiOp?this.nextOpNum+=operation.multiOp:this.nextOpNum+=1}nextOpId(){return this.nextOpNum+"@"+this.actorId}getValueDescription(value){if(!["object","boolean","number","string"].includes(typeof value))throw new TypeError("Unsupported type of value: "+typeof value);if(isObject(value)){if(value instanceof Date)return{type:"value",value:value.getTime(),datatype:"timestamp"};if(value instanceof Int)return{type:"value",value:value.value,datatype:"int"};if(value instanceof Uint)return{type:"value",value:value.value,datatype:"uint"};if(value instanceof Float64)return{type:"value",value:value.value,datatype:"float64"};if(value instanceof Counter)return{type:"value",value:value.value,datatype:"counter"};var objectId=value[OBJECT_ID],type=this.getObjectType(objectId);if(objectId)return"list"===type||"text"===type?{objectId:objectId,type:type,edits:[]}:{objectId:objectId,type:type,props:{}};throw new RangeError(`Object ${JSON.stringify(value)} has no objectId`)}return"number"==typeof value?Number.isInteger(value)&&value<=Number.MAX_SAFE_INTEGER&&value>=Number.MIN_SAFE_INTEGER?{type:"value",value:value,datatype:"int"}:{type:"value",value:value,datatype:"float64"}:{type:"value",value:value}}getValuesDescriptions(path,object,key){var value;if(object instanceof Table)return(value=object.byId(key))?{[key]:this.getValueDescription(value)}:{};if(object instanceof Text){const value=object.get(key);var elemId=object.getElemId(key);return value?{[elemId]:this.getValueDescription(value)}:{}}{const conflicts=object[CONFLICTS][key],values={};if(!conflicts)throw new RangeError(`No children at key ${key} of path `+JSON.stringify(path));for(var opId of Object.keys(conflicts))values[opId]=this.getValueDescription(conflicts[opId]);return values}}getPropertyValue(object,key,opId){return object instanceof Table?object.byId(key):object instanceof Text?object.get(key):object[CONFLICTS][key][opId]}getSubpatch(patch,path){if(0==path.length)return patch;let subpatch=patch,object=this.getObject("_root");for(var pathElem of path){var opId,values=this.getValuesDescriptions(path,object,pathElem.key);if(subpatch.props)subpatch.props[pathElem.key]||(subpatch.props[pathElem.key]=values);else if(subpatch.edits)for(const opId of Object.keys(values))subpatch.edits.push({action:"update",index:pathElem.key,opId:opId,value:values[opId]});let nextOpId=null;for(opId of Object.keys(values))values[opId].objectId===pathElem.objectId&&(nextOpId=opId);if(!nextOpId)throw new RangeError("Cannot find path object with objectId "+pathElem.objectId);subpatch=values[nextOpId],object=this.getPropertyValue(object,pathElem.key,nextOpId)}return subpatch}getObject(objectId){var object=this.updated[objectId]||this.cache[objectId];if(object)return object;throw new RangeError("Target object does not exist: "+objectId)}getObjectType(objectId){if("_root"===objectId)return"map";objectId=this.getObject(objectId);return objectId instanceof Text?"text":objectId instanceof Table?"table":Array.isArray(objectId)?"list":"map"}getObjectField(path,objectId,key){var object;if(["string","number"].includes(typeof key))return object=this.getObject(objectId),object[key]instanceof Counter?getWriteableCounter(object[key].value,this,path,objectId,key):isObject(object[key])?(objectId=object[key][OBJECT_ID],path=path.concat([{key:key,objectId:objectId}]),this.instantiateObject(path,objectId)):object[key]}createNestedObjects(obj,key,value,insert,pred,elemId){if(value[OBJECT_ID])throw new RangeError("Cannot create a reference to an existing document object");var subpatch,objectId=this.nextOpId();if(value instanceof Text)return this.addOp(elemId?{action:"makeText",obj:obj,elemId:elemId,insert:insert,pred:pred}:{action:"makeText",obj:obj,key:key,insert:insert,pred:pred}),this.insertListItems(subpatch={objectId:objectId,type:"text",edits:[]},0,[...value],!0),subpatch;if(value instanceof Table){if(0<value.count)throw new RangeError("Assigning a non-empty Table object is not supported");return this.addOp(elemId?{action:"makeTable",obj:obj,elemId:elemId,insert:insert,pred:pred}:{action:"makeTable",obj:obj,key:key,insert:insert,pred:pred}),{objectId:objectId,type:"table",props:{}}}if(Array.isArray(value)){this.addOp(elemId?{action:"makeList",obj:obj,elemId:elemId,insert:insert,pred:pred}:{action:"makeList",obj:obj,key:key,insert:insert,pred:pred});const subpatch={objectId:objectId,type:"list",edits:[]};return this.insertListItems(subpatch,0,value,!0),subpatch}{this.addOp(elemId?{action:"makeMap",obj:obj,elemId:elemId,insert:insert,pred:pred}:{action:"makeMap",obj:obj,key:key,insert:insert,pred:pred});let props={};for(var nested of Object.keys(value).sort()){var opId=this.nextOpId(),valuePatch=this.setValue(objectId,nested,value[nested],!1,[]);props[nested]={[opId]:valuePatch}}return{objectId:objectId,type:"map",props:props}}}setValue(objectId,key,value,insert,pred,elemId){if(!objectId)throw new RangeError("setValue needs an objectId");if(""===key)throw new RangeError("The key of a map entry must not be an empty string");if(!isObject(value)||value instanceof Date||value instanceof Counter||value instanceof Int||value instanceof Uint||value instanceof Float64){var description=this.getValueDescription(value);const op={action:"set",obj:objectId,insert:insert,value:description.value,pred:pred};return elemId?op.elemId=elemId:op.key=key,description.datatype&&(op.datatype=description.datatype),this.addOp(op),description}return this.createNestedObjects(objectId,key,value,insert,pred,elemId)}applyAtPath(path,callback){var diff={objectId:"_root",type:"map",props:{}};callback(this.getSubpatch(diff,path)),this.applyPatch(diff,this.cache._root,this.updated)}setMapKey(path,key,value){if("string"!=typeof key)throw new RangeError("The key of a map entry must be a string, not "+typeof key);const objectId=0===path.length?"_root":path[path.length-1].objectId,object=this.getObject(objectId);if(object[key]instanceof Counter)throw new RangeError("Cannot overwrite a Counter object; use .increment() or .decrement() to change its value.");(object[key]!==value||1<Object.keys(object[CONFLICTS][key]||{}).length||void 0===value)&&this.applyAtPath(path,subpatch=>{var pred=getPred(object,key),opId=this.nextOpId(),pred=this.setValue(objectId,key,value,!1,pred);subpatch.props[key]={[opId]:pred}})}deleteMapKey(path,key){var objectId=0===path.length?"_root":path[path.length-1].objectId,object=this.getObject(objectId);void 0!==object[key]&&(object=getPred(object,key),this.addOp({action:"del",obj:objectId,key:key,insert:!1,pred:object}),this.applyAtPath(path,subpatch=>{subpatch.props[key]={}}))}insertListItems(subpatch,index,values,newObject){newObject=newObject?[]:this.getObject(subpatch.objectId);if(index<0||index>newObject.length)throw new RangeError(`List index ${index} is out of bounds for list of length `+newObject.length);if(0!==values.length){let elemId=getElemId(newObject,index,!0);newObject=values.every(v=>"string"==typeof v||"number"==typeof v||"boolean"==typeof v||null===v||isObject(v)&&(v instanceof Date||v instanceof Counter||v instanceof Int||v instanceof Uint||v instanceof Float64));const allValueDescriptions=newObject?values.map(v=>this.getValueDescription(v)):[];var allDatatypesSame=allValueDescriptions.every(t=>t.datatype===allValueDescriptions[0].datatype);if(newObject&&allDatatypesSame&&1<values.length){newObject=this.nextOpId(),allDatatypesSame=allValueDescriptions[0].datatype;const values=allValueDescriptions.map(v=>v.value),op={action:"set",obj:subpatch.objectId,elemId:elemId,insert:!0,values:values,pred:[]},edit={action:"multi-insert",elemId:newObject,index:index,values:values};allDatatypesSame&&(op.datatype=allDatatypesSame,edit.datatype=allDatatypesSame),this.addOp(op),subpatch.edits.push(edit)}else for(let offset=0;offset<values.length;offset++){let nextElemId=this.nextOpId();var valuePatch=this.setValue(subpatch.objectId,index+offset,values[offset],!0,[],elemId);elemId=nextElemId,subpatch.edits.push({action:"insert",index:index+offset,elemId:elemId,opId:elemId,value:valuePatch})}}}setListIndex(path,index,value){const objectId=0===path.length?"_root":path[path.length-1].objectId,list=this.getObject(objectId);if(index>=list.length){const insertions=createArrayOfNulls(index-list.length);return insertions.push(value),this.splice(path,list.length,0,insertions)}if(list[index]instanceof Counter)throw new RangeError("Cannot overwrite a Counter object; use .increment() or .decrement() to change its value.");(list[index]!==value||1<Object.keys(list[CONFLICTS][index]||{}).length||void 0===value)&&this.applyAtPath(path,subpatch=>{var pred=getPred(list,index),opId=this.nextOpId(),pred=this.setValue(objectId,index,value,!1,pred,getElemId(list,index));subpatch.edits.push({action:"update",index:index,opId:opId,value:pred})})}splice(path,start,deletions,insertions){var objectId=0===path.length?"_root":path[path.length-1].objectId,list=this.getObject(objectId);if(start<0||deletions<0||start>list.length-deletions)throw new RangeError(deletions+` deletions starting at index ${start} are out of bounds for list of length `+list.length);if(0!==deletions||0!==insertions.length){let patch_diffs={objectId:"_root",type:"map",props:{}},subpatch=this.getSubpatch(patch_diffs,path);if(0<deletions){let op,lastElemParsed,lastPredParsed;for(let i=0;i<deletions;i++){if(this.getObjectField(path,objectId,start+i)instanceof Counter)throw new TypeError("Unsupported operation: deleting a counter from a list");var thisElem=getElemId(list,start+i),thisElemParsed=parseOpId(thisElem),thisPred=getPred(list,start+i),thisPredParsed=1===thisPred.length?parseOpId(thisPred[0]):void 0;op&&lastElemParsed&&lastPredParsed&&thisPredParsed&&lastElemParsed.actorId===thisElemParsed.actorId&&lastElemParsed.counter+1===thisElemParsed.counter&&lastPredParsed.actorId===thisPredParsed.actorId&&lastPredParsed.counter+1===thisPredParsed.counter?op.multiOp=(op.multiOp||1)+1:(op&&this.addOp(op),op={action:"del",obj:objectId,elemId:thisElem,insert:!1,pred:thisPred}),lastElemParsed=thisElemParsed,lastPredParsed=thisPredParsed}this.addOp(op),subpatch.edits.push({action:"remove",index:start,count:deletions})}0<insertions.length&&this.insertListItems(subpatch,start,insertions,!1),this.applyPatch(patch_diffs,this.cache._root,this.updated)}}addTableRow(path,row){if(!isObject(row)||Array.isArray(row))throw new TypeError("A table row must be an object");if(row[OBJECT_ID])throw new TypeError("Cannot reuse an existing object as table row");if(row.id)throw new TypeError('A table row must not have an "id" property; it is generated automatically');const id=uuid(),valuePatch=this.setValue(path[path.length-1].objectId,id,row,!1,[]);return this.applyAtPath(path,subpatch=>{subpatch.props[id]={[valuePatch.objectId]:valuePatch}}),id}deleteTableRow(path,rowId,pred){const objectId=path[path.length-1].objectId,table=this.getObject(objectId);table.byId(rowId)&&(this.addOp({action:"del",obj:objectId,key:rowId,insert:!1,pred:[pred]}),this.applyAtPath(path,subpatch=>{subpatch.props[rowId]={}}))}increment(path,key,delta){var objectId=0===path.length?"_root":path[path.length-1].objectId,object=this.getObject(objectId);if(!(object[key]instanceof Counter))throw new TypeError("Only counter values can be incremented");const type=this.getObjectType(objectId),value=object[key].value+delta,opId=this.nextOpId();var pred=getPred(object,key);"list"===type||"text"===type?(object=getElemId(object,key,!1),this.addOp({action:"inc",obj:objectId,elemId:object,value:delta,insert:!1,pred:pred})):this.addOp({action:"inc",obj:objectId,key:key,value:delta,insert:!1,pred:pred}),this.applyAtPath(path,subpatch=>{"list"===type||"text"===type?subpatch.edits.push({action:"update",index:key,opId:opId,value:{value:value,datatype:"counter"}}):subpatch.props[key]={[opId]:{value:value,datatype:"counter"}}})}}}},{"../src/common":62,"../src/uuid":63,"./apply_patch":30,"./constants":31,"./counter":33,"./numbers":35,"./table":38,"./text":39}],33:[function(require,module,exports){class Counter{constructor(value){this.value=value||0,Object.freeze(this)}valueOf(){return this.value}toString(){return this.valueOf().toString()}toJSON(){return this.value}}class WriteableCounter extends Counter{increment(delta){return this.context.increment(this.path,this.key,delta="number"==typeof delta?delta:1),this.value+=delta,this.value}decrement(delta){return this.increment("number"==typeof delta?-delta:-1)}}module.exports={Counter:Counter,getWriteableCounter:function(value,context,path,objectId,key){const instance=Object.create(WriteableCounter.prototype);return instance.value=value,instance.context=context,instance.path=path,instance.objectId=objectId,instance.key=key,instance}}},{}],34:[function(require,module,exports){const{OPTIONS,CACHE,STATE,OBJECT_ID,CONFLICTS,CHANGE,ELEM_IDS}=require("./constants"),{isObject,copyObject}=require("../src/common"),uuid=require("../src/uuid"),{interpretPatch,cloneRootObject}=require("./apply_patch"),rootObjectProxy=require("./proxies")["rootObjectProxy"],Context=require("./context")["Context"],Text=require("./text")["Text"],Table=require("./table")["Table"];var Counter=require("./counter")["Counter"],{Float64,Int,Uint}=require("./numbers"),require=require("./observable")["Observable"];function checkActorId(actorId){if("string"!=typeof actorId)throw new TypeError("Unsupported type of actorId: "+typeof actorId);if(!/^[0-9a-f]+$/.test(actorId))throw new RangeError("actorId must consist only of lowercase hex digits");if(actorId.length%2!=0)throw new RangeError("actorId must consist of an even number of digits")}function updateRootObject(doc,updated,state){let newDoc=updated._root;if(newDoc||(newDoc=cloneRootObject(doc[CACHE]._root),updated._root=newDoc),Object.defineProperty(newDoc,OPTIONS,{value:doc[OPTIONS]}),Object.defineProperty(newDoc,CACHE,{value:updated}),Object.defineProperty(newDoc,STATE,{value:state}),doc[OPTIONS].freeze)for(var objectId of Object.keys(updated))updated[objectId]instanceof Table?updated[objectId]._freeze():updated[objectId]instanceof Text?(Object.freeze(updated[objectId].elems),Object.freeze(updated[objectId])):(Object.freeze(updated[objectId]),Object.freeze(updated[objectId][CONFLICTS]));for(let objectId of Object.keys(doc[CACHE]))updated[objectId]||(updated[objectId]=doc[CACHE][objectId]);return doc[OPTIONS].freeze&&Object.freeze(updated),newDoc}function makeChange(doc,context,options){var actor=getActorId(doc);if(!actor)throw new Error("Actor ID must be initialized with setActorId() before making a change");const state=copyObject(doc[STATE]);state.seq+=1;var change={actor:actor,seq:state.seq,startOp:state.maxOp+1,deps:state.deps,time:options&&"number"==typeof options.time?options.time:Math.round((new Date).getTime()/1e3),message:options&&"string"==typeof options.message?options.message:"",ops:context.ops};if(doc[OPTIONS].backend){var[backendState,patch,binaryChange]=doc[OPTIONS].backend.applyLocalChange(state.backendState,change),backendState=(state.backendState=backendState,state.lastLocalChange=binaryChange,applyPatchToDoc(doc,patch,state,!0));const patchCallback=options&&options.patchCallback||doc[OPTIONS].patchCallback;return patchCallback&&patchCallback(patch,doc,backendState,!0,[binaryChange]),[backendState,change]}return state.requests=state.requests.concat([{actor:actor,seq:change.seq,before:doc}]),state.maxOp=state.maxOp+function(ops){let count=0;for(const op of ops)"set"===op.action&&op.values?count+=op.values.length:count+=1;return count}(change.ops),state.deps=[],[updateRootObject(doc,context?context.updated:{},state),change]}function applyPatchToDoc(doc,patch,state,fromBackend){var actor=getActorId(doc),updated={};if(interpretPatch(patch.diffs,doc,updated),fromBackend){if(!patch.clock)throw new RangeError("patch is missing clock field");patch.clock[actor]&&patch.clock[actor]>state.seq&&(state.seq=patch.clock[actor]),state.clock=patch.clock,state.deps=patch.deps,state.maxOp=Math.max(state.maxOp,patch.maxOp)}return updateRootObject(doc,updated,state)}function init(options){if("string"==typeof options)options={actorId:options};else if(void 0===options)options={};else if(!isObject(options))throw new TypeError("Unsupported value for init() options: "+options);if(options.deferActorId||(void 0===options.actorId&&(options.actorId=uuid()),checkActorId(options.actorId)),options.observable){const patchCallback=options.patchCallback,observable=options.observable;options.patchCallback=(patch,before,after,local,changes)=>{patchCallback&&patchCallback(patch,before,after,local,changes),observable.patchCallback(patch,before,after,local,changes)}}var root={},cache={_root:root};const state={seq:0,maxOp:0,requests:[],clock:{},deps:[]};return options.backend&&(state.backendState=options.backend.init(),state.lastLocalChange=null),Object.defineProperty(root,OBJECT_ID,{value:"_root"}),Object.defineProperty(root,OPTIONS,{value:Object.freeze(options)}),Object.defineProperty(root,CONFLICTS,{value:Object.freeze({})}),Object.defineProperty(root,CACHE,{value:Object.freeze(cache)}),Object.defineProperty(root,STATE,{value:Object.freeze(state)}),Object.freeze(root)}function change(doc,options,callback){if("_root"!==doc[OBJECT_ID])throw new TypeError("The first argument to Automerge.change must be the document root");if(doc[CHANGE])throw new TypeError("Calls to Automerge.change cannot be nested");if("function"==typeof options&&void 0===callback&&([options,callback]=[callback,options]),void 0!==(options="string"==typeof options?{message:options}:options)&&!isObject(options))throw new TypeError("Unsupported type of options");var actorId=getActorId(doc);if(!actorId)throw new Error("Actor ID must be initialized with setActorId() before making a change");actorId=new Context(doc,actorId);return callback(rootObjectProxy(actorId)),0===Object.keys(actorId.updated).length?[doc,null]:makeChange(doc,actorId,options)}function getActorId(doc){return doc[STATE].actorId||doc[OPTIONS].actorId}module.exports={init:init,from:function(initialState,options){return change(init(options),"Initialization",doc=>Object.assign(doc,initialState))},change:change,emptyChange:function(doc,options){if("_root"!==doc[OBJECT_ID])throw new TypeError("The first argument to Automerge.emptyChange must be the document root");if(void 0!==(options="string"==typeof options?{message:options}:options)&&!isObject(options))throw new TypeError("Unsupported type of options");var actorId=getActorId(doc);if(actorId)return makeChange(doc,new Context(doc,actorId),options);throw new Error("Actor ID must be initialized with setActorId() before making a change")},applyPatch:function(doc,patch,backendState=void 0){if("_root"!==doc[OBJECT_ID])throw new TypeError("The first argument to Frontend.applyPatch must be the document root");const state=copyObject(doc[STATE]);if(doc[OPTIONS].backend){if(backendState)return state.backendState=backendState,applyPatchToDoc(doc,patch,state,!0);throw new RangeError("applyPatch must be called with the updated backend state")}let baseDoc;if(0<state.requests.length)if(baseDoc=state.requests[0].before,patch.actor===getActorId(doc)){if(state.requests[0].seq!==patch.seq)throw new RangeError(`Mismatched sequence number: patch ${patch.seq} does not match next request `+state.requests[0].seq);state.requests=state.requests.slice(1)}else state.requests=state.requests.slice();else baseDoc=doc,state.requests=[];return backendState=applyPatchToDoc(baseDoc,patch,state,!0),0===state.requests.length?backendState:(state.requests[0]=copyObject(state.requests[0]),state.requests[0].before=backendState,updateRootObject(doc,{},state))},getObjectId:function(object){return object[OBJECT_ID]},getObjectById:function(doc,objectId){if(doc[CHANGE])throw new TypeError("Cannot use getObjectById in a change callback");return doc[CACHE][objectId]},getActorId:getActorId,setActorId:function(doc,actorId){return checkActorId(actorId),updateRootObject(doc,{},Object.assign({},doc[STATE],{actorId:actorId}))},getConflicts:function(object,key){if(object[CONFLICTS]&&object[CONFLICTS][key]&&1<Object.keys(object[CONFLICTS][key]).length)return object[CONFLICTS][key]},getLastLocalChange:function(doc){return doc[STATE]&&doc[STATE].lastLocalChange?doc[STATE].lastLocalChange:null},getBackendState:function(doc,callerName=null,argPos="first"){var extraMsg;if("_root"!==doc[OBJECT_ID])throw extraMsg=Array.isArray(doc)?". Note: Automerge.applyChanges now returns an array.":"",callerName?new TypeError(`The ${argPos} argument to Automerge.${callerName} must be the document root`+extraMsg):new TypeError("Argument is not an Automerge document root"+extraMsg);return doc[STATE].backendState},getElementIds:function(list){return list instanceof Text?list.elems.map(elem=>elem.elemId):list[ELEM_IDS]},Text:Text,Table:Table,Counter:Counter,Observable:require,Float64:Float64,Int:Int,Uint:Uint}},{"../src/common":62,"../src/uuid":63,"./apply_patch":30,"./constants":31,"./context":32,"./counter":33,"./numbers":35,"./observable":36,"./proxies":37,"./table":38,"./text":39}],35:[function(require,module,exports){module.exports={Int:class{constructor(value){if(!(Number.isInteger(value)&&value<=Number.MAX_SAFE_INTEGER&&value>=Number.MIN_SAFE_INTEGER))throw new RangeError(`Value ${value} cannot be a uint`);this.value=value,Object.freeze(this)}},Uint:class{constructor(value){if(!(Number.isInteger(value)&&value<=Number.MAX_SAFE_INTEGER&&0<=value))throw new RangeError(`Value ${value} cannot be a uint`);this.value=value,Object.freeze(this)}},Float64:class{constructor(value){if("number"!=typeof value)throw new RangeError(`Value ${value} cannot be a float64`);this.value=value||0,Object.freeze(this)}}}},{}],36:[function(require,module,exports){const{OBJECT_ID,CONFLICTS}=require("./constants");module.exports={Observable:class{constructor(){this.observers={}}patchCallback(patch,before,after,local,changes){this._objectUpdate(patch.diffs,before,after,local,changes)}_objectUpdate(diff,before,after,local,changes){if(diff.objectId){if(this.observers[diff.objectId])for(var callback of this.observers[diff.objectId])callback(diff,before,after,local,changes);if("map"===diff.type&&diff.props)for(const propName of Object.keys(diff.props))for(const opId of Object.keys(diff.props[propName]))this._objectUpdate(diff.props[propName][opId],before&&before[CONFLICTS]&&before[CONFLICTS][propName]&&before[CONFLICTS][propName][opId],after&&after[CONFLICTS]&&after[CONFLICTS][propName]&&after[CONFLICTS][propName][opId],local,changes);else if("table"===diff.type&&diff.props)for(const rowId of Object.keys(diff.props))for(const opId of Object.keys(diff.props[rowId]))this._objectUpdate(diff.props[rowId][opId],before&&before.byId(rowId),after&&after.byId(rowId),local,changes);else if("list"===diff.type&&diff.edits){let offset=0;for(const edit of diff.edits)"insert"===edit.action?(--offset,this._objectUpdate(edit.value,void 0,after&&after[CONFLICTS]&&after[CONFLICTS][edit.index]&&after[CONFLICTS][edit.index][edit.elemId],local,changes)):"multi-insert"===edit.action?offset-=edit.values.length:"update"===edit.action?this._objectUpdate(edit.value,before&&before[CONFLICTS]&&before[CONFLICTS][edit.index+offset]&&before[CONFLICTS][edit.index+offset][edit.opId],after&&after[CONFLICTS]&&after[CONFLICTS][edit.index]&&after[CONFLICTS][edit.index][edit.opId],local,changes):"remove"===edit.action&&(offset+=edit.count)}else if("text"===diff.type&&diff.edits){let offset=0;for(const edit of diff.edits)"insert"===edit.action?(--offset,this._objectUpdate(edit.value,void 0,after&&after.get(edit.index),local,changes)):"multi-insert"===edit.action?offset-=edit.values.length:"update"===edit.action?this._objectUpdate(edit.value,before&&before.get(edit.index+offset),after&&after.get(edit.index),local,changes):"remove"===edit.action&&(offset+=edit.count)}}}observe(object,callback){object=object[OBJECT_ID];if(!object)throw new TypeError("The observed object must be part of an Automerge document");this.observers[object]||(this.observers[object]=[]),this.observers[object].push(callback)}}}},{"./constants":31}],37:[function(require,module,exports){const{OBJECT_ID,CHANGE,STATE}=require("./constants"),createArrayOfNulls=require("../src/common")["createArrayOfNulls"],Text=require("./text")["Text"],Table=require("./table")["Table"];function parseListIndex(key){if("number"!=typeof(key="string"==typeof key&&/^[0-9]+$/.test(key)?parseInt(key,10):key))throw new TypeError("A list index must be a number, but you passed "+JSON.stringify(key));if(key<0||isNaN(key)||key===1/0||key===-1/0)throw new RangeError("A list index must be positive, but you passed "+key);return key}const MapHandler={get(target,key){const{context,objectId,path}=target;return key===OBJECT_ID?objectId:key===CHANGE?context:key===STATE?{actorId:context.actorId}:context.getObjectField(path,objectId,key)},set(target,key,value){const{context,path,readonly}=target;if(Array.isArray(readonly)&&0<=readonly.indexOf(key))throw new RangeError(`Object property "${key}" cannot be modified`);return context.setMapKey(path,key,value),!0},deleteProperty(target,key){const{context,path,readonly}=target;if(Array.isArray(readonly)&&0<=readonly.indexOf(key))throw new RangeError(`Object property "${key}" cannot be modified`);return context.deleteMapKey(path,key),!0},has(target,key){const{context,objectId}=target;return[OBJECT_ID,CHANGE].includes(key)||key in context.getObject(objectId)},getOwnPropertyDescriptor(target,key){const{context,objectId}=target;if(key in context.getObject(objectId))return{configurable:!0,enumerable:!0,value:context.getObjectField(objectId,key)}},ownKeys(target){const{context,objectId}=target;return Object.keys(context.getObject(objectId))}},ListHandler={get(target,key){const[context,objectId,path]=target;return key===Symbol.iterator?context.getObject(objectId)[Symbol.iterator]:key===OBJECT_ID?objectId:key===CHANGE?context:"length"===key?context.getObject(objectId).length:"string"==typeof key&&/^[0-9]+$/.test(key)?context.getObjectField(path,objectId,parseListIndex(key)):function(context,listId,path){const methods={deleteAt(index,numDelete){return context.splice(path,parseListIndex(index),numDelete||1,[]),this},fill(value,start,end){var list=context.getObject(listId);for(let index=parseListIndex(start||0);index<parseListIndex(end||list.length);index++)context.setListIndex(path,index,value);return this},indexOf(o,start=0){var id=o[OBJECT_ID];if(id){var list=context.getObject(listId);for(let index=start;index<list.length;index++)if(list[index][OBJECT_ID]===id)return index;return-1}return context.getObject(listId).indexOf(o,start)},insertAt(index,...values){return context.splice(path,parseListIndex(index),0,values),this},pop(){var last,list=context.getObject(listId);if(0!=list.length)return last=context.getObjectField(path,listId,list.length-1),context.splice(path,list.length-1,1,[]),last},push(...values){var list=context.getObject(listId);return context.splice(path,list.length,0,values),context.getObject(listId).length},shift(){var first;if(0!=context.getObject(listId).length)return first=context.getObjectField(path,listId,0),context.splice(path,0,1,[]),first},splice(start,deleteCount,...values){var list=context.getObject(listId);start=parseListIndex(start),(void 0===deleteCount||deleteCount>list.length-start)&&(deleteCount=list.length-start);const deleted=[];for(let n=0;n<deleteCount;n++)deleted.push(context.getObjectField(path,listId,start+n));return context.splice(path,start,deleteCount,values),deleted},unshift(...values){return context.splice(path,0,0,values),context.getObject(listId).length}};for(let iterator of["entries","keys","values"]){let list=context.getObject(listId);methods[iterator]=()=>list[iterator]()}for(let method of["concat","every","filter","find","findIndex","forEach","includes","join","lastIndexOf","map","reduce","reduceRight","slice","some","toLocaleString","toString"])methods[method]=(...args)=>{const list=context.getObject(listId).map((item,index)=>context.getObjectField(path,listId,index));return list[method](...args)};return methods}(context,objectId,path)[key]},set(target,key,value){const[context,objectId,path]=target;if("length"===key){if("number"!=typeof value)throw new RangeError("Invalid array length");target=context.getObject(objectId).length;value<target?context.splice(path,value,target-value,[]):context.splice(path,target,0,createArrayOfNulls(value-target))}else context.setListIndex(path,parseListIndex(key),value);return!0},deleteProperty(target,key){const[context,,path]=target;return context.splice(path,parseListIndex(key),1,[]),!0},has(target,key){const[context,objectId]=target;return"string"==typeof key&&/^[0-9]+$/.test(key)?parseListIndex(key)<context.getObject(objectId).length:["length",OBJECT_ID,CHANGE].includes(key)},getOwnPropertyDescriptor(target,key){const[context,objectId]=target;target=context.getObject(objectId);if("length"===key)return{writable:!0,value:target.length};if(key===OBJECT_ID)return{configurable:!1,enumerable:!1,value:objectId};if("string"==typeof key&&/^[0-9]+$/.test(key)){key=parseListIndex(key);if(key<target.length)return{configurable:!0,enumerable:!0,value:context.getObjectField(objectId,key)}}},ownKeys(target){const[context,objectId]=target;var key,target=context.getObject(objectId);let keys=["length"];for(key of Object.keys(target))keys.push(key);return keys}};function mapProxy(context,objectId,path,readonly){return new Proxy({context:context,objectId:objectId,path:path,readonly:readonly},MapHandler)}function instantiateProxy(path,objectId,readonly){const object=this.getObject(objectId);return Array.isArray(object)?function(context,objectId,path){return new Proxy([context,objectId,path],ListHandler)}(this,objectId,path):object instanceof Text||object instanceof Table?object.getWriteable(this,path):mapProxy(this,objectId,path,readonly)}module.exports={rootObjectProxy:function(context){return context.instantiateObject=instantiateProxy,mapProxy(context,"_root",[])}}},{"../src/common":62,"./constants":31,"./table":38,"./text":39}],38:[function(require,module,exports){const{OBJECT_ID,CONFLICTS}=require("./constants"),{isObject,copyObject}=require("../src/common");function compareRows(properties,row1,row2){for(var prop of properties)if(row1[prop]!==row2[prop]){if("number"==typeof row1[prop]&&"number"==typeof row2[prop])return row1[prop]-row2[prop];var prop1=""+row1[prop],prop=""+row2[prop];if(prop1!=prop)return prop1<prop?-1:1}return 0}class Table{constructor(){this.entries=Object.freeze({}),this.opIds=Object.freeze({}),Object.freeze(this)}byId(id){return this.entries[id]}get ids(){return Object.keys(this.entries).filter(key=>{var entry=this.entries[key];return isObject(entry)&&entry.id===key})}get count(){return this.ids.length}get rows(){return this.ids.map(id=>this.byId(id))}filter(callback,thisArg){return this.rows.filter(callback,thisArg)}find(callback,thisArg){return this.rows.find(callback,thisArg)}map(callback,thisArg){return this.rows.map(callback,thisArg)}sort(arg){if("function"==typeof arg)return this.rows.sort(arg);if("string"==typeof arg)return this.rows.sort((row1,row2)=>compareRows([arg],row1,row2));if(Array.isArray(arg))return this.rows.sort((row1,row2)=>compareRows(arg,row1,row2));if(void 0===arg)return this.rows.sort((row1,row2)=>compareRows(["id"],row1,row2));throw new TypeError("Unsupported sorting argument: "+arg)}[Symbol.iterator](){let rows=this.rows,index=-1;return{next(){return(index+=1)<rows.length?{done:!1,value:rows[index]}:{done:!0}}}}_clone(){if(this[OBJECT_ID])return instantiateTable(this[OBJECT_ID],copyObject(this.entries),copyObject(this.opIds));throw new RangeError("clone() requires the objectId to be set")}_set(id,value,opId){if(Object.isFrozen(this.entries))throw new Error("A table can only be modified in a change function");isObject(value)&&!Array.isArray(value)&&Object.defineProperty(value,"id",{value:id,enumerable:!0}),this.entries[id]=value,this.opIds[id]=opId}remove(id){if(Object.isFrozen(this.entries))throw new Error("A table can only be modified in a change function");delete this.entries[id],delete this.opIds[id]}_freeze(){Object.freeze(this.entries),Object.freeze(this.opIds),Object.freeze(this)}getWriteable(context,path){if(!this[OBJECT_ID])throw new RangeError("getWriteable() requires the objectId to be set");const instance=Object.create(WriteableTable.prototype);return instance[OBJECT_ID]=this[OBJECT_ID],instance.context=context,instance.entries=this.entries,instance.opIds=this.opIds,instance.path=path,instance}toJSON(){const rows={};for(var id of this.ids)rows[id]=this.byId(id);return rows}}class WriteableTable extends Table{byId(id){var objectId;if(isObject(this.entries[id])&&this.entries[id].id===id)return objectId=this.entries[id][OBJECT_ID],id=this.path.concat([{key:id,objectId:objectId}]),this.context.instantiateObject(id,objectId,["id"])}add(row){return this.context.addTableRow(this.path,row)}remove(id){if(!isObject(this.entries[id])||this.entries[id].id!==id)throw new RangeError(`There is no row with ID ${id} in this table`);this.context.deleteTableRow(this.path,id,this.opIds[id])}}function instantiateTable(objectId,entries,opIds){const instance=Object.create(Table.prototype);if(objectId)return instance[OBJECT_ID]=objectId,instance[CONFLICTS]=Object.freeze({}),instance.entries=entries||{},instance.opIds=opIds||{},instance;throw new RangeError("instantiateTable requires an objectId to be given")}module.exports={Table:Table,instantiateTable:instantiateTable}},{"../src/common":62,"./constants":31}],39:[function(require,module,exports){const OBJECT_ID=require("./constants")["OBJECT_ID"],isObject=require("../src/common")["isObject"];class Text{constructor(text){if("string"==typeof text)return instantiateText(void 0,[...text].map(value=>({value:value})));if(Array.isArray(text)){const elems=text.map(value=>({value:value}));return instantiateText(void 0,elems)}if(void 0===text)return instantiateText(void 0,[]);throw new TypeError("Unsupported initial value for Text: "+text)}get length(){return this.elems.length}get(index){var objectId,value=this.elems[index].value;return this.context&&isObject(value)?(objectId=value[OBJECT_ID],index=this.path.concat([{key:index,objectId:objectId}]),this.context.instantiateObject(index,objectId)):value}getElemId(index){return this.elems[index].elemId}[Symbol.iterator](){let elems=this.elems,index=-1;return{next(){return(index+=1)<elems.length?{done:!1,value:elems[index].value}:{done:!0}}}}toString(){let str="";for(const elem of this.elems)"string"==typeof elem.value&&(str+=elem.value);return str}toSpans(){let spans=[],chars="";for(const elem of this.elems)"string"==typeof elem.value?chars+=elem.value:(0<chars.length&&(spans.push(chars),chars=""),spans.push(elem.value));return 0<chars.length&&spans.push(chars),spans}toJSON(){return this.toString()}getWriteable(context,path){if(!this[OBJECT_ID])throw new RangeError("getWriteable() requires the objectId to be set");const instance=instantiateText(this[OBJECT_ID],this.elems);return instance.context=context,instance.path=path,instance}set(index,value){if(this.context)this.context.setListIndex(this.path,index,value);else{if(this[OBJECT_ID])throw new TypeError("Automerge.Text object cannot be modified outside of a change block");this.elems[index].value=value}return this}insertAt(index,...values){if(this.context)this.context.splice(this.path,index,0,values);else{if(this[OBJECT_ID])throw new TypeError("Automerge.Text object cannot be modified outside of a change block");this.elems.splice(index,0,...values.map(value=>({value:value})))}return this}deleteAt(index,numDelete=1){if(this.context)this.context.splice(this.path,index,numDelete,[]);else{if(this[OBJECT_ID])throw new TypeError("Automerge.Text object cannot be modified outside of a change block");this.elems.splice(index,numDelete)}return this}}for(let method of["concat","every","filter","find","findIndex","forEach","includes","indexOf","join","lastIndexOf","map","reduce","reduceRight","slice","some","toLocaleString"])Text.prototype[method]=function(...args){const array=[...this];return array[method](...args)};function instantiateText(objectId,elems){const instance=Object.create(Text.prototype);return instance[OBJECT_ID]=objectId,instance.elems=elems,instance}module.exports={Text:Text,instantiateText:instantiateText}},{"../src/common":62,"./constants":31}],40:[function(require,module,exports){"use strict";var{Deflate,deflate,deflateRaw,gzip}=require("./lib/deflate"),{Inflate,inflate,inflateRaw,ungzip}=require("./lib/inflate"),require=require("./lib/zlib/constants");module.exports.Deflate=Deflate,module.exports.deflate=deflate,module.exports.deflateRaw=deflateRaw,module.exports.gzip=gzip,module.exports.Inflate=Inflate,module.exports.inflate=inflate,module.exports.inflateRaw=inflateRaw,module.exports.ungzip=ungzip,module.exports.constants=require},{"./lib/deflate":41,"./lib/inflate":42,"./lib/zlib/constants":46}],41:[function(require,module,exports){"use strict";const zlib_deflate=require("./zlib/deflate"),utils=require("./utils/common"),strings=require("./utils/strings"),msg=require("./zlib/messages"),ZStream=require("./zlib/zstream"),toString=Object.prototype.toString,{Z_NO_FLUSH,Z_SYNC_FLUSH,Z_FULL_FLUSH,Z_FINISH,Z_OK,Z_STREAM_END,Z_DEFAULT_COMPRESSION,Z_DEFAULT_STRATEGY,Z_DEFLATED}=require("./zlib/constants");function Deflate(options){this.options=utils.assign({level:Z_DEFAULT_COMPRESSION,method:Z_DEFLATED,chunkSize:16384,windowBits:15,memLevel:8,strategy:Z_DEFAULT_STRATEGY},options||{});let opt=this.options,status=(opt.raw&&0<opt.windowBits?opt.windowBits=-opt.windowBits:opt.gzip&&0<opt.windowBits&&opt.windowBits<16&&(opt.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new ZStream,this.strm.avail_out=0,zlib_deflate.deflateInit2(this.strm,opt.level,opt.method,opt.windowBits,opt.memLevel,opt.strategy));if(status!==Z_OK)throw new Error(msg[status]);if(opt.header&&zlib_deflate.deflateSetHeader(this.strm,opt.header),opt.dictionary){let dict;if(dict="string"==typeof opt.dictionary?strings.string2buf(opt.dictionary):"[object ArrayBuffer]"===toString.call(opt.dictionary)?new Uint8Array(opt.dictionary):opt.dictionary,(status=zlib_deflate.deflateSetDictionary(this.strm,dict))!==Z_OK)throw new Error(msg[status]);this._dict_set=!0}}function deflate(input,options){const deflator=new Deflate(options);if(deflator.push(input,!0),deflator.err)throw deflator.msg||msg[deflator.err];return deflator.result}Deflate.prototype.push=function(data,flush_mode){const strm=this.strm;var chunkSize=this.options.chunkSize;let status,_flush_mode;if(this.ended)return!1;for(_flush_mode=flush_mode===~~flush_mode?flush_mode:!0===flush_mode?Z_FINISH:Z_NO_FLUSH,"string"==typeof data?strm.input=strings.string2buf(data):"[object ArrayBuffer]"===toString.call(data)?strm.input=new Uint8Array(data):strm.input=data,strm.next_in=0,strm.avail_in=strm.input.length;;)if(0===strm.avail_out&&(strm.output=new Uint8Array(chunkSize),strm.next_out=0,strm.avail_out=chunkSize),(_flush_mode===Z_SYNC_FLUSH||_flush_mode===Z_FULL_FLUSH)&&strm.avail_out<=6)this.onData(strm.output.subarray(0,strm.next_out)),strm.avail_out=0;else{if(zlib_deflate.deflate(strm,_flush_mode)===Z_STREAM_END)return 0<strm.next_out&&this.onData(strm.output.subarray(0,strm.next_out)),status=zlib_deflate.deflateEnd(this.strm),this.onEnd(status),this.ended=!0,status===Z_OK;if(0===strm.avail_out)this.onData(strm.output);else if(0<_flush_mode&&0<strm.next_out)this.onData(strm.output.subarray(0,strm.next_out)),strm.avail_out=0;else if(0===strm.avail_in)break}return!0},Deflate.prototype.onData=function(chunk){this.chunks.push(chunk)},Deflate.prototype.onEnd=function(status){status===Z_OK&&(this.result=utils.flattenChunks(this.chunks)),this.chunks=[],this.err=status,this.msg=this.strm.msg},module.exports.Deflate=Deflate,module.exports.deflate=deflate,module.exports.deflateRaw=function(input,options){return(options=options||{}).raw=!0,deflate(input,options)},module.exports.gzip=function(input,options){return(options=options||{}).gzip=!0,deflate(input,options)},module.exports.constants=require("./zlib/constants")},{"./utils/common":43,"./utils/strings":44,"./zlib/constants":46,"./zlib/deflate":48,"./zlib/messages":53,"./zlib/zstream":55}],42:[function(require,module,exports){"use strict";const zlib_inflate=require("./zlib/inflate"),utils=require("./utils/common"),strings=require("./utils/strings"),msg=require("./zlib/messages"),ZStream=require("./zlib/zstream"),GZheader=require("./zlib/gzheader"),toString=Object.prototype.toString,{Z_NO_FLUSH,Z_FINISH,Z_OK,Z_STREAM_END,Z_NEED_DICT,Z_STREAM_ERROR,Z_DATA_ERROR,Z_MEM_ERROR}=require("./zlib/constants");function Inflate(options){this.options=utils.assign({chunkSize:65536,windowBits:15,to:""},options||{});const opt=this.options;opt.raw&&0<=opt.windowBits&&opt.windowBits<16&&(opt.windowBits=-opt.windowBits,0===opt.windowBits&&(opt.windowBits=-15)),!(0<=opt.windowBits&&opt.windowBits<16)||options&&options.windowBits||(opt.windowBits+=32),15<opt.windowBits&&opt.windowBits<48&&0==(15&opt.windowBits)&&(opt.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new ZStream,this.strm.avail_out=0;let status=zlib_inflate.inflateInit2(this.strm,opt.windowBits);if(status!==Z_OK)throw new Error(msg[status]);if(this.header=new GZheader,zlib_inflate.inflateGetHeader(this.strm,this.header),opt.dictionary&&("string"==typeof opt.dictionary?opt.dictionary=strings.string2buf(opt.dictionary):"[object ArrayBuffer]"===toString.call(opt.dictionary)&&(opt.dictionary=new Uint8Array(opt.dictionary)),opt.raw&&(status=zlib_inflate.inflateSetDictionary(this.strm,opt.dictionary))!==Z_OK))throw new Error(msg[status])}function inflate(input,options){const inflator=new Inflate(options);if(inflator.push(input),inflator.err)throw inflator.msg||msg[inflator.err];return inflator.result}Inflate.prototype.push=function(data,flush_mode){const strm=this.strm;var next_out_utf8,tail,utf8str,chunkSize=this.options.chunkSize,dictionary=this.options.dictionary;let status,_flush_mode,last_avail_out;if(this.ended)return!1;for(_flush_mode=flush_mode===~~flush_mode?flush_mode:!0===flush_mode?Z_FINISH:Z_NO_FLUSH,"[object ArrayBuffer]"===toString.call(data)?strm.input=new Uint8Array(data):strm.input=data,strm.next_in=0,strm.avail_in=strm.input.length;;){for(0===strm.avail_out&&(strm.output=new Uint8Array(chunkSize),strm.next_out=0,strm.avail_out=chunkSize),(status=zlib_inflate.inflate(strm,_flush_mode))===Z_NEED_DICT&&dictionary&&((status=zlib_inflate.inflateSetDictionary(strm,dictionary))===Z_OK?status=zlib_inflate.inflate(strm,_flush_mode):status===Z_DATA_ERROR&&(status=Z_NEED_DICT));0<strm.avail_in&&status===Z_STREAM_END&&0<strm.state.wrap&&0!==data[strm.next_in];)zlib_inflate.inflateReset(strm),status=zlib_inflate.inflate(strm,_flush_mode);switch(status){case Z_STREAM_ERROR:case Z_DATA_ERROR:case Z_NEED_DICT:case Z_MEM_ERROR:return this.onEnd(status),!(this.ended=!0)}if(last_avail_out=strm.avail_out,!strm.next_out||0!==strm.avail_out&&status!==Z_STREAM_END||("string"===this.options.to?(next_out_utf8=strings.utf8border(strm.output,strm.next_out),tail=strm.next_out-next_out_utf8,utf8str=strings.buf2string(strm.output,next_out_utf8),strm.next_out=tail,strm.avail_out=chunkSize-tail,tail&&strm.output.set(strm.output.subarray(next_out_utf8,next_out_utf8+tail),0),this.onData(utf8str)):this.onData(strm.output.length===strm.next_out?strm.output:strm.output.subarray(0,strm.next_out))),status!==Z_OK||0!==last_avail_out){if(status===Z_STREAM_END)return status=zlib_inflate.inflateEnd(this.strm),this.onEnd(status),this.ended=!0;if(0===strm.avail_in)break}}return!0},Inflate.prototype.onData=function(chunk){this.chunks.push(chunk)},Inflate.prototype.onEnd=function(status){status===Z_OK&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=utils.flattenChunks(this.chunks)),this.chunks=[],this.err=status,this.msg=this.strm.msg},module.exports.Inflate=Inflate,module.exports.inflate=inflate,module.exports.inflateRaw=function(input,options){return(options=options||{}).raw=!0,inflate(input,options)},module.exports.ungzip=inflate,module.exports.constants=require("./zlib/constants")},{"./utils/common":43,"./utils/strings":44,"./zlib/constants":46,"./zlib/gzheader":49,"./zlib/inflate":51,"./zlib/messages":53,"./zlib/zstream":55}],43:[function(require,module,exports){"use strict";module.exports.assign=function(obj){const sources=Array.prototype.slice.call(arguments,1);for(;sources.length;){var source=sources.shift();if(source){if("object"!=typeof source)throw new TypeError(source+"must be non-object");for(const p in source)((obj,key)=>Object.prototype.hasOwnProperty.call(obj,key))(source,p)&&(obj[p]=source[p])}}return obj},module.exports.flattenChunks=chunks=>{let len=0;for(let i=0,l=chunks.length;i<l;i++)len+=chunks[i].length;const result=new Uint8Array(len);for(let i=0,pos=0,l=chunks.length;i<l;i++){var chunk=chunks[i];result.set(chunk,pos),pos+=chunk.length}return result}},{}],44:[function(require,module,exports){"use strict";let STR_APPLY_UIA_OK=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(__){STR_APPLY_UIA_OK=!1}const _utf8len=new Uint8Array(256);for(let q=0;q<256;q++)_utf8len[q]=252<=q?6:248<=q?5:240<=q?4:224<=q?3:192<=q?2:1;_utf8len[254]=_utf8len[254]=1,module.exports.string2buf=str=>{if("function"==typeof TextEncoder&&TextEncoder.prototype.encode)return(new TextEncoder).encode(str);let buf,c,c2,m_pos,i,str_len=str.length,buf_len=0;for(m_pos=0;m_pos<str_len;m_pos++)55296==(64512&(c=str.charCodeAt(m_pos)))&&m_pos+1<str_len&&56320==(64512&(c2=str.charCodeAt(m_pos+1)))&&(c=65536+(c-55296<<10)+(c2-56320),m_pos++),buf_len+=c<128?1:c<2048?2:c<65536?3:4;for(buf=new Uint8Array(buf_len),i=0,m_pos=0;i<buf_len;m_pos++)55296==(64512&(c=str.charCodeAt(m_pos)))&&m_pos+1<str_len&&56320==(64512&(c2=str.charCodeAt(m_pos+1)))&&(c=65536+(c-55296<<10)+(c2-56320),m_pos++),c<128?buf[i++]=c:(c<2048?buf[i++]=192|c>>>6:(c<65536?buf[i++]=224|c>>>12:(buf[i++]=240|c>>>18,buf[i++]=128|c>>>12&63),buf[i++]=128|c>>>6&63),buf[i++]=128|63&c);return buf};module.exports.buf2string=(buf,max)=>{var len=max||buf.length;if("function"==typeof TextDecoder&&TextDecoder.prototype.decode)return(new TextDecoder).decode(buf.subarray(0,max));let i,out;const utf16buf=new Array(2*len);for(out=0,i=0;i<len;){let c=buf[i++];if(c<128)utf16buf[out++]=c;else{let c_len=_utf8len[c];if(4<c_len)utf16buf[out++]=65533,i+=c_len-1;else{for(c&=2===c_len?31:3===c_len?15:7;1<c_len&&i<len;)c=c<<6|63&buf[i++],c_len--;1<c_len?utf16buf[out++]=65533:c<65536?utf16buf[out++]=c:(c-=65536,utf16buf[out++]=55296|c>>10&1023,utf16buf[out++]=56320|1023&c)}}}return((buf,len)=>{if(len<65534&&buf.subarray&&STR_APPLY_UIA_OK)return String.fromCharCode.apply(null,buf.length===len?buf:buf.subarray(0,len));let result="";for(let i=0;i<len;i++)result+=String.fromCharCode(buf[i]);return result})(utf16buf,out)},module.exports.utf8border=(buf,max)=>{let pos=(max=(max=max||buf.length)>buf.length?buf.length:max)-1;for(;0<=pos&&128==(192&buf[pos]);)pos--;return!(pos<0)&&0!==pos&&pos+_utf8len[buf[pos]]>max?pos:max}},{}],45:[function(require,module,exports){"use strict";module.exports=(adler,buf,len,pos)=>{let s1=65535&adler|0,s2=adler>>>16&65535|0,n=0;for(;0!==len;){for(len-=n=2e3<len?2e3:len;s1=s1+buf[pos++]|0,s2=s2+s1|0,--n;);s1%=65521,s2%=65521}return s1|s2<<16|0}},{}],46:[function(require,module,exports){"use strict";module.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],47:[function(require,module,exports){"use strict";const crcTable=new Uint32Array((()=>{let c,table=[];for(var n=0;n<256;n++){c=n;for(var k=0;k<8;k++)c=1&c?3988292384^c>>>1:c>>>1;table[n]=c}return table})());module.exports=(crc,buf,len,pos)=>{var t=crcTable,end=pos+len;crc^=-1;for(let i=pos;i<end;i++)crc=crc>>>8^t[255&(crc^buf[i])];return-1^crc}},{}],48:[function(require,module,exports){"use strict";const{_tr_init,_tr_stored_block,_tr_flush_block,_tr_tally,_tr_align}=require("./trees"),adler32=require("./adler32"),crc32=require("./crc32"),msg=require("./messages"),{Z_NO_FLUSH,Z_PARTIAL_FLUSH,Z_FULL_FLUSH,Z_FINISH,Z_BLOCK,Z_OK,Z_STREAM_END,Z_STREAM_ERROR,Z_DATA_ERROR,Z_BUF_ERROR,Z_DEFAULT_COMPRESSION,Z_FILTERED,Z_HUFFMAN_ONLY,Z_RLE,Z_FIXED,Z_DEFAULT_STRATEGY,Z_UNKNOWN,Z_DEFLATED}=require("./constants"),MAX_MEM_LEVEL=9;const L_CODES=286,D_CODES=30,BL_CODES=19,HEAP_SIZE=2*L_CODES+1,MAX_BITS=15,MIN_MATCH=3,MAX_MATCH=258,MIN_LOOKAHEAD=MAX_MATCH+MIN_MATCH+1,INIT_STATE=42,BUSY_STATE=113,BS_NEED_MORE=1,BS_BLOCK_DONE=2,BS_FINISH_STARTED=3,BS_FINISH_DONE=4,err=(strm,errorCode)=>(strm.msg=msg[errorCode],errorCode),rank=f=>(f<<1)-(4<f?9:0),zero=buf=>{let len=buf.length;for(;0<=--len;)buf[len]=0};let HASH=(s,prev,data)=>(prev<<s.hash_shift^data)&s.hash_mask;const flush_pending=strm=>{const s=strm.state;let len=s.pending;0!==(len=len>strm.avail_out?strm.avail_out:len)&&(strm.output.set(s.pending_buf.subarray(s.pending_out,s.pending_out+len),strm.next_out),strm.next_out+=len,s.pending_out+=len,strm.total_out+=len,strm.avail_out-=len,s.pending-=len,0===s.pending&&(s.pending_out=0))},flush_block_only=(s,last)=>{_tr_flush_block(s,0<=s.block_start?s.block_start:-1,s.strstart-s.block_start,last),s.block_start=s.strstart,flush_pending(s.strm)},put_byte=(s,b)=>{s.pending_buf[s.pending++]=b},putShortMSB=(s,b)=>{s.pending_buf[s.pending++]=b>>>8&255,s.pending_buf[s.pending++]=255&b},read_buf=(strm,buf,start,size)=>{let len=strm.avail_in;return 0===(len=len>size?size:len)?0:(strm.avail_in-=len,buf.set(strm.input.subarray(strm.next_in,strm.next_in+len),start),1===strm.state.wrap?strm.adler=adler32(strm.adler,buf,len,start):2===strm.state.wrap&&(strm.adler=crc32(strm.adler,buf,len,start)),strm.next_in+=len,strm.total_in+=len,len)},longest_match=(s,cur_match)=>{let chain_length=s.max_chain_length,scan=s.strstart,match;var len;let best_len=s.prev_length,nice_match=s.nice_match;var limit=s.strstart>s.w_size-MIN_LOOKAHEAD?s.strstart-(s.w_size-MIN_LOOKAHEAD):0,_win=s.window,wmask=s.w_mask,prev=s.prev,strend=s.strstart+MAX_MATCH;let scan_end1=_win[scan+best_len-1],scan_end=_win[scan+best_len];s.prev_length>=s.good_match&&(chain_length>>=2),nice_match>s.lookahead&&(nice_match=s.lookahead);do{if(_win[(match=cur_match)+best_len]===scan_end&&_win[match+best_len-1]===scan_end1&&_win[match]===_win[scan]&&_win[++match]===_win[scan+1]){for(scan+=2,match++;_win[++scan]===_win[++match]&&_win[++scan]===_win[++match]&&_win[++scan]===_win[++match]&&_win[++scan]===_win[++match]&&_win[++scan]===_win[++match]&&_win[++scan]===_win[++match]&&_win[++scan]===_win[++match]&&_win[++scan]===_win[++match]&&scan<strend;);if(len=MAX_MATCH-(strend-scan),scan=strend-MAX_MATCH,len>best_len){if(s.match_start=cur_match,(best_len=len)>=nice_match)break;scan_end1=_win[scan+best_len-1],scan_end=_win[scan+best_len]}}}while((cur_match=prev[cur_match&wmask])>limit&&0!=--chain_length);return best_len<=s.lookahead?best_len:s.lookahead},fill_window=s=>{var _w_size=s.w_size;let p,n,m,more,str;do{if(more=s.window_size-s.lookahead-s.strstart,s.strstart>=_w_size+(_w_size-MIN_LOOKAHEAD)){for(s.window.set(s.window.subarray(_w_size,_w_size+_w_size),0),s.match_start-=_w_size,s.strstart-=_w_size,s.block_start-=_w_size,n=s.hash_size,p=n;m=s.head[--p],s.head[p]=m>=_w_size?m-_w_size:0,--n;);for(n=_w_size,p=n;m=s.prev[--p],s.prev[p]=m>=_w_size?m-_w_size:0,--n;);more+=_w_size}if(0===s.strm.avail_in)break;if(n=read_buf(s.strm,s.window,s.strstart+s.lookahead,more),s.lookahead+=n,s.lookahead+s.insert>=MIN_MATCH)for(str=s.strstart-s.insert,s.ins_h=s.window[str],s.ins_h=HASH(s,s.ins_h,s.window[str+1]);s.insert&&(s.ins_h=HASH(s,s.ins_h,s.window[str+MIN_MATCH-1]),s.prev[str&s.w_mask]=s.head[s.ins_h],s.head[s.ins_h]=str,str++,s.insert--,!(s.lookahead+s.insert<MIN_MATCH)););}while(s.lookahead<MIN_LOOKAHEAD&&0!==s.strm.avail_in)};var require=(s,flush)=>{let hash_head,bflush;for(;;){if(s.lookahead<MIN_LOOKAHEAD){if(fill_window(s),s.lookahead<MIN_LOOKAHEAD&&flush===Z_NO_FLUSH)return BS_NEED_MORE;if(0===s.lookahead)break}if(hash_head=0,s.lookahead>=MIN_MATCH&&(s.ins_h=HASH(s,s.ins_h,s.window[s.strstart+MIN_MATCH-1]),hash_head=s.prev[s.strstart&s.w_mask]=s.head[s.ins_h],s.head[s.ins_h]=s.strstart),0!==hash_head&&s.strstart-hash_head<=s.w_size-MIN_LOOKAHEAD&&(s.match_length=longest_match(s,hash_head)),s.match_length>=MIN_MATCH)if(bflush=_tr_tally(s,s.strstart-s.match_start,s.match_length-MIN_MATCH),s.lookahead-=s.match_length,s.match_length<=s.max_lazy_match&&s.lookahead>=MIN_MATCH){for(s.match_length--;s.strstart++,s.ins_h=HASH(s,s.ins_h,s.window[s.strstart+MIN_MATCH-1]),hash_head=s.prev[s.strstart&s.w_mask]=s.head[s.ins_h],s.head[s.ins_h]=s.strstart,0!=--s.match_length;);s.strstart++}else s.strstart+=s.match_length,s.match_length=0,s.ins_h=s.window[s.strstart],s.ins_h=HASH(s,s.ins_h,s.window[s.strstart+1]);else bflush=_tr_tally(s,0,s.window[s.strstart]),s.lookahead--,s.strstart++;if(bflush&&(flush_block_only(s,!1),0===s.strm.avail_out))return BS_NEED_MORE}return s.insert=s.strstart<MIN_MATCH-1?s.strstart:MIN_MATCH-1,flush===Z_FINISH?(flush_block_only(s,!0),0===s.strm.avail_out?BS_FINISH_STARTED:BS_FINISH_DONE):s.last_lit&&(flush_block_only(s,!1),0===s.strm.avail_out)?BS_NEED_MORE:BS_BLOCK_DONE},deflate_slow=(s,flush)=>{let hash_head,bflush;for(var max_insert;;){if(s.lookahead<MIN_LOOKAHEAD){if(fill_window(s),s.lookahead<MIN_LOOKAHEAD&&flush===Z_NO_FLUSH)return BS_NEED_MORE;if(0===s.lookahead)break}if(hash_head=0,s.lookahead>=MIN_MATCH&&(s.ins_h=HASH(s,s.ins_h,s.window[s.strstart+MIN_MATCH-1]),hash_head=s.prev[s.strstart&s.w_mask]=s.head[s.ins_h],s.head[s.ins_h]=s.strstart),s.prev_length=s.match_length,s.prev_match=s.match_start,s.match_length=MIN_MATCH-1,0!==hash_head&&s.prev_length<s.max_lazy_match&&s.strstart-hash_head<=s.w_size-MIN_LOOKAHEAD&&(s.match_length=longest_match(s,hash_head),s.match_length<=5&&(s.strategy===Z_FILTERED||s.match_length===MIN_MATCH&&4096<s.strstart-s.match_start)&&(s.match_length=MIN_MATCH-1)),s.prev_length>=MIN_MATCH&&s.match_length<=s.prev_length){for(max_insert=s.strstart+s.lookahead-MIN_MATCH,bflush=_tr_tally(s,s.strstart-1-s.prev_match,s.prev_length-MIN_MATCH),s.lookahead-=s.prev_length-1,s.prev_length-=2;++s.strstart<=max_insert&&(s.ins_h=HASH(s,s.ins_h,s.window[s.strstart+MIN_MATCH-1]),hash_head=s.prev[s.strstart&s.w_mask]=s.head[s.ins_h],s.head[s.ins_h]=s.strstart),0!=--s.prev_length;);if(s.match_available=0,s.match_length=MIN_MATCH-1,s.strstart++,bflush&&(flush_block_only(s,!1),0===s.strm.avail_out))return BS_NEED_MORE}else if(s.match_available){if((bflush=_tr_tally(s,0,s.window[s.strstart-1]))&&flush_block_only(s,!1),s.strstart++,s.lookahead--,0===s.strm.avail_out)return BS_NEED_MORE}else s.match_available=1,s.strstart++,s.lookahead--}return s.match_available&&(bflush=_tr_tally(s,0,s.window[s.strstart-1]),s.match_available=0),s.insert=s.strstart<MIN_MATCH-1?s.strstart:MIN_MATCH-1,flush===Z_FINISH?(flush_block_only(s,!0),0===s.strm.avail_out?BS_FINISH_STARTED:BS_FINISH_DONE):s.last_lit&&(flush_block_only(s,!1),0===s.strm.avail_out)?BS_NEED_MORE:BS_BLOCK_DONE};function Config(good_length,max_lazy,nice_length,max_chain,func){this.good_length=good_length,this.max_lazy=max_lazy,this.nice_length=nice_length,this.max_chain=max_chain,this.func=func}const configuration_table=[new Config(0,0,0,0,(s,flush)=>{let max_block_size=65535;for(max_block_size>s.pending_buf_size-5&&(max_block_size=s.pending_buf_size-5);;){if(s.lookahead<=1){if(fill_window(s),0===s.lookahead&&flush===Z_NO_FLUSH)return BS_NEED_MORE;if(0===s.lookahead)break}s.strstart+=s.lookahead,s.lookahead=0;var max_start=s.block_start+max_block_size;if((0===s.strstart||s.strstart>=max_start)&&(s.lookahead=s.strstart-max_start,s.strstart=max_start,flush_block_only(s,!1),0===s.strm.avail_out))return BS_NEED_MORE;if(s.strstart-s.block_start>=s.w_size-MIN_LOOKAHEAD&&(flush_block_only(s,!1),0===s.strm.avail_out))return BS_NEED_MORE}return s.insert=0,flush===Z_FINISH?(flush_block_only(s,!0),0===s.strm.avail_out?BS_FINISH_STARTED:BS_FINISH_DONE):(s.strstart>s.block_start&&(flush_block_only(s,!1),s.strm.avail_out),BS_NEED_MORE)}),new Config(4,4,8,4,require),new Config(4,5,16,8,require),new Config(4,6,32,32,require),new Config(4,4,16,16,deflate_slow),new Config(8,16,32,32,deflate_slow),new Config(8,16,128,128,deflate_slow),new Config(8,32,128,256,deflate_slow),new Config(32,128,258,1024,deflate_slow),new Config(32,258,258,4096,deflate_slow)];function DeflateState(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=Z_DEFLATED,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(2*HEAP_SIZE),this.dyn_dtree=new Uint16Array(2*(2*D_CODES+1)),this.bl_tree=new Uint16Array(2*(2*BL_CODES+1)),zero(this.dyn_ltree),zero(this.dyn_dtree),zero(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(MAX_BITS+1),this.heap=new Uint16Array(2*L_CODES+1),zero(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(2*L_CODES+1),zero(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}const deflateResetKeep=strm=>{if(!strm||!strm.state)return err(strm,Z_STREAM_ERROR);strm.total_in=strm.total_out=0,strm.data_type=Z_UNKNOWN;const s=strm.state;return s.pending=0,s.pending_out=0,s.wrap<0&&(s.wrap=-s.wrap),s.status=s.wrap?INIT_STATE:BUSY_STATE,strm.adler=2===s.wrap?0:1,s.last_flush=Z_NO_FLUSH,_tr_init(s),Z_OK},deflateReset=strm=>{var ret=deflateResetKeep(strm);return ret===Z_OK&&((strm=strm.state).window_size=2*strm.w_size,zero(strm.head),strm.max_lazy_match=configuration_table[strm.level].max_lazy,strm.good_match=configuration_table[strm.level].good_length,strm.nice_match=configuration_table[strm.level].nice_length,strm.max_chain_length=configuration_table[strm.level].max_chain,strm.strstart=0,strm.block_start=0,strm.lookahead=0,strm.insert=0,strm.match_length=strm.prev_length=MIN_MATCH-1,strm.match_available=0,strm.ins_h=0),ret};const deflateInit2=(strm,level,method,windowBits,memLevel,strategy)=>{if(!strm)return Z_STREAM_ERROR;let wrap=1;if(level===Z_DEFAULT_COMPRESSION&&(level=6),windowBits<0?(wrap=0,windowBits=-windowBits):15<windowBits&&(wrap=2,windowBits-=16),memLevel<1||memLevel>MAX_MEM_LEVEL||method!==Z_DEFLATED||windowBits<8||15<windowBits||level<0||9<level||strategy<0||strategy>Z_FIXED)return err(strm,Z_STREAM_ERROR);8===windowBits&&(windowBits=9);const s=new DeflateState;return(strm.state=s).strm=strm,s.wrap=wrap,s.gzhead=null,s.w_bits=windowBits,s.w_size=1<<s.w_bits,s.w_mask=s.w_size-1,s.hash_bits=memLevel+7,s.hash_size=1<<s.hash_bits,s.hash_mask=s.hash_size-1,s.hash_shift=~~((s.hash_bits+MIN_MATCH-1)/MIN_MATCH),s.window=new Uint8Array(2*s.w_size),s.head=new Uint16Array(s.hash_size),s.prev=new Uint16Array(s.w_size),s.lit_bufsize=1<<memLevel+6,s.pending_buf_size=4*s.lit_bufsize,s.pending_buf=new Uint8Array(s.pending_buf_size),s.d_buf=+s.lit_bufsize,s.l_buf=3*s.lit_bufsize,s.level=level,s.strategy=strategy,s.method=method,deflateReset(strm)};module.exports.deflateInit=(strm,level)=>deflateInit2(strm,level,Z_DEFLATED,15,8,Z_DEFAULT_STRATEGY),module.exports.deflateInit2=deflateInit2,module.exports.deflateReset=deflateReset,module.exports.deflateResetKeep=deflateResetKeep,module.exports.deflateSetHeader=(strm,head)=>!strm||!strm.state||2!==strm.state.wrap?Z_STREAM_ERROR:(strm.state.gzhead=head,Z_OK),module.exports.deflate=(strm,flush)=>{let beg,val;if(!strm||!strm.state||flush>Z_BLOCK||flush<0)return strm?err(strm,Z_STREAM_ERROR):Z_STREAM_ERROR;const s=strm.state;if(!strm.output||!strm.input&&0!==strm.avail_in||666===s.status&&flush!==Z_FINISH)return err(strm,0===strm.avail_out?Z_BUF_ERROR:Z_STREAM_ERROR);s.strm=strm;var old_flush=s.last_flush;if(s.last_flush=flush,s.status===INIT_STATE)if(2===s.wrap)strm.adler=0,put_byte(s,31),put_byte(s,139),put_byte(s,8),s.gzhead?(put_byte(s,(s.gzhead.text?1:0)+(s.gzhead.hcrc?2:0)+(s.gzhead.extra?4:0)+(s.gzhead.name?8:0)+(s.gzhead.comment?16:0)),put_byte(s,255&s.gzhead.time),put_byte(s,s.gzhead.time>>8&255),put_byte(s,s.gzhead.time>>16&255),put_byte(s,s.gzhead.time>>24&255),put_byte(s,9===s.level?2:s.strategy>=Z_HUFFMAN_ONLY||s.level<2?4:0),put_byte(s,255&s.gzhead.os),s.gzhead.extra&&s.gzhead.extra.length&&(put_byte(s,255&s.gzhead.extra.length),put_byte(s,s.gzhead.extra.length>>8&255)),s.gzhead.hcrc&&(strm.adler=crc32(strm.adler,s.pending_buf,s.pending,0)),s.gzindex=0,s.status=69):(put_byte(s,0),put_byte(s,0),put_byte(s,0),put_byte(s,0),put_byte(s,0),put_byte(s,9===s.level?2:s.strategy>=Z_HUFFMAN_ONLY||s.level<2?4:0),put_byte(s,3),s.status=BUSY_STATE);else{let header=Z_DEFLATED+(s.w_bits-8<<4)<<8,level_flags=-1;level_flags=s.strategy>=Z_HUFFMAN_ONLY||s.level<2?0:s.level<6?1:6===s.level?2:3,header|=level_flags<<6,0!==s.strstart&&(header|=32),header+=31-header%31,s.status=BUSY_STATE,putShortMSB(s,header),0!==s.strstart&&(putShortMSB(s,strm.adler>>>16),putShortMSB(s,65535&strm.adler)),strm.adler=1}if(69===s.status)if(s.gzhead.extra){for(beg=s.pending;s.gzindex<(65535&s.gzhead.extra.length)&&(s.pending!==s.pending_buf_size||(s.gzhead.hcrc&&s.pending>beg&&(strm.adler=crc32(strm.adler,s.pending_buf,s.pending-beg,beg)),flush_pending(strm),beg=s.pending,s.pending!==s.pending_buf_size));)put_byte(s,255&s.gzhead.extra[s.gzindex]),s.gzindex++;s.gzhead.hcrc&&s.pending>beg&&(strm.adler=crc32(strm.adler,s.pending_buf,s.pending-beg,beg)),s.gzindex===s.gzhead.extra.length&&(s.gzindex=0,s.status=73)}else s.status=73;if(73===s.status)if(s.gzhead.name){beg=s.pending;do{if(s.pending===s.pending_buf_size&&(s.gzhead.hcrc&&s.pending>beg&&(strm.adler=crc32(strm.adler,s.pending_buf,s.pending-beg,beg)),flush_pending(strm),beg=s.pending,s.pending===s.pending_buf_size)){val=1;break}}while(val=s.gzindex<s.gzhead.name.length?255&s.gzhead.name.charCodeAt(s.gzindex++):0,put_byte(s,val),0!==val);s.gzhead.hcrc&&s.pending>beg&&(strm.adler=crc32(strm.adler,s.pending_buf,s.pending-beg,beg)),0===val&&(s.gzindex=0,s.status=91)}else s.status=91;if(91===s.status)if(s.gzhead.comment){beg=s.pending;do{if(s.pending===s.pending_buf_size&&(s.gzhead.hcrc&&s.pending>beg&&(strm.adler=crc32(strm.adler,s.pending_buf,s.pending-beg,beg)),flush_pending(strm),beg=s.pending,s.pending===s.pending_buf_size)){val=1;break}}while(val=s.gzindex<s.gzhead.comment.length?255&s.gzhead.comment.charCodeAt(s.gzindex++):0,put_byte(s,val),0!==val);s.gzhead.hcrc&&s.pending>beg&&(strm.adler=crc32(strm.adler,s.pending_buf,s.pending-beg,beg)),0===val&&(s.status=103)}else s.status=103;if(103===s.status&&(s.gzhead.hcrc?(s.pending+2>s.pending_buf_size&&flush_pending(strm),s.pending+2<=s.pending_buf_size&&(put_byte(s,255&strm.adler),put_byte(s,strm.adler>>8&255),strm.adler=0,s.status=BUSY_STATE)):s.status=BUSY_STATE),0!==s.pending){if(flush_pending(strm),0===strm.avail_out)return s.last_flush=-1,Z_OK}else if(0===strm.avail_in&&rank(flush)<=rank(old_flush)&&flush!==Z_FINISH)return err(strm,Z_BUF_ERROR);if(666===s.status&&0!==strm.avail_in)return err(strm,Z_BUF_ERROR);if(0!==strm.avail_in||0!==s.lookahead||flush!==Z_NO_FLUSH&&666!==s.status){old_flush=s.strategy===Z_HUFFMAN_ONLY?((s,flush)=>{for(var bflush;;){if(0===s.lookahead&&(fill_window(s),0===s.lookahead)){if(flush===Z_NO_FLUSH)return BS_NEED_MORE;break}if(s.match_length=0,bflush=_tr_tally(s,0,s.window[s.strstart]),s.lookahead--,s.strstart++,bflush&&(flush_block_only(s,!1),0===s.strm.avail_out))return BS_NEED_MORE}return s.insert=0,flush===Z_FINISH?(flush_block_only(s,!0),0===s.strm.avail_out?BS_FINISH_STARTED:BS_FINISH_DONE):s.last_lit&&(flush_block_only(s,!1),0===s.strm.avail_out)?BS_NEED_MORE:BS_BLOCK_DONE})(s,flush):s.strategy===Z_RLE?((s,flush)=>{let bflush;var prev;let scan,strend;for(var _win=s.window;;){if(s.lookahead<=MAX_MATCH){if(fill_window(s),s.lookahead<=MAX_MATCH&&flush===Z_NO_FLUSH)return BS_NEED_MORE;if(0===s.lookahead)break}if(s.match_length=0,s.lookahead>=MIN_MATCH&&0<s.strstart&&(prev=_win[scan=s.strstart-1])===_win[++scan]&&prev===_win[++scan]&&prev===_win[++scan]){for(strend=s.strstart+MAX_MATCH;prev===_win[++scan]&&prev===_win[++scan]&&prev===_win[++scan]&&prev===_win[++scan]&&prev===_win[++scan]&&prev===_win[++scan]&&prev===_win[++scan]&&prev===_win[++scan]&&scan<strend;);s.match_length=MAX_MATCH-(strend-scan),s.match_length>s.lookahead&&(s.match_length=s.lookahead)}if(s.match_length>=MIN_MATCH?(bflush=_tr_tally(s,1,s.match_length-MIN_MATCH),s.lookahead-=s.match_length,s.strstart+=s.match_length,s.match_length=0):(bflush=_tr_tally(s,0,s.window[s.strstart]),s.lookahead--,s.strstart++),bflush&&(flush_block_only(s,!1),0===s.strm.avail_out))return BS_NEED_MORE}return s.insert=0,flush===Z_FINISH?(flush_block_only(s,!0),0===s.strm.avail_out?BS_FINISH_STARTED:BS_FINISH_DONE):s.last_lit&&(flush_block_only(s,!1),0===s.strm.avail_out)?BS_NEED_MORE:BS_BLOCK_DONE})(s,flush):configuration_table[s.level].func(s,flush);if(old_flush!==BS_FINISH_STARTED&&old_flush!==BS_FINISH_DONE||(s.status=666),old_flush===BS_NEED_MORE||old_flush===BS_FINISH_STARTED)return 0===strm.avail_out&&(s.last_flush=-1),Z_OK;if(old_flush===BS_BLOCK_DONE&&(flush===Z_PARTIAL_FLUSH?_tr_align(s):flush!==Z_BLOCK&&(_tr_stored_block(s,0,0,!1),flush===Z_FULL_FLUSH&&(zero(s.head),0===s.lookahead&&(s.strstart=0,s.block_start=0,s.insert=0))),flush_pending(strm),0===strm.avail_out))return s.last_flush=-1,Z_OK}return flush!==Z_FINISH?Z_OK:s.wrap<=0?Z_STREAM_END:(2===s.wrap?(put_byte(s,255&strm.adler),put_byte(s,strm.adler>>8&255),put_byte(s,strm.adler>>16&255),put_byte(s,strm.adler>>24&255),put_byte(s,255&strm.total_in),put_byte(s,strm.total_in>>8&255),put_byte(s,strm.total_in>>16&255),put_byte(s,strm.total_in>>24&255)):(putShortMSB(s,strm.adler>>>16),putShortMSB(s,65535&strm.adler)),flush_pending(strm),0<s.wrap&&(s.wrap=-s.wrap),0!==s.pending?Z_OK:Z_STREAM_END)},module.exports.deflateEnd=strm=>{if(!strm||!strm.state)return Z_STREAM_ERROR;var status=strm.state.status;return status!==INIT_STATE&&69!==status&&73!==status&&91!==status&&103!==status&&status!==BUSY_STATE&&666!==status?err(strm,Z_STREAM_ERROR):(strm.state=null,status===BUSY_STATE?err(strm,Z_DATA_ERROR):Z_OK)},module.exports.deflateSetDictionary=(strm,dictionary)=>{let dictLength=dictionary.length;if(!strm||!strm.state)return Z_STREAM_ERROR;const s=strm.state;var wrap=s.wrap;if(2===wrap||1===wrap&&s.status!==INIT_STATE||s.lookahead)return Z_STREAM_ERROR;if(1===wrap&&(strm.adler=adler32(strm.adler,dictionary,dictLength,0)),s.wrap=0,dictLength>=s.w_size){0===wrap&&(zero(s.head),s.strstart=0,s.block_start=0,s.insert=0);let tmpDict=new Uint8Array(s.w_size);tmpDict.set(dictionary.subarray(dictLength-s.w_size,dictLength),0),dictionary=tmpDict,dictLength=s.w_size}var avail=strm.avail_in,next=strm.next_in,input=strm.input;for(strm.avail_in=dictLength,strm.next_in=0,strm.input=dictionary,fill_window(s);s.lookahead>=MIN_MATCH;){let str=s.strstart,n=s.lookahead-(MIN_MATCH-1);for(;s.ins_h=HASH(s,s.ins_h,s.window[str+MIN_MATCH-1]),s.prev[str&s.w_mask]=s.head[s.ins_h],s.head[s.ins_h]=str,str++,--n;);s.strstart=str,s.lookahead=MIN_MATCH-1,fill_window(s)}return s.strstart+=s.lookahead,s.block_start=s.strstart,s.insert=s.lookahead,s.lookahead=0,s.match_length=s.prev_length=MIN_MATCH-1,s.match_available=0,strm.next_in=next,strm.input=input,strm.avail_in=avail,s.wrap=wrap,Z_OK},module.exports.deflateInfo="pako deflate (from Nodeca project)"},{"./adler32":45,"./constants":46,"./crc32":47,"./messages":53,"./trees":54}],49:[function(require,module,exports){"use strict";module.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],50:[function(require,module,exports){"use strict";module.exports=function(strm,start){let _in;var last,beg,end,dmax,wsize,whave,wnext,s_window,lcode,dcode,lmask,dmask,dist;let _out,hold,bits,here,op,len,from,from_source,input,output;const state=strm.state;_in=strm.next_in,input=strm.input,last=_in+(strm.avail_in-5),_out=strm.next_out,output=strm.output,beg=_out-(start-strm.avail_out),end=_out+(strm.avail_out-257),dmax=state.dmax,wsize=state.wsize,whave=state.whave,wnext=state.wnext,s_window=state.window,hold=state.hold,bits=state.bits,lcode=state.lencode,dcode=state.distcode,lmask=(1<<state.lenbits)-1,dmask=(1<<state.distbits)-1;top:do{for(bits<15&&(hold+=input[_in++]<<bits,bits+=8,hold+=input[_in++]<<bits,bits+=8),here=lcode[hold&lmask];;){if(op=here>>>24,hold>>>=op,bits-=op,0===(op=here>>>16&255))output[_out++]=65535&here;else{if(!(16&op)){if(0==(64&op)){here=lcode[(65535&here)+(hold&(1<<op)-1)];continue}if(32&op){state.mode=12;break top}strm.msg="invalid literal/length code",state.mode=30;break top}for(len=65535&here,(op&=15)&&(bits<op&&(hold+=input[_in++]<<bits,bits+=8),len+=hold&(1<<op)-1,hold>>>=op,bits-=op),bits<15&&(hold+=input[_in++]<<bits,bits+=8,hold+=input[_in++]<<bits,bits+=8),here=dcode[hold&dmask];;){if(op=here>>>24,hold>>>=op,bits-=op,!(16&(op=here>>>16&255))){if(0==(64&op)){here=dcode[(65535&here)+(hold&(1<<op)-1)];continue}strm.msg="invalid distance code",state.mode=30;break top}if(dist=65535&here,op&=15,bits<op&&(hold+=input[_in++]<<bits,(bits+=8)<op&&(hold+=input[_in++]<<bits,bits+=8)),dmax<(dist+=hold&(1<<op)-1)){strm.msg="invalid distance too far back",state.mode=30;break top}if(hold>>>=op,bits-=op,dist>(op=_out-beg)){if((op=dist-op)>whave&&state.sane){strm.msg="invalid distance too far back",state.mode=30;break top}if(from=0,from_source=s_window,0===wnext){if(from+=wsize-op,op<len){for(len-=op;output[_out++]=s_window[from++],--op;);from=_out-dist,from_source=output}}else if(wnext<op){if(from+=wsize+wnext-op,(op-=wnext)<len){for(len-=op;output[_out++]=s_window[from++],--op;);if(from=0,wnext<len){for(op=wnext,len-=op;output[_out++]=s_window[from++],--op;);from=_out-dist,from_source=output}}}else if(from+=wnext-op,op<len){for(len-=op;output[_out++]=s_window[from++],--op;);from=_out-dist,from_source=output}for(;2<len;)output[_out++]=from_source[from++],output[_out++]=from_source[from++],output[_out++]=from_source[from++],len-=3;len&&(output[_out++]=from_source[from++],1<len&&(output[_out++]=from_source[from++]))}else{for(from=_out-dist;output[_out++]=output[from++],output[_out++]=output[from++],output[_out++]=output[from++],2<(len-=3););len&&(output[_out++]=output[from++],1<len&&(output[_out++]=output[from++]))}break}}break}}while(_in<last&&_out<end);len=bits>>3,_in-=len,bits-=len<<3,hold&=(1<<bits)-1,strm.next_in=_in,strm.next_out=_out,strm.avail_in=_in<last?last-_in+5:5-(_in-last),strm.avail_out=_out<end?end-_out+257:257-(_out-end),state.hold=hold,state.bits=bits}},{}],51:[function(require,module,exports){"use strict";const adler32=require("./adler32"),crc32=require("./crc32"),inflate_fast=require("./inffast"),inflate_table=require("./inftrees"),LENS=1,DISTS=2,{Z_FINISH,Z_BLOCK,Z_TREES,Z_OK,Z_STREAM_END,Z_NEED_DICT,Z_STREAM_ERROR,Z_DATA_ERROR,Z_MEM_ERROR,Z_BUF_ERROR,Z_DEFLATED}=require("./constants"),HEAD=1,ENOUGH_LENS=852,ENOUGH_DISTS=592;const zswap32=q=>(q>>>24&255)+(q>>>8&65280)+((65280&q)<<8)+((255&q)<<24);function InflateState(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const inflateResetKeep=strm=>{if(!strm||!strm.state)return Z_STREAM_ERROR;const state=strm.state;return strm.total_in=strm.total_out=state.total=0,strm.msg="",state.wrap&&(strm.adler=1&state.wrap),state.mode=HEAD,state.last=0,state.havedict=0,state.dmax=32768,state.head=null,state.hold=0,state.bits=0,state.lencode=state.lendyn=new Int32Array(ENOUGH_LENS),state.distcode=state.distdyn=new Int32Array(ENOUGH_DISTS),state.sane=1,state.back=-1,Z_OK},inflateReset=strm=>{if(!strm||!strm.state)return Z_STREAM_ERROR;const state=strm.state;return state.wsize=0,state.whave=0,state.wnext=0,inflateResetKeep(strm)},inflateReset2=(strm,windowBits)=>{let wrap;if(!strm||!strm.state)return Z_STREAM_ERROR;const state=strm.state;return windowBits<0?(wrap=0,windowBits=-windowBits):(wrap=1+(windowBits>>4),windowBits<48&&(windowBits&=15)),windowBits&&(windowBits<8||15<windowBits)?Z_STREAM_ERROR:(null!==state.window&&state.wbits!==windowBits&&(state.window=null),state.wrap=wrap,state.wbits=windowBits,inflateReset(strm))},inflateInit2=(strm,windowBits)=>{if(!strm)return Z_STREAM_ERROR;const state=new InflateState;(strm.state=state).window=null;windowBits=inflateReset2(strm,windowBits);return windowBits!==Z_OK&&(strm.state=null),windowBits};let virgin=!0,lenfix,distfix;const updatewindow=(strm,src,end,copy)=>{let dist;const state=strm.state;return null===state.window&&(state.wsize=1<<state.wbits,state.wnext=0,state.whave=0,state.window=new Uint8Array(state.wsize)),copy>=state.wsize?(state.window.set(src.subarray(end-state.wsize,end),0),state.wnext=0,state.whave=state.wsize):((dist=state.wsize-state.wnext)>copy&&(dist=copy),state.window.set(src.subarray(end-copy,end-copy+dist),state.wnext),(copy-=dist)?(state.window.set(src.subarray(end-copy,end),0),state.wnext=copy,state.whave=state.wsize):(state.wnext+=dist,state.wnext===state.wsize&&(state.wnext=0),state.whave<state.wsize&&(state.whave+=dist))),0};module.exports.inflateReset=inflateReset,module.exports.inflateReset2=inflateReset2,module.exports.inflateResetKeep=inflateResetKeep,module.exports.inflateInit=strm=>inflateInit2(strm,15),module.exports.inflateInit2=inflateInit2,module.exports.inflate=(strm,flush)=>{let state,input,output,next,put,have,left,hold,bits,_in,_out,copy,from,from_source,here=0,here_bits,here_op,here_val,last_bits,last_op,last_val,len,ret;const hbuf=new Uint8Array(4);let opts,n;var order=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(!strm||!strm.state||!strm.output||!strm.input&&0!==strm.avail_in)return Z_STREAM_ERROR;12===(state=strm.state).mode&&(state.mode=13),put=strm.next_out,output=strm.output,left=strm.avail_out,next=strm.next_in,input=strm.input,have=strm.avail_in,hold=state.hold,bits=state.bits,_in=have,_out=left,ret=Z_OK;inf_leave:for(;;)switch(state.mode){case HEAD:if(0===state.wrap){state.mode=13;break}for(;bits<16;){if(0===have)break inf_leave;have--,hold+=input[next++]<<bits,bits+=8}if(2&state.wrap&&35615===hold){state.check=0,hbuf[0]=255&hold,hbuf[1]=hold>>>8&255,state.check=crc32(state.check,hbuf,2,0),hold=0,bits=0,state.mode=2;break}if(state.flags=0,state.head&&(state.head.done=!1),!(1&state.wrap)||(((255&hold)<<8)+(hold>>8))%31){strm.msg="incorrect header check",state.mode=30;break}if((15&hold)!==Z_DEFLATED){strm.msg="unknown compression method",state.mode=30;break}if(hold>>>=4,bits-=4,len=8+(15&hold),0===state.wbits)state.wbits=len;else if(len>state.wbits){strm.msg="invalid window size",state.mode=30;break}state.dmax=1<<state.wbits,strm.adler=state.check=1,state.mode=512&hold?10:12,hold=0,bits=0;break;case 2:for(;bits<16;){if(0===have)break inf_leave;have--,hold+=input[next++]<<bits,bits+=8}if(state.flags=hold,(255&state.flags)!==Z_DEFLATED){strm.msg="unknown compression method",state.mode=30;break}if(57344&state.flags){strm.msg="unknown header flags set",state.mode=30;break}state.head&&(state.head.text=hold>>8&1),512&state.flags&&(hbuf[0]=255&hold,hbuf[1]=hold>>>8&255,state.check=crc32(state.check,hbuf,2,0)),hold=0,bits=0,state.mode=3;case 3:for(;bits<32;){if(0===have)break inf_leave;have--,hold+=input[next++]<<bits,bits+=8}state.head&&(state.head.time=hold),512&state.flags&&(hbuf[0]=255&hold,hbuf[1]=hold>>>8&255,hbuf[2]=hold>>>16&255,hbuf[3]=hold>>>24&255,state.check=crc32(state.check,hbuf,4,0)),hold=0,bits=0,state.mode=4;case 4:for(;bits<16;){if(0===have)break inf_leave;have--,hold+=input[next++]<<bits,bits+=8}state.head&&(state.head.xflags=255&hold,state.head.os=hold>>8),512&state.flags&&(hbuf[0]=255&hold,hbuf[1]=hold>>>8&255,state.check=crc32(state.check,hbuf,2,0)),hold=0,bits=0,state.mode=5;case 5:if(1024&state.flags){for(;bits<16;){if(0===have)break inf_leave;have--,hold+=input[next++]<<bits,bits+=8}state.length=hold,state.head&&(state.head.extra_len=hold),512&state.flags&&(hbuf[0]=255&hold,hbuf[1]=hold>>>8&255,state.check=crc32(state.check,hbuf,2,0)),hold=0,bits=0}else state.head&&(state.head.extra=null);state.mode=6;case 6:if(1024&state.flags&&((copy=(copy=state.length)>have?have:copy)&&(state.head&&(len=state.head.extra_len-state.length,state.head.extra||(state.head.extra=new Uint8Array(state.head.extra_len)),state.head.extra.set(input.subarray(next,next+copy),len)),512&state.flags&&(state.check=crc32(state.check,input,copy,next)),have-=copy,next+=copy,state.length-=copy),state.length))break inf_leave;state.length=0,state.mode=7;case 7:if(2048&state.flags){if(0===have)break inf_leave;for(copy=0;len=input[next+copy++],state.head&&len&&state.length<65536&&(state.head.name+=String.fromCharCode(len)),len&&copy<have;);if(512&state.flags&&(state.check=crc32(state.check,input,copy,next)),have-=copy,next+=copy,len)break inf_leave}else state.head&&(state.head.name=null);state.length=0,state.mode=8;case 8:if(4096&state.flags){if(0===have)break inf_leave;for(copy=0;len=input[next+copy++],state.head&&len&&state.length<65536&&(state.head.comment+=String.fromCharCode(len)),len&&copy<have;);if(512&state.flags&&(state.check=crc32(state.check,input,copy,next)),have-=copy,next+=copy,len)break inf_leave}else state.head&&(state.head.comment=null);state.mode=9;case 9:if(512&state.flags){for(;bits<16;){if(0===have)break inf_leave;have--,hold+=input[next++]<<bits,bits+=8}if(hold!==(65535&state.check)){strm.msg="header crc mismatch",state.mode=30;break}hold=0,bits=0}state.head&&(state.head.hcrc=state.flags>>9&1,state.head.done=!0),strm.adler=state.check=0,state.mode=12;break;case 10:for(;bits<32;){if(0===have)break inf_leave;have--,hold+=input[next++]<<bits,bits+=8}strm.adler=state.check=zswap32(hold),hold=0,bits=0,state.mode=11;case 11:if(0===state.havedict)return strm.next_out=put,strm.avail_out=left,strm.next_in=next,strm.avail_in=have,state.hold=hold,state.bits=bits,Z_NEED_DICT;strm.adler=state.check=1,state.mode=12;case 12:if(flush===Z_BLOCK||flush===Z_TREES)break inf_leave;case 13:if(state.last){hold>>>=7&bits,bits-=7&bits,state.mode=27;break}for(;bits<3;){if(0===have)break inf_leave;have--,hold+=input[next++]<<bits,bits+=8}switch(state.last=1&hold,hold>>>=1,--bits,3&hold){case 0:state.mode=14;break;case 1:if((state=>{if(virgin){lenfix=new Int32Array(512),distfix=new Int32Array(32);let sym=0;for(;sym<144;)state.lens[sym++]=8;for(;sym<256;)state.lens[sym++]=9;for(;sym<280;)state.lens[sym++]=7;for(;sym<288;)state.lens[sym++]=8;for(inflate_table(LENS,state.lens,0,288,lenfix,0,state.work,{bits:9}),sym=0;sym<32;)state.lens[sym++]=5;inflate_table(DISTS,state.lens,0,32,distfix,0,state.work,{bits:5}),virgin=!1}state.lencode=lenfix,state.lenbits=9,state.distcode=distfix,state.distbits=5})(state),state.mode=20,flush!==Z_TREES)break;hold>>>=2,bits-=2;break inf_leave;case 2:state.mode=17;break;case 3:strm.msg="invalid block type",state.mode=30}hold>>>=2,bits-=2;break;case 14:for(hold>>>=7&bits,bits-=7&bits;bits<32;){if(0===have)break inf_leave;have--,hold+=input[next++]<<bits,bits+=8}if((65535&hold)!=(hold>>>16^65535)){strm.msg="invalid stored block lengths",state.mode=30;break}if(state.length=65535&hold,hold=0,bits=0,state.mode=15,flush===Z_TREES)break inf_leave;case 15:state.mode=16;case 16:if(copy=state.length){if(0===(copy=(copy=copy>have?have:copy)>left?left:copy))break inf_leave;output.set(input.subarray(next,next+copy),put),have-=copy,next+=copy,left-=copy,put+=copy,state.length-=copy;break}state.mode=12;break;case 17:for(;bits<14;){if(0===have)break inf_leave;have--,hold+=input[next++]<<bits,bits+=8}if(state.nlen=257+(31&hold),hold>>>=5,bits-=5,state.ndist=1+(31&hold),hold>>>=5,bits-=5,state.ncode=4+(15&hold),hold>>>=4,bits-=4,286<state.nlen||30<state.ndist){strm.msg="too many length or distance symbols",state.mode=30;break}state.have=0,state.mode=18;case 18:for(;state.have<state.ncode;){for(;bits<3;){if(0===have)break inf_leave;have--,hold+=input[next++]<<bits,bits+=8}state.lens[order[state.have++]]=7&hold,hold>>>=3,bits-=3}for(;state.have<19;)state.lens[order[state.have++]]=0;if(state.lencode=state.lendyn,state.lenbits=7,opts={bits:state.lenbits},ret=inflate_table(0,state.lens,0,19,state.lencode,0,state.work,opts),state.lenbits=opts.bits,ret){strm.msg="invalid code lengths set",state.mode=30;break}state.have=0,state.mode=19;case 19:for(;state.have<state.nlen+state.ndist;){for(;here=state.lencode[hold&(1<<state.lenbits)-1],here_bits=here>>>24,here_op=here>>>16&255,here_val=65535&here,!(here_bits<=bits);){if(0===have)break inf_leave;have--,hold+=input[next++]<<bits,bits+=8}if(here_val<16)hold>>>=here_bits,bits-=here_bits,state.lens[state.have++]=here_val;else{if(16===here_val){for(n=here_bits+2;bits<n;){if(0===have)break inf_leave;have--,hold+=input[next++]<<bits,bits+=8}if(hold>>>=here_bits,bits-=here_bits,0===state.have){strm.msg="invalid bit length repeat",state.mode=30;break}len=state.lens[state.have-1],copy=3+(3&hold),hold>>>=2,bits-=2}else if(17===here_val){for(n=here_bits+3;bits<n;){if(0===have)break inf_leave;have--,hold+=input[next++]<<bits,bits+=8}hold>>>=here_bits,bits-=here_bits,len=0,copy=3+(7&hold),hold>>>=3,bits-=3}else{for(n=here_bits+7;bits<n;){if(0===have)break inf_leave;have--,hold+=input[next++]<<bits,bits+=8}hold>>>=here_bits,bits-=here_bits,len=0,copy=11+(127&hold),hold>>>=7,bits-=7}if(state.have+copy>state.nlen+state.ndist){strm.msg="invalid bit length repeat",state.mode=30;break}for(;copy--;)state.lens[state.have++]=len}}if(30===state.mode)break;if(0===state.lens[256]){strm.msg="invalid code -- missing end-of-block",state.mode=30;break}if(state.lenbits=9,opts={bits:state.lenbits},ret=inflate_table(LENS,state.lens,0,state.nlen,state.lencode,0,state.work,opts),state.lenbits=opts.bits,ret){strm.msg="invalid literal/lengths set",state.mode=30;break}if(state.distbits=6,state.distcode=state.distdyn,opts={bits:state.distbits},ret=inflate_table(DISTS,state.lens,state.nlen,state.ndist,state.distcode,0,state.work,opts),state.distbits=opts.bits,ret){strm.msg="invalid distances set",state.mode=30;break}if(state.mode=20,flush===Z_TREES)break inf_leave;case 20:state.mode=21;case 21:if(6<=have&&258<=left){strm.next_out=put,strm.avail_out=left,strm.next_in=next,strm.avail_in=have,state.hold=hold,state.bits=bits,inflate_fast(strm,_out),put=strm.next_out,output=strm.output,left=strm.avail_out,next=strm.next_in,input=strm.input,have=strm.avail_in,hold=state.hold,bits=state.bits,12===state.mode&&(state.back=-1);break}for(state.back=0;here=state.lencode[hold&(1<<state.lenbits)-1],here_bits=here>>>24,here_op=here>>>16&255,here_val=65535&here,!(here_bits<=bits);){if(0===have)break inf_leave;have--,hold+=input[next++]<<bits,bits+=8}if(here_op&&0==(240&here_op)){for(last_bits=here_bits,last_op=here_op,last_val=here_val;here=state.lencode[last_val+((hold&(1<<last_bits+last_op)-1)>>last_bits)],here_bits=here>>>24,here_op=here>>>16&255,here_val=65535&here,!(last_bits+here_bits<=bits);){if(0===have)break inf_leave;have--,hold+=input[next++]<<bits,bits+=8}hold>>>=last_bits,bits-=last_bits,state.back+=last_bits}if(hold>>>=here_bits,bits-=here_bits,state.back+=here_bits,state.length=here_val,0===here_op){state.mode=26;break}if(32&here_op){state.back=-1,state.mode=12;break}if(64&here_op){strm.msg="invalid literal/length code",state.mode=30;break}state.extra=15&here_op,state.mode=22;case 22:if(state.extra){for(n=state.extra;bits<n;){if(0===have)break inf_leave;have--,hold+=input[next++]<<bits,bits+=8}state.length+=hold&(1<<state.extra)-1,hold>>>=state.extra,bits-=state.extra,state.back+=state.extra}state.was=state.length,state.mode=23;case 23:for(;here=state.distcode[hold&(1<<state.distbits)-1],here_bits=here>>>24,here_op=here>>>16&255,here_val=65535&here,!(here_bits<=bits);){if(0===have)break inf_leave;have--,hold+=input[next++]<<bits,bits+=8}if(0==(240&here_op)){for(last_bits=here_bits,last_op=here_op,last_val=here_val;here=state.distcode[last_val+((hold&(1<<last_bits+last_op)-1)>>last_bits)],here_bits=here>>>24,here_op=here>>>16&255,here_val=65535&here,!(last_bits+here_bits<=bits);){if(0===have)break inf_leave;have--,hold+=input[next++]<<bits,bits+=8}hold>>>=last_bits,bits-=last_bits,state.back+=last_bits}if(hold>>>=here_bits,bits-=here_bits,state.back+=here_bits,64&here_op){strm.msg="invalid distance code",state.mode=30;break}state.offset=here_val,state.extra=15&here_op,state.mode=24;case 24:if(state.extra){for(n=state.extra;bits<n;){if(0===have)break inf_leave;have--,hold+=input[next++]<<bits,bits+=8}state.offset+=hold&(1<<state.extra)-1,hold>>>=state.extra,bits-=state.extra,state.back+=state.extra}if(state.offset>state.dmax){strm.msg="invalid distance too far back",state.mode=30;break}state.mode=25;case 25:if(0===left)break inf_leave;if(copy=_out-left,state.offset>copy){if((copy=state.offset-copy)>state.whave&&state.sane){strm.msg="invalid distance too far back",state.mode=30;break}from=copy>state.wnext?(copy-=state.wnext,state.wsize-copy):state.wnext-copy,copy>state.length&&(copy=state.length),from_source=state.window}else from_source=output,from=put-state.offset,copy=state.length;for(copy>left&&(copy=left),left-=copy,state.length-=copy;output[put++]=from_source[from++],--copy;);0===state.length&&(state.mode=21);break;case 26:if(0===left)break inf_leave;output[put++]=state.length,left--,state.mode=21;break;case 27:if(state.wrap){for(;bits<32;){if(0===have)break inf_leave;have--,hold|=input[next++]<<bits,bits+=8}if(_out-=left,strm.total_out+=_out,state.total+=_out,_out&&(strm.adler=state.check=(state.flags?crc32:adler32)(state.check,output,_out,put-_out)),_out=left,(state.flags?hold:zswap32(hold))!==state.check){strm.msg="incorrect data check",state.mode=30;break}hold=0,bits=0}state.mode=28;case 28:if(state.wrap&&state.flags){for(;bits<32;){if(0===have)break inf_leave;have--,hold+=input[next++]<<bits,bits+=8}if(hold!==(4294967295&state.total)){strm.msg="incorrect length check",state.mode=30;break}hold=0,bits=0}state.mode=29;case 29:ret=Z_STREAM_END;break inf_leave;case 30:ret=Z_DATA_ERROR;break inf_leave;case 31:return Z_MEM_ERROR;default:return Z_STREAM_ERROR}return strm.next_out=put,strm.avail_out=left,strm.next_in=next,strm.avail_in=have,state.hold=hold,state.bits=bits,(state.wsize||_out!==strm.avail_out&&state.mode<30&&(state.mode<27||flush!==Z_FINISH))&&updatewindow(strm,strm.output,strm.next_out,_out-strm.avail_out)?(state.mode=31,Z_MEM_ERROR):(_in-=strm.avail_in,_out-=strm.avail_out,strm.total_in+=_in,strm.total_out+=_out,state.total+=_out,state.wrap&&_out&&(strm.adler=state.check=(state.flags?crc32:adler32)(state.check,output,_out,strm.next_out-_out)),strm.data_type=state.bits+(state.last?64:0)+(12===state.mode?128:0)+(20===state.mode||15===state.mode?256:0),ret=(0==_in&&0===_out||flush===Z_FINISH)&&ret===Z_OK?Z_BUF_ERROR:ret)},module.exports.inflateEnd=strm=>{if(!strm||!strm.state)return Z_STREAM_ERROR;let state=strm.state;return state.window&&(state.window=null),strm.state=null,Z_OK},module.exports.inflateGetHeader=(strm,head)=>{if(!strm||!strm.state)return Z_STREAM_ERROR;const state=strm.state;return 0==(2&state.wrap)?Z_STREAM_ERROR:((state.head=head).done=!1,Z_OK)},module.exports.inflateSetDictionary=(strm,dictionary)=>{var dictLength=dictionary.length;let state;return!strm||!strm.state||0!==(state=strm.state).wrap&&11!==state.mode?Z_STREAM_ERROR:11===state.mode&&adler32(1,dictionary,dictLength,0)!==state.check?Z_DATA_ERROR:updatewindow(strm,dictionary,dictLength,dictLength)?(state.mode=31,Z_MEM_ERROR):(state.havedict=1,Z_OK)},module.exports.inflateInfo="pako inflate (from Nodeca project)"},{"./adler32":45,"./constants":46,"./crc32":47,"./inffast":50,"./inftrees":52}],52:[function(require,module,exports){"use strict";const lbase=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),lext=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),dbase=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),dext=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]);module.exports=(type,lens,lens_index,codes,table,table_index,work,opts)=>{var mask,bits=opts.bits;let len=0,sym=0,min=0,max=0,root=0,curr=0,drop=0,left=0,used=0,huff=0,incr,fill,low,next,base=null,base_index=0,end;const count=new Uint16Array(16),offs=new Uint16Array(16);let extra=null,extra_index=0,here_bits,here_op,here_val;for(len=0;len<=15;len++)count[len]=0;for(sym=0;sym<codes;sym++)count[lens[lens_index+sym]]++;for(root=bits,max=15;1<=max&&0===count[max];max--);if(root>max&&(root=max),0===max)return table[table_index++]=20971520,table[table_index++]=20971520,opts.bits=1,0;for(min=1;min<max&&0===count[min];min++);for(root<min&&(root=min),left=1,len=1;len<=15;len++)if((left=(left<<=1)-count[len])<0)return-1;if(0<left&&(0===type||1!==max))return-1;for(offs[1]=0,len=1;len<15;len++)offs[len+1]=offs[len]+count[len];for(sym=0;sym<codes;sym++)0!==lens[lens_index+sym]&&(work[offs[lens[lens_index+sym]]++]=sym);if(end=0===type?(base=extra=work,19):1===type?(base=lbase,base_index-=257,extra=lext,extra_index-=257,256):(base=dbase,extra=dext,-1),huff=0,sym=0,len=min,next=table_index,curr=root,drop=0,low=-1,mask=(used=1<<root)-1,1===type&&852<used||2===type&&592<used)return 1;for(;;){for(here_bits=len-drop,here_val=work[sym]<end?(here_op=0,work[sym]):work[sym]>end?(here_op=extra[extra_index+work[sym]],base[base_index+work[sym]]):(here_op=96,0),incr=1<<len-drop,fill=1<<curr,min=fill;fill-=incr,table[next+(huff>>drop)+fill]=here_bits<<24|here_op<<16|here_val|0,0!==fill;);for(incr=1<<len-1;huff&incr;)incr>>=1;if(huff=0!==incr?(huff&=incr-1)+incr:0,sym++,0==--count[len]){if(len===max)break;len=lens[lens_index+work[sym]]}if(len>root&&(huff&mask)!==low){for(0===drop&&(drop=root),next+=min,curr=len-drop,left=1<<curr;curr+drop<max&&!((left-=count[curr+drop])<=0);)curr++,left<<=1;if(used+=1<<curr,1===type&&852<used||2===type&&592<used)return 1;table[low=huff&mask]=root<<24|curr<<16|next-table_index|0}}return 0!==huff&&(table[next+huff]=len-drop<<24|64<<16|0),opts.bits=root,0}},{}],53:[function(require,module,exports){"use strict";module.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],54:[function(require,module,exports){"use strict";const Z_BINARY=0,Z_TEXT=1;function zero(buf){let len=buf.length;for(;0<=--len;)buf[len]=0}const LENGTH_CODES=29,LITERALS=256,L_CODES=LITERALS+1+LENGTH_CODES,D_CODES=30,BL_CODES=19,HEAP_SIZE=2*L_CODES+1,MAX_BITS=15,Buf_size=16,MAX_BL_BITS=7,END_BLOCK=256,extra_lbits=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),extra_dbits=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),extra_blbits=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),bl_order=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);const static_ltree=new Array(2*(L_CODES+2)),static_dtree=(zero(static_ltree),new Array(2*D_CODES)),_dist_code=(zero(static_dtree),new Array(512)),_length_code=(zero(_dist_code),new Array(256)),base_length=(zero(_length_code),new Array(LENGTH_CODES)),base_dist=(zero(base_length),new Array(D_CODES));function StaticTreeDesc(static_tree,extra_bits,extra_base,elems,max_length){this.static_tree=static_tree,this.extra_bits=extra_bits,this.extra_base=extra_base,this.elems=elems,this.max_length=max_length,this.has_stree=static_tree&&static_tree.length}zero(base_dist);let static_l_desc,static_d_desc,static_bl_desc;function TreeDesc(dyn_tree,stat_desc){this.dyn_tree=dyn_tree,this.max_code=0,this.stat_desc=stat_desc}const d_code=dist=>dist<256?_dist_code[dist]:_dist_code[256+(dist>>>7)],put_short=(s,w)=>{s.pending_buf[s.pending++]=255&w,s.pending_buf[s.pending++]=w>>>8&255},send_bits=(s,value,length)=>{s.bi_valid>Buf_size-length?(s.bi_buf|=value<<s.bi_valid&65535,put_short(s,s.bi_buf),s.bi_buf=value>>Buf_size-s.bi_valid,s.bi_valid+=length-Buf_size):(s.bi_buf|=value<<s.bi_valid&65535,s.bi_valid+=length)},send_code=(s,c,tree)=>{send_bits(s,tree[2*c],tree[2*c+1])},bi_reverse=(code,len)=>{let res=0;for(;res|=1&code,code>>>=1,res<<=1,0<--len;);return res>>>1},gen_bitlen=(s,desc)=>{const tree=desc.dyn_tree;var f,max_code=desc.max_code,stree=desc.stat_desc.static_tree,has_stree=desc.stat_desc.has_stree,extra=desc.stat_desc.extra_bits,base=desc.stat_desc.extra_base,max_length=desc.stat_desc.max_length;let h,n,m,bits,xbits,overflow=0;for(bits=0;bits<=MAX_BITS;bits++)s.bl_count[bits]=0;for(tree[2*s.heap[s.heap_max]+1]=0,h=s.heap_max+1;h<HEAP_SIZE;h++)n=s.heap[h],(bits=tree[2*tree[2*n+1]+1]+1)>max_length&&(bits=max_length,overflow++),tree[2*n+1]=bits,n>max_code||(s.bl_count[bits]++,xbits=0,n>=base&&(xbits=extra[n-base]),f=tree[2*n],s.opt_len+=f*(bits+xbits),has_stree&&(s.static_len+=f*(stree[2*n+1]+xbits)));if(0!==overflow){do{for(bits=max_length-1;0===s.bl_count[bits];)bits--}while(s.bl_count[bits]--,s.bl_count[bits+1]+=2,s.bl_count[max_length]--,0<(overflow-=2));for(bits=max_length;0!==bits;bits--)for(n=s.bl_count[bits];0!==n;)max_code<(m=s.heap[--h])||(tree[2*m+1]!==bits&&(s.opt_len+=(bits-tree[2*m+1])*tree[2*m],tree[2*m+1]=bits),n--)}},gen_codes=(tree,max_code,bl_count)=>{const next_code=new Array(MAX_BITS+1);let code=0,bits,n;for(bits=1;bits<=MAX_BITS;bits++)next_code[bits]=code=code+bl_count[bits-1]<<1;for(n=0;n<=max_code;n++){var len=tree[2*n+1];0!==len&&(tree[2*n]=bi_reverse(next_code[len]++,len))}},init_block=s=>{let n;for(n=0;n<L_CODES;n++)s.dyn_ltree[2*n]=0;for(n=0;n<D_CODES;n++)s.dyn_dtree[2*n]=0;for(n=0;n<BL_CODES;n++)s.bl_tree[2*n]=0;s.dyn_ltree[2*END_BLOCK]=1,s.opt_len=s.static_len=0,s.last_lit=s.matches=0},bi_windup=s=>{8<s.bi_valid?put_short(s,s.bi_buf):0<s.bi_valid&&(s.pending_buf[s.pending++]=s.bi_buf),s.bi_buf=0,s.bi_valid=0},smaller=(tree,n,m,depth)=>{var _n2=2*n,_m2=2*m;return tree[_n2]<tree[_m2]||tree[_n2]===tree[_m2]&&depth[n]<=depth[m]},pqdownheap=(s,tree,k)=>{var v=s.heap[k];let j=k<<1;for(;j<=s.heap_len&&(j<s.heap_len&&smaller(tree,s.heap[j+1],s.heap[j],s.depth)&&j++,!smaller(tree,v,s.heap[j],s.depth));)s.heap[k]=s.heap[j],k=j,j<<=1;s.heap[k]=v},compress_block=(s,ltree,dtree)=>{var dist;let lc,lx=0,code,extra;if(0!==s.last_lit)for(;dist=s.pending_buf[s.d_buf+2*lx]<<8|s.pending_buf[s.d_buf+2*lx+1],lc=s.pending_buf[s.l_buf+lx],lx++,0==dist?send_code(s,lc,ltree):(code=_length_code[lc],send_code(s,code+LITERALS+1,ltree),0!==(extra=extra_lbits[code])&&(lc-=base_length[code],send_bits(s,lc,extra)),dist--,code=d_code(dist),send_code(s,code,dtree),0!==(extra=extra_dbits[code])&&(dist-=base_dist[code],send_bits(s,dist,extra))),lx<s.last_lit;);send_code(s,END_BLOCK,ltree)},build_tree=(s,desc)=>{const tree=desc.dyn_tree;var stree=desc.stat_desc.static_tree,has_stree=desc.stat_desc.has_stree,elems=desc.stat_desc.elems;let n,m,max_code=-1,node;for(s.heap_len=0,s.heap_max=HEAP_SIZE,n=0;n<elems;n++)0!==tree[2*n]?(s.heap[++s.heap_len]=max_code=n,s.depth[n]=0):tree[2*n+1]=0;for(;s.heap_len<2;)node=s.heap[++s.heap_len]=max_code<2?++max_code:0,tree[2*node]=1,s.depth[node]=0,s.opt_len--,has_stree&&(s.static_len-=stree[2*node+1]);for(desc.max_code=max_code,n=s.heap_len>>1;1<=n;n--)pqdownheap(s,tree,n);for(node=elems;n=s.heap[1],s.heap[1]=s.heap[s.heap_len--],pqdownheap(s,tree,1),m=s.heap[1],s.heap[--s.heap_max]=n,s.heap[--s.heap_max]=m,tree[2*node]=tree[2*n]+tree[2*m],s.depth[node]=(s.depth[n]>=s.depth[m]?s.depth[n]:s.depth[m])+1,tree[2*n+1]=tree[2*m+1]=node,s.heap[1]=node++,pqdownheap(s,tree,1),2<=s.heap_len;);s.heap[--s.heap_max]=s.heap[1],gen_bitlen(s,desc),gen_codes(tree,max_code,s.bl_count)},scan_tree=(s,tree,max_code)=>{let n,prevlen=-1;var curlen;let nextlen=tree[1],count=0,max_count=7,min_count=4;for(0===nextlen&&(max_count=138,min_count=3),tree[2*(max_code+1)+1]=65535,n=0;n<=max_code;n++)curlen=nextlen,nextlen=tree[2*(n+1)+1],++count<max_count&&curlen===nextlen||(count<min_count?s.bl_tree[2*curlen]+=count:0!==curlen?(curlen!==prevlen&&s.bl_tree[2*curlen]++,s.bl_tree[32]++):count<=10?s.bl_tree[34]++:s.bl_tree[36]++,count=0,prevlen=curlen,min_count=0===nextlen?(max_count=138,3):curlen===nextlen?(max_count=6,3):(max_count=7,4))},send_tree=(s,tree,max_code)=>{let n,prevlen=-1;var curlen;let nextlen=tree[1],count=0,max_count=7,min_count=4;for(0===nextlen&&(max_count=138,min_count=3),n=0;n<=max_code;n++)if(curlen=nextlen,nextlen=tree[2*(n+1)+1],!(++count<max_count&&curlen===nextlen)){if(count<min_count)for(;send_code(s,curlen,s.bl_tree),0!=--count;);else 0!==curlen?(curlen!==prevlen&&(send_code(s,curlen,s.bl_tree),count--),send_code(s,16,s.bl_tree),send_bits(s,count-3,2)):count<=10?(send_code(s,17,s.bl_tree),send_bits(s,count-3,3)):(send_code(s,18,s.bl_tree),send_bits(s,count-11,7));count=0,prevlen=curlen,min_count=0===nextlen?(max_count=138,3):curlen===nextlen?(max_count=6,3):(max_count=7,4)}};let static_init_done=!1;const _tr_stored_block=(s,buf,stored_len,last)=>{send_bits(s,0+(last?1:0),3),((s,buf,len,header)=>{bi_windup(s),header&&(put_short(s,len),put_short(s,~len)),s.pending_buf.set(s.window.subarray(buf,buf+len),s.pending),s.pending+=len})(s,buf,stored_len,!0)};module.exports._tr_init=s=>{if(!static_init_done){{let n,bits,length,code,dist;const bl_count=new Array(MAX_BITS+1);for(length=0,code=0;code<LENGTH_CODES-1;code++)for(base_length[code]=length,n=0;n<1<<extra_lbits[code];n++)_length_code[length++]=code;for(_length_code[length-1]=code,dist=0,code=0;code<16;code++)for(base_dist[code]=dist,n=0;n<1<<extra_dbits[code];n++)_dist_code[dist++]=code;for(dist>>=7;code<D_CODES;code++)for(base_dist[code]=dist<<7,n=0;n<1<<extra_dbits[code]-7;n++)_dist_code[256+dist++]=code;for(bits=0;bits<=MAX_BITS;bits++)bl_count[bits]=0;for(n=0;n<=143;)static_ltree[2*n+1]=8,n++,bl_count[8]++;for(;n<=255;)static_ltree[2*n+1]=9,n++,bl_count[9]++;for(;n<=279;)static_ltree[2*n+1]=7,n++,bl_count[7]++;for(;n<=287;)static_ltree[2*n+1]=8,n++,bl_count[8]++;for(gen_codes(static_ltree,L_CODES+1,bl_count),n=0;n<D_CODES;n++)static_dtree[2*n+1]=5,static_dtree[2*n]=bi_reverse(n,5);static_l_desc=new StaticTreeDesc(static_ltree,extra_lbits,LITERALS+1,L_CODES,MAX_BITS),static_d_desc=new StaticTreeDesc(static_dtree,extra_dbits,0,D_CODES,MAX_BITS),static_bl_desc=new StaticTreeDesc(new Array(0),extra_blbits,0,BL_CODES,MAX_BL_BITS)}static_init_done=!0}s.l_desc=new TreeDesc(s.dyn_ltree,static_l_desc),s.d_desc=new TreeDesc(s.dyn_dtree,static_d_desc),s.bl_desc=new TreeDesc(s.bl_tree,static_bl_desc),s.bi_buf=0,s.bi_valid=0,init_block(s)},module.exports._tr_stored_block=_tr_stored_block,module.exports._tr_flush_block=(s,buf,stored_len,last)=>{let opt_lenb,static_lenb,max_blindex=0;0<s.level?(2===s.strm.data_type&&(s.strm.data_type=(s=>{let black_mask=4093624447,n;for(n=0;n<=31;n++,black_mask>>>=1)if(1&black_mask&&0!==s.dyn_ltree[2*n])return Z_BINARY;if(0!==s.dyn_ltree[18]||0!==s.dyn_ltree[20]||0!==s.dyn_ltree[26])return Z_TEXT;for(n=32;n<LITERALS;n++)if(0!==s.dyn_ltree[2*n])return Z_TEXT;return Z_BINARY})(s)),build_tree(s,s.l_desc),build_tree(s,s.d_desc),max_blindex=(s=>{let max_blindex;for(scan_tree(s,s.dyn_ltree,s.l_desc.max_code),scan_tree(s,s.dyn_dtree,s.d_desc.max_code),build_tree(s,s.bl_desc),max_blindex=BL_CODES-1;3<=max_blindex&&0===s.bl_tree[2*bl_order[max_blindex]+1];max_blindex--);return s.opt_len+=3*(max_blindex+1)+5+5+4,max_blindex})(s),opt_lenb=s.opt_len+3+7>>>3,(static_lenb=s.static_len+3+7>>>3)<=opt_lenb&&(opt_lenb=static_lenb)):opt_lenb=static_lenb=stored_len+5,stored_len+4<=opt_lenb&&-1!==buf?_tr_stored_block(s,buf,stored_len,last):4===s.strategy||static_lenb===opt_lenb?(send_bits(s,2+(last?1:0),3),compress_block(s,static_ltree,static_dtree)):(send_bits(s,4+(last?1:0),3),((s,lcodes,dcodes,blcodes)=>{let rank;for(send_bits(s,lcodes-257,5),send_bits(s,dcodes-1,5),send_bits(s,blcodes-4,4),rank=0;rank<blcodes;rank++)send_bits(s,s.bl_tree[2*bl_order[rank]+1],3);send_tree(s,s.dyn_ltree,lcodes-1),send_tree(s,s.dyn_dtree,dcodes-1)})(s,s.l_desc.max_code+1,s.d_desc.max_code+1,max_blindex+1),compress_block(s,s.dyn_ltree,s.dyn_dtree)),init_block(s),last&&bi_windup(s)},module.exports._tr_tally=(s,dist,lc)=>(s.pending_buf[s.d_buf+2*s.last_lit]=dist>>>8&255,s.pending_buf[s.d_buf+2*s.last_lit+1]=255&dist,s.pending_buf[s.l_buf+s.last_lit]=255&lc,s.last_lit++,0===dist?s.dyn_ltree[2*lc]++:(s.matches++,dist--,s.dyn_ltree[2*(_length_code[lc]+LITERALS+1)]++,s.dyn_dtree[2*d_code(dist)]++),s.last_lit===s.lit_bufsize-1),module.exports._tr_align=s=>{send_bits(s,2,3),send_code(s,END_BLOCK,static_ltree),(s=>{16===s.bi_valid?(put_short(s,s.bi_buf),s.bi_buf=0,s.bi_valid=0):8<=s.bi_valid&&(s.pending_buf[s.pending++]=255&s.bi_buf,s.bi_buf>>=8,s.bi_valid-=8)})(s)}},{}],55:[function(require,module,exports){"use strict";module.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],56:[function(require,module,exports){var v1=require("./v1"),require=require("./v4"),uuid=require;uuid.v1=v1,uuid.v4=require,module.exports=uuid},{"./v1":59,"./v4":60}],57:[function(require,module,exports){for(var byteToHex=[],i=0;i<256;++i)byteToHex[i]=(i+256).toString(16).substr(1);module.exports=function(buf,offset){var offset=offset||0,bth=byteToHex;return[bth[buf[offset++]],bth[buf[offset++]],bth[buf[offset++]],bth[buf[offset++]],"-",bth[buf[offset++]],bth[buf[offset++]],"-",bth[buf[offset++]],bth[buf[offset++]],"-",bth[buf[offset++]],bth[buf[offset++]],"-",bth[buf[offset++]],bth[buf[offset++]],bth[buf[offset++]],bth[buf[offset++]],bth[buf[offset++]],bth[buf[+offset]]].join("")}},{}],58:[function(require,module,exports){var rnds8,rnds,getRandomValues="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);getRandomValues?(rnds8=new Uint8Array(16),module.exports=function(){return getRandomValues(rnds8),rnds8}):(rnds=new Array(16),module.exports=function(){for(var r,i=0;i<16;i++)0==(3&i)&&(r=4294967296*Math.random()),rnds[i]=r>>>((3&i)<<3)&255;return rnds})},{}],59:[function(require,module,exports){var _nodeId,_clockseq,rng=require("./lib/rng"),bytesToUuid=require("./lib/bytesToUuid"),_lastMSecs=0,_lastNSecs=0;module.exports=function(options,buf,offset){var i=buf&&offset||0,b=buf||[],node=(options=options||{}).node||_nodeId,offset=void 0!==options.clockseq?options.clockseq:_clockseq,seedBytes=(null!=node&&null!=offset||(seedBytes=rng(),null==node&&(node=_nodeId=[1|seedBytes[0],seedBytes[1],seedBytes[2],seedBytes[3],seedBytes[4],seedBytes[5]]),null==offset&&(offset=_clockseq=16383&(seedBytes[6]<<8|seedBytes[7]))),void 0!==options.msecs?options.msecs:(new Date).getTime()),nsecs=void 0!==options.nsecs?options.nsecs:_lastNSecs+1,dt=seedBytes-_lastMSecs+(nsecs-_lastNSecs)/1e4;if(dt<0&&void 0===options.clockseq&&(offset=offset+1&16383),1e4<=(nsecs=(dt<0||_lastMSecs<seedBytes)&&void 0===options.nsecs?0:nsecs))throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");_lastMSecs=seedBytes,_clockseq=offset,dt=(1e4*(268435455&(seedBytes+=122192928e5))+(_lastNSecs=nsecs))%4294967296,b[i++]=dt>>>24&255,b[i++]=dt>>>16&255,b[i++]=dt>>>8&255,b[i++]=255&dt,options=seedBytes/4294967296*1e4&268435455,b[i++]=options>>>8&255,b[i++]=255&options,b[i++]=options>>>24&15|16,b[i++]=options>>>16&255,b[i++]=offset>>>8|128,b[i++]=255&offset;for(var n=0;n<6;++n)b[i+n]=node[n];return buf||bytesToUuid(b)}},{"./lib/bytesToUuid":57,"./lib/rng":58}],60:[function(require,module,exports){var rng=require("./lib/rng"),bytesToUuid=require("./lib/bytesToUuid");module.exports=function(options,buf,offset){var i=buf&&offset||0,rnds=("string"==typeof options&&(buf="binary"===options?new Array(16):null,options=null),(options=options||{}).random||(options.rng||rng)());if(rnds[6]=15&rnds[6]|64,rnds[8]=63&rnds[8]|128,buf)for(var ii=0;ii<16;++ii)buf[i+ii]=rnds[ii];return buf||bytesToUuid(rnds)}},{"./lib/bytesToUuid":57,"./lib/rng":58}],61:[function(require,module,exports){var name,uuid=require("./uuid");const Frontend=require("../frontend"),OPTIONS=require("../frontend/constants")["OPTIONS"],{encodeChange,decodeChange}=require("../backend/columnar"),isObject=require("./common")["isObject"];let backend=require("../backend");function init(options){if("string"==typeof options)options={actorId:options};else if(void 0===options)options={};else if(!isObject(options))throw new TypeError("Unsupported options for init(): "+options);return Frontend.init(Object.assign({backend:backend},options))}function change(doc,options,callback){var[doc]=Frontend.change(doc,options,callback);return doc}function getAllChanges(doc){return backend.getAllChanges(Frontend.getBackendState(doc,"getAllChanges"))}function applyPatch(doc,patch,backendState,changes,options){backendState=Frontend.applyPatch(doc,patch,backendState);const patchCallback=options.patchCallback||doc[OPTIONS].patchCallback;return patchCallback&&patchCallback(patch,doc,backendState,!1,changes),backendState}function applyChanges(doc,changes,options={}){var oldState=Frontend.getBackendState(doc,"applyChanges"),[oldState,patch]=backend.applyChanges(oldState,changes);return[applyPatch(doc,patch,oldState,changes,options),patch]}module.exports={init:init,from:function(initialState,options){return change(init(options),{message:"Initialization"},doc=>Object.assign(doc,initialState))},change:change,emptyChange:function(doc,options){var[doc]=Frontend.emptyChange(doc,options);return doc},clone:function(doc,options={}){return doc=backend.clone(Frontend.getBackendState(doc,"clone")),applyPatch(init(options),backend.getPatch(doc),doc,[],options)},free:function(doc){backend.free(Frontend.getBackendState(doc,"free"))},load:function(data,options={}){var state=backend.load(data);return applyPatch(init(options),backend.getPatch(state),state,[data],options)},save:function(doc){return backend.save(Frontend.getBackendState(doc,"save"))},merge:function(localDoc,remoteDoc){var localState=Frontend.getBackendState(localDoc,"merge"),remoteState=Frontend.getBackendState(remoteDoc,"merge","second");if(Frontend.getActorId(localDoc)===Frontend.getActorId(remoteDoc))throw new RangeError("Cannot merge an actor with itself");var[remoteDoc]=applyChanges(localDoc,backend.getChangesAdded(localState,remoteState));return remoteDoc},getChanges:function(oldDoc,newDoc){return oldDoc=Frontend.getBackendState(oldDoc,"getChanges"),newDoc=Frontend.getBackendState(newDoc,"getChanges","second"),backend.getChanges(newDoc,backend.getHeads(oldDoc))},getAllChanges:getAllChanges,applyChanges:applyChanges,encodeChange:encodeChange,decodeChange:decodeChange,equals:function equals(val1,val2){if(!isObject(val1)||!isObject(val2))return val1===val2;var keys1=Object.keys(val1).sort(),keys2=Object.keys(val2).sort();if(keys1.length!==keys2.length)return!1;for(let i=0;i<keys1.length;i++){if(keys1[i]!==keys2[i])return!1;if(!equals(val1[keys1[i]],val2[keys2[i]]))return!1}return!0},getHistory:function(doc){const actor=Frontend.getActorId(doc),history=getAllChanges(doc);return history.map((change,index)=>({get change(){return decodeChange(change)},get snapshot(){var state=backend.loadChanges(backend.init(),history.slice(0,index+1));return Frontend.applyPatch(init(actor),backend.getPatch(state),state)}}))},uuid:uuid,Frontend:Frontend,setDefaultBackend:function(newBackend){backend=newBackend},generateSyncMessage:function(doc,syncState){return doc=Frontend.getBackendState(doc,"generateSyncMessage"),backend.generateSyncMessage(doc,syncState)},receiveSyncMessage:function(doc,oldSyncState,message){var oldBackendState=Frontend.getBackendState(doc,"receiveSyncMessage"),[oldBackendState,oldSyncState,patch]=backend.receiveSyncMessage(oldBackendState,oldSyncState,message);if(!patch)return[doc,oldSyncState,patch];let changes=null;return[applyPatch(doc,patch,oldBackendState,changes=doc[OPTIONS].patchCallback?backend.decodeSyncMessage(message).changes:changes,{}),oldSyncState,patch]},initSyncState:function(){return backend.initSyncState()},get Backend(){return backend}};for(name of["getObjectId","getObjectById","getActorId","setActorId","getConflicts","getLastLocalChange","Text","Table","Counter","Observable","Int","Uint","Float64"])module.exports[name]=Frontend[name]},{"../backend":26,"../backend/columnar":24,"../frontend":34,"../frontend/constants":31,"./common":62,"./uuid":63}],62:[function(require,module,exports){function isObject(obj){return"object"==typeof obj&&null!==obj}module.exports={isObject:isObject,copyObject:function(obj){if(!isObject(obj))return{};let copy={};for(var key of Object.keys(obj))copy[key]=obj[key];return copy},parseOpId:function(opId){var match=/^(\d+)@(.*)$/.exec(opId||"");if(match)return{counter:parseInt(match[1],10),actorId:match[2]};throw new RangeError("Not a valid opId: "+opId)},equalBytes:function(array1,array2){if(!(array1 instanceof Uint8Array&&array2 instanceof Uint8Array))throw new TypeError("equalBytes can only compare Uint8Arrays");if(array1.byteLength!==array2.byteLength)return!1;for(let i=0;i<array1.byteLength;i++)if(array1[i]!==array2[i])return!1;return!0},createArrayOfNulls:function(length){const array=new Array(length);for(let i=0;i<length;i++)array[i]=null;return array}}},{}],63:[function(require,module,exports){const uuid=require("uuid")["v4"];function defaultFactory(){return uuid().replace(/-/g,"")}let factory=defaultFactory;function makeUuid(){return factory()}makeUuid.setFactory=newFactory=>{factory=newFactory},makeUuid.reset=()=>{factory=defaultFactory},module.exports=makeUuid},{uuid:56}],64:[function(require,module,exports){!function(global){!function(){"use strict";var possibleNames=["BigInt64Array","BigUint64Array","Float32Array","Float64Array","Int16Array","Int32Array","Int8Array","Uint16Array","Uint32Array","Uint8Array","Uint8ClampedArray"],g="undefined"==typeof globalThis?global:globalThis;module.exports=function(){for(var out=[],i=0;i<possibleNames.length;i++)"function"==typeof g[possibleNames[i]]&&(out[out.length]=possibleNames[i]);return out}}.call(this)}.call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],65:[function(require,module,exports){"use strict";exports.byteLength=function(b64){var b64=getLens(b64),validLen=b64[0],b64=b64[1];return 3*(validLen+b64)/4-b64},exports.toByteArray=function(b64){var tmp,i,lens=getLens(b64),validLen=lens[0],lens=lens[1],arr=new Arr(function(validLen,placeHoldersLen){return 3*(validLen+placeHoldersLen)/4-placeHoldersLen}(validLen,lens)),curByte=0,len=0<lens?validLen-4:validLen;for(i=0;i<len;i+=4)tmp=revLookup[b64.charCodeAt(i)]<<18|revLookup[b64.charCodeAt(i+1)]<<12|revLookup[b64.charCodeAt(i+2)]<<6|revLookup[b64.charCodeAt(i+3)],arr[curByte++]=tmp>>16&255,arr[curByte++]=tmp>>8&255,arr[curByte++]=255&tmp;2===lens&&(tmp=revLookup[b64.charCodeAt(i)]<<2|revLookup[b64.charCodeAt(i+1)]>>4,arr[curByte++]=255&tmp);1===lens&&(tmp=revLookup[b64.charCodeAt(i)]<<10|revLookup[b64.charCodeAt(i+1)]<<4|revLookup[b64.charCodeAt(i+2)]>>2,arr[curByte++]=tmp>>8&255,arr[curByte++]=255&tmp);return arr},exports.fromByteArray=function(uint8){for(var tmp,len=uint8.length,extraBytes=len%3,parts=[],i=0,len2=len-extraBytes;i<len2;i+=16383)parts.push(function(uint8,start,end){for(var tmp,output=[],i=start;i<end;i+=3)tmp=(uint8[i]<<16&16711680)+(uint8[i+1]<<8&65280)+(255&uint8[i+2]),output.push(function(num){return lookup[num>>18&63]+lookup[num>>12&63]+lookup[num>>6&63]+lookup[63&num]}(tmp));return output.join("")}(uint8,i,len2<i+16383?len2:i+16383));1==extraBytes?(tmp=uint8[len-1],parts.push(lookup[tmp>>2]+lookup[tmp<<4&63]+"==")):2==extraBytes&&(tmp=(uint8[len-2]<<8)+uint8[len-1],parts.push(lookup[tmp>>10]+lookup[tmp>>4&63]+lookup[tmp<<2&63]+"="));return parts.join("")};for(var lookup=[],revLookup=[],Arr="undefined"!=typeof Uint8Array?Uint8Array:Array,code="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",i=0,len=code.length;i<len;++i)lookup[i]=code[i],revLookup[code.charCodeAt(i)]=i;function getLens(b64){var len=b64.length;if(0<len%4)throw new Error("Invalid string. Length must be a multiple of 4");b64=b64.indexOf("="),len=(b64=-1===b64?len:b64)===len?0:4-b64%4;return[b64,len]}revLookup["-".charCodeAt(0)]=62,revLookup["_".charCodeAt(0)]=63},{}],66:[function(require,module,exports){!function(module,exports){"use strict";function assert(val,msg){if(!val)throw new Error(msg||"Assertion failed")}function inherits(ctor,superCtor){ctor.super_=superCtor;function TempCtor(){}TempCtor.prototype=superCtor.prototype,ctor.prototype=new TempCtor,ctor.prototype.constructor=ctor}function BN(number,base,endian){if(BN.isBN(number))return number;this.negative=0,this.words=null,this.length=0,(this.red=null)!==number&&("le"!==base&&"be"!==base||(endian=base,base=10),this._init(number||0,base||10,endian||"be"))}var Buffer;"object"==typeof module?module.exports=BN:exports.BN=BN,(BN.BN=BN).wordSize=26;try{Buffer=("undefined"!=typeof window&&void 0!==window.Buffer?window:require("buffer")).Buffer}catch(e){}function parseHex4Bits(string,index){index=string.charCodeAt(index);return 48<=index&&index<=57?index-48:65<=index&&index<=70?index-55:97<=index&&index<=102?index-87:void assert(!1,"Invalid character in "+string)}function parseHexByte(string,lowerBound,index){var r=parseHex4Bits(string,index);return lowerBound<=index-1&&(r|=parseHex4Bits(string,index-1)<<4),r}function parseBase(str,start,end,mul){for(var r=0,b=0,len=Math.min(str.length,end),i=start;i<len;i++){var c=str.charCodeAt(i)-48;r*=mul,b=49<=c?c-49+10:17<=c?c-17+10:c,assert(0<=c&&b<mul,"Invalid character"),r+=b}return r}function move(dest,src){dest.words=src.words,dest.length=src.length,dest.negative=src.negative,dest.red=src.red}if(BN.isBN=function(num){return num instanceof BN||null!==num&&"object"==typeof num&&num.constructor.wordSize===BN.wordSize&&Array.isArray(num.words)},BN.max=function(left,right){return 0<left.cmp(right)?left:right},BN.min=function(left,right){return left.cmp(right)<0?left:right},BN.prototype._init=function(number,base,endian){if("number"==typeof number)return this._initNumber(number,base,endian);if("object"==typeof number)return this._initArray(number,base,endian);assert((base="hex"===base?16:base)===(0|base)&&2<=base&&base<=36);var start=0;"-"===(number=number.toString().replace(/\s+/g,""))[0]&&(start++,this.negative=1),start<number.length&&(16===base?this._parseHex(number,start,endian):(this._parseBase(number,base,start),"le"===endian&&this._initArray(this.toArray(),base,endian)))},BN.prototype._initNumber=function(number,base,endian){number<0&&(this.negative=1,number=-number),number<67108864?(this.words=[67108863&number],this.length=1):number<4503599627370496?(this.words=[67108863&number,number/67108864&67108863],this.length=2):(assert(number<9007199254740992),this.words=[67108863&number,number/67108864&67108863,1],this.length=3),"le"===endian&&this._initArray(this.toArray(),base,endian)},BN.prototype._initArray=function(number,base,endian){if(assert("number"==typeof number.length),number.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(number.length/3),this.words=new Array(this.length);for(var j,w,i=0;i<this.length;i++)this.words[i]=0;var off=0;if("be"===endian)for(i=number.length-1,j=0;0<=i;i-=3)w=number[i]|number[i-1]<<8|number[i-2]<<16,this.words[j]|=w<<off&67108863,this.words[j+1]=w>>>26-off&67108863,26<=(off+=24)&&(off-=26,j++);else if("le"===endian)for(j=i=0;i<number.length;i+=3)w=number[i]|number[i+1]<<8|number[i+2]<<16,this.words[j]|=w<<off&67108863,this.words[j+1]=w>>>26-off&67108863,26<=(off+=24)&&(off-=26,j++);return this._strip()},BN.prototype._parseHex=function(number,start,endian){this.length=Math.ceil((number.length-start)/6),this.words=new Array(this.length);for(var i=0;i<this.length;i++)this.words[i]=0;var w,off=0,j=0;if("be"===endian)for(i=number.length-1;start<=i;i-=2)w=parseHexByte(number,start,i)<<off,this.words[j]|=67108863&w,18<=off?(off-=18,this.words[j+=1]|=w>>>26):off+=8;else for(i=(number.length-start)%2==0?start+1:start;i<number.length;i+=2)w=parseHexByte(number,start,i)<<off,this.words[j]|=67108863&w,18<=off?(off-=18,this.words[j+=1]|=w>>>26):off+=8;this._strip()},BN.prototype._parseBase=function(number,base,start){this.words=[0];for(var limbLen=0,limbPow=this.length=1;limbPow<=67108863;limbPow*=base)limbLen++;for(var limbPow=limbPow/base|0,total=number.length-start,mod=total%--limbLen,end=Math.min(total,total-mod)+start,word=0,i=start;i<end;i+=limbLen)word=parseBase(number,i,i+limbLen,base),this.imuln(limbPow),this.words[0]+word<67108864?this.words[0]+=word:this._iaddn(word);if(0!=mod){for(var pow=1,word=parseBase(number,i,number.length,base),i=0;i<mod;i++)pow*=base;this.imuln(pow),this.words[0]+word<67108864?this.words[0]+=word:this._iaddn(word)}this._strip()},BN.prototype.copy=function(dest){dest.words=new Array(this.length);for(var i=0;i<this.length;i++)dest.words[i]=this.words[i];dest.length=this.length,dest.negative=this.negative,dest.red=this.red},BN.prototype._move=function(dest){move(dest,this)},BN.prototype.clone=function(){var r=new BN(null);return this.copy(r),r},BN.prototype._expand=function(size){for(;this.length<size;)this.words[this.length++]=0;return this},BN.prototype._strip=function(){for(;1<this.length&&0===this.words[this.length-1];)this.length--;return this._normSign()},BN.prototype._normSign=function(){return 1===this.length&&0===this.words[0]&&(this.negative=0),this},"undefined"!=typeof Symbol&&"function"==typeof Symbol.for)try{BN.prototype[Symbol.for("nodejs.util.inspect.custom")]=inspect}catch(e){BN.prototype.inspect=inspect}else BN.prototype.inspect=inspect;function inspect(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"}var zeros=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],groupSizes=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],groupBases=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];BN.prototype.toString=function(base,padding){if(padding=0|padding||1,16===(base=base||10)||"hex"===base){out="";for(var off=0,carry=0,i=0;i<this.length;i++){var w=this.words[i],word=(16777215&(w<<off|carry)).toString(16),out=0!==(carry=w>>>24-off&16777215)||i!==this.length-1?zeros[6-word.length]+word+out:word+out;26<=(off+=2)&&(off-=26,i--)}for(0!==carry&&(out=carry.toString(16)+out);out.length%padding!=0;)out="0"+out;return out=0!==this.negative?"-"+out:out}if(base===(0|base)&&2<=base&&base<=36){var groupSize=groupSizes[base],groupBase=groupBases[base];for(out="",(c=this.clone()).negative=0;!c.isZero();){var c,r=c.modrn(groupBase).toString(base);out=(c=c.idivn(groupBase)).isZero()?r+out:zeros[groupSize-r.length]+r+out}for(this.isZero()&&(out="0"+out);out.length%padding!=0;)out="0"+out;return out=0!==this.negative?"-"+out:out}assert(!1,"Base should be between 2 and 36")},BN.prototype.toNumber=function(){var ret=this.words[0];return 2===this.length?ret+=67108864*this.words[1]:3===this.length&&1===this.words[2]?ret+=4503599627370496+67108864*this.words[1]:2<this.length&&assert(!1,"Number can only safely store up to 53 bits"),0!==this.negative?-ret:ret},BN.prototype.toJSON=function(){return this.toString(16,2)},Buffer&&(BN.prototype.toBuffer=function(endian,length){return this.toArrayLike(Buffer,endian,length)}),BN.prototype.toArray=function(endian,length){return this.toArrayLike(Array,endian,length)};function smallMulTo(self,num,out){out.negative=num.negative^self.negative;var len=self.length+num.length|0,len=(out.length=len)-1|0,carry=(r=(0|self.words[0])*(0|num.words[0]))/67108864|0;out.words[0]=67108863&r;for(var k=1;k<len;k++){for(var r,ncarry=carry>>>26,rword=67108863&carry,maxJ=Math.min(k,num.length-1),j=Math.max(0,k-self.length+1);j<=maxJ;j++)ncarry+=(r=(0|self.words[k-j|0])*(0|num.words[j])+rword)/67108864|0,rword=67108863&r;out.words[k]=0|rword,carry=0|ncarry}return 0!==carry?out.words[k]=0|carry:out.length--,out._strip()}BN.prototype.toArrayLike=function(ArrayType,endian,length){this._strip();var byteLength=this.byteLength(),length=length||Math.max(1,byteLength),ArrayType=(assert(byteLength<=length,"byte array longer than desired length"),assert(0<length,"Requested array length <= 0"),function(ArrayType,size){return ArrayType.allocUnsafe?ArrayType.allocUnsafe(size):new ArrayType(size)}(ArrayType,length));return this["_toArrayLike"+("le"===endian?"LE":"BE")](ArrayType,byteLength),ArrayType},BN.prototype._toArrayLikeLE=function(res,byteLength){for(var position=0,carry=0,i=0,shift=0;i<this.length;i++){var word=this.words[i]<<shift|carry;res[position++]=255&word,position<res.length&&(res[position++]=word>>8&255),position<res.length&&(res[position++]=word>>16&255),6===shift?(position<res.length&&(res[position++]=word>>24&255),shift=carry=0):(carry=word>>>24,shift+=2)}if(position<res.length)for(res[position++]=carry;position<res.length;)res[position++]=0},BN.prototype._toArrayLikeBE=function(res,byteLength){for(var position=res.length-1,carry=0,i=0,shift=0;i<this.length;i++){var word=this.words[i]<<shift|carry;res[position--]=255&word,0<=position&&(res[position--]=word>>8&255),0<=position&&(res[position--]=word>>16&255),6===shift?(0<=position&&(res[position--]=word>>24&255),shift=carry=0):(carry=word>>>24,shift+=2)}if(0<=position)for(res[position--]=carry;0<=position;)res[position--]=0},Math.clz32?BN.prototype._countBits=function(w){return 32-Math.clz32(w)}:BN.prototype._countBits=function(w){var r=0;return 4096<=w&&(r+=13,w>>>=13),64<=w&&(r+=7,w>>>=7),8<=w&&(r+=4,w>>>=4),2<=w&&(r+=2,w>>>=2),r+w},BN.prototype._zeroBits=function(w){if(0===w)return 26;var r=0;return 0==(8191&w)&&(r+=13,w>>>=13),0==(127&w)&&(r+=7,w>>>=7),0==(15&w)&&(r+=4,w>>>=4),0==(3&w)&&(r+=2,w>>>=2),0==(1&w)&&r++,r},BN.prototype.bitLength=function(){var w=this.words[this.length-1],w=this._countBits(w);return 26*(this.length-1)+w},BN.prototype.zeroBits=function(){if(this.isZero())return 0;for(var r=0,i=0;i<this.length;i++){var b=this._zeroBits(this.words[i]);if(r+=b,26!==b)break}return r},BN.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},BN.prototype.toTwos=function(width){return 0!==this.negative?this.abs().inotn(width).iaddn(1):this.clone()},BN.prototype.fromTwos=function(width){return this.testn(width-1)?this.notn(width).iaddn(1).ineg():this.clone()},BN.prototype.isNeg=function(){return 0!==this.negative},BN.prototype.neg=function(){return this.clone().ineg()},BN.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},BN.prototype.iuor=function(num){for(;this.length<num.length;)this.words[this.length++]=0;for(var i=0;i<num.length;i++)this.words[i]=this.words[i]|num.words[i];return this._strip()},BN.prototype.ior=function(num){return assert(0==(this.negative|num.negative)),this.iuor(num)},BN.prototype.or=function(num){return this.length>num.length?this.clone().ior(num):num.clone().ior(this)},BN.prototype.uor=function(num){return this.length>num.length?this.clone().iuor(num):num.clone().iuor(this)},BN.prototype.iuand=function(num){for(var b=this.length>num.length?num:this,i=0;i<b.length;i++)this.words[i]=this.words[i]&num.words[i];return this.length=b.length,this._strip()},BN.prototype.iand=function(num){return assert(0==(this.negative|num.negative)),this.iuand(num)},BN.prototype.and=function(num){return this.length>num.length?this.clone().iand(num):num.clone().iand(this)},BN.prototype.uand=function(num){return this.length>num.length?this.clone().iuand(num):num.clone().iuand(this)},BN.prototype.iuxor=function(num){for(var a,b=this.length>num.length?(a=this,num):(a=num,this),i=0;i<b.length;i++)this.words[i]=a.words[i]^b.words[i];if(this!==a)for(;i<a.length;i++)this.words[i]=a.words[i];return this.length=a.length,this._strip()},BN.prototype.ixor=function(num){return assert(0==(this.negative|num.negative)),this.iuxor(num)},BN.prototype.xor=function(num){return this.length>num.length?this.clone().ixor(num):num.clone().ixor(this)},BN.prototype.uxor=function(num){return this.length>num.length?this.clone().iuxor(num):num.clone().iuxor(this)},BN.prototype.inotn=function(width){assert("number"==typeof width&&0<=width);var bytesNeeded=0|Math.ceil(width/26),width=width%26;this._expand(bytesNeeded),0<width&&bytesNeeded--;for(var i=0;i<bytesNeeded;i++)this.words[i]=67108863&~this.words[i];return 0<width&&(this.words[i]=~this.words[i]&67108863>>26-width),this._strip()},BN.prototype.notn=function(width){return this.clone().inotn(width)},BN.prototype.setn=function(bit,val){assert("number"==typeof bit&&0<=bit);var off=bit/26|0,bit=bit%26;return this._expand(1+off),this.words[off]=val?this.words[off]|1<<bit:this.words[off]&~(1<<bit),this._strip()},BN.prototype.iadd=function(num){var r,a;if(0!==this.negative&&0===num.negative)return this.negative=0,r=this.isub(num),this.negative^=1,this._normSign();if(0===this.negative&&0!==num.negative)return num.negative=0,r=this.isub(num),num.negative=1,r._normSign();for(var b=this.length>num.length?(a=this,num):(a=num,this),carry=0,i=0;i<b.length;i++)r=(0|a.words[i])+(0|b.words[i])+carry,this.words[i]=67108863&r,carry=r>>>26;for(;0!==carry&&i<a.length;i++)r=(0|a.words[i])+carry,this.words[i]=67108863&r,carry=r>>>26;if(this.length=a.length,0!==carry)this.words[this.length]=carry,this.length++;else if(a!==this)for(;i<a.length;i++)this.words[i]=a.words[i];return this},BN.prototype.add=function(num){var res;return 0!==num.negative&&0===this.negative?(num.negative=0,res=this.sub(num),num.negative^=1,res):0===num.negative&&0!==this.negative?(this.negative=0,res=num.sub(this),this.negative=1,res):this.length>num.length?this.clone().iadd(num):num.clone().iadd(this)},BN.prototype.isub=function(num){var r;if(0!==num.negative)return num.negative=0,r=this.iadd(num),num.negative=1,r._normSign();if(0!==this.negative)return this.negative=0,this.iadd(num),this.negative=1,this._normSign();var a,cmp=this.cmp(num);if(0===cmp)return this.negative=0,this.length=1,this.words[0]=0,this;for(var b=0<cmp?(a=this,num):(a=num,this),carry=0,i=0;i<b.length;i++)carry=(r=(0|a.words[i])-(0|b.words[i])+carry)>>26,this.words[i]=67108863&r;for(;0!==carry&&i<a.length;i++)carry=(r=(0|a.words[i])+carry)>>26,this.words[i]=67108863&r;if(0===carry&&i<a.length&&a!==this)for(;i<a.length;i++)this.words[i]=a.words[i];return this.length=Math.max(this.length,i),a!==this&&(this.negative=1),this._strip()},BN.prototype.sub=function(num){return this.clone().isub(num)};var comb10MulTo=function(self,num,out){var lo,a=self.words,b=num.words,o=out.words,a0=0|a[0],al0=8191&a0,a0=a0>>>13,a1=0|a[1],al1=8191&a1,a1=a1>>>13,a2=0|a[2],al2=8191&a2,a2=a2>>>13,a3=0|a[3],al3=8191&a3,a3=a3>>>13,a4=0|a[4],al4=8191&a4,a4=a4>>>13,a5=0|a[5],al5=8191&a5,a5=a5>>>13,a6=0|a[6],al6=8191&a6,a6=a6>>>13,a7=0|a[7],al7=8191&a7,a7=a7>>>13,a8=0|a[8],al8=8191&a8,a8=a8>>>13,a=0|a[9],al9=8191&a,a=a>>>13,b0=0|b[0],bl0=8191&b0,b0=b0>>>13,b1=0|b[1],bl1=8191&b1,b1=b1>>>13,b2=0|b[2],bl2=8191&b2,b2=b2>>>13,b3=0|b[3],bl3=8191&b3,b3=b3>>>13,b4=0|b[4],bl4=8191&b4,b4=b4>>>13,b5=0|b[5],bl5=8191&b5,b5=b5>>>13,b6=0|b[6],bl6=8191&b6,b6=b6>>>13,b7=0|b[7],bl7=8191&b7,b7=b7>>>13,b8=0|b[8],bl8=8191&b8,b8=b8>>>13,b=0|b[9],bl9=8191&b,b=b>>>13,num=(out.negative=self.negative^num.negative,out.length=19,(0+Math.imul(al0,bl0)|0)+((8191&(self=Math.imul(al0,b0)+Math.imul(a0,bl0)|0))<<13)|0),c=(Math.imul(a0,b0)+(self>>>13)|0)+(num>>>26)|0;num&=67108863,lo=Math.imul(al1,bl0),self=Math.imul(al1,b0)+Math.imul(a1,bl0)|0,hi=Math.imul(a1,b0);var hi,w1=(c+(lo+Math.imul(al0,bl1)|0)|0)+((8191&(self=(self+Math.imul(al0,b1)|0)+Math.imul(a0,bl1)|0))<<13)|0,w2=(c=((hi+Math.imul(a0,b1)|0)+(self>>>13)|0)+(w1>>>26)|0,w1&=67108863,lo=Math.imul(al2,bl0),self=Math.imul(al2,b0)+Math.imul(a2,bl0)|0,hi=Math.imul(a2,b0),lo=lo+Math.imul(al1,bl1)|0,self=(self+Math.imul(al1,b1)|0)+Math.imul(a1,bl1)|0,hi=hi+Math.imul(a1,b1)|0,(c+(lo+Math.imul(al0,bl2)|0)|0)+((8191&(self=(self+Math.imul(al0,b2)|0)+Math.imul(a0,bl2)|0))<<13)|0),w3=(c=((hi+Math.imul(a0,b2)|0)+(self>>>13)|0)+(w2>>>26)|0,w2&=67108863,lo=Math.imul(al3,bl0),self=Math.imul(al3,b0)+Math.imul(a3,bl0)|0,hi=Math.imul(a3,b0),lo=lo+Math.imul(al2,bl1)|0,self=(self+Math.imul(al2,b1)|0)+Math.imul(a2,bl1)|0,hi=hi+Math.imul(a2,b1)|0,lo=lo+Math.imul(al1,bl2)|0,self=(self+Math.imul(al1,b2)|0)+Math.imul(a1,bl2)|0,hi=hi+Math.imul(a1,b2)|0,(c+(lo+Math.imul(al0,bl3)|0)|0)+((8191&(self=(self+Math.imul(al0,b3)|0)+Math.imul(a0,bl3)|0))<<13)|0),w4=(c=((hi+Math.imul(a0,b3)|0)+(self>>>13)|0)+(w3>>>26)|0,w3&=67108863,lo=Math.imul(al4,bl0),self=Math.imul(al4,b0)+Math.imul(a4,bl0)|0,hi=Math.imul(a4,b0),lo=lo+Math.imul(al3,bl1)|0,self=(self+Math.imul(al3,b1)|0)+Math.imul(a3,bl1)|0,hi=hi+Math.imul(a3,b1)|0,lo=lo+Math.imul(al2,bl2)|0,self=(self+Math.imul(al2,b2)|0)+Math.imul(a2,bl2)|0,hi=hi+Math.imul(a2,b2)|0,lo=lo+Math.imul(al1,bl3)|0,self=(self+Math.imul(al1,b3)|0)+Math.imul(a1,bl3)|0,hi=hi+Math.imul(a1,b3)|0,(c+(lo+Math.imul(al0,bl4)|0)|0)+((8191&(self=(self+Math.imul(al0,b4)|0)+Math.imul(a0,bl4)|0))<<13)|0),w5=(c=((hi+Math.imul(a0,b4)|0)+(self>>>13)|0)+(w4>>>26)|0,w4&=67108863,lo=Math.imul(al5,bl0),self=Math.imul(al5,b0)+Math.imul(a5,bl0)|0,hi=Math.imul(a5,b0),lo=lo+Math.imul(al4,bl1)|0,self=(self+Math.imul(al4,b1)|0)+Math.imul(a4,bl1)|0,hi=hi+Math.imul(a4,b1)|0,lo=lo+Math.imul(al3,bl2)|0,self=(self+Math.imul(al3,b2)|0)+Math.imul(a3,bl2)|0,hi=hi+Math.imul(a3,b2)|0,lo=lo+Math.imul(al2,bl3)|0,self=(self+Math.imul(al2,b3)|0)+Math.imul(a2,bl3)|0,hi=hi+Math.imul(a2,b3)|0,lo=lo+Math.imul(al1,bl4)|0,self=(self+Math.imul(al1,b4)|0)+Math.imul(a1,bl4)|0,hi=hi+Math.imul(a1,b4)|0,(c+(lo+Math.imul(al0,bl5)|0)|0)+((8191&(self=(self+Math.imul(al0,b5)|0)+Math.imul(a0,bl5)|0))<<13)|0),w6=(c=((hi+Math.imul(a0,b5)|0)+(self>>>13)|0)+(w5>>>26)|0,w5&=67108863,lo=Math.imul(al6,bl0),self=Math.imul(al6,b0)+Math.imul(a6,bl0)|0,hi=Math.imul(a6,b0),lo=lo+Math.imul(al5,bl1)|0,self=(self+Math.imul(al5,b1)|0)+Math.imul(a5,bl1)|0,hi=hi+Math.imul(a5,b1)|0,lo=lo+Math.imul(al4,bl2)|0,self=(self+Math.imul(al4,b2)|0)+Math.imul(a4,bl2)|0,hi=hi+Math.imul(a4,b2)|0,lo=lo+Math.imul(al3,bl3)|0,self=(self+Math.imul(al3,b3)|0)+Math.imul(a3,bl3)|0,hi=hi+Math.imul(a3,b3)|0,lo=lo+Math.imul(al2,bl4)|0,self=(self+Math.imul(al2,b4)|0)+Math.imul(a2,bl4)|0,hi=hi+Math.imul(a2,b4)|0,lo=lo+Math.imul(al1,bl5)|0,self=(self+Math.imul(al1,b5)|0)+Math.imul(a1,bl5)|0,hi=hi+Math.imul(a1,b5)|0,(c+(lo+Math.imul(al0,bl6)|0)|0)+((8191&(self=(self+Math.imul(al0,b6)|0)+Math.imul(a0,bl6)|0))<<13)|0),w7=(c=((hi+Math.imul(a0,b6)|0)+(self>>>13)|0)+(w6>>>26)|0,w6&=67108863,lo=Math.imul(al7,bl0),self=Math.imul(al7,b0)+Math.imul(a7,bl0)|0,hi=Math.imul(a7,b0),lo=lo+Math.imul(al6,bl1)|0,self=(self+Math.imul(al6,b1)|0)+Math.imul(a6,bl1)|0,hi=hi+Math.imul(a6,b1)|0,lo=lo+Math.imul(al5,bl2)|0,self=(self+Math.imul(al5,b2)|0)+Math.imul(a5,bl2)|0,hi=hi+Math.imul(a5,b2)|0,lo=lo+Math.imul(al4,bl3)|0,self=(self+Math.imul(al4,b3)|0)+Math.imul(a4,bl3)|0,hi=hi+Math.imul(a4,b3)|0,lo=lo+Math.imul(al3,bl4)|0,self=(self+Math.imul(al3,b4)|0)+Math.imul(a3,bl4)|0,hi=hi+Math.imul(a3,b4)|0,lo=lo+Math.imul(al2,bl5)|0,self=(self+Math.imul(al2,b5)|0)+Math.imul(a2,bl5)|0,hi=hi+Math.imul(a2,b5)|0,lo=lo+Math.imul(al1,bl6)|0,self=(self+Math.imul(al1,b6)|0)+Math.imul(a1,bl6)|0,hi=hi+Math.imul(a1,b6)|0,(c+(lo+Math.imul(al0,bl7)|0)|0)+((8191&(self=(self+Math.imul(al0,b7)|0)+Math.imul(a0,bl7)|0))<<13)|0),w8=(c=((hi+Math.imul(a0,b7)|0)+(self>>>13)|0)+(w7>>>26)|0,w7&=67108863,lo=Math.imul(al8,bl0),self=Math.imul(al8,b0)+Math.imul(a8,bl0)|0,hi=Math.imul(a8,b0),lo=lo+Math.imul(al7,bl1)|0,self=(self+Math.imul(al7,b1)|0)+Math.imul(a7,bl1)|0,hi=hi+Math.imul(a7,b1)|0,lo=lo+Math.imul(al6,bl2)|0,self=(self+Math.imul(al6,b2)|0)+Math.imul(a6,bl2)|0,hi=hi+Math.imul(a6,b2)|0,lo=lo+Math.imul(al5,bl3)|0,self=(self+Math.imul(al5,b3)|0)+Math.imul(a5,bl3)|0,hi=hi+Math.imul(a5,b3)|0,lo=lo+Math.imul(al4,bl4)|0,self=(self+Math.imul(al4,b4)|0)+Math.imul(a4,bl4)|0,hi=hi+Math.imul(a4,b4)|0,lo=lo+Math.imul(al3,bl5)|0,self=(self+Math.imul(al3,b5)|0)+Math.imul(a3,bl5)|0,hi=hi+Math.imul(a3,b5)|0,lo=lo+Math.imul(al2,bl6)|0,self=(self+Math.imul(al2,b6)|0)+Math.imul(a2,bl6)|0,hi=hi+Math.imul(a2,b6)|0,lo=lo+Math.imul(al1,bl7)|0,self=(self+Math.imul(al1,b7)|0)+Math.imul(a1,bl7)|0,hi=hi+Math.imul(a1,b7)|0,(c+(lo+Math.imul(al0,bl8)|0)|0)+((8191&(self=(self+Math.imul(al0,b8)|0)+Math.imul(a0,bl8)|0))<<13)|0),bl0=(c=((hi+Math.imul(a0,b8)|0)+(self>>>13)|0)+(w8>>>26)|0,w8&=67108863,lo=Math.imul(al9,bl0),self=Math.imul(al9,b0)+Math.imul(a,bl0)|0,hi=Math.imul(a,b0),lo=lo+Math.imul(al8,bl1)|0,self=(self+Math.imul(al8,b1)|0)+Math.imul(a8,bl1)|0,hi=hi+Math.imul(a8,b1)|0,lo=lo+Math.imul(al7,bl2)|0,self=(self+Math.imul(al7,b2)|0)+Math.imul(a7,bl2)|0,hi=hi+Math.imul(a7,b2)|0,lo=lo+Math.imul(al6,bl3)|0,self=(self+Math.imul(al6,b3)|0)+Math.imul(a6,bl3)|0,hi=hi+Math.imul(a6,b3)|0,lo=lo+Math.imul(al5,bl4)|0,self=(self+Math.imul(al5,b4)|0)+Math.imul(a5,bl4)|0,hi=hi+Math.imul(a5,b4)|0,lo=lo+Math.imul(al4,bl5)|0,self=(self+Math.imul(al4,b5)|0)+Math.imul(a4,bl5)|0,hi=hi+Math.imul(a4,b5)|0,lo=lo+Math.imul(al3,bl6)|0,self=(self+Math.imul(al3,b6)|0)+Math.imul(a3,bl6)|0,hi=hi+Math.imul(a3,b6)|0,lo=lo+Math.imul(al2,bl7)|0,self=(self+Math.imul(al2,b7)|0)+Math.imul(a2,bl7)|0,hi=hi+Math.imul(a2,b7)|0,lo=lo+Math.imul(al1,bl8)|0,self=(self+Math.imul(al1,b8)|0)+Math.imul(a1,bl8)|0,hi=hi+Math.imul(a1,b8)|0,(c+(lo+Math.imul(al0,bl9)|0)|0)+((8191&(self=(self+Math.imul(al0,b)|0)+Math.imul(a0,bl9)|0))<<13)|0),b0=(c=((hi+Math.imul(a0,b)|0)+(self>>>13)|0)+(bl0>>>26)|0,bl0&=67108863,lo=Math.imul(al9,bl1),self=Math.imul(al9,b1)+Math.imul(a,bl1)|0,hi=Math.imul(a,b1),lo=lo+Math.imul(al8,bl2)|0,self=(self+Math.imul(al8,b2)|0)+Math.imul(a8,bl2)|0,hi=hi+Math.imul(a8,b2)|0,lo=lo+Math.imul(al7,bl3)|0,self=(self+Math.imul(al7,b3)|0)+Math.imul(a7,bl3)|0,hi=hi+Math.imul(a7,b3)|0,lo=lo+Math.imul(al6,bl4)|0,self=(self+Math.imul(al6,b4)|0)+Math.imul(a6,bl4)|0,hi=hi+Math.imul(a6,b4)|0,lo=lo+Math.imul(al5,bl5)|0,self=(self+Math.imul(al5,b5)|0)+Math.imul(a5,bl5)|0,hi=hi+Math.imul(a5,b5)|0,lo=lo+Math.imul(al4,bl6)|0,self=(self+Math.imul(al4,b6)|0)+Math.imul(a4,bl6)|0,hi=hi+Math.imul(a4,b6)|0,lo=lo+Math.imul(al3,bl7)|0,self=(self+Math.imul(al3,b7)|0)+Math.imul(a3,bl7)|0,hi=hi+Math.imul(a3,b7)|0,lo=lo+Math.imul(al2,bl8)|0,self=(self+Math.imul(al2,b8)|0)+Math.imul(a2,bl8)|0,hi=hi+Math.imul(a2,b8)|0,(c+(lo+Math.imul(al1,bl9)|0)|0)+((8191&(self=(self+Math.imul(al1,b)|0)+Math.imul(a1,bl9)|0))<<13)|0),al0=(c=((hi+Math.imul(a1,b)|0)+(self>>>13)|0)+(b0>>>26)|0,b0&=67108863,lo=Math.imul(al9,bl2),self=Math.imul(al9,b2)+Math.imul(a,bl2)|0,hi=Math.imul(a,b2),lo=lo+Math.imul(al8,bl3)|0,self=(self+Math.imul(al8,b3)|0)+Math.imul(a8,bl3)|0,hi=hi+Math.imul(a8,b3)|0,lo=lo+Math.imul(al7,bl4)|0,self=(self+Math.imul(al7,b4)|0)+Math.imul(a7,bl4)|0,hi=hi+Math.imul(a7,b4)|0,lo=lo+Math.imul(al6,bl5)|0,self=(self+Math.imul(al6,b5)|0)+Math.imul(a6,bl5)|0,hi=hi+Math.imul(a6,b5)|0,lo=lo+Math.imul(al5,bl6)|0,self=(self+Math.imul(al5,b6)|0)+Math.imul(a5,bl6)|0,hi=hi+Math.imul(a5,b6)|0,lo=lo+Math.imul(al4,bl7)|0,self=(self+Math.imul(al4,b7)|0)+Math.imul(a4,bl7)|0,hi=hi+Math.imul(a4,b7)|0,lo=lo+Math.imul(al3,bl8)|0,self=(self+Math.imul(al3,b8)|0)+Math.imul(a3,bl8)|0,hi=hi+Math.imul(a3,b8)|0,(c+(lo+Math.imul(al2,bl9)|0)|0)+((8191&(self=(self+Math.imul(al2,b)|0)+Math.imul(a2,bl9)|0))<<13)|0),a0=(c=((hi+Math.imul(a2,b)|0)+(self>>>13)|0)+(al0>>>26)|0,al0&=67108863,lo=Math.imul(al9,bl3),self=Math.imul(al9,b3)+Math.imul(a,bl3)|0,hi=Math.imul(a,b3),lo=lo+Math.imul(al8,bl4)|0,self=(self+Math.imul(al8,b4)|0)+Math.imul(a8,bl4)|0,hi=hi+Math.imul(a8,b4)|0,lo=lo+Math.imul(al7,bl5)|0,self=(self+Math.imul(al7,b5)|0)+Math.imul(a7,bl5)|0,hi=hi+Math.imul(a7,b5)|0,lo=lo+Math.imul(al6,bl6)|0,self=(self+Math.imul(al6,b6)|0)+Math.imul(a6,bl6)|0,hi=hi+Math.imul(a6,b6)|0,lo=lo+Math.imul(al5,bl7)|0,self=(self+Math.imul(al5,b7)|0)+Math.imul(a5,bl7)|0,hi=hi+Math.imul(a5,b7)|0,lo=lo+Math.imul(al4,bl8)|0,self=(self+Math.imul(al4,b8)|0)+Math.imul(a4,bl8)|0,hi=hi+Math.imul(a4,b8)|0,(c+(lo+Math.imul(al3,bl9)|0)|0)+((8191&(self=(self+Math.imul(al3,b)|0)+Math.imul(a3,bl9)|0))<<13)|0),bl1=(c=((hi+Math.imul(a3,b)|0)+(self>>>13)|0)+(a0>>>26)|0,a0&=67108863,lo=Math.imul(al9,bl4),self=Math.imul(al9,b4)+Math.imul(a,bl4)|0,hi=Math.imul(a,b4),lo=lo+Math.imul(al8,bl5)|0,self=(self+Math.imul(al8,b5)|0)+Math.imul(a8,bl5)|0,hi=hi+Math.imul(a8,b5)|0,lo=lo+Math.imul(al7,bl6)|0,self=(self+Math.imul(al7,b6)|0)+Math.imul(a7,bl6)|0,hi=hi+Math.imul(a7,b6)|0,lo=lo+Math.imul(al6,bl7)|0,self=(self+Math.imul(al6,b7)|0)+Math.imul(a6,bl7)|0,hi=hi+Math.imul(a6,b7)|0,lo=lo+Math.imul(al5,bl8)|0,self=(self+Math.imul(al5,b8)|0)+Math.imul(a5,bl8)|0,hi=hi+Math.imul(a5,b8)|0,(c+(lo+Math.imul(al4,bl9)|0)|0)+((8191&(self=(self+Math.imul(al4,b)|0)+Math.imul(a4,bl9)|0))<<13)|0),b1=(c=((hi+Math.imul(a4,b)|0)+(self>>>13)|0)+(bl1>>>26)|0,bl1&=67108863,lo=Math.imul(al9,bl5),self=Math.imul(al9,b5)+Math.imul(a,bl5)|0,hi=Math.imul(a,b5),lo=lo+Math.imul(al8,bl6)|0,self=(self+Math.imul(al8,b6)|0)+Math.imul(a8,bl6)|0,hi=hi+Math.imul(a8,b6)|0,lo=lo+Math.imul(al7,bl7)|0,self=(self+Math.imul(al7,b7)|0)+Math.imul(a7,bl7)|0,hi=hi+Math.imul(a7,b7)|0,lo=lo+Math.imul(al6,bl8)|0,self=(self+Math.imul(al6,b8)|0)+Math.imul(a6,bl8)|0,hi=hi+Math.imul(a6,b8)|0,(c+(lo+Math.imul(al5,bl9)|0)|0)+((8191&(self=(self+Math.imul(al5,b)|0)+Math.imul(a5,bl9)|0))<<13)|0),al1=(c=((hi+Math.imul(a5,b)|0)+(self>>>13)|0)+(b1>>>26)|0,b1&=67108863,lo=Math.imul(al9,bl6),self=Math.imul(al9,b6)+Math.imul(a,bl6)|0,hi=Math.imul(a,b6),lo=lo+Math.imul(al8,bl7)|0,self=(self+Math.imul(al8,b7)|0)+Math.imul(a8,bl7)|0,hi=hi+Math.imul(a8,b7)|0,lo=lo+Math.imul(al7,bl8)|0,self=(self+Math.imul(al7,b8)|0)+Math.imul(a7,bl8)|0,hi=hi+Math.imul(a7,b8)|0,(c+(lo+Math.imul(al6,bl9)|0)|0)+((8191&(self=(self+Math.imul(al6,b)|0)+Math.imul(a6,bl9)|0))<<13)|0),a1=(c=((hi+Math.imul(a6,b)|0)+(self>>>13)|0)+(al1>>>26)|0,al1&=67108863,lo=Math.imul(al9,bl7),self=Math.imul(al9,b7)+Math.imul(a,bl7)|0,hi=Math.imul(a,b7),lo=lo+Math.imul(al8,bl8)|0,self=(self+Math.imul(al8,b8)|0)+Math.imul(a8,bl8)|0,hi=hi+Math.imul(a8,b8)|0,(c+(lo+Math.imul(al7,bl9)|0)|0)+((8191&(self=(self+Math.imul(al7,b)|0)+Math.imul(a7,bl9)|0))<<13)|0),bl2=(c=((hi+Math.imul(a7,b)|0)+(self>>>13)|0)+(a1>>>26)|0,a1&=67108863,lo=Math.imul(al9,bl8),self=Math.imul(al9,b8)+Math.imul(a,bl8)|0,hi=Math.imul(a,b8),(c+(lo+Math.imul(al8,bl9)|0)|0)+((8191&(self=(self+Math.imul(al8,b)|0)+Math.imul(a8,bl9)|0))<<13)|0),b2=(c=((hi+Math.imul(a8,b)|0)+(self>>>13)|0)+(bl2>>>26)|0,bl2&=67108863,(c+Math.imul(al9,bl9)|0)+((8191&(self=Math.imul(al9,b)+Math.imul(a,bl9)|0))<<13)|0);return c=(Math.imul(a,b)+(self>>>13)|0)+(b2>>>26)|0,b2&=67108863,o[0]=num,o[1]=w1,o[2]=w2,o[3]=w3,o[4]=w4,o[5]=w5,o[6]=w6,o[7]=w7,o[8]=w8,o[9]=bl0,o[10]=b0,o[11]=al0,o[12]=a0,o[13]=bl1,o[14]=b1,o[15]=al1,o[16]=a1,o[17]=bl2,o[18]=b2,0!=c&&(o[19]=c,out.length++),out};function bigMulTo(self,num,out){out.negative=num.negative^self.negative,out.length=self.length+num.length;for(var carry=0,hncarry=0,k=0;k<out.length-1;k++){for(var ncarry=hncarry,hncarry=0,rword=67108863&carry,maxJ=Math.min(k,num.length-1),j=Math.max(0,k-self.length+1);j<=maxJ;j++){var lo,r=(0|self.words[k-j])*(0|num.words[j]),rword=67108863&(lo=(67108863&r)+rword|0);hncarry+=(ncarry=(ncarry=ncarry+(r/67108864|0)|0)+(lo>>>26)|0)>>>26,ncarry&=67108863}out.words[k]=rword,carry=ncarry,ncarry=hncarry}return 0!==carry?out.words[k]=carry:out.length--,out._strip()}function jumboMulTo(self,num,out){return bigMulTo(self,num,out)}Math.imul||(comb10MulTo=smallMulTo),BN.prototype.mulTo=function(num,out){var len=this.length+num.length,len=(10===this.length&&10===num.length?comb10MulTo:len<63?smallMulTo:len<1024?bigMulTo:jumboMulTo)(this,num,out);return len},BN.prototype.mul=function(num){var out=new BN(null);return out.words=new Array(this.length+num.length),this.mulTo(num,out)},BN.prototype.mulf=function(num){var out=new BN(null);return out.words=new Array(this.length+num.length),jumboMulTo(this,num,out)},BN.prototype.imul=function(num){return this.clone().mulTo(num,this)},BN.prototype.imuln=function(num){for(var isNegNum=num<0,carry=(assert("number"==typeof(num=isNegNum?-num:num)),assert(num<67108864),0),i=0;i<this.length;i++){var w=(0|this.words[i])*num,lo=(67108863&w)+(67108863&carry),carry=(carry>>=26)+(w/67108864|0)+(lo>>>26);this.words[i]=67108863&lo}return 0!==carry&&(this.words[i]=carry,this.length++),isNegNum?this.ineg():this},BN.prototype.muln=function(num){return this.clone().imuln(num)},BN.prototype.sqr=function(){return this.mul(this)},BN.prototype.isqr=function(){return this.imul(this.clone())},BN.prototype.pow=function(num){var w=function(num){for(var w=new Array(num.bitLength()),bit=0;bit<w.length;bit++)w[bit]=num.words[bit/26|0]>>>bit%26&1;return w}(num);if(0===w.length)return new BN(1);for(var res=this,i=0;i<w.length&&0===w[i];i++,res=res.sqr());if(++i<w.length)for(var q=res.sqr();i<w.length;i++,q=q.sqr())0!==w[i]&&(res=res.mul(q));return res},BN.prototype.iushln=function(bits){assert("number"==typeof bits&&0<=bits);var r=bits%26,s=(bits-r)/26,carryMask=67108863>>>26-r<<26-r;if(0!=r){for(var carry=0,i=0;i<this.length;i++){var newCarry=this.words[i]&carryMask,c=(0|this.words[i])-newCarry<<r;this.words[i]=c|carry,carry=newCarry>>>26-r}carry&&(this.words[i]=carry,this.length++)}if(0!=s){for(i=this.length-1;0<=i;i--)this.words[i+s]=this.words[i];for(i=0;i<s;i++)this.words[i]=0;this.length+=s}return this._strip()},BN.prototype.ishln=function(bits){return assert(0===this.negative),this.iushln(bits)},BN.prototype.iushrn=function(bits,hint,extended){assert("number"==typeof bits&&0<=bits),h=hint?(hint-hint%26)/26:0;var h,r=bits%26,s=Math.min((bits-r)/26,this.length),mask=67108863^67108863>>>r<<r,maskedWords=extended;if(h-=s,h=Math.max(0,h),maskedWords){for(var i=0;i<s;i++)maskedWords.words[i]=this.words[i];maskedWords.length=s}if(0!==s)if(this.length>s)for(this.length-=s,i=0;i<this.length;i++)this.words[i]=this.words[i+s];else this.words[0]=0,this.length=1;for(var carry=0,i=this.length-1;0<=i&&(0!==carry||h<=i);i--){var word=0|this.words[i];this.words[i]=carry<<26-r|word>>>r,carry=word&mask}return maskedWords&&0!==carry&&(maskedWords.words[maskedWords.length++]=carry),0===this.length&&(this.words[0]=0,this.length=1),this._strip()},BN.prototype.ishrn=function(bits,hint,extended){return assert(0===this.negative),this.iushrn(bits,hint,extended)},BN.prototype.shln=function(bits){return this.clone().ishln(bits)},BN.prototype.ushln=function(bits){return this.clone().iushln(bits)},BN.prototype.shrn=function(bits){return this.clone().ishrn(bits)},BN.prototype.ushrn=function(bits){return this.clone().iushrn(bits)},BN.prototype.testn=function(bit){assert("number"==typeof bit&&0<=bit);var r=bit%26,bit=(bit-r)/26;return!(this.length<=bit)&&!!(this.words[bit]&1<<r)},BN.prototype.imaskn=function(bits){assert("number"==typeof bits&&0<=bits);var r=bits%26,bits=(bits-r)/26;return assert(0===this.negative,"imaskn works only with positive numbers"),this.length<=bits?this:(0!=r&&bits++,this.length=Math.min(bits,this.length),0!=r&&(this.words[this.length-1]&=67108863^67108863>>>r<<r),this._strip())},BN.prototype.maskn=function(bits){return this.clone().imaskn(bits)},BN.prototype.iaddn=function(num){return assert("number"==typeof num),assert(num<67108864),num<0?this.isubn(-num):0!==this.negative?(1===this.length&&(0|this.words[0])<=num?(this.words[0]=num-(0|this.words[0]),this.negative=0):(this.negative=0,this.isubn(num),this.negative=1),this):this._iaddn(num)},BN.prototype._iaddn=function(num){this.words[0]+=num;for(var i=0;i<this.length&&67108864<=this.words[i];i++)this.words[i]-=67108864,i===this.length-1?this.words[i+1]=1:this.words[i+1]++;return this.length=Math.max(this.length,i+1),this},BN.prototype.isubn=function(num){if(assert("number"==typeof num),assert(num<67108864),num<0)return this.iaddn(-num);if(0!==this.negative)return this.negative=0,this.iaddn(num),this.negative=1,this;if(this.words[0]-=num,1===this.length&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var i=0;i<this.length&&this.words[i]<0;i++)this.words[i]+=67108864,--this.words[i+1];return this._strip()},BN.prototype.addn=function(num){return this.clone().iaddn(num)},BN.prototype.subn=function(num){return this.clone().isubn(num)},BN.prototype.iabs=function(){return this.negative=0,this},BN.prototype.abs=function(){return this.clone().iabs()},BN.prototype._ishlnsubmul=function(num,mul,shift){for(var len=num.length+shift,carry=(this._expand(len),0),i=0;i<num.length;i++){var w=(0|this.words[i+shift])+carry,right=(0|num.words[i])*mul,carry=((w-=67108863&right)>>26)-(right/67108864|0);this.words[i+shift]=67108863&w}for(;i<this.length-shift;i++)carry=(w=(0|this.words[i+shift])+carry)>>26,this.words[i+shift]=67108863&w;if(0===carry)return this._strip();for(assert(-1===carry),i=carry=0;i<this.length;i++)carry=(w=-(0|this.words[i])+carry)>>26,this.words[i]=67108863&w;return this.negative=1,this._strip()},BN.prototype._wordDiv=function(num,mode){this.length,num.length;var q,a=this.clone(),b=num,bhi=0|b.words[b.length-1],m=(0!=(num=26-this._countBits(bhi))&&(b=b.ushln(num),a.iushln(num),bhi=0|b.words[b.length-1]),a.length-b.length);if("mod"!==mode){(q=new BN(null)).length=1+m,q.words=new Array(q.length);for(var i=0;i<q.length;i++)q.words[i]=0}var diff=a.clone()._ishlnsubmul(b,1,m);0===diff.negative&&(a=diff,q&&(q.words[m]=1));for(var j=m-1;0<=j;j--){var qj=67108864*(0|a.words[b.length+j])+(0|a.words[b.length+j-1]),qj=Math.min(qj/bhi|0,67108863);for(a._ishlnsubmul(b,qj,j);0!==a.negative;)qj--,a.negative=0,a._ishlnsubmul(b,1,j),a.isZero()||(a.negative^=1);q&&(q.words[j]=qj)}return q&&q._strip(),a._strip(),"div"!==mode&&0!=num&&a.iushrn(num),{div:q||null,mod:a}},BN.prototype.divmod=function(num,mode,positive){return assert(!num.isZero()),this.isZero()?{div:new BN(0),mod:new BN(0)}:0!==this.negative&&0===num.negative?(res=this.neg().divmod(num,mode),"mod"!==mode&&(div=res.div.neg()),"div"!==mode&&(mod=res.mod.neg(),positive&&0!==mod.negative&&mod.iadd(num)),{div:div,mod:mod}):0===this.negative&&0!==num.negative?(res=this.divmod(num.neg(),mode),{div:div="mod"!==mode?res.div.neg():div,mod:res.mod}):0!=(this.negative&num.negative)?(res=this.neg().divmod(num.neg(),mode),"div"!==mode&&(mod=res.mod.neg(),positive&&0!==mod.negative&&mod.isub(num)),{div:res.div,mod:mod}):num.length>this.length||this.cmp(num)<0?{div:new BN(0),mod:this}:1===num.length?"div"===mode?{div:this.divn(num.words[0]),mod:null}:"mod"===mode?{div:null,mod:new BN(this.modrn(num.words[0]))}:{div:this.divn(num.words[0]),mod:new BN(this.modrn(num.words[0]))}:this._wordDiv(num,mode);var div,mod,res},BN.prototype.div=function(num){return this.divmod(num,"div",!1).div},BN.prototype.mod=function(num){return this.divmod(num,"mod",!1).mod},BN.prototype.umod=function(num){return this.divmod(num,"mod",!0).mod},BN.prototype.divRound=function(num){var dm=this.divmod(num);if(dm.mod.isZero())return dm.div;var mod=0!==dm.div.negative?dm.mod.isub(num):dm.mod,half=num.ushrn(1),num=num.andln(1),mod=mod.cmp(half);return mod<0||1===num&&0===mod?dm.div:0!==dm.div.negative?dm.div.isubn(1):dm.div.iaddn(1)},BN.prototype.modrn=function(num){for(var isNegNum=num<0,p=(assert((num=isNegNum?-num:num)<=67108863),(1<<26)%num),acc=0,i=this.length-1;0<=i;i--)acc=(p*acc+(0|this.words[i]))%num;return isNegNum?-acc:acc},BN.prototype.modn=function(num){return this.modrn(num)},BN.prototype.idivn=function(num){for(var isNegNum=num<0,carry=(assert((num=isNegNum?-num:num)<=67108863),0),i=this.length-1;0<=i;i--){var w=(0|this.words[i])+67108864*carry;this.words[i]=w/num|0,carry=w%num}return this._strip(),isNegNum?this.ineg():this},BN.prototype.divn=function(num){return this.clone().idivn(num)},BN.prototype.egcd=function(p){assert(0===p.negative),assert(!p.isZero());for(var x=this,y=p.clone(),x=0!==x.negative?x.umod(p):x.clone(),A=new BN(1),B=new BN(0),C=new BN(0),D=new BN(1),g=0;x.isEven()&&y.isEven();)x.iushrn(1),y.iushrn(1),++g;for(var yp=y.clone(),xp=x.clone();!x.isZero();){for(var i=0,im=1;0==(x.words[0]&im)&&i<26;++i,im<<=1);if(0<i)for(x.iushrn(i);0<i--;)(A.isOdd()||B.isOdd())&&(A.iadd(yp),B.isub(xp)),A.iushrn(1),B.iushrn(1);for(var j=0,jm=1;0==(y.words[0]&jm)&&j<26;++j,jm<<=1);if(0<j)for(y.iushrn(j);0<j--;)(C.isOdd()||D.isOdd())&&(C.iadd(yp),D.isub(xp)),C.iushrn(1),D.iushrn(1);0<=x.cmp(y)?(x.isub(y),A.isub(C),B.isub(D)):(y.isub(x),C.isub(A),D.isub(B))}return{a:C,b:D,gcd:y.iushln(g)}},BN.prototype._invmp=function(p){assert(0===p.negative),assert(!p.isZero());for(var res,a=this,b=p.clone(),a=0!==a.negative?a.umod(p):a.clone(),x1=new BN(1),x2=new BN(0),delta=b.clone();0<a.cmpn(1)&&0<b.cmpn(1);){for(var i=0,im=1;0==(a.words[0]&im)&&i<26;++i,im<<=1);if(0<i)for(a.iushrn(i);0<i--;)x1.isOdd()&&x1.iadd(delta),x1.iushrn(1);for(var j=0,jm=1;0==(b.words[0]&jm)&&j<26;++j,jm<<=1);if(0<j)for(b.iushrn(j);0<j--;)x2.isOdd()&&x2.iadd(delta),x2.iushrn(1);0<=a.cmp(b)?(a.isub(b),x1.isub(x2)):(b.isub(a),x2.isub(x1))}return(res=0===a.cmpn(1)?x1:x2).cmpn(0)<0&&res.iadd(p),res},BN.prototype.gcd=function(num){if(this.isZero())return num.abs();if(num.isZero())return this.abs();var a=this.clone(),b=num.clone();a.negative=0;for(var shift=b.negative=0;a.isEven()&&b.isEven();shift++)a.iushrn(1),b.iushrn(1);for(;;){for(;a.isEven();)a.iushrn(1);for(;b.isEven();)b.iushrn(1);var r=a.cmp(b);if(r<0)var t=a,a=b,b=t;else if(0===r||0===b.cmpn(1))break;a.isub(b)}return b.iushln(shift)},BN.prototype.invm=function(num){return this.egcd(num).a.umod(num)},BN.prototype.isEven=function(){return 0==(1&this.words[0])},BN.prototype.isOdd=function(){return 1==(1&this.words[0])},BN.prototype.andln=function(num){return this.words[0]&num},BN.prototype.bincn=function(bit){assert("number"==typeof bit);var r=bit%26,bit=(bit-r)/26,r=1<<r;if(this.length<=bit)return this._expand(1+bit),this.words[bit]|=r,this;for(var carry=r,i=bit;0!==carry&&i<this.length;i++){var w=0|this.words[i],carry=(w+=carry)>>>26;w&=67108863,this.words[i]=w}return 0!==carry&&(this.words[i]=carry,this.length++),this},BN.prototype.isZero=function(){return 1===this.length&&0===this.words[0]},BN.prototype.cmpn=function(num){var negative=num<0;return 0===this.negative||negative?0===this.negative&&negative?1:(this._strip(),negative=1<this.length?1:(assert((num=negative?-num:num)<=67108863,"Number is too big"),(negative=0|this.words[0])===num?0:negative<num?-1:1),0!==this.negative?0|-negative:negative):-1},BN.prototype.cmp=function(num){if(0!==this.negative&&0===num.negative)return-1;if(0===this.negative&&0!==num.negative)return 1;num=this.ucmp(num);return 0!==this.negative?0|-num:num},BN.prototype.ucmp=function(num){if(this.length>num.length)return 1;if(this.length<num.length)return-1;for(var res=0,i=this.length-1;0<=i;i--){var a=0|this.words[i],b=0|num.words[i];if(a!=b){a<b?res=-1:b<a&&(res=1);break}}return res},BN.prototype.gtn=function(num){return 1===this.cmpn(num)},BN.prototype.gt=function(num){return 1===this.cmp(num)},BN.prototype.gten=function(num){return 0<=this.cmpn(num)},BN.prototype.gte=function(num){return 0<=this.cmp(num)},BN.prototype.ltn=function(num){return-1===this.cmpn(num)},BN.prototype.lt=function(num){return-1===this.cmp(num)},BN.prototype.lten=function(num){return this.cmpn(num)<=0},BN.prototype.lte=function(num){return this.cmp(num)<=0},BN.prototype.eqn=function(num){return 0===this.cmpn(num)},BN.prototype.eq=function(num){return 0===this.cmp(num)},BN.red=function(num){return new Red(num)},BN.prototype.toRed=function(ctx){return assert(!this.red,"Already a number in reduction context"),assert(0===this.negative,"red works only with positives"),ctx.convertTo(this)._forceRed(ctx)},BN.prototype.fromRed=function(){return assert(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},BN.prototype._forceRed=function(ctx){return this.red=ctx,this},BN.prototype.forceRed=function(ctx){return assert(!this.red,"Already a number in reduction context"),this._forceRed(ctx)},BN.prototype.redAdd=function(num){return assert(this.red,"redAdd works only with red numbers"),this.red.add(this,num)},BN.prototype.redIAdd=function(num){return assert(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,num)},BN.prototype.redSub=function(num){return assert(this.red,"redSub works only with red numbers"),this.red.sub(this,num)},BN.prototype.redISub=function(num){return assert(this.red,"redISub works only with red numbers"),this.red.isub(this,num)},BN.prototype.redShl=function(num){return assert(this.red,"redShl works only with red numbers"),this.red.shl(this,num)},BN.prototype.redMul=function(num){return assert(this.red,"redMul works only with red numbers"),this.red._verify2(this,num),this.red.mul(this,num)},BN.prototype.redIMul=function(num){return assert(this.red,"redMul works only with red numbers"),this.red._verify2(this,num),this.red.imul(this,num)},BN.prototype.redSqr=function(){return assert(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},BN.prototype.redISqr=function(){return assert(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},BN.prototype.redSqrt=function(){return assert(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},BN.prototype.redInvm=function(){return assert(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},BN.prototype.redNeg=function(){return assert(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},BN.prototype.redPow=function(num){return assert(this.red&&!num.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,num)};var primes={k256:null,p224:null,p192:null,p25519:null};function MPrime(name,p){this.name=name,this.p=new BN(p,16),this.n=this.p.bitLength(),this.k=new BN(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}function K256(){MPrime.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}function P224(){MPrime.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}function P192(){MPrime.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}function P25519(){MPrime.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}function Red(m){var prime;"string"==typeof m?(prime=BN._prime(m),this.m=prime.p,this.prime=prime):(assert(m.gtn(1),"modulus must be greater than 1"),this.m=m,this.prime=null)}function Mont(m){Red.call(this,m),this.shift=this.m.bitLength(),this.shift%26!=0&&(this.shift+=26-this.shift%26),this.r=new BN(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}MPrime.prototype._tmp=function(){var tmp=new BN(null);return tmp.words=new Array(Math.ceil(this.n/13)),tmp},MPrime.prototype.ireduce=function(num){for(var rlen,r=num;this.split(r,this.tmp),(rlen=(r=(r=this.imulK(r)).iadd(this.tmp)).bitLength())>this.n;);num=rlen<this.n?-1:r.ucmp(this.p);return 0===num?(r.words[0]=0,r.length=1):0<num?r.isub(this.p):void 0!==r.strip?r.strip():r._strip(),r},MPrime.prototype.split=function(input,out){input.iushrn(this.n,0,out)},MPrime.prototype.imulK=function(num){return num.imul(this.k)},inherits(K256,MPrime),K256.prototype.split=function(input,output){for(var outLen=Math.min(input.length,9),i=0;i<outLen;i++)output.words[i]=input.words[i];if(output.length=outLen,input.length<=9)return input.words[0]=0,void(input.length=1);var prev=input.words[9];for(output.words[output.length++]=4194303&prev,i=10;i<input.length;i++){var next=0|input.words[i];input.words[i-10]=(4194303&next)<<4|prev>>>22,prev=next}0===(input.words[i-10]=prev>>>=22)&&10<input.length?input.length-=10:input.length-=9},K256.prototype.imulK=function(num){num.words[num.length]=0,num.words[num.length+1]=0,num.length+=2;for(var lo=0,i=0;i<num.length;i++){var w=0|num.words[i];lo+=977*w,num.words[i]=67108863&lo,lo=64*w+(lo/67108864|0)}return 0===num.words[num.length-1]&&(num.length--,0===num.words[num.length-1]&&num.length--),num},inherits(P224,MPrime),inherits(P192,MPrime),inherits(P25519,MPrime),P25519.prototype.imulK=function(num){for(var carry=0,i=0;i<num.length;i++){var hi=19*(0|num.words[i])+carry,lo=67108863&hi;hi>>>=26,num.words[i]=lo,carry=hi}return 0!==carry&&(num.words[num.length++]=carry),num},BN._prime=function(name){if(primes[name])return primes[name];var prime;if("k256"===name)prime=new K256;else if("p224"===name)prime=new P224;else if("p192"===name)prime=new P192;else{if("p25519"!==name)throw new Error("Unknown prime "+name);prime=new P25519}return primes[name]=prime},Red.prototype._verify1=function(a){assert(0===a.negative,"red works only with positives"),assert(a.red,"red works only with red numbers")},Red.prototype._verify2=function(a,b){assert(0==(a.negative|b.negative),"red works only with positives"),assert(a.red&&a.red===b.red,"red works only with red numbers")},Red.prototype.imod=function(a){return this.prime?this.prime.ireduce(a)._forceRed(this):(move(a,a.umod(this.m)._forceRed(this)),a)},Red.prototype.neg=function(a){return a.isZero()?a.clone():this.m.sub(a)._forceRed(this)},Red.prototype.add=function(a,b){this._verify2(a,b);a=a.add(b);return 0<=a.cmp(this.m)&&a.isub(this.m),a._forceRed(this)},Red.prototype.iadd=function(a,b){this._verify2(a,b);a=a.iadd(b);return 0<=a.cmp(this.m)&&a.isub(this.m),a},Red.prototype.sub=function(a,b){this._verify2(a,b);a=a.sub(b);return a.cmpn(0)<0&&a.iadd(this.m),a._forceRed(this)},Red.prototype.isub=function(a,b){this._verify2(a,b);a=a.isub(b);return a.cmpn(0)<0&&a.iadd(this.m),a},Red.prototype.shl=function(a,num){return this._verify1(a),this.imod(a.ushln(num))},Red.prototype.imul=function(a,b){return this._verify2(a,b),this.imod(a.imul(b))},Red.prototype.mul=function(a,b){return this._verify2(a,b),this.imod(a.mul(b))},Red.prototype.isqr=function(a){return this.imul(a,a.clone())},Red.prototype.sqr=function(a){return this.mul(a,a)},Red.prototype.sqrt=function(a){if(a.isZero())return a.clone();var mod3=this.m.andln(3);if(assert(mod3%2==1),3===mod3)return mod3=this.m.add(new BN(1)).iushrn(2),this.pow(a,mod3);for(var q=this.m.subn(1),s=0;!q.isZero()&&0===q.andln(1);)s++,q.iushrn(1);assert(!q.isZero());for(var one=new BN(1).toRed(this),nOne=one.redNeg(),lpow=this.m.subn(1).iushrn(1),z=new BN(2*(z=this.m.bitLength())*z).toRed(this);0!==this.pow(z,lpow).cmp(nOne);)z.redIAdd(nOne);for(var c=this.pow(z,q),r=this.pow(a,q.addn(1).iushrn(1)),t=this.pow(a,q),m=s;0!==t.cmp(one);){for(var tmp=t,i=0;0!==tmp.cmp(one);i++)tmp=tmp.redSqr();assert(i<m);var b=this.pow(c,new BN(1).iushln(m-i-1)),r=r.redMul(b),c=b.redSqr(),t=t.redMul(c),m=i}return r},Red.prototype.invm=function(a){a=a._invmp(this.m);return 0!==a.negative?(a.negative=0,this.imod(a).redNeg()):this.imod(a)},Red.prototype.pow=function(a,num){if(num.isZero())return new BN(1).toRed(this);if(0===num.cmpn(1))return a.clone();var wnd=new Array(16);wnd[0]=new BN(1).toRed(this),wnd[1]=a;for(var i=2;i<wnd.length;i++)wnd[i]=this.mul(wnd[i-1],a);var res=wnd[0],current=0,currentLen=0,start=num.bitLength()%26;for(0===start&&(start=26),i=num.length-1;0<=i;i--){for(var word=num.words[i],j=start-1;0<=j;j--){var bit=word>>j&1;res!==wnd[0]&&(res=this.sqr(res)),0==bit&&0===current?currentLen=0:(current=current<<1|bit,(4===++currentLen||0===i&&0===j)&&(res=this.mul(res,wnd[current]),current=currentLen=0))}start=26}return res},Red.prototype.convertTo=function(num){var r=num.umod(this.m);return r===num?r.clone():r},Red.prototype.convertFrom=function(num){num=num.clone();return num.red=null,num},BN.mont=function(num){return new Mont(num)},inherits(Mont,Red),Mont.prototype.convertTo=function(num){return this.imod(num.ushln(this.shift))},Mont.prototype.convertFrom=function(num){num=this.imod(num.mul(this.rinv));return num.red=null,num},Mont.prototype.imul=function(a,b){if(a.isZero()||b.isZero())return a.words[0]=0,a.length=1,a;a=a.imul(b),b=a.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),a=a.isub(b).iushrn(this.shift),b=a;return 0<=a.cmp(this.m)?b=a.isub(this.m):a.cmpn(0)<0&&(b=a.iadd(this.m)),b._forceRed(this)},Mont.prototype.mul=function(a,b){if(a.isZero()||b.isZero())return new BN(0)._forceRed(this);a=a.mul(b),b=a.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),a=a.isub(b).iushrn(this.shift),b=a;return 0<=a.cmp(this.m)?b=a.isub(this.m):a.cmpn(0)<0&&(b=a.iadd(this.m)),b._forceRed(this)},Mont.prototype.invm=function(a){return this.imod(a._invmp(this.m).mul(this.r2))._forceRed(this)}}(void 0===module||module,this)},{buffer:68}],67:[function(require,module,exports){var r;function Rand(rand){this.rand=rand}if(module.exports=function(len){return(r=r||new Rand(null)).generate(len)},(module.exports.Rand=Rand).prototype.generate=function(len){return this._rand(len)},Rand.prototype._rand=function(n){if(this.rand.getBytes)return this.rand.getBytes(n);for(var res=new Uint8Array(n),i=0;i<res.length;i++)res[i]=this.rand.getByte();return res},"object"==typeof self)self.crypto&&self.crypto.getRandomValues?Rand.prototype._rand=function(n){n=new Uint8Array(n);return self.crypto.getRandomValues(n),n}:self.msCrypto&&self.msCrypto.getRandomValues?Rand.prototype._rand=function(n){n=new Uint8Array(n);return self.msCrypto.getRandomValues(n),n}:"object"==typeof window&&(Rand.prototype._rand=function(){throw new Error("Not implemented yet")});else try{var crypto=require("crypto");if("function"!=typeof crypto.randomBytes)throw new Error("Not supported");Rand.prototype._rand=function(n){return crypto.randomBytes(n)}}catch(e){}},{crypto:68}],68:[function(require,module,exports){},{}],69:[function(require,module,exports){var Buffer=require("safe-buffer").Buffer;function asUInt32Array(buf){for(var len=(buf=Buffer.isBuffer(buf)?buf:Buffer.from(buf)).length/4|0,out=new Array(len),i=0;i<len;i++)out[i]=buf.readUInt32BE(4*i);return out}function scrubVec(v){for(;0<v.length;v++)v[0]=0}function cryptBlock(M,keySchedule,SUB_MIX,SBOX,nRounds){for(var t0,t1,t2,t3,SUB_MIX0=SUB_MIX[0],SUB_MIX1=SUB_MIX[1],SUB_MIX2=SUB_MIX[2],SUB_MIX3=SUB_MIX[3],s0=M[0]^keySchedule[0],s1=M[1]^keySchedule[1],s2=M[2]^keySchedule[2],s3=M[3]^keySchedule[3],ksRow=4,round=1;round<nRounds;round++)t0=SUB_MIX0[s0>>>24]^SUB_MIX1[s1>>>16&255]^SUB_MIX2[s2>>>8&255]^SUB_MIX3[255&s3]^keySchedule[ksRow++],t1=SUB_MIX0[s1>>>24]^SUB_MIX1[s2>>>16&255]^SUB_MIX2[s3>>>8&255]^SUB_MIX3[255&s0]^keySchedule[ksRow++],t2=SUB_MIX0[s2>>>24]^SUB_MIX1[s3>>>16&255]^SUB_MIX2[s0>>>8&255]^SUB_MIX3[255&s1]^keySchedule[ksRow++],t3=SUB_MIX0[s3>>>24]^SUB_MIX1[s0>>>16&255]^SUB_MIX2[s1>>>8&255]^SUB_MIX3[255&s2]^keySchedule[ksRow++],s0=t0,s1=t1,s2=t2,s3=t3;return t0=(SBOX[s0>>>24]<<24|SBOX[s1>>>16&255]<<16|SBOX[s2>>>8&255]<<8|SBOX[255&s3])^keySchedule[ksRow++],t1=(SBOX[s1>>>24]<<24|SBOX[s2>>>16&255]<<16|SBOX[s3>>>8&255]<<8|SBOX[255&s0])^keySchedule[ksRow++],t2=(SBOX[s2>>>24]<<24|SBOX[s3>>>16&255]<<16|SBOX[s0>>>8&255]<<8|SBOX[255&s1])^keySchedule[ksRow++],t3=(SBOX[s3>>>24]<<24|SBOX[s0>>>16&255]<<16|SBOX[s1>>>8&255]<<8|SBOX[255&s2])^keySchedule[ksRow++],[t0>>>=0,t1>>>=0,t2>>>=0,t3>>>=0]}var RCON=[0,1,2,4,8,16,32,64,128,27,54],G=function(){for(var d=new Array(256),j=0;j<256;j++)d[j]=j<128?j<<1:j<<1^283;for(var SBOX=[],INV_SBOX=[],SUB_MIX=[[],[],[],[]],INV_SUB_MIX=[[],[],[],[]],x=0,xi=0,i=0;i<256;++i){var sx=xi^xi<<1^xi<<2^xi<<3^xi<<4,x2=(SBOX[x]=sx=sx>>>8^255&sx^99,d[INV_SBOX[sx]=x]),x4=d[x2],x8=d[x4],t=257*d[sx]^16843008*sx;SUB_MIX[0][x]=t<<24|t>>>8,SUB_MIX[1][x]=t<<16|t>>>16,SUB_MIX[2][x]=t<<8|t>>>24,SUB_MIX[3][x]=t,INV_SUB_MIX[0][sx]=(t=16843009*x8^65537*x4^257*x2^16843008*x)<<24|t>>>8,INV_SUB_MIX[1][sx]=t<<16|t>>>16,INV_SUB_MIX[2][sx]=t<<8|t>>>24,INV_SUB_MIX[3][sx]=t,0===x?x=xi=1:(x=x2^d[d[d[x8^x2]]],xi^=d[d[xi]])}return{SBOX:SBOX,INV_SBOX:INV_SBOX,SUB_MIX:SUB_MIX,INV_SUB_MIX:INV_SUB_MIX}}();function AES(key){this._key=asUInt32Array(key),this._reset()}AES.blockSize=16,AES.keySize=32,AES.prototype.blockSize=AES.blockSize,AES.prototype.keySize=AES.keySize,AES.prototype._reset=function(){for(var keyWords=this._key,keySize=keyWords.length,nRounds=keySize+6,ksRows=4*(nRounds+1),keySchedule=[],k=0;k<keySize;k++)keySchedule[k]=keyWords[k];for(k=keySize;k<ksRows;k++){var t=keySchedule[k-1];k%keySize==0?(t=G.SBOX[(t=t<<8|t>>>24)>>>24]<<24|G.SBOX[t>>>16&255]<<16|G.SBOX[t>>>8&255]<<8|G.SBOX[255&t],t^=RCON[k/keySize|0]<<24):6<keySize&&k%keySize==4&&(t=G.SBOX[t>>>24]<<24|G.SBOX[t>>>16&255]<<16|G.SBOX[t>>>8&255]<<8|G.SBOX[255&t]),keySchedule[k]=keySchedule[k-keySize]^t}for(var invKeySchedule=[],ik=0;ik<ksRows;ik++){var ksR=ksRows-ik,tt=keySchedule[ksR-(ik%4?0:4)];invKeySchedule[ik]=ik<4||ksR<=4?tt:G.INV_SUB_MIX[0][G.SBOX[tt>>>24]]^G.INV_SUB_MIX[1][G.SBOX[tt>>>16&255]]^G.INV_SUB_MIX[2][G.SBOX[tt>>>8&255]]^G.INV_SUB_MIX[3][G.SBOX[255&tt]]}this._nRounds=nRounds,this._keySchedule=keySchedule,this._invKeySchedule=invKeySchedule},AES.prototype.encryptBlockRaw=function(M){return cryptBlock(M=asUInt32Array(M),this._keySchedule,G.SUB_MIX,G.SBOX,this._nRounds)},AES.prototype.encryptBlock=function(M){var M=this.encryptBlockRaw(M),buf=Buffer.allocUnsafe(16);return buf.writeUInt32BE(M[0],0),buf.writeUInt32BE(M[1],4),buf.writeUInt32BE(M[2],8),buf.writeUInt32BE(M[3],12),buf},AES.prototype.decryptBlock=function(M){var m1=(M=asUInt32Array(M))[1],m1=(M[1]=M[3],M[3]=m1,cryptBlock(M,this._invKeySchedule,G.INV_SUB_MIX,G.INV_SBOX,this._nRounds)),M=Buffer.allocUnsafe(16);return M.writeUInt32BE(m1[0],0),M.writeUInt32BE(m1[3],4),M.writeUInt32BE(m1[2],8),M.writeUInt32BE(m1[1],12),M},AES.prototype.scrub=function(){scrubVec(this._keySchedule),scrubVec(this._invKeySchedule),scrubVec(this._key)},module.exports.AES=AES},{"safe-buffer":367}],70:[function(require,module,exports){var aes=require("./aes"),Buffer=require("safe-buffer").Buffer,Transform=require("cipher-base"),inherits=require("inherits"),GHASH=require("./ghash"),xor=require("buffer-xor"),incr32=require("./incr32");function StreamCipher(mode,key,iv,decrypt){Transform.call(this);var h=Buffer.alloc(4,0),key=(this._cipher=new aes.AES(key),this._cipher.encryptBlock(h));this._ghash=new GHASH(key),iv=function(self,iv,ck){if(12===iv.length)return self._finID=Buffer.concat([iv,Buffer.from([0,0,0,1])]),Buffer.concat([iv,Buffer.from([0,0,0,2])]);var ck=new GHASH(ck),toPad=(len=iv.length)%16,iv=(ck.update(iv),toPad&&ck.update(Buffer.alloc(16-toPad,0)),ck.update(Buffer.alloc(8,0)),8*len),len=((toPad=Buffer.alloc(8)).writeUIntBE(iv,0,8),ck.update(toPad),self._finID=ck.state,Buffer.from(self._finID));return incr32(len),len}(this,iv,key),this._prev=Buffer.from(iv),this._cache=Buffer.allocUnsafe(0),this._secCache=Buffer.allocUnsafe(0),this._decrypt=decrypt,this._alen=0,this._len=0,this._mode=mode,this._authTag=null,this._called=!1}inherits(StreamCipher,Transform),StreamCipher.prototype._update=function(chunk){!this._called&&this._alen&&(rump=16-this._alen%16)<16&&(rump=Buffer.alloc(rump,0),this._ghash.update(rump)),this._called=!0;var rump=this._mode.encrypt(this,chunk);return this._decrypt?this._ghash.update(chunk):this._ghash.update(rump),this._len+=chunk.length,rump},StreamCipher.prototype._final=function(){if(this._decrypt&&!this._authTag)throw new Error("Unsupported state or unable to authenticate data");var tag=xor(this._ghash.final(8*this._alen,8*this._len),this._cipher.encryptBlock(this._finID));if(this._decrypt&&function(a,b){for(var out=0,len=(a.length!==b.length&&out++,Math.min(a.length,b.length)),i=0;i<len;++i)out+=a[i]^b[i];return out}(tag,this._authTag))throw new Error("Unsupported state or unable to authenticate data");this._authTag=tag,this._cipher.scrub()},StreamCipher.prototype.getAuthTag=function(){if(this._decrypt||!Buffer.isBuffer(this._authTag))throw new Error("Attempting to get auth tag in unsupported state");return this._authTag},StreamCipher.prototype.setAuthTag=function(tag){if(!this._decrypt)throw new Error("Attempting to set auth tag in unsupported state");this._authTag=tag},StreamCipher.prototype.setAAD=function(buf){if(this._called)throw new Error("Attempting to set AAD in unsupported state");this._ghash.update(buf),this._alen+=buf.length},module.exports=StreamCipher},{"./aes":69,"./ghash":74,"./incr32":75,"buffer-xor":131,"cipher-base":136,inherits:220,"safe-buffer":367}],71:[function(require,module,exports){var ciphers=require("./encrypter"),deciphers=require("./decrypter"),modes=require("./modes/list.json");exports.createCipher=exports.Cipher=ciphers.createCipher,exports.createCipheriv=exports.Cipheriv=ciphers.createCipheriv,exports.createDecipher=exports.Decipher=deciphers.createDecipher,exports.createDecipheriv=exports.Decipheriv=deciphers.createDecipheriv,exports.listCiphers=exports.getCiphers=function(){return Object.keys(modes)}},{"./decrypter":72,"./encrypter":73,"./modes/list.json":83}],72:[function(require,module,exports){var AuthCipher=require("./authCipher"),Buffer=require("safe-buffer").Buffer,MODES=require("./modes"),StreamCipher=require("./streamCipher"),Transform=require("cipher-base"),aes=require("./aes"),ebtk=require("evp_bytestokey");function Decipher(mode,key,iv){Transform.call(this),this._cache=new Splitter,this._last=void 0,this._cipher=new aes.AES(key),this._prev=Buffer.from(iv),this._mode=mode,this._autopadding=!0}function Splitter(){this.cache=Buffer.allocUnsafe(0)}function createDecipheriv(suite,password,iv){suite=MODES[suite.toLowerCase()];if(!suite)throw new TypeError("invalid suite type");if("string"==typeof iv&&(iv=Buffer.from(iv)),"GCM"!==suite.mode&&iv.length!==suite.iv)throw new TypeError("invalid iv length "+iv.length);if((password="string"==typeof password?Buffer.from(password):password).length!==suite.key/8)throw new TypeError("invalid key length "+password.length);return"stream"===suite.type?new StreamCipher(suite.module,password,iv,!0):"auth"===suite.type?new AuthCipher(suite.module,password,iv,!0):new Decipher(suite.module,password,iv)}require("inherits")(Decipher,Transform),Decipher.prototype._update=function(data){this._cache.add(data);for(var chunk,out=[];chunk=this._cache.get(this._autopadding);)chunk=this._mode.decrypt(this,chunk),out.push(chunk);return Buffer.concat(out)},Decipher.prototype._final=function(){var chunk=this._cache.flush();if(this._autopadding){var last=this._mode.decrypt(this,chunk),padded=last[15];if(padded<1||16<padded)throw new Error("unable to decrypt data");for(var i=-1;++i<padded;)if(last[i+(16-padded)]!==padded)throw new Error("unable to decrypt data");if(16!==padded)return last.slice(0,16-padded)}else if(chunk)throw new Error("data not multiple of block length")},Decipher.prototype.setAutoPadding=function(setTo){return this._autopadding=!!setTo,this},Splitter.prototype.add=function(data){this.cache=Buffer.concat([this.cache,data])},Splitter.prototype.get=function(autoPadding){var out;if(autoPadding){if(16<this.cache.length)return out=this.cache.slice(0,16),this.cache=this.cache.slice(16),out}else if(16<=this.cache.length)return out=this.cache.slice(0,16),this.cache=this.cache.slice(16),out;return null},Splitter.prototype.flush=function(){if(this.cache.length)return this.cache},exports.createDecipher=function(suite,password){var config=MODES[suite.toLowerCase()];if(config)return password=ebtk(password,!1,config.key,config.iv),createDecipheriv(suite,password.key,password.iv);throw new TypeError("invalid suite type")},exports.createDecipheriv=createDecipheriv},{"./aes":69,"./authCipher":70,"./modes":82,"./streamCipher":85,"cipher-base":136,evp_bytestokey:179,inherits:220,"safe-buffer":367}],73:[function(require,module,exports){var MODES=require("./modes"),AuthCipher=require("./authCipher"),Buffer=require("safe-buffer").Buffer,StreamCipher=require("./streamCipher"),Transform=require("cipher-base"),aes=require("./aes"),ebtk=require("evp_bytestokey");function Cipher(mode,key,iv){Transform.call(this),this._cache=new Splitter,this._cipher=new aes.AES(key),this._prev=Buffer.from(iv),this._mode=mode,this._autopadding=!0}require("inherits")(Cipher,Transform),Cipher.prototype._update=function(data){this._cache.add(data);for(var chunk,out=[];chunk=this._cache.get();)chunk=this._mode.encrypt(this,chunk),out.push(chunk);return Buffer.concat(out)};var PADDING=Buffer.alloc(16,16);function Splitter(){this.cache=Buffer.allocUnsafe(0)}function createCipheriv(suite,password,iv){suite=MODES[suite.toLowerCase()];if(!suite)throw new TypeError("invalid suite type");if((password="string"==typeof password?Buffer.from(password):password).length!==suite.key/8)throw new TypeError("invalid key length "+password.length);if("string"==typeof iv&&(iv=Buffer.from(iv)),"GCM"!==suite.mode&&iv.length!==suite.iv)throw new TypeError("invalid iv length "+iv.length);return new("stream"===suite.type?StreamCipher:"auth"===suite.type?AuthCipher:Cipher)(suite.module,password,iv)}Cipher.prototype._final=function(){var chunk=this._cache.flush();if(this._autopadding)return chunk=this._mode.encrypt(this,chunk),this._cipher.scrub(),chunk;if(!chunk.equals(PADDING))throw this._cipher.scrub(),new Error("data not multiple of block length")},Cipher.prototype.setAutoPadding=function(setTo){return this._autopadding=!!setTo,this},Splitter.prototype.add=function(data){this.cache=Buffer.concat([this.cache,data])},Splitter.prototype.get=function(){var out;return 15<this.cache.length?(out=this.cache.slice(0,16),this.cache=this.cache.slice(16),out):null},Splitter.prototype.flush=function(){for(var len=16-this.cache.length,padBuff=Buffer.allocUnsafe(len),i=-1;++i<len;)padBuff.writeUInt8(len,i);return Buffer.concat([this.cache,padBuff])},exports.createCipheriv=createCipheriv,exports.createCipher=function(suite,password){var config=MODES[suite.toLowerCase()];if(config)return password=ebtk(password,!1,config.key,config.iv),createCipheriv(suite,password.key,password.iv);throw new TypeError("invalid suite type")}},{"./aes":69,"./authCipher":70,"./modes":82,"./streamCipher":85,"cipher-base":136,evp_bytestokey:179,inherits:220,"safe-buffer":367}],74:[function(require,module,exports){var Buffer=require("safe-buffer").Buffer,ZEROES=Buffer.alloc(16,0);function fromArray(out){var buf=Buffer.allocUnsafe(16);return buf.writeUInt32BE(out[0]>>>0,0),buf.writeUInt32BE(out[1]>>>0,4),buf.writeUInt32BE(out[2]>>>0,8),buf.writeUInt32BE(out[3]>>>0,12),buf}function GHASH(key){this.h=key,this.state=Buffer.alloc(16,0),this.cache=Buffer.allocUnsafe(0)}GHASH.prototype.ghash=function(block){for(var i=-1;++i<block.length;)this.state[i]^=block[i];this._multiply()},GHASH.prototype._multiply=function(){for(var buf,j,lsbVi,Vi=[(buf=this.h).readUInt32BE(0),buf.readUInt32BE(4),buf.readUInt32BE(8),buf.readUInt32BE(12)],Zi=[0,0,0,0],i=-1;++i<128;){for(0!=(this.state[~~(i/8)]&1<<7-i%8)&&(Zi[0]^=Vi[0],Zi[1]^=Vi[1],Zi[2]^=Vi[2],Zi[3]^=Vi[3]),lsbVi=0!=(1&Vi[3]),j=3;0<j;j--)Vi[j]=Vi[j]>>>1|(1&Vi[j-1])<<31;Vi[0]=Vi[0]>>>1,lsbVi&&(Vi[0]=Vi[0]^225<<24)}this.state=fromArray(Zi)},GHASH.prototype.update=function(buf){var chunk;for(this.cache=Buffer.concat([this.cache,buf]);16<=this.cache.length;)chunk=this.cache.slice(0,16),this.cache=this.cache.slice(16),this.ghash(chunk)},GHASH.prototype.final=function(abl,bl){return this.cache.length&&this.ghash(Buffer.concat([this.cache,ZEROES],16)),this.ghash(fromArray([0,abl,0,bl])),this.state},module.exports=GHASH},{"safe-buffer":367}],75:[function(require,module,exports){module.exports=function(iv){for(var item,len=iv.length;len--;){if(255!==(item=iv.readUInt8(len))){item++,iv.writeUInt8(item,len);break}iv.writeUInt8(0,len)}}},{}],76:[function(require,module,exports){var xor=require("buffer-xor");exports.encrypt=function(self,block){block=xor(block,self._prev);return self._prev=self._cipher.encryptBlock(block),self._prev},exports.decrypt=function(self,block){var pad=self._prev,self=(self._prev=block,self._cipher.decryptBlock(block));return xor(self,pad)}},{"buffer-xor":131}],77:[function(require,module,exports){var Buffer=require("safe-buffer").Buffer,xor=require("buffer-xor");function encryptStart(self,data,decrypt){var len=data.length,out=xor(data,self._cache);return self._cache=self._cache.slice(len),self._prev=Buffer.concat([self._prev,decrypt?data:out]),out}exports.encrypt=function(self,data,decrypt){for(var len,out=Buffer.allocUnsafe(0);data.length;){if(0===self._cache.length&&(self._cache=self._cipher.encryptBlock(self._prev),self._prev=Buffer.allocUnsafe(0)),!(self._cache.length<=data.length)){out=Buffer.concat([out,encryptStart(self,data,decrypt)]);break}len=self._cache.length,out=Buffer.concat([out,encryptStart(self,data.slice(0,len),decrypt)]),data=data.slice(len)}return out}},{"buffer-xor":131,"safe-buffer":367}],78:[function(require,module,exports){var Buffer=require("safe-buffer").Buffer;function encryptByte(self,byteParam,decrypt){for(var bit,value,i=-1,out=0;++i<8;)out+=(128&(value=self._cipher.encryptBlock(self._prev)[0]^(bit=byteParam&1<<7-i?128:0)))>>i%8,self._prev=function(buffer,value){var len=buffer.length,i=-1,out=Buffer.allocUnsafe(buffer.length);buffer=Buffer.concat([buffer,Buffer.from([value])]);for(;++i<len;)out[i]=buffer[i]<<1|buffer[i+1]>>7;return out}(self._prev,decrypt?bit:value);return out}exports.encrypt=function(self,chunk,decrypt){for(var len=chunk.length,out=Buffer.allocUnsafe(len),i=-1;++i<len;)out[i]=encryptByte(self,chunk[i],decrypt);return out}},{"safe-buffer":367}],79:[function(require,module,exports){var Buffer=require("safe-buffer").Buffer;exports.encrypt=function(self,chunk,decrypt){for(var len=chunk.length,out=Buffer.allocUnsafe(len),i=-1;++i<len;)out[i]=function(self,byteParam,decrypt){var out=self._cipher.encryptBlock(self._prev)[0]^byteParam;return self._prev=Buffer.concat([self._prev.slice(1),Buffer.from([decrypt?byteParam:out])]),out}(self,chunk[i],decrypt);return out}},{"safe-buffer":367}],80:[function(require,module,exports){var xor=require("buffer-xor"),Buffer=require("safe-buffer").Buffer,incr32=require("../incr32");exports.encrypt=function(self,chunk){var chunkNum=Math.ceil(chunk.length/16),start=self._cache.length;self._cache=Buffer.concat([self._cache,Buffer.allocUnsafe(16*chunkNum)]);for(var i=0;i<chunkNum;i++){var out=function(self){var out=self._cipher.encryptBlockRaw(self._prev);return incr32(self._prev),out}(self),offset=start+16*i;self._cache.writeUInt32BE(out[0],offset+0),self._cache.writeUInt32BE(out[1],offset+4),self._cache.writeUInt32BE(out[2],offset+8),self._cache.writeUInt32BE(out[3],offset+12)}var pad=self._cache.slice(0,chunk.length);return self._cache=self._cache.slice(chunk.length),xor(chunk,pad)}},{"../incr32":75,"buffer-xor":131,"safe-buffer":367}],81:[function(require,module,exports){exports.encrypt=function(self,block){return self._cipher.encryptBlock(block)},exports.decrypt=function(self,block){return self._cipher.decryptBlock(block)}},{}],82:[function(require,module,exports){var key,modeModules={ECB:require("./ecb"),CBC:require("./cbc"),CFB:require("./cfb"),CFB8:require("./cfb8"),CFB1:require("./cfb1"),OFB:require("./ofb"),CTR:require("./ctr"),GCM:require("./ctr")},modes=require("./list.json");for(key in modes)modes[key].module=modeModules[modes[key].mode];module.exports=modes},{"./cbc":76,"./cfb":77,"./cfb1":78,"./cfb8":79,"./ctr":80,"./ecb":81,"./list.json":83,"./ofb":84}],83:[function(require,module,exports){module.exports={"aes-128-ecb":{cipher:"AES",key:128,iv:0,mode:"ECB",type:"block"},"aes-192-ecb":{cipher:"AES",key:192,iv:0,mode:"ECB",type:"block"},"aes-256-ecb":{cipher:"AES",key:256,iv:0,mode:"ECB",type:"block"},"aes-128-cbc":{cipher:"AES",key:128,iv:16,mode:"CBC",type:"block"},"aes-192-cbc":{cipher:"AES",key:192,iv:16,mode:"CBC",type:"block"},"aes-256-cbc":{cipher:"AES",key:256,iv:16,mode:"CBC",type:"block"},aes128:{cipher:"AES",key:128,iv:16,mode:"CBC",type:"block"},aes192:{cipher:"AES",key:192,iv:16,mode:"CBC",type:"block"},aes256:{cipher:"AES",key:256,iv:16,mode:"CBC",type:"block"},"aes-128-cfb":{cipher:"AES",key:128,iv:16,mode:"CFB",type:"stream"},"aes-192-cfb":{cipher:"AES",key:192,iv:16,mode:"CFB",type:"stream"},"aes-256-cfb":{cipher:"AES",key:256,iv:16,mode:"CFB",type:"stream"},"aes-128-cfb8":{cipher:"AES",key:128,iv:16,mode:"CFB8",type:"stream"},"aes-192-cfb8":{cipher:"AES",key:192,iv:16,mode:"CFB8",type:"stream"},"aes-256-cfb8":{cipher:"AES",key:256,iv:16,mode:"CFB8",type:"stream"},"aes-128-cfb1":{cipher:"AES",key:128,iv:16,mode:"CFB1",type:"stream"},"aes-192-cfb1":{cipher:"AES",key:192,iv:16,mode:"CFB1",type:"stream"},"aes-256-cfb1":{cipher:"AES",key:256,iv:16,mode:"CFB1",type:"stream"},"aes-128-ofb":{cipher:"AES",key:128,iv:16,mode:"OFB",type:"stream"},"aes-192-ofb":{cipher:"AES",key:192,iv:16,mode:"OFB",type:"stream"},"aes-256-ofb":{cipher:"AES",key:256,iv:16,mode:"OFB",type:"stream"},"aes-128-ctr":{cipher:"AES",key:128,iv:16,mode:"CTR",type:"stream"},"aes-192-ctr":{cipher:"AES",key:192,iv:16,mode:"CTR",type:"stream"},"aes-256-ctr":{cipher:"AES",key:256,iv:16,mode:"CTR",type:"stream"},"aes-128-gcm":{cipher:"AES",key:128,iv:12,mode:"GCM",type:"auth"},"aes-192-gcm":{cipher:"AES",key:192,iv:12,mode:"GCM",type:"auth"},"aes-256-gcm":{cipher:"AES",key:256,iv:12,mode:"GCM",type:"auth"}}},{}],84:[function(require,module,exports){!function(Buffer){!function(){var xor=require("buffer-xor");exports.encrypt=function(self,chunk){for(;self._cache.length<chunk.length;)self._cache=Buffer.concat([self._cache,function(self){return self._prev=self._cipher.encryptBlock(self._prev),self._prev}(self)]);var pad=self._cache.slice(0,chunk.length);return self._cache=self._cache.slice(chunk.length),xor(chunk,pad)}}.call(this)}.call(this,require("buffer").Buffer)},{buffer:112,"buffer-xor":131}],85:[function(require,module,exports){var aes=require("./aes"),Buffer=require("safe-buffer").Buffer,Transform=require("cipher-base");function StreamCipher(mode,key,iv,decrypt){Transform.call(this),this._cipher=new aes.AES(key),this._prev=Buffer.from(iv),this._cache=Buffer.allocUnsafe(0),this._secCache=Buffer.allocUnsafe(0),this._decrypt=decrypt,this._mode=mode}require("inherits")(StreamCipher,Transform),StreamCipher.prototype._update=function(chunk){return this._mode.encrypt(this,chunk,this._decrypt)},StreamCipher.prototype._final=function(){this._cipher.scrub()},module.exports=StreamCipher},{"./aes":69,"cipher-base":136,inherits:220,"safe-buffer":367}],86:[function(require,module,exports){var DES=require("browserify-des"),aes=require("browserify-aes/browser"),aesModes=require("browserify-aes/modes"),desModes=require("browserify-des/modes"),ebtk=require("evp_bytestokey");function createCipheriv(suite,key,iv){if(suite=suite.toLowerCase(),aesModes[suite])return aes.createCipheriv(suite,key,iv);if(desModes[suite])return new DES({key:key,iv:iv,mode:suite});throw new TypeError("invalid suite type")}function createDecipheriv(suite,key,iv){if(suite=suite.toLowerCase(),aesModes[suite])return aes.createDecipheriv(suite,key,iv);if(desModes[suite])return new DES({key:key,iv:iv,mode:suite,decrypt:!0});throw new TypeError("invalid suite type")}exports.createCipher=exports.Cipher=function(suite,password){var keyLen,ivLen;if(suite=suite.toLowerCase(),aesModes[suite])keyLen=aesModes[suite].key,ivLen=aesModes[suite].iv;else{if(!desModes[suite])throw new TypeError("invalid suite type");keyLen=8*desModes[suite].key,ivLen=desModes[suite].iv}return password=ebtk(password,!1,keyLen,ivLen),createCipheriv(suite,password.key,password.iv)},exports.createCipheriv=exports.Cipheriv=createCipheriv,exports.createDecipher=exports.Decipher=function(suite,password){var keyLen,ivLen;if(suite=suite.toLowerCase(),aesModes[suite])keyLen=aesModes[suite].key,ivLen=aesModes[suite].iv;else{if(!desModes[suite])throw new TypeError("invalid suite type");keyLen=8*desModes[suite].key,ivLen=desModes[suite].iv}return password=ebtk(password,!1,keyLen,ivLen),createDecipheriv(suite,password.key,password.iv)},exports.createDecipheriv=exports.Decipheriv=createDecipheriv,exports.listCiphers=exports.getCiphers=function(){return Object.keys(desModes).concat(aes.getCiphers())}},{"browserify-aes/browser":71,"browserify-aes/modes":82,"browserify-des":87,"browserify-des/modes":88,evp_bytestokey:179}],87:[function(require,module,exports){var CipherBase=require("cipher-base"),des=require("des.js"),inherits=require("inherits"),Buffer=require("safe-buffer").Buffer,modes={"des-ede3-cbc":des.CBC.instantiate(des.EDE),"des-ede3":des.EDE,"des-ede-cbc":des.CBC.instantiate(des.EDE),"des-ede":des.EDE,"des-cbc":des.CBC.instantiate(des.DES),"des-ecb":des.DES};function DES(opts){CipherBase.call(this);var modeName=opts.mode.toLowerCase(),mode=modes[modeName],type=opts.decrypt?"decrypt":"encrypt",key=opts.key,modeName=(Buffer.isBuffer(key)||(key=Buffer.from(key)),"des-ede"!==modeName&&"des-ede-cbc"!==modeName||(key=Buffer.concat([key,key.slice(0,8)])),opts.iv);Buffer.isBuffer(modeName)||(modeName=Buffer.from(modeName)),this._des=mode.create({key:key,iv:modeName,type:type})}modes.des=modes["des-cbc"],modes.des3=modes["des-ede3-cbc"],inherits(module.exports=DES,CipherBase),DES.prototype._update=function(data){return Buffer.from(this._des.update(data))},DES.prototype._final=function(){return Buffer.from(this._des.final())}},{"cipher-base":136,"des.js":148,inherits:220,"safe-buffer":367}],88:[function(require,module,exports){exports["des-ecb"]={key:8,iv:0},exports["des-cbc"]=exports.des={key:8,iv:8},exports["des-ede3-cbc"]=exports.des3={key:24,iv:8},exports["des-ede3"]={key:24,iv:0},exports["des-ede-cbc"]={key:16,iv:8},exports["des-ede"]={key:16,iv:0}},{}],89:[function(require,module,exports){!function(Buffer){!function(){var BN=require("bn.js"),randomBytes=require("randombytes");function getr(priv){for(var r,len=priv.modulus.byteLength();0<=(r=new BN(randomBytes(len))).cmp(priv.modulus)||!r.umod(priv.prime1)||!r.umod(priv.prime2););return r}function crt(msg,priv){var blinds=function(priv){var r=getr(priv);return{blinder:r.toRed(BN.mont(priv.modulus)).redPow(new BN(priv.publicExponent)).fromRed(),unblinder:r.invm(priv.modulus)}}(priv),len=priv.modulus.byteLength(),msg=new BN(msg).mul(blinds.blinder).umod(priv.modulus),c1=msg.toRed(BN.mont(priv.prime1)),msg=msg.toRed(BN.mont(priv.prime2)),qinv=priv.coefficient,p=priv.prime1,q=priv.prime2,c1=c1.redPow(priv.exponent1).fromRed(),msg=msg.redPow(priv.exponent2).fromRed(),c1=c1.isub(msg).imul(qinv).umod(p).imul(q);return msg.iadd(c1).imul(blinds.unblinder).umod(priv.modulus).toArrayLike(Buffer,"be",len)}crt.getr=getr,module.exports=crt}.call(this)}.call(this,require("buffer").Buffer)},{"bn.js":66,buffer:112,randombytes:363}],90:[function(require,module,exports){module.exports=require("./browser/algorithms.json")},{"./browser/algorithms.json":91}],91:[function(require,module,exports){module.exports={sha224WithRSAEncryption:{sign:"rsa",hash:"sha224",id:"302d300d06096086480165030402040500041c"},"RSA-SHA224":{sign:"ecdsa/rsa",hash:"sha224",id:"302d300d06096086480165030402040500041c"},sha256WithRSAEncryption:{sign:"rsa",hash:"sha256",id:"3031300d060960864801650304020105000420"},"RSA-SHA256":{sign:"ecdsa/rsa",hash:"sha256",id:"3031300d060960864801650304020105000420"},sha384WithRSAEncryption:{sign:"rsa",hash:"sha384",id:"3041300d060960864801650304020205000430"},"RSA-SHA384":{sign:"ecdsa/rsa",hash:"sha384",id:"3041300d060960864801650304020205000430"},sha512WithRSAEncryption:{sign:"rsa",hash:"sha512",id:"3051300d060960864801650304020305000440"},"RSA-SHA512":{sign:"ecdsa/rsa",hash:"sha512",id:"3051300d060960864801650304020305000440"},"RSA-SHA1":{sign:"rsa",hash:"sha1",id:"3021300906052b0e03021a05000414"},"ecdsa-with-SHA1":{sign:"ecdsa",hash:"sha1",id:""},sha256:{sign:"ecdsa",hash:"sha256",id:""},sha224:{sign:"ecdsa",hash:"sha224",id:""},sha384:{sign:"ecdsa",hash:"sha384",id:""},sha512:{sign:"ecdsa",hash:"sha512",id:""},"DSA-SHA":{sign:"dsa",hash:"sha1",id:""},"DSA-SHA1":{sign:"dsa",hash:"sha1",id:""},DSA:{sign:"dsa",hash:"sha1",id:""},"DSA-WITH-SHA224":{sign:"dsa",hash:"sha224",id:""},"DSA-SHA224":{sign:"dsa",hash:"sha224",id:""},"DSA-WITH-SHA256":{sign:"dsa",hash:"sha256",id:""},"DSA-SHA256":{sign:"dsa",hash:"sha256",id:""},"DSA-WITH-SHA384":{sign:"dsa",hash:"sha384",id:""},"DSA-SHA384":{sign:"dsa",hash:"sha384",id:""},"DSA-WITH-SHA512":{sign:"dsa",hash:"sha512",id:""},"DSA-SHA512":{sign:"dsa",hash:"sha512",id:""},"DSA-RIPEMD160":{sign:"dsa",hash:"rmd160",id:""},ripemd160WithRSA:{sign:"rsa",hash:"rmd160",id:"3021300906052b2403020105000414"},"RSA-RIPEMD160":{sign:"rsa",hash:"rmd160",id:"3021300906052b2403020105000414"},md5WithRSAEncryption:{sign:"rsa",hash:"md5",id:"3020300c06082a864886f70d020505000410"},"RSA-MD5":{sign:"rsa",hash:"md5",id:"3020300c06082a864886f70d020505000410"}}},{}],92:[function(require,module,exports){module.exports={"1.3.132.0.10":"secp256k1","1.3.132.0.33":"p224","1.2.840.10045.3.1.1":"p192","1.2.840.10045.3.1.7":"p256","1.3.132.0.34":"p384","1.3.132.0.35":"p521"}},{}],93:[function(require,module,exports){var Buffer=require("safe-buffer").Buffer,createHash=require("create-hash"),stream=require("readable-stream"),inherits=require("inherits"),sign=require("./sign"),verify=require("./verify"),algorithms=require("./algorithms.json");function Sign(algorithm){stream.Writable.call(this);algorithm=algorithms[algorithm];if(!algorithm)throw new Error("Unknown message digest");this._hashType=algorithm.hash,this._hash=createHash(algorithm.hash),this._tag=algorithm.id,this._signType=algorithm.sign}function Verify(algorithm){stream.Writable.call(this);algorithm=algorithms[algorithm];if(!algorithm)throw new Error("Unknown message digest");this._hash=createHash(algorithm.hash),this._tag=algorithm.id,this._signType=algorithm.sign}function createSign(algorithm){return new Sign(algorithm)}function createVerify(algorithm){return new Verify(algorithm)}Object.keys(algorithms).forEach(function(key){algorithms[key].id=Buffer.from(algorithms[key].id,"hex"),algorithms[key.toLowerCase()]=algorithms[key]}),inherits(Sign,stream.Writable),Sign.prototype._write=function(data,_,done){this._hash.update(data),done()},Sign.prototype.update=function(data,enc){return"string"==typeof data&&(data=Buffer.from(data,enc)),this._hash.update(data),this},Sign.prototype.sign=function(key,enc){this.end();var hash=this._hash.digest(),hash=sign(hash,key,this._hashType,this._signType,this._tag);return enc?hash.toString(enc):hash},inherits(Verify,stream.Writable),Verify.prototype._write=function(data,_,done){this._hash.update(data),done()},Verify.prototype.update=function(data,enc){return"string"==typeof data&&(data=Buffer.from(data,enc)),this._hash.update(data),this},Verify.prototype.verify=function(key,sig,enc){"string"==typeof sig&&(sig=Buffer.from(sig,enc)),this.end();enc=this._hash.digest();return verify(sig,enc,key,this._signType,this._tag)},module.exports={Sign:createSign,Verify:createVerify,createSign:createSign,createVerify:createVerify}},{"./algorithms.json":91,"./sign":94,"./verify":95,"create-hash":139,inherits:220,"readable-stream":110,"safe-buffer":111}],94:[function(require,module,exports){var Buffer=require("safe-buffer").Buffer,createHmac=require("create-hmac"),crt=require("browserify-rsa"),EC=require("elliptic").ec,BN=require("bn.js"),parseKeys=require("parse-asn1"),curves=require("./curves.json");function getKey(x,q,hash,algo){(x=Buffer.from(x.toArray())).length<q.byteLength()&&(zeros=Buffer.alloc(q.byteLength()-x.length),x=Buffer.concat([zeros,x]));var zeros=hash.length,hash=function(bits,q){bits=(bits=bits2int(bits,q)).mod(q);bits=Buffer.from(bits.toArray());bits.length<q.byteLength()&&(q=Buffer.alloc(q.byteLength()-bits.length),bits=Buffer.concat([q,bits]));return bits}(hash,q),zeros=((q=Buffer.alloc(zeros)).fill(1),Buffer.alloc(zeros)),zeros=createHmac(algo,zeros).update(q).update(Buffer.from([0])).update(x).update(hash).digest(),q=createHmac(algo,zeros).update(q).digest();return{k:zeros=createHmac(algo,zeros).update(q).update(Buffer.from([1])).update(x).update(hash).digest(),v:q=createHmac(algo,zeros).update(q).digest()}}function bits2int(obits,q){var bits=new BN(obits),obits=(obits.length<<3)-q.bitLength();return 0<obits&&bits.ishrn(obits),bits}function makeKey(q,kv,algo){var t,k;do{for(t=Buffer.alloc(0);8*t.length<q.bitLength();)kv.v=createHmac(algo,kv.k).update(kv.v).digest(),t=Buffer.concat([t,kv.v])}while(k=bits2int(t,q),kv.k=createHmac(algo,kv.k).update(kv.v).update(Buffer.from([0])).digest(),kv.v=createHmac(algo,kv.k).update(kv.v).digest(),-1!==k.cmp(q));return k}module.exports=function(hash,key,hashType,signType,tag){if((key=parseKeys(key)).curve){if("ecdsa"!==signType&&"ecdsa/rsa"!==signType)throw new Error("wrong private key type");return function(hash,priv){var curveId=curves[priv.curve.join(".")];if(!curveId)throw new Error("unknown curve "+priv.curve.join("."));curveId=new EC(curveId).keyFromPrivate(priv.privateKey).sign(hash);return Buffer.from(curveId.toDER())}(hash,key)}if("dsa"===key.type){if("dsa"!==signType)throw new Error("wrong private key type");return function(hash,priv,algo){var k,x=priv.params.priv_key,p=priv.params.p,q=priv.params.q,g=priv.params.g,r=new BN(0),H=bits2int(hash,q).mod(q),s=!1,kv=getKey(x,q,hash,algo);for(;!1===s;)k=makeKey(q,kv,algo),r=function(g,k,p,q){return g.toRed(BN.mont(p)).redPow(k).fromRed().mod(q)}(g,k,p,q),0===(s=k.invm(q).imul(H.add(x.mul(r))).mod(q)).cmpn(0)&&(s=!1,r=new BN(0));return function(r,s){r=r.toArray(),s=s.toArray(),128&r[0]&&(r=[0].concat(r));128&s[0]&&(s=[0].concat(s));var res=[48,r.length+s.length+4,2,r.length];return res=res.concat(r,[2,s.length],s),Buffer.from(res)}(r,s)}(hash,key,hashType)}if("rsa"!==signType&&"ecdsa/rsa"!==signType)throw new Error("wrong private key type");hash=Buffer.concat([tag,hash]);for(var len=key.modulus.byteLength(),pad=[0,1];hash.length+pad.length+1<len;)pad.push(255);pad.push(0);for(var i=-1;++i<hash.length;)pad.push(hash[i]);return crt(pad,key)},module.exports.getKey=getKey,module.exports.makeKey=makeKey},{"./curves.json":92,"bn.js":66,"browserify-rsa":89,"create-hmac":141,elliptic:159,"parse-asn1":347,"safe-buffer":111}],95:[function(require,module,exports){var Buffer=require("safe-buffer").Buffer,BN=require("bn.js"),EC=require("elliptic").ec,parseKeys=require("parse-asn1"),curves=require("./curves.json");function checkValue(b,q){if(b.cmpn(0)<=0)throw new Error("invalid sig");if(b.cmp(q)>=q)throw new Error("invalid sig")}module.exports=function(sig,hash,key,signType,tag){if("ec"===(key=parseKeys(key)).type){if("ecdsa"!==signType&&"ecdsa/rsa"!==signType)throw new Error("wrong public key type");return function(sig,hash,pub){var curveId=curves[pub.data.algorithm.curve.join(".")];if(!curveId)throw new Error("unknown curve "+pub.data.algorithm.curve.join("."));curveId=new EC(curveId),pub=pub.data.subjectPrivateKey.data;return curveId.verify(hash,sig,pub)}(sig,hash,key)}if("dsa"===key.type){if("dsa"!==signType)throw new Error("wrong public key type");return function(sig,hash,pub){var p=pub.data.p,q=pub.data.q,g=pub.data.g,pub=pub.data.pub_key,sig=parseKeys.signature.decode(sig,"der"),s=sig.s,sig=sig.r,montp=(checkValue(s,q),checkValue(sig,q),BN.mont(p)),s=s.invm(q);return 0===g.toRed(montp).redPow(new BN(hash).mul(s).mod(q)).fromRed().mul(pub.toRed(montp).redPow(sig.mul(s).mod(q)).fromRed()).mod(p).mod(q).cmp(sig)}(sig,hash,key)}if("rsa"!==signType&&"ecdsa/rsa"!==signType)throw new Error("wrong public key type");hash=Buffer.concat([tag,hash]);for(var len=key.modulus.byteLength(),pad=[1],padNum=0;hash.length+pad.length+2<len;)pad.push(255),padNum++;pad.push(0);for(var i=-1;++i<hash.length;)pad.push(hash[i]);var pad=Buffer.from(pad),signType=BN.mont(key.modulus),out=(sig=(sig=new BN(sig).toRed(signType)).redPow(new BN(key.publicExponent)),sig=Buffer.from(sig.fromRed().toArray()),padNum<8?1:0),len=Math.min(sig.length,pad.length);for(sig.length!==pad.length&&(out=1),i=-1;++i<len;)out|=sig[i]^pad[i];return 0===out}},{"./curves.json":92,"bn.js":66,elliptic:159,"parse-asn1":347,"safe-buffer":111}],96:[function(require,module,exports){"use strict";var codes={};function createErrorType(code,message,Base){var NodeError=function(_Base){var subClass,superClass;function NodeError(arg1,arg2,arg3){return _Base.call(this,function(arg1,arg2,arg3){return"string"==typeof message?message:message(arg1,arg2,arg3)}(arg1,arg2,arg3))||this}return superClass=_Base,(subClass=NodeError).prototype=Object.create(superClass.prototype),(subClass.prototype.constructor=subClass).__proto__=superClass,NodeError}(Base=Base||Error);NodeError.prototype.name=Base.name,NodeError.prototype.code=code,codes[code]=NodeError}function oneOf(expected,thing){var len;return Array.isArray(expected)?(len=expected.length,expected=expected.map(function(i){return String(i)}),2<len?"one of ".concat(thing," ").concat(expected.slice(0,len-1).join(", "),", or ")+expected[len-1]:2===len?"one of ".concat(thing," ").concat(expected[0]," or ").concat(expected[1]):"of ".concat(thing," ").concat(expected[0])):"of ".concat(thing," ").concat(String(expected))}createErrorType("ERR_INVALID_OPT_VALUE",function(name,value){return'The value "'+value+'" is invalid for option "'+name+'"'},TypeError),createErrorType("ERR_INVALID_ARG_TYPE",function(name,expected,actual){var determiner,pos,search;return"string"==typeof expected&&(search="not ",expected.substr(!pos||pos<0?0:+pos,search.length)===search)?(determiner="must not be",expected=expected.replace(/^not /,"")):determiner="must be",search=function(str,search,this_len){return(void 0===this_len||this_len>str.length)&&(this_len=str.length),str.substring(this_len-search.length,this_len)===search}(name," argument")?"The ".concat(name," ").concat(determiner," ").concat(oneOf(expected,"type")):(pos=function(str,search,start){return!((start="number"!=typeof start?0:start)+search.length>str.length)&&-1!==str.indexOf(search,start)}(name,".")?"property":"argument",'The "'.concat(name,'" ').concat(pos," ").concat(determiner," ").concat(oneOf(expected,"type"))),search+=". Received type ".concat(typeof actual)},TypeError),createErrorType("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF"),createErrorType("ERR_METHOD_NOT_IMPLEMENTED",function(name){return"The "+name+" method is not implemented"}),createErrorType("ERR_STREAM_PREMATURE_CLOSE","Premature close"),createErrorType("ERR_STREAM_DESTROYED",function(name){return"Cannot call "+name+" after a stream was destroyed"}),createErrorType("ERR_MULTIPLE_CALLBACK","Callback called multiple times"),createErrorType("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable"),createErrorType("ERR_STREAM_WRITE_AFTER_END","write after end"),createErrorType("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),createErrorType("ERR_UNKNOWN_ENCODING",function(arg){return"Unknown encoding: "+arg},TypeError),createErrorType("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event"),module.exports.codes=codes},{}],97:[function(require,module,exports){!function(process){!function(){"use strict";var objectKeys=Object.keys||function(obj){var key,keys=[];for(key in obj)keys.push(key);return keys},Readable=(module.exports=Duplex,require("./_stream_readable")),Writable=require("./_stream_writable");require("inherits")(Duplex,Readable);for(var keys=objectKeys(Writable.prototype),v=0;v<keys.length;v++){var method=keys[v];Duplex.prototype[method]||(Duplex.prototype[method]=Writable.prototype[method])}function Duplex(options){if(!(this instanceof Duplex))return new Duplex(options);Readable.call(this,options),Writable.call(this,options),this.allowHalfOpen=!0,options&&(!1===options.readable&&(this.readable=!1),!1===options.writable&&(this.writable=!1),!1===options.allowHalfOpen&&(this.allowHalfOpen=!1,this.once("end",onend)))}function onend(){this._writableState.ended||process.nextTick(onEndNT,this)}function onEndNT(self){self.end()}Object.defineProperty(Duplex.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(Duplex.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(Duplex.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(Duplex.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed&&this._writableState.destroyed)},set:function(value){void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed=value,this._writableState.destroyed=value)}})}.call(this)}.call(this,require("_process"))},{"./_stream_readable":99,"./_stream_writable":101,_process:354,inherits:220}],98:[function(require,module,exports){"use strict";module.exports=PassThrough;var Transform=require("./_stream_transform");function PassThrough(options){if(!(this instanceof PassThrough))return new PassThrough(options);Transform.call(this,options)}require("inherits")(PassThrough,Transform),PassThrough.prototype._transform=function(chunk,encoding,cb){cb(null,chunk)}},{"./_stream_transform":100,inherits:220}],99:[function(require,module,exports){!function(process,global){!function(){"use strict";function EElistenerCount(emitter,type){return emitter.listeners(type).length}(module.exports=Readable).ReadableState=ReadableState,require("events").EventEmitter;var Duplex,Stream=require("./internal/streams/stream"),Buffer=require("buffer").Buffer,OurUint8Array=global.Uint8Array||function(){};var StringDecoder,createReadableStreamAsyncIterator,from,debugUtil=require("util"),debug=debugUtil&&debugUtil.debuglog?debugUtil.debuglog("stream"):function(){},BufferList=require("./internal/streams/buffer_list"),debugUtil=require("./internal/streams/destroy"),getHighWaterMark=require("./internal/streams/state").getHighWaterMark,_require$codes=require("../errors").codes,ERR_INVALID_ARG_TYPE=_require$codes.ERR_INVALID_ARG_TYPE,ERR_STREAM_PUSH_AFTER_EOF=_require$codes.ERR_STREAM_PUSH_AFTER_EOF,ERR_METHOD_NOT_IMPLEMENTED=_require$codes.ERR_METHOD_NOT_IMPLEMENTED,ERR_STREAM_UNSHIFT_AFTER_END_EVENT=_require$codes.ERR_STREAM_UNSHIFT_AFTER_END_EVENT,errorOrDestroy=(require("inherits")(Readable,Stream),debugUtil.errorOrDestroy),kProxyEvents=["error","close","destroy","pause","resume"];function ReadableState(options,stream,isDuplex){Duplex=Duplex||require("./_stream_duplex"),"boolean"!=typeof isDuplex&&(isDuplex=stream instanceof Duplex),this.objectMode=!!(options=options||{}).objectMode,isDuplex&&(this.objectMode=this.objectMode||!!options.readableObjectMode),this.highWaterMark=getHighWaterMark(this,options,"readableHighWaterMark",isDuplex),this.buffer=new BufferList,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=!1!==options.emitClose,this.autoDestroy=!!options.autoDestroy,this.destroyed=!1,this.defaultEncoding=options.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,options.encoding&&(StringDecoder=StringDecoder||require("string_decoder/").StringDecoder,this.decoder=new StringDecoder(options.encoding),this.encoding=options.encoding)}function Readable(options){if(Duplex=Duplex||require("./_stream_duplex"),!(this instanceof Readable))return new Readable(options);var isDuplex=this instanceof Duplex;this._readableState=new ReadableState(options,this,isDuplex),this.readable=!0,options&&("function"==typeof options.read&&(this._read=options.read),"function"==typeof options.destroy&&(this._destroy=options.destroy)),Stream.call(this)}function readableAddChunk(stream,chunk,encoding,addToFront,skipChunkCheck){debug("readableAddChunk",chunk);var er,state=stream._readableState;if(null===chunk)state.reading=!1,!function(stream,state){var chunk;debug("onEofChunk"),state.ended||(state.decoder&&(chunk=state.decoder.end())&&chunk.length&&(state.buffer.push(chunk),state.length+=state.objectMode?1:chunk.length),state.ended=!0,state.sync?emitReadable(stream):(state.needReadable=!1,state.emittedReadable||(state.emittedReadable=!0,emitReadable_(stream))))}(stream,state);else if(er=skipChunkCheck?er:function(state,chunk){var er;!function(obj){return Buffer.isBuffer(obj)||obj instanceof OurUint8Array}(chunk)&&"string"!=typeof chunk&&void 0!==chunk&&!state.objectMode&&(er=new ERR_INVALID_ARG_TYPE("chunk",["string","Buffer","Uint8Array"],chunk));return er}(state,chunk))errorOrDestroy(stream,er);else if(state.objectMode||chunk&&0<chunk.length)if("string"==typeof chunk||state.objectMode||Object.getPrototypeOf(chunk)===Buffer.prototype||(chunk=function(chunk){return Buffer.from(chunk)}(chunk)),addToFront)state.endEmitted?errorOrDestroy(stream,new ERR_STREAM_UNSHIFT_AFTER_END_EVENT):addChunk(stream,state,chunk,!0);else if(state.ended)errorOrDestroy(stream,new ERR_STREAM_PUSH_AFTER_EOF);else{if(state.destroyed)return!1;state.reading=!1,state.decoder&&!encoding?(chunk=state.decoder.write(chunk),state.objectMode||0!==chunk.length?addChunk(stream,state,chunk,!1):maybeReadMore(stream,state)):addChunk(stream,state,chunk,!1)}else addToFront||(state.reading=!1,maybeReadMore(stream,state));return!state.ended&&(state.length<state.highWaterMark||0===state.length)}function addChunk(stream,state,chunk,addToFront){state.flowing&&0===state.length&&!state.sync?(state.awaitDrain=0,stream.emit("data",chunk)):(state.length+=state.objectMode?1:chunk.length,addToFront?state.buffer.unshift(chunk):state.buffer.push(chunk),state.needReadable&&emitReadable(stream)),maybeReadMore(stream,state)}Object.defineProperty(Readable.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._readableState&&this._readableState.destroyed},set:function(value){this._readableState&&(this._readableState.destroyed=value)}}),Readable.prototype.destroy=debugUtil.destroy,Readable.prototype._undestroy=debugUtil.undestroy,Readable.prototype._destroy=function(err,cb){cb(err)},Readable.prototype.push=function(chunk,encoding){var skipChunkCheck,state=this._readableState;return state.objectMode?skipChunkCheck=!0:"string"==typeof chunk&&((encoding=encoding||state.defaultEncoding)!==state.encoding&&(chunk=Buffer.from(chunk,encoding),encoding=""),skipChunkCheck=!0),readableAddChunk(this,chunk,encoding,!1,skipChunkCheck)},Readable.prototype.unshift=function(chunk){return readableAddChunk(this,chunk,null,!0,!1)},Readable.prototype.isPaused=function(){return!1===this._readableState.flowing},Readable.prototype.setEncoding=function(enc){for(var decoder=new(StringDecoder=StringDecoder||require("string_decoder/").StringDecoder)(enc),p=(this._readableState.decoder=decoder,this._readableState.encoding=this._readableState.decoder.encoding,this._readableState.buffer.head),content="";null!==p;)content+=decoder.write(p.data),p=p.next;return this._readableState.buffer.clear(),""!==content&&this._readableState.buffer.push(content),this._readableState.length=content.length,this};var MAX_HWM=1073741824;function howMuchToRead(n,state){return n<=0||0===state.length&&state.ended?0:state.objectMode?1:n!=n?(state.flowing&&state.length?state.buffer.head.data:state).length:(n>state.highWaterMark&&(state.highWaterMark=function(n){return MAX_HWM<=n?n=MAX_HWM:(n--,n=(n=(n=(n=(n|=n>>>1)|n>>>2)|n>>>4)|n>>>8)|n>>>16,n++),n}(n)),n<=state.length?n:state.ended?state.length:(state.needReadable=!0,0))}function emitReadable(stream){var state=stream._readableState;debug("emitReadable",state.needReadable,state.emittedReadable),state.needReadable=!1,state.emittedReadable||(debug("emitReadable",state.flowing),state.emittedReadable=!0,process.nextTick(emitReadable_,stream))}function emitReadable_(stream){var state=stream._readableState;debug("emitReadable_",state.destroyed,state.length,state.ended),state.destroyed||!state.length&&!state.ended||(stream.emit("readable"),state.emittedReadable=!1),state.needReadable=!state.flowing&&!state.ended&&state.length<=state.highWaterMark,flow(stream)}function maybeReadMore(stream,state){state.readingMore||(state.readingMore=!0,process.nextTick(maybeReadMore_,stream,state))}function maybeReadMore_(stream,state){for(;!state.reading&&!state.ended&&(state.length<state.highWaterMark||state.flowing&&0===state.length);){var len=state.length;if(debug("maybeReadMore read 0"),stream.read(0),len===state.length)break}state.readingMore=!1}function updateReadableListening(self){var state=self._readableState;state.readableListening=0<self.listenerCount("readable"),state.resumeScheduled&&!state.paused?state.flowing=!0:0<self.listenerCount("data")&&self.resume()}function nReadingNextTick(self){debug("readable nexttick read 0"),self.read(0)}function resume_(stream,state){debug("resume",state.reading),state.reading||stream.read(0),state.resumeScheduled=!1,stream.emit("resume"),flow(stream),state.flowing&&!state.reading&&stream.read(0)}function flow(stream){var state=stream._readableState;for(debug("flow",state.flowing);state.flowing&&null!==stream.read(););}function fromList(n,state){return 0===state.length?null:(state.objectMode?ret=state.buffer.shift():!n||n>=state.length?(ret=state.decoder?state.buffer.join(""):1===state.buffer.length?state.buffer.first():state.buffer.concat(state.length),state.buffer.clear()):ret=state.buffer.consume(n,state.decoder),ret);var ret}function endReadable(stream){var state=stream._readableState;debug("endReadable",state.endEmitted),state.endEmitted||(state.ended=!0,process.nextTick(endReadableNT,state,stream))}function endReadableNT(state,stream){debug("endReadableNT",state.endEmitted,state.length),state.endEmitted||0!==state.length||(state.endEmitted=!0,stream.readable=!1,stream.emit("end"),state.autoDestroy&&(!(state=stream._writableState)||state.autoDestroy&&state.finished)&&stream.destroy())}function indexOf(xs,x){for(var i=0,l=xs.length;i<l;i++)if(xs[i]===x)return i;return-1}Readable.prototype.read=function(n){debug("read",n),n=parseInt(n,10);var state=this._readableState,nOrig=n;if(0!==n&&(state.emittedReadable=!1),0===n&&state.needReadable&&((0!==state.highWaterMark?state.length>=state.highWaterMark:0<state.length)||state.ended))return debug("read: emitReadable",state.length,state.ended),(0===state.length&&state.ended?endReadable:emitReadable)(this),null;if(0===(n=howMuchToRead(n,state))&&state.ended)return 0===state.length&&endReadable(this),null;var doRead=state.needReadable;return debug("need readable",doRead),(0===state.length||state.length-n<state.highWaterMark)&&debug("length less than watermark",doRead=!0),state.ended||state.reading?debug("reading or ended",doRead=!1):doRead&&(debug("do read"),state.reading=!0,state.sync=!0,0===state.length&&(state.needReadable=!0),this._read(state.highWaterMark),state.sync=!1,state.reading||(n=howMuchToRead(nOrig,state))),null===(doRead=0<n?fromList(n,state):null)?(state.needReadable=state.length<=state.highWaterMark,n=0):(state.length-=n,state.awaitDrain=0),0===state.length&&(state.ended||(state.needReadable=!0),nOrig!==n&&state.ended&&endReadable(this)),null!==doRead&&this.emit("data",doRead),doRead},Readable.prototype._read=function(n){errorOrDestroy(this,new ERR_METHOD_NOT_IMPLEMENTED("_read()"))},Readable.prototype.pipe=function(dest,pipeOpts){var src=this,state=this._readableState;switch(state.pipesCount){case 0:state.pipes=dest;break;case 1:state.pipes=[state.pipes,dest];break;default:state.pipes.push(dest)}state.pipesCount+=1,debug("pipe count=%d opts=%j",state.pipesCount,pipeOpts);pipeOpts=(!pipeOpts||!1!==pipeOpts.end)&&dest!==process.stdout&&dest!==process.stderr?onend:unpipe;function onunpipe(readable,unpipeInfo){debug("onunpipe"),readable===src&&unpipeInfo&&!1===unpipeInfo.hasUnpiped&&(unpipeInfo.hasUnpiped=!0,debug("cleanup"),dest.removeListener("close",onclose),dest.removeListener("finish",onfinish),dest.removeListener("drain",ondrain),dest.removeListener("error",onerror),dest.removeListener("unpipe",onunpipe),src.removeListener("end",onend),src.removeListener("end",unpipe),src.removeListener("data",ondata),cleanedUp=!0,!state.awaitDrain||dest._writableState&&!dest._writableState.needDrain||ondrain())}function onend(){debug("onend"),dest.end()}state.endEmitted?process.nextTick(pipeOpts):src.once("end",pipeOpts),dest.on("unpipe",onunpipe);var ondrain=function(src){return function(){var state=src._readableState;debug("pipeOnDrain",state.awaitDrain),state.awaitDrain&&state.awaitDrain--,0===state.awaitDrain&&EElistenerCount(src,"data")&&(state.flowing=!0,flow(src))}}(src),cleanedUp=(dest.on("drain",ondrain),!1);function ondata(chunk){debug("ondata");chunk=dest.write(chunk);debug("dest.write",chunk),!1===chunk&&((1===state.pipesCount&&state.pipes===dest||1<state.pipesCount&&-1!==indexOf(state.pipes,dest))&&!cleanedUp&&(debug("false write response, pause",state.awaitDrain),state.awaitDrain++),src.pause())}function onerror(er){debug("onerror",er),unpipe(),dest.removeListener("error",onerror),0===EElistenerCount(dest,"error")&&errorOrDestroy(dest,er)}function onclose(){dest.removeListener("finish",onfinish),unpipe()}function onfinish(){debug("onfinish"),dest.removeListener("close",onclose),unpipe()}function unpipe(){debug("unpipe"),src.unpipe(dest)}return src.on("data",ondata),function(emitter,event,fn){if("function"==typeof emitter.prependListener)return emitter.prependListener(event,fn);emitter._events&&emitter._events[event]?Array.isArray(emitter._events[event])?emitter._events[event].unshift(fn):emitter._events[event]=[fn,emitter._events[event]]:emitter.on(event,fn)}(dest,"error",onerror),dest.once("close",onclose),dest.once("finish",onfinish),dest.emit("pipe",src),state.flowing||(debug("pipe resume"),src.resume()),dest},Readable.prototype.unpipe=function(dest){var state=this._readableState,unpipeInfo={hasUnpiped:!1};if(0===state.pipesCount)return this;if(1===state.pipesCount)return dest&&dest!==state.pipes||(dest=dest||state.pipes,state.pipes=null,state.pipesCount=0,state.flowing=!1,dest&&dest.emit("unpipe",this,unpipeInfo)),this;if(!dest){var dests=state.pipes,len=state.pipesCount;state.pipes=null,state.pipesCount=0,state.flowing=!1;for(var i=0;i<len;i++)dests[i].emit("unpipe",this,{hasUnpiped:!1});return this}var index=indexOf(state.pipes,dest);return-1===index||(state.pipes.splice(index,1),--state.pipesCount,1===state.pipesCount&&(state.pipes=state.pipes[0]),dest.emit("unpipe",this,unpipeInfo)),this},Readable.prototype.addListener=Readable.prototype.on=function(ev,fn){var fn=Stream.prototype.on.call(this,ev,fn),state=this._readableState;return"data"===ev?(state.readableListening=0<this.listenerCount("readable"),!1!==state.flowing&&this.resume()):"readable"!==ev||state.endEmitted||state.readableListening||(state.readableListening=state.needReadable=!0,state.flowing=!1,state.emittedReadable=!1,debug("on readable",state.length,state.reading),state.length?emitReadable(this):state.reading||process.nextTick(nReadingNextTick,this)),fn},Readable.prototype.removeListener=function(ev,fn){fn=Stream.prototype.removeListener.call(this,ev,fn);return"readable"===ev&&process.nextTick(updateReadableListening,this),fn},Readable.prototype.removeAllListeners=function(ev){var res=Stream.prototype.removeAllListeners.apply(this,arguments);return"readable"!==ev&&void 0!==ev||process.nextTick(updateReadableListening,this),res},Readable.prototype.resume=function(){var state=this._readableState;return state.flowing||(debug("resume"),state.flowing=!state.readableListening,function(stream,state){state.resumeScheduled||(state.resumeScheduled=!0,process.nextTick(resume_,stream,state))}(this,state)),state.paused=!1,this},Readable.prototype.pause=function(){return debug("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(debug("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this},Readable.prototype.wrap=function(stream){var i,_this=this,state=this._readableState,paused=!1;for(i in stream.on("end",function(){var chunk;debug("wrapped end"),state.decoder&&!state.ended&&(chunk=state.decoder.end())&&chunk.length&&_this.push(chunk),_this.push(null)}),stream.on("data",function(chunk){debug("wrapped data"),state.decoder&&(chunk=state.decoder.write(chunk)),state.objectMode&&null==chunk||(state.objectMode||chunk&&chunk.length)&&!_this.push(chunk)&&(paused=!0,stream.pause())}),stream)void 0===this[i]&&"function"==typeof stream[i]&&(this[i]=function(method){return function(){return stream[method].apply(stream,arguments)}}(i));for(var n=0;n<kProxyEvents.length;n++)stream.on(kProxyEvents[n],this.emit.bind(this,kProxyEvents[n]));return this._read=function(n){debug("wrapped _read",n),paused&&(paused=!1,stream.resume())},this},"function"==typeof Symbol&&(Readable.prototype[Symbol.asyncIterator]=function(){return(createReadableStreamAsyncIterator=void 0===createReadableStreamAsyncIterator?require("./internal/streams/async_iterator"):createReadableStreamAsyncIterator)(this)}),Object.defineProperty(Readable.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),Object.defineProperty(Readable.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}}),Object.defineProperty(Readable.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(state){this._readableState&&(this._readableState.flowing=state)}}),Readable._fromList=fromList,Object.defineProperty(Readable.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}}),"function"==typeof Symbol&&(Readable.from=function(iterable,opts){return(from=void 0===from?require("./internal/streams/from"):from)(Readable,iterable,opts)})}.call(this)}.call(this,require("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../errors":96,"./_stream_duplex":97,"./internal/streams/async_iterator":102,"./internal/streams/buffer_list":103,"./internal/streams/destroy":104,"./internal/streams/from":106,"./internal/streams/state":108,"./internal/streams/stream":109,_process:354,buffer:112,events:178,inherits:220,"string_decoder/":377,util:68}],100:[function(require,module,exports){"use strict";module.exports=Transform;var module=require("../errors").codes,ERR_METHOD_NOT_IMPLEMENTED=module.ERR_METHOD_NOT_IMPLEMENTED,ERR_MULTIPLE_CALLBACK=module.ERR_MULTIPLE_CALLBACK,ERR_TRANSFORM_ALREADY_TRANSFORMING=module.ERR_TRANSFORM_ALREADY_TRANSFORMING,ERR_TRANSFORM_WITH_LENGTH_0=module.ERR_TRANSFORM_WITH_LENGTH_0,Duplex=require("./_stream_duplex");function Transform(options){if(!(this instanceof Transform))return new Transform(options);Duplex.call(this,options),this._transformState={afterTransform:function(er,data){var ts=this._transformState,cb=(ts.transforming=!1,ts.writecb);if(null===cb)return this.emit("error",new ERR_MULTIPLE_CALLBACK);ts.writechunk=null,(ts.writecb=null)!=data&&this.push(data),cb(er),(ts=this._readableState).reading=!1,(ts.needReadable||ts.length<ts.highWaterMark)&&this._read(ts.highWaterMark)}.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,options&&("function"==typeof options.transform&&(this._transform=options.transform),"function"==typeof options.flush&&(this._flush=options.flush)),this.on("prefinish",prefinish)}function prefinish(){var _this=this;"function"!=typeof this._flush||this._readableState.destroyed?done(this,null,null):this._flush(function(er,data){done(_this,er,data)})}function done(stream,er,data){if(er)return stream.emit("error",er);if(null!=data&&stream.push(data),stream._writableState.length)throw new ERR_TRANSFORM_WITH_LENGTH_0;if(stream._transformState.transforming)throw new ERR_TRANSFORM_ALREADY_TRANSFORMING;stream.push(null)}require("inherits")(Transform,Duplex),Transform.prototype.push=function(chunk,encoding){return this._transformState.needTransform=!1,Duplex.prototype.push.call(this,chunk,encoding)},Transform.prototype._transform=function(chunk,encoding,cb){cb(new ERR_METHOD_NOT_IMPLEMENTED("_transform()"))},Transform.prototype._write=function(chunk,encoding,cb){var ts=this._transformState;ts.writecb=cb,ts.writechunk=chunk,ts.writeencoding=encoding,ts.transforming||(cb=this._readableState,(ts.needTransform||cb.needReadable||cb.length<cb.highWaterMark)&&this._read(cb.highWaterMark))},Transform.prototype._read=function(n){var ts=this._transformState;null===ts.writechunk||ts.transforming?ts.needTransform=!0:(ts.transforming=!0,this._transform(ts.writechunk,ts.writeencoding,ts.afterTransform))},Transform.prototype._destroy=function(err,cb){Duplex.prototype._destroy.call(this,err,function(err2){cb(err2)})}},{"../errors":96,"./_stream_duplex":97,inherits:220}],101:[function(require,module,exports){!function(process,global){!function(){"use strict";function CorkedRequest(state){var _this=this;this.next=null,this.entry=null,this.finish=function(){!function(corkReq,state,err){var entry=corkReq.entry;corkReq.entry=null;for(;entry;){var cb=entry.callback;state.pendingcb--,cb(err),entry=entry.next}state.corkedRequestsFree.next=corkReq}(_this,state)}}(module.exports=Writable).WritableState=WritableState;var Duplex,internalUtil={deprecate:require("util-deprecate")},Stream=require("./internal/streams/stream"),Buffer=require("buffer").Buffer,OurUint8Array=global.Uint8Array||function(){};var realHasInstance,destroyImpl=require("./internal/streams/destroy"),getHighWaterMark=require("./internal/streams/state").getHighWaterMark,_require$codes=require("../errors").codes,ERR_INVALID_ARG_TYPE=_require$codes.ERR_INVALID_ARG_TYPE,ERR_METHOD_NOT_IMPLEMENTED=_require$codes.ERR_METHOD_NOT_IMPLEMENTED,ERR_MULTIPLE_CALLBACK=_require$codes.ERR_MULTIPLE_CALLBACK,ERR_STREAM_CANNOT_PIPE=_require$codes.ERR_STREAM_CANNOT_PIPE,ERR_STREAM_DESTROYED=_require$codes.ERR_STREAM_DESTROYED,ERR_STREAM_NULL_VALUES=_require$codes.ERR_STREAM_NULL_VALUES,ERR_STREAM_WRITE_AFTER_END=_require$codes.ERR_STREAM_WRITE_AFTER_END,ERR_UNKNOWN_ENCODING=_require$codes.ERR_UNKNOWN_ENCODING,errorOrDestroy=destroyImpl.errorOrDestroy;function nop(){}function WritableState(options,stream,isDuplex){Duplex=Duplex||require("./_stream_duplex"),"boolean"!=typeof isDuplex&&(isDuplex=stream instanceof Duplex),this.objectMode=!!(options=options||{}).objectMode,isDuplex&&(this.objectMode=this.objectMode||!!options.writableObjectMode),this.highWaterMark=getHighWaterMark(this,options,"writableHighWaterMark",isDuplex),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1;isDuplex=(this.destroyed=!1)===options.decodeStrings;this.decodeStrings=!isDuplex,this.defaultEncoding=options.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(er){!function(stream,er){var state=stream._writableState,sync=state.sync,cb=state.writecb;if("function"!=typeof cb)throw new ERR_MULTIPLE_CALLBACK;(function(state){state.writing=!1,state.writecb=null,state.length-=state.writelen,state.writelen=0})(state),er?function(stream,state,sync,er,cb){--state.pendingcb,sync?(process.nextTick(cb,er),process.nextTick(finishMaybe,stream,state),stream._writableState.errorEmitted=!0,errorOrDestroy(stream,er)):(cb(er),stream._writableState.errorEmitted=!0,errorOrDestroy(stream,er),finishMaybe(stream,state))}(stream,state,sync,er,cb):((er=needFinish(state)||stream.destroyed)||state.corked||state.bufferProcessing||!state.bufferedRequest||clearBuffer(stream,state),sync?process.nextTick(afterWrite,stream,state,er,cb):afterWrite(stream,state,er,cb))}(stream,er)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=!1!==options.emitClose,this.autoDestroy=!!options.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new CorkedRequest(this)}require("inherits")(Writable,Stream),WritableState.prototype.getBuffer=function(){for(var current=this.bufferedRequest,out=[];current;)out.push(current),current=current.next;return out};try{Object.defineProperty(WritableState.prototype,"buffer",{get:internalUtil.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch(_){}function Writable(options){var isDuplex=this instanceof(Duplex=Duplex||require("./_stream_duplex"));if(!isDuplex&&!realHasInstance.call(Writable,this))return new Writable(options);this._writableState=new WritableState(options,this,isDuplex),this.writable=!0,options&&("function"==typeof options.write&&(this._write=options.write),"function"==typeof options.writev&&(this._writev=options.writev),"function"==typeof options.destroy&&(this._destroy=options.destroy),"function"==typeof options.final&&(this._final=options.final)),Stream.call(this)}function doWrite(stream,state,writev,len,chunk,encoding,cb){state.writelen=len,state.writecb=cb,state.writing=!0,state.sync=!0,state.destroyed?state.onwrite(new ERR_STREAM_DESTROYED("write")):writev?stream._writev(chunk,state.onwrite):stream._write(chunk,encoding,state.onwrite),state.sync=!1}function afterWrite(stream,state,finished,cb){finished||!function(stream,state){0===state.length&&state.needDrain&&(state.needDrain=!1,stream.emit("drain"))}(stream,state),state.pendingcb--,cb(),finishMaybe(stream,state)}function clearBuffer(stream,state){state.bufferProcessing=!0;var entry=state.bufferedRequest;if(stream._writev&&entry&&entry.next){for(var l=state.bufferedRequestCount,buffer=new Array(l),l=state.corkedRequestsFree,count=(l.entry=entry,0),allBuffers=!0;entry;)(buffer[count]=entry).isBuf||(allBuffers=!1),entry=entry.next,count+=1;buffer.allBuffers=allBuffers,doWrite(stream,state,!0,state.length,buffer,"",l.finish),state.pendingcb++,state.lastBufferedRequest=null,l.next?(state.corkedRequestsFree=l.next,l.next=null):state.corkedRequestsFree=new CorkedRequest(state),state.bufferedRequestCount=0}else{for(;entry;){var chunk=entry.chunk,encoding=entry.encoding,cb=entry.callback;if(doWrite(stream,state,!1,state.objectMode?1:chunk.length,chunk,encoding,cb),entry=entry.next,state.bufferedRequestCount--,state.writing)break}null===entry&&(state.lastBufferedRequest=null)}state.bufferedRequest=entry,state.bufferProcessing=!1}function needFinish(state){return state.ending&&0===state.length&&null===state.bufferedRequest&&!state.finished&&!state.writing}function callFinal(stream,state){stream._final(function(err){state.pendingcb--,err&&errorOrDestroy(stream,err),state.prefinished=!0,stream.emit("prefinish"),finishMaybe(stream,state)})}function finishMaybe(stream,state){var need=needFinish(state);return need&&(function(stream,state){state.prefinished||state.finalCalled||("function"!=typeof stream._final||state.destroyed?(state.prefinished=!0,stream.emit("prefinish")):(state.pendingcb++,state.finalCalled=!0,process.nextTick(callFinal,stream,state)))}(stream,state),0===state.pendingcb&&(state.finished=!0,stream.emit("finish"),state.autoDestroy&&(!(state=stream._readableState)||state.autoDestroy&&state.endEmitted)&&stream.destroy())),need}"function"==typeof Symbol&&Symbol.hasInstance&&"function"==typeof Function.prototype[Symbol.hasInstance]?(realHasInstance=Function.prototype[Symbol.hasInstance],Object.defineProperty(Writable,Symbol.hasInstance,{value:function(object){return!!realHasInstance.call(this,object)||this===Writable&&(object&&object._writableState instanceof WritableState)}})):realHasInstance=function(object){return object instanceof this},Writable.prototype.pipe=function(){errorOrDestroy(this,new ERR_STREAM_CANNOT_PIPE)},Writable.prototype.write=function(chunk,encoding,cb){var state=this._writableState,ret=!1,obj=!state.objectMode&&(obj=chunk,Buffer.isBuffer(obj)||obj instanceof OurUint8Array);return obj&&!Buffer.isBuffer(chunk)&&(chunk=function(chunk){return Buffer.from(chunk)}(chunk)),"function"==typeof encoding&&(cb=encoding,encoding=null),encoding=obj?"buffer":encoding||state.defaultEncoding,"function"!=typeof cb&&(cb=nop),state.ending?function(stream,cb){var er=new ERR_STREAM_WRITE_AFTER_END;errorOrDestroy(stream,er),process.nextTick(cb,er)}(this,cb):(obj||function(stream,state,chunk,cb){var er;return null===chunk?er=new ERR_STREAM_NULL_VALUES:"string"==typeof chunk||state.objectMode||(er=new ERR_INVALID_ARG_TYPE("chunk",["string","Buffer"],chunk)),!er||(errorOrDestroy(stream,er),void process.nextTick(cb,er))}(this,state,chunk,cb))&&(state.pendingcb++,ret=function(stream,state,isBuf,chunk,encoding,cb){isBuf||(newChunk=function(state,chunk,encoding){state.objectMode||!1===state.decodeStrings||"string"!=typeof chunk||(chunk=Buffer.from(chunk,encoding));return chunk}(state,chunk,encoding),chunk!==newChunk&&(isBuf=!0,encoding="buffer",chunk=newChunk));var newChunk=state.objectMode?1:chunk.length,ret=(state.length+=newChunk,state.length<state.highWaterMark);ret||(state.needDrain=!0);{var last;state.writing||state.corked?(last=state.lastBufferedRequest,state.lastBufferedRequest={chunk:chunk,encoding:encoding,isBuf:isBuf,callback:cb,next:null},last?last.next=state.lastBufferedRequest:state.bufferedRequest=state.lastBufferedRequest,state.bufferedRequestCount+=1):doWrite(stream,state,!1,newChunk,chunk,encoding,cb)}return ret}(this,state,obj,chunk,encoding,cb)),ret},Writable.prototype.cork=function(){this._writableState.corked++},Writable.prototype.uncork=function(){var state=this._writableState;state.corked&&(state.corked--,state.writing||state.corked||state.bufferProcessing||!state.bufferedRequest||clearBuffer(this,state))},Writable.prototype.setDefaultEncoding=function(encoding){if("string"==typeof encoding&&(encoding=encoding.toLowerCase()),-1<["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((encoding+"").toLowerCase()))return this._writableState.defaultEncoding=encoding,this;throw new ERR_UNKNOWN_ENCODING(encoding)},Object.defineProperty(Writable.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(Writable.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Writable.prototype._write=function(chunk,encoding,cb){cb(new ERR_METHOD_NOT_IMPLEMENTED("_write()"))},Writable.prototype._writev=null,Writable.prototype.end=function(chunk,encoding,cb){var state=this._writableState;return"function"==typeof chunk?(cb=chunk,encoding=chunk=null):"function"==typeof encoding&&(cb=encoding,encoding=null),null!=chunk&&this.write(chunk,encoding),state.corked&&(state.corked=1,this.uncork()),state.ending||function(stream,state,cb){state.ending=!0,finishMaybe(stream,state),cb&&(state.finished?process.nextTick(cb):stream.once("finish",cb));state.ended=!0,stream.writable=!1}(this,state,cb),this},Object.defineProperty(Writable.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(Writable.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._writableState&&this._writableState.destroyed},set:function(value){this._writableState&&(this._writableState.destroyed=value)}}),Writable.prototype.destroy=destroyImpl.destroy,Writable.prototype._undestroy=destroyImpl.undestroy,Writable.prototype._destroy=function(err,cb){cb(err)}}.call(this)}.call(this,require("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../errors":96,"./_stream_duplex":97,"./internal/streams/destroy":104,"./internal/streams/state":108,"./internal/streams/stream":109,_process:354,buffer:112,inherits:220,"util-deprecate":378}],102:[function(require,module,exports){!function(process){!function(){"use strict";var _Object$setPrototypeO;function _defineProperty(obj,key,value){key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value}var finished=require("./end-of-stream"),kLastResolve=Symbol("lastResolve"),kLastReject=Symbol("lastReject"),kError=Symbol("error"),kEnded=Symbol("ended"),kLastPromise=Symbol("lastPromise"),kHandlePromise=Symbol("handlePromise"),kStream=Symbol("stream");function readAndResolve(iter){var data,resolve=iter[kLastResolve];null!==resolve&&null!==(data=iter[kStream].read())&&(iter[kLastPromise]=null,iter[kLastResolve]=null,iter[kLastReject]=null,resolve({value:data,done:!1}))}var AsyncIteratorPrototype=Object.getPrototypeOf(function(){}),ReadableStreamAsyncIteratorPrototype=Object.setPrototypeOf((_defineProperty(_Object$setPrototypeO={get stream(){return this[kStream]},next:function(){var _this=this,error=this[kError];if(null!==error)return Promise.reject(error);if(this[kEnded])return Promise.resolve({value:void 0,done:!0});if(this[kStream].destroyed)return new Promise(function(resolve,reject){process.nextTick(function(){_this[kError]?reject(_this[kError]):resolve({value:void 0,done:!0})})});var promise,error=this[kLastPromise];if(error)promise=new Promise(function(lastPromise,iter){return function(resolve,reject){lastPromise.then(function(){iter[kEnded]?resolve({value:void 0,done:!0}):iter[kHandlePromise](resolve,reject)},reject)}}(error,this));else{error=this[kStream].read();if(null!==error)return Promise.resolve({value:error,done:!1});promise=new Promise(this[kHandlePromise])}return this[kLastPromise]=promise}},Symbol.asyncIterator,function(){return this}),_defineProperty(_Object$setPrototypeO,"return",function(){var _this2=this;return new Promise(function(resolve,reject){_this2[kStream].destroy(null,function(err){err?reject(err):resolve({value:void 0,done:!0})})})}),_Object$setPrototypeO),AsyncIteratorPrototype);module.exports=function(stream){var _Object$create,iterator=Object.create(ReadableStreamAsyncIteratorPrototype,(_defineProperty(_Object$create={},kStream,{value:stream,writable:!0}),_defineProperty(_Object$create,kLastResolve,{value:null,writable:!0}),_defineProperty(_Object$create,kLastReject,{value:null,writable:!0}),_defineProperty(_Object$create,kError,{value:null,writable:!0}),_defineProperty(_Object$create,kEnded,{value:stream._readableState.endEmitted,writable:!0}),_defineProperty(_Object$create,kHandlePromise,{value:function(resolve,reject){var data=iterator[kStream].read();data?(iterator[kLastPromise]=null,iterator[kLastResolve]=null,iterator[kLastReject]=null,resolve({value:data,done:!1})):(iterator[kLastResolve]=resolve,iterator[kLastReject]=reject)},writable:!0}),_Object$create));return iterator[kLastPromise]=null,finished(stream,function(err){if(err&&"ERR_STREAM_PREMATURE_CLOSE"!==err.code)return null!==(reject=iterator[kLastReject])&&(iterator[kLastPromise]=null,iterator[kLastResolve]=null,iterator[kLastReject]=null,reject(err)),void(iterator[kError]=err);var reject=iterator[kLastResolve];null!==reject&&(iterator[kLastPromise]=null,iterator[kLastResolve]=null,reject({value:void 0,done:!(iterator[kLastReject]=null)})),iterator[kEnded]=!0}),stream.on("readable",function(iter){process.nextTick(readAndResolve,iter)}.bind(null,iterator)),iterator}}.call(this)}.call(this,require("_process"))},{"./end-of-stream":105,_process:354}],103:[function(require,module,exports){"use strict";function ownKeys(object,enumerableOnly){var symbols,keys=Object.keys(object);return Object.getOwnPropertySymbols&&(symbols=Object.getOwnPropertySymbols(object),enumerableOnly&&(symbols=symbols.filter(function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable})),keys.push.apply(keys,symbols)),keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?ownKeys(Object(source),!0).forEach(function(key){!function(obj,key,value){key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value}(target,key,source[key])}):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):ownKeys(Object(source)).forEach(function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))})}return target}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}var Buffer=require("buffer").Buffer,inspect=require("util").inspect,custom=inspect&&inspect.custom||"inspect";module.exports=function(){function BufferList(){if(!(this instanceof BufferList))throw new TypeError("Cannot call a class as a function");this.head=null,this.tail=null,this.length=0}var Constructor,protoProps,staticProps;return Constructor=BufferList,(protoProps=[{key:"push",value:function(v){v={data:v,next:null};0<this.length?this.tail.next=v:this.head=v,this.tail=v,++this.length}},{key:"unshift",value:function(v){v={data:v,next:this.head};0===this.length&&(this.tail=v),this.head=v,++this.length}},{key:"shift",value:function(){var ret;if(0!==this.length)return ret=this.head.data,1===this.length?this.head=this.tail=null:this.head=this.head.next,--this.length,ret}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(s){if(0===this.length)return"";for(var p=this.head,ret=""+p.data;p=p.next;)ret+=s+p.data;return ret}},{key:"concat",value:function(n){if(0===this.length)return Buffer.alloc(0);for(var src,offset,ret=Buffer.allocUnsafe(n>>>0),p=this.head,i=0;p;)src=p.data,offset=i,Buffer.prototype.copy.call(src,ret,offset),i+=p.data.length,p=p.next;return ret}},{key:"consume",value:function(n,hasStrings){var ret;return n<this.head.data.length?(ret=this.head.data.slice(0,n),this.head.data=this.head.data.slice(n)):ret=n===this.head.data.length?this.shift():hasStrings?this._getString(n):this._getBuffer(n),ret}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(n){var p=this.head,c=1,ret=p.data;for(n-=ret.length;p=p.next;){var str=p.data,nb=n>str.length?str.length:n;if(nb===str.length?ret+=str:ret+=str.slice(0,n),0===(n-=nb)){nb===str.length?(++c,p.next?this.head=p.next:this.head=this.tail=null):(this.head=p).data=str.slice(nb);break}++c}return this.length-=c,ret}},{key:"_getBuffer",value:function(n){var ret=Buffer.allocUnsafe(n),p=this.head,c=1;for(p.data.copy(ret),n-=p.data.length;p=p.next;){var buf=p.data,nb=n>buf.length?buf.length:n;if(buf.copy(ret,ret.length-n,0,nb),0===(n-=nb)){nb===buf.length?(++c,p.next?this.head=p.next:this.head=this.tail=null):(this.head=p).data=buf.slice(nb);break}++c}return this.length-=c,ret}},{key:custom,value:function(_,options){return inspect(this,_objectSpread({},options,{depth:0,customInspect:!1}))}}])&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),BufferList}()},{buffer:112,util:68}],104:[function(require,module,exports){!function(process){!function(){"use strict";function emitErrorAndCloseNT(self,err){emitErrorNT(self,err),emitCloseNT(self)}function emitCloseNT(self){self._writableState&&!self._writableState.emitClose||self._readableState&&!self._readableState.emitClose||self.emit("close")}function emitErrorNT(self,err){self.emit("error",err)}module.exports={destroy:function(err,cb){var _this=this,readableDestroyed=this._readableState&&this._readableState.destroyed,writableDestroyed=this._writableState&&this._writableState.destroyed;return readableDestroyed||writableDestroyed?cb?cb(err):err&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,process.nextTick(emitErrorNT,this,err)):process.nextTick(emitErrorNT,this,err)):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(err||null,function(err){!cb&&err?_this._writableState?_this._writableState.errorEmitted?process.nextTick(emitCloseNT,_this):(_this._writableState.errorEmitted=!0,process.nextTick(emitErrorAndCloseNT,_this,err)):process.nextTick(emitErrorAndCloseNT,_this,err):cb?(process.nextTick(emitCloseNT,_this),cb(err)):process.nextTick(emitCloseNT,_this)})),this},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)},errorOrDestroy:function(stream,err){var rState=stream._readableState,wState=stream._writableState;rState&&rState.autoDestroy||wState&&wState.autoDestroy?stream.destroy(err):stream.emit("error",err)}}}.call(this)}.call(this,require("_process"))},{_process:354}],105:[function(require,module,exports){"use strict";var ERR_STREAM_PREMATURE_CLOSE=require("../../../errors").codes.ERR_STREAM_PREMATURE_CLOSE;function noop(){}module.exports=function eos(stream,opts,callback){if("function"==typeof opts)return eos(stream,null,opts);callback=function(callback){var called=!1;return function(){if(!called){called=!0;for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++)args[_key]=arguments[_key];callback.apply(this,args)}}}(callback||noop);function onlegacyfinish(){stream.writable||onfinish()}function onfinish(){writableEnded=!(writable=!1),readable||callback.call(stream)}function onend(){readableEnded=!(readable=!1),writable||callback.call(stream)}function onerror(err){callback.call(stream,err)}function onclose(){var err;return readable&&!readableEnded?(stream._readableState&&stream._readableState.ended||(err=new ERR_STREAM_PREMATURE_CLOSE),callback.call(stream,err)):writable&&!writableEnded?(stream._writableState&&stream._writableState.ended||(err=new ERR_STREAM_PREMATURE_CLOSE),callback.call(stream,err)):void 0}function onrequest(){stream.req.on("finish",onfinish)}var readable=(opts=opts||{}).readable||!1!==opts.readable&&stream.readable,writable=opts.writable||!1!==opts.writable&&stream.writable,writableEnded=stream._writableState&&stream._writableState.finished,readableEnded=stream._readableState&&stream._readableState.endEmitted;return function(stream){return stream.setHeader&&"function"==typeof stream.abort}(stream)?(stream.on("complete",onfinish),stream.on("abort",onclose),stream.req?onrequest():stream.on("request",onrequest)):writable&&!stream._writableState&&(stream.on("end",onlegacyfinish),stream.on("close",onlegacyfinish)),stream.on("end",onend),stream.on("finish",onfinish),!1!==opts.error&&stream.on("error",onerror),stream.on("close",onclose),function(){stream.removeListener("complete",onfinish),stream.removeListener("abort",onclose),stream.removeListener("request",onrequest),stream.req&&stream.req.removeListener("finish",onfinish),stream.removeListener("end",onlegacyfinish),stream.removeListener("close",onlegacyfinish),stream.removeListener("finish",onfinish),stream.removeListener("end",onend),stream.removeListener("error",onerror),stream.removeListener("close",onclose)}}},{"../../../errors":96}],106:[function(require,module,exports){module.exports=function(){throw new Error("Readable.from is not available in the browser")}},{}],107:[function(require,module,exports){"use strict";var eos;var _require$codes=require("../../../errors").codes,ERR_MISSING_ARGS=_require$codes.ERR_MISSING_ARGS,ERR_STREAM_DESTROYED=_require$codes.ERR_STREAM_DESTROYED;function noop(err){if(err)throw err}function destroyer(stream,reading,writing,callback){callback=function(callback){var called=!1;return function(){called||(called=!0,callback.apply(void 0,arguments))}}(callback);var closed=!1,destroyed=(stream.on("close",function(){closed=!0}),(eos=void 0===eos?require("./end-of-stream"):eos)(stream,{readable:reading,writable:writing},function(err){if(err)return callback(err);closed=!0,callback()}),!1);return function(err){if(!closed&&!destroyed)return destroyed=!0,function(stream){return stream.setHeader&&"function"==typeof stream.abort}(stream)?stream.abort():"function"==typeof stream.destroy?stream.destroy():void callback(err||new ERR_STREAM_DESTROYED("pipe"))}}function call(fn){fn()}function pipe(from,to){return from.pipe(to)}module.exports=function(){for(var _len=arguments.length,streams=new Array(_len),_key=0;_key<_len;_key++)streams[_key]=arguments[_key];var error,callback=function(streams){return!streams.length||"function"!=typeof streams[streams.length-1]?noop:streams.pop()}(streams);if((streams=Array.isArray(streams[0])?streams[0]:streams).length<2)throw new ERR_MISSING_ARGS("streams");var destroys=streams.map(function(stream,i){var reading=i<streams.length-1;return destroyer(stream,reading,0<i,function(err){error=error||err,err&&destroys.forEach(call),reading||(destroys.forEach(call),callback(error))})});return streams.reduce(pipe)}},{"../../../errors":96,"./end-of-stream":105}],108:[function(require,module,exports){"use strict";var ERR_INVALID_OPT_VALUE=require("../../../errors").codes.ERR_INVALID_OPT_VALUE;module.exports={getHighWaterMark:function(state,options,duplexKey,isDuplex){if(null==(options=function(options,isDuplex,duplexKey){return null!=options.highWaterMark?options.highWaterMark:isDuplex?options[duplexKey]:null}(options,isDuplex,duplexKey)))return state.objectMode?16:16384;if(!isFinite(options)||Math.floor(options)!==options||options<0)throw new ERR_INVALID_OPT_VALUE(isDuplex?duplexKey:"highWaterMark",options);return Math.floor(options)}}},{"../../../errors":96}],109:[function(require,module,exports){module.exports=require("events").EventEmitter},{events:178}],110:[function(require,module,exports){(((exports=module.exports=require("./lib/_stream_readable.js")).Stream=exports).Readable=exports).Writable=require("./lib/_stream_writable.js"),exports.Duplex=require("./lib/_stream_duplex.js"),exports.Transform=require("./lib/_stream_transform.js"),exports.PassThrough=require("./lib/_stream_passthrough.js"),exports.finished=require("./lib/internal/streams/end-of-stream.js"),exports.pipeline=require("./lib/internal/streams/pipeline.js")},{"./lib/_stream_duplex.js":97,"./lib/_stream_passthrough.js":98,"./lib/_stream_readable.js":99,"./lib/_stream_transform.js":100,"./lib/_stream_writable.js":101,"./lib/internal/streams/end-of-stream.js":105,"./lib/internal/streams/pipeline.js":107}],111:[function(require,module,exports){var buffer=require("buffer"),Buffer=buffer.Buffer;function copyProps(src,dst){for(var key in src)dst[key]=src[key]}function SafeBuffer(arg,encodingOrOffset,length){return Buffer(arg,encodingOrOffset,length)}Buffer.from&&Buffer.alloc&&Buffer.allocUnsafe&&Buffer.allocUnsafeSlow?module.exports=buffer:(copyProps(buffer,exports),exports.Buffer=SafeBuffer),SafeBuffer.prototype=Object.create(Buffer.prototype),copyProps(Buffer,SafeBuffer),SafeBuffer.from=function(arg,encodingOrOffset,length){if("number"==typeof arg)throw new TypeError("Argument must not be a number");return Buffer(arg,encodingOrOffset,length)},SafeBuffer.alloc=function(size,fill,encoding){if("number"!=typeof size)throw new TypeError("Argument must be a number");size=Buffer(size);return void 0!==fill?"string"==typeof encoding?size.fill(fill,encoding):size.fill(fill):size.fill(0),size},SafeBuffer.allocUnsafe=function(size){if("number"!=typeof size)throw new TypeError("Argument must be a number");return Buffer(size)},SafeBuffer.allocUnsafeSlow=function(size){if("number"!=typeof size)throw new TypeError("Argument must be a number");return buffer.SlowBuffer(size)}},{buffer:112}],112:[function(require,module,exports){!function(Buffer){!function(){"use strict";var base64=require("base64-js"),ieee754=require("ieee754"),K_MAX_LENGTH=(exports.Buffer=Buffer,exports.SlowBuffer=function(length){+length!=length&&(length=0);return Buffer.alloc(+length)},exports.INSPECT_MAX_BYTES=50,2147483647);function createBuffer(length){if(K_MAX_LENGTH<length)throw new RangeError('The value "'+length+'" is invalid for option "size"');length=new Uint8Array(length);return length.__proto__=Buffer.prototype,length}function Buffer(arg,encodingOrOffset,length){if("number"!=typeof arg)return from(arg,encodingOrOffset,length);if("string"==typeof encodingOrOffset)throw new TypeError('The "string" argument must be of type string. Received type number');return allocUnsafe(arg)}function from(value,encodingOrOffset,length){if("string"==typeof value)return function(string,encoding){"string"==typeof encoding&&""!==encoding||(encoding="utf8");if(!Buffer.isEncoding(encoding))throw new TypeError("Unknown encoding: "+encoding);var length=0|byteLength(string,encoding),buf=createBuffer(length),string=buf.write(string,encoding);string!==length&&(buf=buf.slice(0,string));return buf}(value,encodingOrOffset);if(ArrayBuffer.isView(value))return fromArrayLike(value);if(null==value)throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof value);if(isInstance(value,ArrayBuffer)||value&&isInstance(value.buffer,ArrayBuffer))return function(array,byteOffset,length){if(byteOffset<0||array.byteLength<byteOffset)throw new RangeError('"offset" is outside of buffer bounds');if(array.byteLength<byteOffset+(length||0))throw new RangeError('"length" is outside of buffer bounds');array=void 0===byteOffset&&void 0===length?new Uint8Array(array):void 0===length?new Uint8Array(array,byteOffset):new Uint8Array(array,byteOffset,length);return array.__proto__=Buffer.prototype,array}(value,encodingOrOffset,length);if("number"==typeof value)throw new TypeError('The "value" argument must not be of type number. Received type number');var valueOf=value.valueOf&&value.valueOf();if(null!=valueOf&&valueOf!==value)return Buffer.from(valueOf,encodingOrOffset,length);valueOf=function(obj){{var len,buf;if(Buffer.isBuffer(obj))return len=0|checked(obj.length),0===(buf=createBuffer(len)).length||obj.copy(buf,0,0,len),buf}if(void 0!==obj.length)return"number"!=typeof obj.length||numberIsNaN(obj.length)?createBuffer(0):fromArrayLike(obj);if("Buffer"===obj.type&&Array.isArray(obj.data))return fromArrayLike(obj.data)}(value);if(valueOf)return valueOf;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof value[Symbol.toPrimitive])return Buffer.from(value[Symbol.toPrimitive]("string"),encodingOrOffset,length);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof value)}function assertSize(size){if("number"!=typeof size)throw new TypeError('"size" argument must be of type number');if(size<0)throw new RangeError('The value "'+size+'" is invalid for option "size"')}function allocUnsafe(size){return assertSize(size),createBuffer(size<0?0:0|checked(size))}function fromArrayLike(array){for(var length=array.length<0?0:0|checked(array.length),buf=createBuffer(length),i=0;i<length;i+=1)buf[i]=255&array[i];return buf}function checked(length){if(K_MAX_LENGTH<=length)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+K_MAX_LENGTH.toString(16)+" bytes");return 0|length}function byteLength(string,encoding){if(Buffer.isBuffer(string))return string.length;if(ArrayBuffer.isView(string)||isInstance(string,ArrayBuffer))return string.byteLength;if("string"!=typeof string)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof string);var len=string.length,mustMatch=2<arguments.length&&!0===arguments[2];if(!mustMatch&&0===len)return 0;for(var loweredCase=!1;;)switch(encoding){case"ascii":case"latin1":case"binary":return len;case"utf8":case"utf-8":return utf8ToBytes(string).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*len;case"hex":return len>>>1;case"base64":return base64ToBytes(string).length;default:if(loweredCase)return mustMatch?-1:utf8ToBytes(string).length;encoding=(""+encoding).toLowerCase(),loweredCase=!0}}function slowToString(encoding,start,end){var loweredCase=!1;if((start=void 0===start||start<0?0:start)>this.length)return"";if((end=void 0===end||end>this.length?this.length:end)<=0)return"";if((end>>>=0)<=(start>>>=0))return"";for(encoding=encoding||"utf8";;)switch(encoding){case"hex":return function(buf,start,end){var len=buf.length;(!start||start<0)&&(start=0);(!end||end<0||len<end)&&(end=len);for(var out="",i=start;i<end;++i)out+=function(n){return n<16?"0"+n.toString(16):n.toString(16)}(buf[i]);return out}(this,start,end);case"utf8":case"utf-8":return utf8Slice(this,start,end);case"ascii":return function(buf,start,end){var ret="";end=Math.min(buf.length,end);for(var i=start;i<end;++i)ret+=String.fromCharCode(127&buf[i]);return ret}(this,start,end);case"latin1":case"binary":return function(buf,start,end){var ret="";end=Math.min(buf.length,end);for(var i=start;i<end;++i)ret+=String.fromCharCode(buf[i]);return ret}(this,start,end);case"base64":return function(buf,start,end){return 0===start&&end===buf.length?base64.fromByteArray(buf):base64.fromByteArray(buf.slice(start,end))}(this,start,end);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return function(buf,start,end){for(var bytes=buf.slice(start,end),res="",i=0;i<bytes.length;i+=2)res+=String.fromCharCode(bytes[i]+256*bytes[i+1]);return res}(this,start,end);default:if(loweredCase)throw new TypeError("Unknown encoding: "+encoding);encoding=(encoding+"").toLowerCase(),loweredCase=!0}}function swap(b,n,m){var i=b[n];b[n]=b[m],b[m]=i}function bidirectionalIndexOf(buffer,val,byteOffset,encoding,dir){if(0===buffer.length)return-1;if("string"==typeof byteOffset?(encoding=byteOffset,byteOffset=0):2147483647<byteOffset?byteOffset=2147483647:byteOffset<-2147483648&&(byteOffset=-2147483648),(byteOffset=(byteOffset=numberIsNaN(byteOffset=+byteOffset)?dir?0:buffer.length-1:byteOffset)<0?buffer.length+byteOffset:byteOffset)>=buffer.length){if(dir)return-1;byteOffset=buffer.length-1}else if(byteOffset<0){if(!dir)return-1;byteOffset=0}if("string"==typeof val&&(val=Buffer.from(val,encoding)),Buffer.isBuffer(val))return 0===val.length?-1:arrayIndexOf(buffer,val,byteOffset,encoding,dir);if("number"==typeof val)return val&=255,"function"==typeof Uint8Array.prototype.indexOf?(dir?Uint8Array.prototype.indexOf:Uint8Array.prototype.lastIndexOf).call(buffer,val,byteOffset):arrayIndexOf(buffer,[val],byteOffset,encoding,dir);throw new TypeError("val must be string, number or Buffer")}function arrayIndexOf(arr,val,byteOffset,encoding,dir){var indexSize=1,arrLength=arr.length,valLength=val.length;if(void 0!==encoding&&("ucs2"===(encoding=String(encoding).toLowerCase())||"ucs-2"===encoding||"utf16le"===encoding||"utf-16le"===encoding)){if(arr.length<2||val.length<2)return-1;arrLength/=indexSize=2,valLength/=2,byteOffset/=2}function read(buf,i){return 1===indexSize?buf[i]:buf.readUInt16BE(i*indexSize)}if(dir)for(var foundIndex=-1,i=byteOffset;i<arrLength;i++)if(read(arr,i)===read(val,-1===foundIndex?0:i-foundIndex)){if(i-(foundIndex=-1===foundIndex?i:foundIndex)+1===valLength)return foundIndex*indexSize}else-1!==foundIndex&&(i-=i-foundIndex),foundIndex=-1;else for(i=byteOffset=arrLength<byteOffset+valLength?arrLength-valLength:byteOffset;0<=i;i--){for(var found=!0,j=0;j<valLength;j++)if(read(arr,i+j)!==read(val,j)){found=!1;break}if(found)return i}return-1}function asciiWrite(buf,string,offset,length){return blitBuffer(function(str){for(var byteArray=[],i=0;i<str.length;++i)byteArray.push(255&str.charCodeAt(i));return byteArray}(string),buf,offset,length)}function ucs2Write(buf,string,offset,length){return blitBuffer(function(str,units){for(var hi,c,byteArray=[],i=0;i<str.length&&!((units-=2)<0);++i)c=str.charCodeAt(i),hi=c>>8,c=c%256,byteArray.push(c),byteArray.push(hi);return byteArray}(string,buf.length-offset),buf,offset,length)}function utf8Slice(buf,start,end){end=Math.min(buf.length,end);for(var res=[],i=start;i<end;){var secondByte,thirdByte,fourthByte,tempCodePoint,firstByte=buf[i],codePoint=null,bytesPerSequence=239<firstByte?4:223<firstByte?3:191<firstByte?2:1;if(i+bytesPerSequence<=end)switch(bytesPerSequence){case 1:firstByte<128&&(codePoint=firstByte);break;case 2:128==(192&(secondByte=buf[i+1]))&&127<(tempCodePoint=(31&firstByte)<<6|63&secondByte)&&(codePoint=tempCodePoint);break;case 3:secondByte=buf[i+1],thirdByte=buf[i+2],128==(192&secondByte)&&128==(192&thirdByte)&&2047<(tempCodePoint=(15&firstByte)<<12|(63&secondByte)<<6|63&thirdByte)&&(tempCodePoint<55296||57343<tempCodePoint)&&(codePoint=tempCodePoint);break;case 4:secondByte=buf[i+1],thirdByte=buf[i+2],fourthByte=buf[i+3],128==(192&secondByte)&&128==(192&thirdByte)&&128==(192&fourthByte)&&65535<(tempCodePoint=(15&firstByte)<<18|(63&secondByte)<<12|(63&thirdByte)<<6|63&fourthByte)&&tempCodePoint<1114112&&(codePoint=tempCodePoint)}null===codePoint?(codePoint=65533,bytesPerSequence=1):65535<codePoint&&(codePoint-=65536,res.push(codePoint>>>10&1023|55296),codePoint=56320|1023&codePoint),res.push(codePoint),i+=bytesPerSequence}return function(codePoints){var len=codePoints.length;if(len<=MAX_ARGUMENTS_LENGTH)return String.fromCharCode.apply(String,codePoints);var res="",i=0;for(;i<len;)res+=String.fromCharCode.apply(String,codePoints.slice(i,i+=MAX_ARGUMENTS_LENGTH));return res}(res)}exports.kMaxLength=K_MAX_LENGTH,(Buffer.TYPED_ARRAY_SUPPORT=function(){try{var arr=new Uint8Array(1);return arr.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===arr.foo()}catch(e){return!1}}())||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(Buffer.prototype,"parent",{enumerable:!0,get:function(){if(Buffer.isBuffer(this))return this.buffer}}),Object.defineProperty(Buffer.prototype,"offset",{enumerable:!0,get:function(){if(Buffer.isBuffer(this))return this.byteOffset}}),"undefined"!=typeof Symbol&&null!=Symbol.species&&Buffer[Symbol.species]===Buffer&&Object.defineProperty(Buffer,Symbol.species,{value:null,configurable:!0,enumerable:!1,writable:!1}),Buffer.poolSize=8192,Buffer.from=from,Buffer.prototype.__proto__=Uint8Array.prototype,Buffer.__proto__=Uint8Array,Buffer.alloc=function(size,fill,encoding){return assertSize(size),!(size<=0)&&void 0!==fill?"string"==typeof encoding?createBuffer(size).fill(fill,encoding):createBuffer(size).fill(fill):createBuffer(size)},Buffer.allocUnsafe=allocUnsafe,Buffer.allocUnsafeSlow=allocUnsafe,Buffer.isBuffer=function(b){return null!=b&&!0===b._isBuffer&&b!==Buffer.prototype},Buffer.compare=function(a,b){if(isInstance(a,Uint8Array)&&(a=Buffer.from(a,a.offset,a.byteLength)),isInstance(b,Uint8Array)&&(b=Buffer.from(b,b.offset,b.byteLength)),!Buffer.isBuffer(a)||!Buffer.isBuffer(b))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(a===b)return 0;for(var x=a.length,y=b.length,i=0,len=Math.min(x,y);i<len;++i)if(a[i]!==b[i]){x=a[i],y=b[i];break}return x<y?-1:y<x?1:0},Buffer.isEncoding=function(encoding){switch(String(encoding).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},Buffer.concat=function(list,length){if(!Array.isArray(list))throw new TypeError('"list" argument must be an Array of Buffers');if(0===list.length)return Buffer.alloc(0);if(void 0===length)for(i=length=0;i<list.length;++i)length+=list[i].length;for(var buffer=Buffer.allocUnsafe(length),pos=0,i=0;i<list.length;++i){var buf=list[i];if(isInstance(buf,Uint8Array)&&(buf=Buffer.from(buf)),!Buffer.isBuffer(buf))throw new TypeError('"list" argument must be an Array of Buffers');buf.copy(buffer,pos),pos+=buf.length}return buffer},Buffer.byteLength=byteLength,Buffer.prototype._isBuffer=!0,Buffer.prototype.swap16=function(){var len=this.length;if(len%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var i=0;i<len;i+=2)swap(this,i,i+1);return this},Buffer.prototype.swap32=function(){var len=this.length;if(len%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var i=0;i<len;i+=4)swap(this,i,i+3),swap(this,i+1,i+2);return this},Buffer.prototype.swap64=function(){var len=this.length;if(len%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var i=0;i<len;i+=8)swap(this,i,i+7),swap(this,i+1,i+6),swap(this,i+2,i+5),swap(this,i+3,i+4);return this},Buffer.prototype.toLocaleString=Buffer.prototype.toString=function(){var length=this.length;return 0===length?"":0===arguments.length?utf8Slice(this,0,length):slowToString.apply(this,arguments)},Buffer.prototype.equals=function(b){if(Buffer.isBuffer(b))return this===b||0===Buffer.compare(this,b);throw new TypeError("Argument must be a Buffer")},Buffer.prototype.inspect=function(){var str="",max=exports.INSPECT_MAX_BYTES,str=this.toString("hex",0,max).replace(/(.{2})/g,"$1 ").trim();return this.length>max&&(str+=" ... "),"<Buffer "+str+">"},Buffer.prototype.compare=function(target,start,end,thisStart,thisEnd){if(isInstance(target,Uint8Array)&&(target=Buffer.from(target,target.offset,target.byteLength)),!Buffer.isBuffer(target))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof target);if(void 0===end&&(end=target?target.length:0),void 0===thisStart&&(thisStart=0),void 0===thisEnd&&(thisEnd=this.length),(start=void 0===start?0:start)<0||end>target.length||thisStart<0||thisEnd>this.length)throw new RangeError("out of range index");if(thisEnd<=thisStart&&end<=start)return 0;if(thisEnd<=thisStart)return-1;if(end<=start)return 1;if(this===target)return 0;for(var x=(thisEnd>>>=0)-(thisStart>>>=0),y=(end>>>=0)-(start>>>=0),len=Math.min(x,y),thisCopy=this.slice(thisStart,thisEnd),targetCopy=target.slice(start,end),i=0;i<len;++i)if(thisCopy[i]!==targetCopy[i]){x=thisCopy[i],y=targetCopy[i];break}return x<y?-1:y<x?1:0},Buffer.prototype.includes=function(val,byteOffset,encoding){return-1!==this.indexOf(val,byteOffset,encoding)},Buffer.prototype.indexOf=function(val,byteOffset,encoding){return bidirectionalIndexOf(this,val,byteOffset,encoding,!0)},Buffer.prototype.lastIndexOf=function(val,byteOffset,encoding){return bidirectionalIndexOf(this,val,byteOffset,encoding,!1)},Buffer.prototype.write=function(string,offset,length,encoding){if(void 0===offset)encoding="utf8",length=this.length,offset=0;else if(void 0===length&&"string"==typeof offset)encoding=offset,length=this.length,offset=0;else{if(!isFinite(offset))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");offset>>>=0,isFinite(length)?(length>>>=0,void 0===encoding&&(encoding="utf8")):(encoding=length,length=void 0)}var remaining=this.length-offset;if((void 0===length||remaining<length)&&(length=remaining),0<string.length&&(length<0||offset<0)||offset>this.length)throw new RangeError("Attempt to write outside buffer bounds");encoding=encoding||"utf8";for(var loweredCase=!1;;)switch(encoding){case"hex":return function(buf,string,offset,length){offset=Number(offset)||0;var remaining=buf.length-offset;(!length||remaining<(length=Number(length)))&&(length=remaining),(remaining=string.length)/2<length&&(length=remaining/2);for(var i=0;i<length;++i){var parsed=parseInt(string.substr(2*i,2),16);if(numberIsNaN(parsed))return i;buf[offset+i]=parsed}return i}(this,string,offset,length);case"utf8":case"utf-8":return function(buf,string,offset,length){return blitBuffer(utf8ToBytes(string,buf.length-offset),buf,offset,length)}(this,string,offset,length);case"ascii":return asciiWrite(this,string,offset,length);case"latin1":case"binary":return asciiWrite(this,string,offset,length);case"base64":return function(buf,string,offset,length){return blitBuffer(base64ToBytes(string),buf,offset,length)}(this,string,offset,length);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return ucs2Write(this,string,offset,length);default:if(loweredCase)throw new TypeError("Unknown encoding: "+encoding);encoding=(""+encoding).toLowerCase(),loweredCase=!0}},Buffer.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var MAX_ARGUMENTS_LENGTH=4096;function checkOffset(offset,ext,length){if(offset%1!=0||offset<0)throw new RangeError("offset is not uint");if(length<offset+ext)throw new RangeError("Trying to access beyond buffer length")}function checkInt(buf,value,offset,ext,max,min){if(!Buffer.isBuffer(buf))throw new TypeError('"buffer" argument must be a Buffer instance');if(max<value||value<min)throw new RangeError('"value" argument is out of bounds');if(offset+ext>buf.length)throw new RangeError("Index out of range")}function checkIEEE754(buf,value,offset,ext){if(offset+ext>buf.length)throw new RangeError("Index out of range");if(offset<0)throw new RangeError("Index out of range")}function writeFloat(buf,value,offset,littleEndian,noAssert){return value=+value,offset>>>=0,noAssert||checkIEEE754(buf,0,offset,4),ieee754.write(buf,value,offset,littleEndian,23,4),offset+4}function writeDouble(buf,value,offset,littleEndian,noAssert){return value=+value,offset>>>=0,noAssert||checkIEEE754(buf,0,offset,8),ieee754.write(buf,value,offset,littleEndian,52,8),offset+8}Buffer.prototype.slice=function(start,end){var len=this.length,len=((start=~~start)<0?(start+=len)<0&&(start=0):len<start&&(start=len),(end=void 0===end?len:~~end)<0?(end+=len)<0&&(end=0):len<end&&(end=len),end<start&&(end=start),this.subarray(start,end));return len.__proto__=Buffer.prototype,len},Buffer.prototype.readUIntLE=function(offset,byteLength,noAssert){offset>>>=0,byteLength>>>=0,noAssert||checkOffset(offset,byteLength,this.length);for(var val=this[offset],mul=1,i=0;++i<byteLength&&(mul*=256);)val+=this[offset+i]*mul;return val},Buffer.prototype.readUIntBE=function(offset,byteLength,noAssert){offset>>>=0,byteLength>>>=0,noAssert||checkOffset(offset,byteLength,this.length);for(var val=this[offset+--byteLength],mul=1;0<byteLength&&(mul*=256);)val+=this[offset+--byteLength]*mul;return val},Buffer.prototype.readUInt8=function(offset,noAssert){return offset>>>=0,noAssert||checkOffset(offset,1,this.length),this[offset]},Buffer.prototype.readUInt16LE=function(offset,noAssert){return offset>>>=0,noAssert||checkOffset(offset,2,this.length),this[offset]|this[offset+1]<<8},Buffer.prototype.readUInt16BE=function(offset,noAssert){return offset>>>=0,noAssert||checkOffset(offset,2,this.length),this[offset]<<8|this[offset+1]},Buffer.prototype.readUInt32LE=function(offset,noAssert){return offset>>>=0,noAssert||checkOffset(offset,4,this.length),(this[offset]|this[offset+1]<<8|this[offset+2]<<16)+16777216*this[offset+3]},Buffer.prototype.readUInt32BE=function(offset,noAssert){return offset>>>=0,noAssert||checkOffset(offset,4,this.length),16777216*this[offset]+(this[offset+1]<<16|this[offset+2]<<8|this[offset+3])},Buffer.prototype.readIntLE=function(offset,byteLength,noAssert){offset>>>=0,byteLength>>>=0,noAssert||checkOffset(offset,byteLength,this.length);for(var val=this[offset],mul=1,i=0;++i<byteLength&&(mul*=256);)val+=this[offset+i]*mul;return(mul*=128)<=val&&(val-=Math.pow(2,8*byteLength)),val},Buffer.prototype.readIntBE=function(offset,byteLength,noAssert){offset>>>=0,byteLength>>>=0,noAssert||checkOffset(offset,byteLength,this.length);for(var i=byteLength,mul=1,val=this[offset+--i];0<i&&(mul*=256);)val+=this[offset+--i]*mul;return(mul*=128)<=val&&(val-=Math.pow(2,8*byteLength)),val},Buffer.prototype.readInt8=function(offset,noAssert){return offset>>>=0,noAssert||checkOffset(offset,1,this.length),128&this[offset]?-1*(255-this[offset]+1):this[offset]},Buffer.prototype.readInt16LE=function(offset,noAssert){offset>>>=0,noAssert||checkOffset(offset,2,this.length);noAssert=this[offset]|this[offset+1]<<8;return 32768&noAssert?4294901760|noAssert:noAssert},Buffer.prototype.readInt16BE=function(offset,noAssert){offset>>>=0,noAssert||checkOffset(offset,2,this.length);noAssert=this[offset+1]|this[offset]<<8;return 32768&noAssert?4294901760|noAssert:noAssert},Buffer.prototype.readInt32LE=function(offset,noAssert){return offset>>>=0,noAssert||checkOffset(offset,4,this.length),this[offset]|this[offset+1]<<8|this[offset+2]<<16|this[offset+3]<<24},Buffer.prototype.readInt32BE=function(offset,noAssert){return offset>>>=0,noAssert||checkOffset(offset,4,this.length),this[offset]<<24|this[offset+1]<<16|this[offset+2]<<8|this[offset+3]},Buffer.prototype.readFloatLE=function(offset,noAssert){return offset>>>=0,noAssert||checkOffset(offset,4,this.length),ieee754.read(this,offset,!0,23,4)},Buffer.prototype.readFloatBE=function(offset,noAssert){return offset>>>=0,noAssert||checkOffset(offset,4,this.length),ieee754.read(this,offset,!1,23,4)},Buffer.prototype.readDoubleLE=function(offset,noAssert){return offset>>>=0,noAssert||checkOffset(offset,8,this.length),ieee754.read(this,offset,!0,52,8)},Buffer.prototype.readDoubleBE=function(offset,noAssert){return offset>>>=0,noAssert||checkOffset(offset,8,this.length),ieee754.read(this,offset,!1,52,8)},Buffer.prototype.writeUIntLE=function(value,offset,byteLength,noAssert){value=+value,offset>>>=0,byteLength>>>=0,noAssert||checkInt(this,value,offset,byteLength,Math.pow(2,8*byteLength)-1,0);var mul=1,i=0;for(this[offset]=255&value;++i<byteLength&&(mul*=256);)this[offset+i]=value/mul&255;return offset+byteLength},Buffer.prototype.writeUIntBE=function(value,offset,byteLength,noAssert){value=+value,offset>>>=0,byteLength>>>=0,noAssert||checkInt(this,value,offset,byteLength,Math.pow(2,8*byteLength)-1,0);var i=byteLength-1,mul=1;for(this[offset+i]=255&value;0<=--i&&(mul*=256);)this[offset+i]=value/mul&255;return offset+byteLength},Buffer.prototype.writeUInt8=function(value,offset,noAssert){return value=+value,offset>>>=0,noAssert||checkInt(this,value,offset,1,255,0),this[offset]=255&value,offset+1},Buffer.prototype.writeUInt16LE=function(value,offset,noAssert){return value=+value,offset>>>=0,noAssert||checkInt(this,value,offset,2,65535,0),this[offset]=255&value,this[offset+1]=value>>>8,offset+2},Buffer.prototype.writeUInt16BE=function(value,offset,noAssert){return value=+value,offset>>>=0,noAssert||checkInt(this,value,offset,2,65535,0),this[offset]=value>>>8,this[offset+1]=255&value,offset+2},Buffer.prototype.writeUInt32LE=function(value,offset,noAssert){return value=+value,offset>>>=0,noAssert||checkInt(this,value,offset,4,4294967295,0),this[offset+3]=value>>>24,this[offset+2]=value>>>16,this[offset+1]=value>>>8,this[offset]=255&value,offset+4},Buffer.prototype.writeUInt32BE=function(value,offset,noAssert){return value=+value,offset>>>=0,noAssert||checkInt(this,value,offset,4,4294967295,0),this[offset]=value>>>24,this[offset+1]=value>>>16,this[offset+2]=value>>>8,this[offset+3]=255&value,offset+4},Buffer.prototype.writeIntLE=function(value,offset,byteLength,noAssert){value=+value,offset>>>=0,noAssert||checkInt(this,value,offset,byteLength,(noAssert=Math.pow(2,8*byteLength-1))-1,-noAssert);var i=0,mul=1,sub=0;for(this[offset]=255&value;++i<byteLength&&(mul*=256);)value<0&&0===sub&&0!==this[offset+i-1]&&(sub=1),this[offset+i]=(value/mul>>0)-sub&255;return offset+byteLength},Buffer.prototype.writeIntBE=function(value,offset,byteLength,noAssert){value=+value,offset>>>=0,noAssert||checkInt(this,value,offset,byteLength,(noAssert=Math.pow(2,8*byteLength-1))-1,-noAssert);var i=byteLength-1,mul=1,sub=0;for(this[offset+i]=255&value;0<=--i&&(mul*=256);)value<0&&0===sub&&0!==this[offset+i+1]&&(sub=1),this[offset+i]=(value/mul>>0)-sub&255;return offset+byteLength},Buffer.prototype.writeInt8=function(value,offset,noAssert){return value=+value,offset>>>=0,noAssert||checkInt(this,value,offset,1,127,-128),this[offset]=255&(value=value<0?255+value+1:value),offset+1},Buffer.prototype.writeInt16LE=function(value,offset,noAssert){return value=+value,offset>>>=0,noAssert||checkInt(this,value,offset,2,32767,-32768),this[offset]=255&value,this[offset+1]=value>>>8,offset+2},Buffer.prototype.writeInt16BE=function(value,offset,noAssert){return value=+value,offset>>>=0,noAssert||checkInt(this,value,offset,2,32767,-32768),this[offset]=value>>>8,this[offset+1]=255&value,offset+2},Buffer.prototype.writeInt32LE=function(value,offset,noAssert){return value=+value,offset>>>=0,noAssert||checkInt(this,value,offset,4,2147483647,-2147483648),this[offset]=255&value,this[offset+1]=value>>>8,this[offset+2]=value>>>16,this[offset+3]=value>>>24,offset+4},Buffer.prototype.writeInt32BE=function(value,offset,noAssert){return value=+value,offset>>>=0,noAssert||checkInt(this,value,offset,4,2147483647,-2147483648),this[offset]=(value=value<0?4294967295+value+1:value)>>>24,this[offset+1]=value>>>16,this[offset+2]=value>>>8,this[offset+3]=255&value,offset+4},Buffer.prototype.writeFloatLE=function(value,offset,noAssert){return writeFloat(this,value,offset,!0,noAssert)},Buffer.prototype.writeFloatBE=function(value,offset,noAssert){return writeFloat(this,value,offset,!1,noAssert)},Buffer.prototype.writeDoubleLE=function(value,offset,noAssert){return writeDouble(this,value,offset,!0,noAssert)},Buffer.prototype.writeDoubleBE=function(value,offset,noAssert){return writeDouble(this,value,offset,!1,noAssert)},Buffer.prototype.copy=function(target,targetStart,start,end){if(!Buffer.isBuffer(target))throw new TypeError("argument should be a Buffer");if(start=start||0,end||0===end||(end=this.length),targetStart>=target.length&&(targetStart=target.length),(end=0<end&&end<start?start:end)===start)return 0;if(0===target.length||0===this.length)return 0;if((targetStart=targetStart||0)<0)throw new RangeError("targetStart out of bounds");if(start<0||start>=this.length)throw new RangeError("Index out of range");if(end<0)throw new RangeError("sourceEnd out of bounds");end>this.length&&(end=this.length);var len=(end=target.length-targetStart<end-start?target.length-targetStart+start:end)-start;if(this===target&&"function"==typeof Uint8Array.prototype.copyWithin)this.copyWithin(targetStart,start,end);else if(this===target&&start<targetStart&&targetStart<end)for(var i=len-1;0<=i;--i)target[i+targetStart]=this[i+start];else Uint8Array.prototype.set.call(target,this.subarray(start,end),targetStart);return len},Buffer.prototype.fill=function(val,start,end,encoding){if("string"==typeof val){if("string"==typeof start?(encoding=start,start=0,end=this.length):"string"==typeof end&&(encoding=end,end=this.length),void 0!==encoding&&"string"!=typeof encoding)throw new TypeError("encoding must be a string");if("string"==typeof encoding&&!Buffer.isEncoding(encoding))throw new TypeError("Unknown encoding: "+encoding);var code;1===val.length&&(code=val.charCodeAt(0),("utf8"===encoding&&code<128||"latin1"===encoding)&&(val=code))}else"number"==typeof val&&(val&=255);if(start<0||this.length<start||this.length<end)throw new RangeError("Out of range index");if(end<=start)return this;var i;if(start>>>=0,end=void 0===end?this.length:end>>>0,"number"==typeof(val=val||0))for(i=start;i<end;++i)this[i]=val;else{var bytes=Buffer.isBuffer(val)?val:Buffer.from(val,encoding),len=bytes.length;if(0===len)throw new TypeError('The value "'+val+'" is invalid for argument "value"');for(i=0;i<end-start;++i)this[i+start]=bytes[i%len]}return this};var INVALID_BASE64_RE=/[^+/0-9A-Za-z-_]/g;function utf8ToBytes(string,units){units=units||1/0;for(var codePoint,length=string.length,leadSurrogate=null,bytes=[],i=0;i<length;++i){if(55295<(codePoint=string.charCodeAt(i))&&codePoint<57344){if(!leadSurrogate){if(56319<codePoint){-1<(units-=3)&&bytes.push(239,191,189);continue}if(i+1===length){-1<(units-=3)&&bytes.push(239,191,189);continue}leadSurrogate=codePoint;continue}if(codePoint<56320){-1<(units-=3)&&bytes.push(239,191,189),leadSurrogate=codePoint;continue}codePoint=65536+(leadSurrogate-55296<<10|codePoint-56320)}else leadSurrogate&&-1<(units-=3)&&bytes.push(239,191,189);if(leadSurrogate=null,codePoint<128){if(--units<0)break;bytes.push(codePoint)}else if(codePoint<2048){if((units-=2)<0)break;bytes.push(codePoint>>6|192,63&codePoint|128)}else if(codePoint<65536){if((units-=3)<0)break;bytes.push(codePoint>>12|224,codePoint>>6&63|128,63&codePoint|128)}else{if(!(codePoint<1114112))throw new Error("Invalid code point");if((units-=4)<0)break;bytes.push(codePoint>>18|240,codePoint>>12&63|128,codePoint>>6&63|128,63&codePoint|128)}}return bytes}function base64ToBytes(str){return base64.toByteArray(function(str){if((str=(str=str.split("=")[0]).trim().replace(INVALID_BASE64_RE,"")).length<2)return"";for(;str.length%4!=0;)str+="=";return str}(str))}function blitBuffer(src,dst,offset,length){for(var i=0;i<length&&!(i+offset>=dst.length||i>=src.length);++i)dst[i+offset]=src[i];return i}function isInstance(obj,type){return obj instanceof type||null!=obj&&null!=obj.constructor&&null!=obj.constructor.name&&obj.constructor.name===type.name}function numberIsNaN(obj){return obj!=obj}}.call(this)}.call(this,require("buffer").Buffer)},{"base64-js":65,buffer:112,ieee754:219}],113:[function(require,module,exports){module.exports=Stream;var EE=require("events").EventEmitter;function Stream(){EE.call(this)}require("inherits")(Stream,EE),Stream.Readable=require("readable-stream/lib/_stream_readable.js"),Stream.Writable=require("readable-stream/lib/_stream_writable.js"),Stream.Duplex=require("readable-stream/lib/_stream_duplex.js"),Stream.Transform=require("readable-stream/lib/_stream_transform.js"),Stream.PassThrough=require("readable-stream/lib/_stream_passthrough.js"),Stream.finished=require("readable-stream/lib/internal/streams/end-of-stream.js"),Stream.pipeline=require("readable-stream/lib/internal/streams/pipeline.js"),(Stream.Stream=Stream).prototype.pipe=function(dest,options){var source=this;function ondata(chunk){dest.writable&&!1===dest.write(chunk)&&source.pause&&source.pause()}function ondrain(){source.readable&&source.resume&&source.resume()}source.on("data",ondata),dest.on("drain",ondrain),dest._isStdio||options&&!1===options.end||(source.on("end",onend),source.on("close",onclose));var didOnEnd=!1;function onend(){didOnEnd||(didOnEnd=!0,dest.end())}function onclose(){didOnEnd||(didOnEnd=!0,"function"==typeof dest.destroy&&dest.destroy())}function onerror(er){if(cleanup(),0===EE.listenerCount(this,"error"))throw er}function cleanup(){source.removeListener("data",ondata),dest.removeListener("drain",ondrain),source.removeListener("end",onend),source.removeListener("close",onclose),source.removeListener("error",onerror),dest.removeListener("error",onerror),source.removeListener("end",cleanup),source.removeListener("close",cleanup),dest.removeListener("close",cleanup)}return source.on("error",onerror),dest.on("error",onerror),source.on("end",cleanup),source.on("close",cleanup),dest.on("close",cleanup),dest.emit("pipe",source),dest}},{events:178,inherits:220,"readable-stream/lib/_stream_duplex.js":115,"readable-stream/lib/_stream_passthrough.js":116,"readable-stream/lib/_stream_readable.js":117,"readable-stream/lib/_stream_transform.js":118,"readable-stream/lib/_stream_writable.js":119,"readable-stream/lib/internal/streams/end-of-stream.js":123,"readable-stream/lib/internal/streams/pipeline.js":125}],114:[function(require,module,exports){arguments[4][96][0].apply(exports,arguments)},{dup:96}],115:[function(require,module,exports){arguments[4][97][0].apply(exports,arguments)},{"./_stream_readable":117,"./_stream_writable":119,_process:354,dup:97,inherits:220}],116:[function(require,module,exports){arguments[4][98][0].apply(exports,arguments)},{"./_stream_transform":118,dup:98,inherits:220}],117:[function(require,module,exports){arguments[4][99][0].apply(exports,arguments)},{"../errors":114,"./_stream_duplex":115,"./internal/streams/async_iterator":120,"./internal/streams/buffer_list":121,"./internal/streams/destroy":122,"./internal/streams/from":124,"./internal/streams/state":126,"./internal/streams/stream":127,_process:354,buffer:112,dup:99,events:178,inherits:220,"string_decoder/":377,util:68}],118:[function(require,module,exports){arguments[4][100][0].apply(exports,arguments)},{"../errors":114,"./_stream_duplex":115,dup:100,inherits:220}],119:[function(require,module,exports){arguments[4][101][0].apply(exports,arguments)},{"../errors":114,"./_stream_duplex":115,"./internal/streams/destroy":122,"./internal/streams/state":126,"./internal/streams/stream":127,_process:354,buffer:112,dup:101,inherits:220,"util-deprecate":378}],120:[function(require,module,exports){arguments[4][102][0].apply(exports,arguments)},{"./end-of-stream":123,_process:354,dup:102}],121:[function(require,module,exports){arguments[4][103][0].apply(exports,arguments)},{buffer:112,dup:103,util:68}],122:[function(require,module,exports){arguments[4][104][0].apply(exports,arguments)},{_process:354,dup:104}],123:[function(require,module,exports){arguments[4][105][0].apply(exports,arguments)},{"../../../errors":114,dup:105}],124:[function(require,module,exports){arguments[4][106][0].apply(exports,arguments)},{dup:106}],125:[function(require,module,exports){arguments[4][107][0].apply(exports,arguments)},{"../../../errors":114,"./end-of-stream":123,dup:107}],126:[function(require,module,exports){arguments[4][108][0].apply(exports,arguments)},{"../../../errors":114,dup:108}],127:[function(require,module,exports){arguments[4][109][0].apply(exports,arguments)},{dup:109,events:178}],128:[function(require,module,exports){module.exports=function(arg){return arg&&"object"==typeof arg&&"function"==typeof arg.copy&&"function"==typeof arg.fill&&"function"==typeof arg.readUInt8}},{}],129:[function(require,module,exports){"use strict";var isArgumentsObject=require("is-arguments"),isGeneratorFunction=require("is-generator-function"),whichTypedArray=require("which-typed-array"),isTypedArray=require("is-typed-array");function uncurryThis(f){return f.call.bind(f)}var bigIntValue,symbolValue,BigIntSupported="undefined"!=typeof BigInt,SymbolSupported="undefined"!=typeof Symbol,ObjectToString=uncurryThis(Object.prototype.toString),numberValue=uncurryThis(Number.prototype.valueOf),stringValue=uncurryThis(String.prototype.valueOf),booleanValue=uncurryThis(Boolean.prototype.valueOf);function checkBoxedPrimitive(value,prototypeValueOf){if("object"!=typeof value)return!1;try{return prototypeValueOf(value),!0}catch(e){return!1}}function isMapToString(value){return"[object Map]"===ObjectToString(value)}function isSetToString(value){return"[object Set]"===ObjectToString(value)}function isWeakMapToString(value){return"[object WeakMap]"===ObjectToString(value)}function isWeakSetToString(value){return"[object WeakSet]"===ObjectToString(value)}function isArrayBufferToString(value){return"[object ArrayBuffer]"===ObjectToString(value)}function isArrayBuffer(value){return"undefined"!=typeof ArrayBuffer&&(isArrayBufferToString.working?isArrayBufferToString(value):value instanceof ArrayBuffer)}function isDataViewToString(value){return"[object DataView]"===ObjectToString(value)}function isDataView(value){return"undefined"!=typeof DataView&&(isDataViewToString.working?isDataViewToString(value):value instanceof DataView)}BigIntSupported&&(bigIntValue=uncurryThis(BigInt.prototype.valueOf)),SymbolSupported&&(symbolValue=uncurryThis(Symbol.prototype.valueOf)),exports.isArgumentsObject=isArgumentsObject,exports.isGeneratorFunction=isGeneratorFunction,exports.isTypedArray=isTypedArray,exports.isPromise=function(input){return"undefined"!=typeof Promise&&input instanceof Promise||null!==input&&"object"==typeof input&&"function"==typeof input.then&&"function"==typeof input.catch},exports.isArrayBufferView=function(value){return"undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(value):isTypedArray(value)||isDataView(value)},exports.isUint8Array=function(value){return"Uint8Array"===whichTypedArray(value)},exports.isUint8ClampedArray=function(value){return"Uint8ClampedArray"===whichTypedArray(value)},exports.isUint16Array=function(value){return"Uint16Array"===whichTypedArray(value)},exports.isUint32Array=function(value){return"Uint32Array"===whichTypedArray(value)},exports.isInt8Array=function(value){return"Int8Array"===whichTypedArray(value)},exports.isInt16Array=function(value){return"Int16Array"===whichTypedArray(value)},exports.isInt32Array=function(value){return"Int32Array"===whichTypedArray(value)},exports.isFloat32Array=function(value){return"Float32Array"===whichTypedArray(value)},exports.isFloat64Array=function(value){return"Float64Array"===whichTypedArray(value)},exports.isBigInt64Array=function(value){return"BigInt64Array"===whichTypedArray(value)},exports.isBigUint64Array=function(value){return"BigUint64Array"===whichTypedArray(value)},isMapToString.working="undefined"!=typeof Map&&isMapToString(new Map),exports.isMap=function(value){return"undefined"!=typeof Map&&(isMapToString.working?isMapToString(value):value instanceof Map)},isSetToString.working="undefined"!=typeof Set&&isSetToString(new Set),exports.isSet=function(value){return"undefined"!=typeof Set&&(isSetToString.working?isSetToString(value):value instanceof Set)},isWeakMapToString.working="undefined"!=typeof WeakMap&&isWeakMapToString(new WeakMap),exports.isWeakMap=function(value){return"undefined"!=typeof WeakMap&&(isWeakMapToString.working?isWeakMapToString(value):value instanceof WeakMap)},isWeakSetToString.working="undefined"!=typeof WeakSet&&isWeakSetToString(new WeakSet),exports.isWeakSet=isWeakSetToString,isArrayBufferToString.working="undefined"!=typeof ArrayBuffer&&isArrayBufferToString(new ArrayBuffer),exports.isArrayBuffer=isArrayBuffer,isDataViewToString.working="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof DataView&&isDataViewToString(new DataView(new ArrayBuffer(1),0,1)),exports.isDataView=isDataView;var SharedArrayBufferCopy="undefined"!=typeof SharedArrayBuffer?SharedArrayBuffer:void 0;function isSharedArrayBufferToString(value){return"[object SharedArrayBuffer]"===ObjectToString(value)}function isSharedArrayBuffer(value){return void 0!==SharedArrayBufferCopy&&((isSharedArrayBufferToString.working=void 0===isSharedArrayBufferToString.working?isSharedArrayBufferToString(new SharedArrayBufferCopy):isSharedArrayBufferToString.working)?isSharedArrayBufferToString(value):value instanceof SharedArrayBufferCopy)}function isNumberObject(value){return checkBoxedPrimitive(value,numberValue)}function isStringObject(value){return checkBoxedPrimitive(value,stringValue)}function isBooleanObject(value){return checkBoxedPrimitive(value,booleanValue)}function isBigIntObject(value){return BigIntSupported&&checkBoxedPrimitive(value,bigIntValue)}function isSymbolObject(value){return SymbolSupported&&checkBoxedPrimitive(value,symbolValue)}exports.isSharedArrayBuffer=isSharedArrayBuffer,exports.isAsyncFunction=function(value){return"[object AsyncFunction]"===ObjectToString(value)},exports.isMapIterator=function(value){return"[object Map Iterator]"===ObjectToString(value)},exports.isSetIterator=function(value){return"[object Set Iterator]"===ObjectToString(value)},exports.isGeneratorObject=function(value){return"[object Generator]"===ObjectToString(value)},exports.isWebAssemblyCompiledModule=function(value){return"[object WebAssembly.Module]"===ObjectToString(value)},exports.isNumberObject=isNumberObject,exports.isStringObject=isStringObject,exports.isBooleanObject=isBooleanObject,exports.isBigIntObject=isBigIntObject,exports.isSymbolObject=isSymbolObject,exports.isBoxedPrimitive=function(value){return isNumberObject(value)||isStringObject(value)||isBooleanObject(value)||isBigIntObject(value)||isSymbolObject(value)},exports.isAnyArrayBuffer=function(value){return"undefined"!=typeof Uint8Array&&(isArrayBuffer(value)||isSharedArrayBuffer(value))},["isProxy","isExternal","isModuleNamespaceObject"].forEach(function(method){Object.defineProperty(exports,method,{enumerable:!1,value:function(){throw new Error(method+" is not supported in userland")}})})},{"is-arguments":222,"is-generator-function":225,"is-typed-array":226,"which-typed-array":379}],130:[function(require,module,exports){!function(process){!function(){var debugEnv,getOwnPropertyDescriptors=Object.getOwnPropertyDescriptors||function(obj){for(var keys=Object.keys(obj),descriptors={},i=0;i<keys.length;i++)descriptors[keys[i]]=Object.getOwnPropertyDescriptor(obj,keys[i]);return descriptors},formatRegExp=/%[sdj%]/g,debugs=(exports.format=function(f){if(!isString(f)){for(var objects=[],i=0;i<arguments.length;i++)objects.push(inspect(arguments[i]));return objects.join(" ")}for(var i=1,args=arguments,len=args.length,str=String(f).replace(formatRegExp,function(x){if("%%"===x)return"%";if(len<=i)return x;switch(x){case"%s":return String(args[i++]);case"%d":return Number(args[i++]);case"%j":try{return JSON.stringify(args[i++])}catch(_){return"[Circular]"}default:return x}}),x=args[i];i<len;x=args[++i])null!==x&&isObject(x)?str+=" "+inspect(x):str+=" "+x;return str},exports.deprecate=function(fn,msg){if(void 0!==process&&!0===process.noDeprecation)return fn;if(void 0===process)return function(){return exports.deprecate(fn,msg).apply(this,arguments)};var warned=!1;return function(){if(!warned){if(process.throwDeprecation)throw new Error(msg);process.traceDeprecation?console.trace(msg):console.error(msg),warned=!0}return fn.apply(this,arguments)}},{}),debugEnvRegex=/^$/;function inspect(obj,opts){var ctx={seen:[],stylize:stylizeNoColor};return 3<=arguments.length&&(ctx.depth=arguments[2]),4<=arguments.length&&(ctx.colors=arguments[3]),isBoolean(opts)?ctx.showHidden=opts:opts&&exports._extend(ctx,opts),void 0===ctx.showHidden&&(ctx.showHidden=!1),void 0===ctx.depth&&(ctx.depth=2),void 0===ctx.colors&&(ctx.colors=!1),void 0===ctx.customInspect&&(ctx.customInspect=!0),ctx.colors&&(ctx.stylize=stylizeWithColor),formatValue(ctx,obj,ctx.depth)}function stylizeWithColor(str,styleType){styleType=inspect.styles[styleType];return styleType?"["+inspect.colors[styleType][0]+"m"+str+"["+inspect.colors[styleType][1]+"m":str}function stylizeNoColor(str,styleType){return str}function formatValue(ctx,value,recurseTimes){if(ctx.customInspect&&value&&isFunction(value.inspect)&&value.inspect!==exports.inspect&&(!value.constructor||value.constructor.prototype!==value))return isString(ret=value.inspect(recurseTimes,ctx))?ret:formatValue(ctx,ret,recurseTimes);var ret=function(ctx,value){if(void 0===value)return ctx.stylize("undefined","undefined");{var simple;if(isString(value))return simple="'"+JSON.stringify(value).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'",ctx.stylize(simple,"string")}return isNumber(value)?ctx.stylize(""+value,"number"):isBoolean(value)?ctx.stylize(""+value,"boolean"):null===value?ctx.stylize("null","null"):void 0}(ctx,value);if(ret)return ret;var ret=Object.keys(value),visibleKeys=function(array){var hash={};return array.forEach(function(val,idx){hash[val]=!0}),hash}(ret);if(ctx.showHidden&&(ret=Object.getOwnPropertyNames(value)),isError(value)&&(0<=ret.indexOf("message")||0<=ret.indexOf("description")))return formatError(value);if(0===ret.length){if(isFunction(value))return name=value.name?": "+value.name:"",ctx.stylize("[Function"+name+"]","special");if(isRegExp(value))return ctx.stylize(RegExp.prototype.toString.call(value),"regexp");if(isDate(value))return ctx.stylize(Date.prototype.toString.call(value),"date");if(isError(value))return formatError(value)}var name="",array=!1,braces=["{","}"];return isArray(value)&&(array=!0,braces=["[","]"]),isFunction(value)&&(name=" [Function"+(value.name?": "+value.name:"")+"]"),isRegExp(value)&&(name=" "+RegExp.prototype.toString.call(value)),isDate(value)&&(name=" "+Date.prototype.toUTCString.call(value)),isError(value)&&(name=" "+formatError(value)),0!==ret.length||array&&0!=value.length?recurseTimes<0?isRegExp(value)?ctx.stylize(RegExp.prototype.toString.call(value),"regexp"):ctx.stylize("[Object]","special"):(ctx.seen.push(value),ret=array?function(ctx,value,recurseTimes,visibleKeys,keys){for(var output=[],i=0,l=value.length;i<l;++i)hasOwnProperty(value,String(i))?output.push(formatProperty(ctx,value,recurseTimes,visibleKeys,String(i),!0)):output.push("");return keys.forEach(function(key){key.match(/^\d+$/)||output.push(formatProperty(ctx,value,recurseTimes,visibleKeys,key,!0))}),output}(ctx,value,recurseTimes,visibleKeys,ret):ret.map(function(key){return formatProperty(ctx,value,recurseTimes,visibleKeys,key,array)}),ctx.seen.pop(),function(output,base,braces){if(60<output.reduce(function(prev,cur){return 0<=cur.indexOf("\n")&&0,prev+cur.replace(/\u001b\[\d\d?m/g,"").length+1},0))return braces[0]+(""===base?"":base+"\n ")+" "+output.join(",\n  ")+" "+braces[1];return braces[0]+base+" "+output.join(", ")+" "+braces[1]}(ret,name,braces)):braces[0]+name+braces[1]}function formatError(value){return"["+Error.prototype.toString.call(value)+"]"}function formatProperty(ctx,value,recurseTimes,visibleKeys,key,array){var name,str,value=Object.getOwnPropertyDescriptor(value,key)||{value:value[key]};if(value.get?str=value.set?ctx.stylize("[Getter/Setter]","special"):ctx.stylize("[Getter]","special"):value.set&&(str=ctx.stylize("[Setter]","special")),hasOwnProperty(visibleKeys,key)||(name="["+key+"]"),str||(ctx.seen.indexOf(value.value)<0?-1<(str=formatValue(ctx,value.value,null===recurseTimes?null:recurseTimes-1)).indexOf("\n")&&(str=array?str.split("\n").map(function(line){return"  "+line}).join("\n").substr(2):"\n"+str.split("\n").map(function(line){return"   "+line}).join("\n")):str=ctx.stylize("[Circular]","special")),void 0===name){if(array&&key.match(/^\d+$/))return str;name=(name=JSON.stringify(""+key)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(name=name.substr(1,name.length-2),ctx.stylize(name,"name")):(name=name.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),ctx.stylize(name,"string"))}return name+": "+str}function isArray(ar){return Array.isArray(ar)}function isBoolean(arg){return"boolean"==typeof arg}function isNull(arg){return null===arg}function isNumber(arg){return"number"==typeof arg}function isString(arg){return"string"==typeof arg}function isUndefined(arg){return void 0===arg}function isRegExp(re){return isObject(re)&&"[object RegExp]"===objectToString(re)}function isObject(arg){return"object"==typeof arg&&null!==arg}function isDate(d){return isObject(d)&&"[object Date]"===objectToString(d)}function isError(e){return isObject(e)&&("[object Error]"===objectToString(e)||e instanceof Error)}function isFunction(arg){return"function"==typeof arg}function objectToString(o){return Object.prototype.toString.call(o)}function pad(n){return n<10?"0"+n.toString(10):n.toString(10)}process.env.NODE_DEBUG&&(debugEnv=(debugEnv=process.env.NODE_DEBUG).replace(/[|\\{}()[\]^$+?.]/g,"\\$&").replace(/\*/g,".*").replace(/,/g,"$|^").toUpperCase(),debugEnvRegex=new RegExp("^"+debugEnv+"$","i")),exports.debuglog=function(set){var pid;return set=set.toUpperCase(),debugs[set]||(debugEnvRegex.test(set)?(pid=process.pid,debugs[set]=function(){var msg=exports.format.apply(exports,arguments);console.error("%s %d: %s",set,pid,msg)}):debugs[set]=function(){}),debugs[set]},(exports.inspect=inspect).colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},inspect.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},exports.types=require("./support/types"),exports.isArray=isArray,exports.isBoolean=isBoolean,exports.isNull=isNull,exports.isNullOrUndefined=function(arg){return null==arg},exports.isNumber=isNumber,exports.isString=isString,exports.isSymbol=function(arg){return"symbol"==typeof arg},exports.isUndefined=isUndefined,exports.isRegExp=isRegExp,exports.types.isRegExp=isRegExp,exports.isObject=isObject,exports.isDate=isDate,exports.types.isDate=isDate,exports.isError=isError,exports.types.isNativeError=isError,exports.isFunction=isFunction,exports.isPrimitive=function(arg){return null===arg||"boolean"==typeof arg||"number"==typeof arg||"string"==typeof arg||"symbol"==typeof arg||void 0===arg},exports.isBuffer=require("./support/isBuffer");var months=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function hasOwnProperty(obj,prop){return Object.prototype.hasOwnProperty.call(obj,prop)}exports.log=function(){var d,time;console.log("%s - %s",(d=new Date,time=[pad(d.getHours()),pad(d.getMinutes()),pad(d.getSeconds())].join(":"),[d.getDate(),months[d.getMonth()],time].join(" ")),exports.format.apply(exports,arguments))},exports.inherits=require("inherits"),exports._extend=function(origin,add){if(!add||!isObject(add))return origin;for(var keys=Object.keys(add),i=keys.length;i--;)origin[keys[i]]=add[keys[i]];return origin};var kCustomPromisifiedSymbol="undefined"!=typeof Symbol?Symbol("util.promisify.custom"):void 0;exports.promisify=function(original){if("function"!=typeof original)throw new TypeError('The "original" argument must be of type Function');if(kCustomPromisifiedSymbol&&original[kCustomPromisifiedSymbol]){var fn;if("function"!=typeof(fn=original[kCustomPromisifiedSymbol]))throw new TypeError('The "util.promisify.custom" argument must be of type Function');return Object.defineProperty(fn,kCustomPromisifiedSymbol,{value:fn,enumerable:!1,writable:!1,configurable:!0}),fn}function fn(){for(var promiseResolve,promiseReject,promise=new Promise(function(resolve,reject){promiseResolve=resolve,promiseReject=reject}),args=[],i=0;i<arguments.length;i++)args.push(arguments[i]);args.push(function(err,value){err?promiseReject(err):promiseResolve(value)});try{original.apply(this,args)}catch(err){promiseReject(err)}return promise}return Object.setPrototypeOf(fn,Object.getPrototypeOf(original)),kCustomPromisifiedSymbol&&Object.defineProperty(fn,kCustomPromisifiedSymbol,{value:fn,enumerable:!1,writable:!1,configurable:!0}),Object.defineProperties(fn,getOwnPropertyDescriptors(original))},exports.promisify.custom=kCustomPromisifiedSymbol,exports.callbackify=function(original){if("function"!=typeof original)throw new TypeError('The "original" argument must be of type Function');function callbackified(){for(var args=[],i=0;i<arguments.length;i++)args.push(arguments[i]);var maybeCb=args.pop();if("function"!=typeof maybeCb)throw new TypeError("The last argument must be of type Function");function cb(){return maybeCb.apply(self,arguments)}var self=this;original.apply(this,args).then(function(ret){process.nextTick(cb.bind(null,null,ret))},function(rej){process.nextTick(function(reason,cb){var newReason;return reason||((newReason=new Error("Promise was rejected with a falsy value")).reason=reason,reason=newReason),cb(reason)}.bind(null,rej,cb))})}return Object.setPrototypeOf(callbackified,Object.getPrototypeOf(original)),Object.defineProperties(callbackified,getOwnPropertyDescriptors(original)),callbackified}}.call(this)}.call(this,require("_process"))},{"./support/isBuffer":128,"./support/types":129,_process:354,inherits:220}],131:[function(require,module,exports){!function(Buffer){!function(){module.exports=function(a,b){for(var length=Math.min(a.length,b.length),buffer=new Buffer(length),i=0;i<length;++i)buffer[i]=a[i]^b[i];return buffer}}.call(this)}.call(this,require("buffer").Buffer)},{buffer:112}],132:[function(require,module,exports){"use strict";var GetIntrinsic=require("get-intrinsic"),callBind=require("./"),$indexOf=callBind(GetIntrinsic("String.prototype.indexOf"));module.exports=function(name,allowMissing){allowMissing=GetIntrinsic(name,!!allowMissing);return"function"==typeof allowMissing&&-1<$indexOf(name,".prototype.")?callBind(allowMissing):allowMissing}},{"./":133,"get-intrinsic":184}],133:[function(require,module,exports){"use strict";var bind=require("function-bind"),require=require("get-intrinsic"),$apply=require("%Function.prototype.apply%"),$call=require("%Function.prototype.call%"),$reflectApply=require("%Reflect.apply%",!0)||bind.call($call,$apply),$gOPD=require("%Object.getOwnPropertyDescriptor%",!0),$defineProperty=require("%Object.defineProperty%",!0),$max=require("%Math.max%");if($defineProperty)try{$defineProperty({},"a",{value:1})}catch(e){$defineProperty=null}module.exports=function(originalFunction){var func=$reflectApply(bind,$call,arguments);return $gOPD&&$defineProperty&&$gOPD(func,"length").configurable&&$defineProperty(func,"length",{value:1+$max(0,originalFunction.length-(arguments.length-1))}),func};function applyBind(){return $reflectApply(bind,$apply,arguments)}$defineProperty?$defineProperty(module.exports,"apply",{value:applyBind}):module.exports.apply=applyBind},{"function-bind":183,"get-intrinsic":184}],134:[function(require,module,exports){"use strict";var nextTick=require("./next-tick");exports.fromCallback=function(callback,symbol){if(void 0===callback){var promise=new Promise(function(resolve,reject){callback=function(err,res){err?reject(err):resolve(res)}});callback[void 0!==symbol?symbol:"promise"]=promise}else if("function"!=typeof callback)throw new TypeError("Callback must be a function");return callback},exports.fromPromise=function(promise,callback){if(void 0===callback)return promise;promise.then(function(res){nextTick(()=>callback(null,res))}).catch(function(err){nextTick(()=>callback(err))})}},{"./next-tick":135}],135:[function(require,module,exports){module.exports="function"==typeof queueMicrotask?queueMicrotask:fn=>Promise.resolve().then(fn)},{}],136:[function(require,module,exports){var Buffer=require("safe-buffer").Buffer,Transform=require("stream").Transform,StringDecoder=require("string_decoder").StringDecoder;function CipherBase(hashMode){Transform.call(this),this.hashMode="string"==typeof hashMode,this.hashMode?this[hashMode]=this._finalOrDigest:this.final=this._finalOrDigest,this._final&&(this.__final=this._final,this._final=null),this._decoder=null,this._encoding=null}require("inherits")(CipherBase,Transform),CipherBase.prototype.update=function(data,inputEnc,outputEnc){"string"==typeof data&&(data=Buffer.from(data,inputEnc));inputEnc=this._update(data);return this.hashMode?this:outputEnc?this._toString(inputEnc,outputEnc):inputEnc},CipherBase.prototype.setAutoPadding=function(){},CipherBase.prototype.getAuthTag=function(){throw new Error("trying to get auth tag in unsupported state")},CipherBase.prototype.setAuthTag=function(){throw new Error("trying to set auth tag in unsupported state")},CipherBase.prototype.setAAD=function(){throw new Error("trying to set aad in unsupported state")},CipherBase.prototype._transform=function(data,_,next){var err;try{this.hashMode?this._update(data):this.push(this._update(data))}catch(e){err=e}finally{next(err)}},CipherBase.prototype._flush=function(done){var err;try{this.push(this.__final())}catch(e){err=e}done(err)},CipherBase.prototype._finalOrDigest=function(outputEnc){var outData=this.__final()||Buffer.alloc(0);return outData=outputEnc?this._toString(outData,outputEnc,!0):outData},CipherBase.prototype._toString=function(value,enc,fin){if(this._decoder||(this._decoder=new StringDecoder(enc),this._encoding=enc),this._encoding!==enc)throw new Error("can't switch encodings");enc=this._decoder.write(value);return fin&&(enc+=this._decoder.end()),enc},module.exports=CipherBase},{inherits:220,"safe-buffer":367,stream:113,string_decoder:377}],137:[function(require,module,exports){!function(Buffer){!function(){var elliptic=require("elliptic"),BN=require("bn.js"),aliases=(module.exports=function(curve){return new ECDH(curve)},{secp256k1:{name:"secp256k1",byteLength:32},secp224r1:{name:"p224",byteLength:28},prime256v1:{name:"p256",byteLength:32},prime192v1:{name:"p192",byteLength:24},ed25519:{name:"ed25519",byteLength:32},secp384r1:{name:"p384",byteLength:48},secp521r1:{name:"p521",byteLength:66}});function ECDH(curve){this.curveType=aliases[curve],this.curveType||(this.curveType={name:curve}),this.curve=new elliptic.ec(this.curveType.name),this.keys=void 0}function formatReturnValue(bn,enc,len){Array.isArray(bn)||(bn=bn.toArray());bn=new Buffer(bn);return len&&bn.length<len&&((len=new Buffer(len-bn.length)).fill(0),bn=Buffer.concat([len,bn])),enc?bn.toString(enc):bn}aliases.p224=aliases.secp224r1,aliases.p256=aliases.secp256r1=aliases.prime256v1,aliases.p192=aliases.secp192r1=aliases.prime192v1,aliases.p384=aliases.secp384r1,aliases.p521=aliases.secp521r1,ECDH.prototype.generateKeys=function(enc,format){return this.keys=this.curve.genKeyPair(),this.getPublicKey(enc,format)},ECDH.prototype.computeSecret=function(other,inenc,enc){return inenc=inenc||"utf8",Buffer.isBuffer(other)||(other=new Buffer(other,inenc)),formatReturnValue(this.curve.keyFromPublic(other).getPublic().mul(this.keys.getPrivate()).getX(),enc,this.curveType.byteLength)},ECDH.prototype.getPublicKey=function(enc,format){var key=this.keys.getPublic("compressed"===format,!0);return"hybrid"===format&&(key[key.length-1]%2?key[0]=7:key[0]=6),formatReturnValue(key,enc)},ECDH.prototype.getPrivateKey=function(enc){return formatReturnValue(this.keys.getPrivate(),enc)},ECDH.prototype.setPublicKey=function(pub,enc){return enc=enc||"utf8",Buffer.isBuffer(pub)||(pub=new Buffer(pub,enc)),this.keys._importPublic(pub),this},ECDH.prototype.setPrivateKey=function(priv,enc){enc=enc||"utf8",Buffer.isBuffer(priv)||(priv=new Buffer(priv,enc));enc=(enc=new BN(priv)).toString(16);return this.keys=this.curve.genKeyPair(),this.keys._importPrivate(enc),this}}.call(this)}.call(this,require("buffer").Buffer)},{"bn.js":138,buffer:112,elliptic:159}],138:[function(require,module,exports){arguments[4][22][0].apply(exports,arguments)},{buffer:68,dup:22}],139:[function(require,module,exports){"use strict";var inherits=require("inherits"),MD5=require("md5.js"),RIPEMD160=require("ripemd160"),sha=require("sha.js"),Base=require("cipher-base");function Hash(hash){Base.call(this,"digest"),this._hash=hash}inherits(Hash,Base),Hash.prototype._update=function(data){this._hash.update(data)},Hash.prototype._final=function(){return this._hash.digest()},module.exports=function(alg){return"md5"===(alg=alg.toLowerCase())?new MD5:"rmd160"===alg||"ripemd160"===alg?new RIPEMD160:new Hash(sha(alg))}},{"cipher-base":136,inherits:220,"md5.js":262,ripemd160:365,"sha.js":370}],140:[function(require,module,exports){var MD5=require("md5.js");module.exports=function(buffer){return(new MD5).update(buffer).digest()}},{"md5.js":262}],141:[function(require,module,exports){"use strict";var inherits=require("inherits"),Legacy=require("./legacy"),Base=require("cipher-base"),Buffer=require("safe-buffer").Buffer,md5=require("create-hash/md5"),RIPEMD160=require("ripemd160"),sha=require("sha.js"),ZEROS=Buffer.alloc(128);function Hmac(alg,key){Base.call(this,"digest"),"string"==typeof key&&(key=Buffer.from(key));for(var blocksize="sha512"===alg||"sha384"===alg?128:64,ipad=(this._alg=alg,(this._key=key).length>blocksize?key=("rmd160"===alg?new RIPEMD160:sha(alg)).update(key).digest():key.length<blocksize&&(key=Buffer.concat([key,ZEROS],blocksize)),this._ipad=Buffer.allocUnsafe(blocksize)),opad=this._opad=Buffer.allocUnsafe(blocksize),i=0;i<blocksize;i++)ipad[i]=54^key[i],opad[i]=92^key[i];this._hash="rmd160"===alg?new RIPEMD160:sha(alg),this._hash.update(ipad)}inherits(Hmac,Base),Hmac.prototype._update=function(data){this._hash.update(data)},Hmac.prototype._final=function(){var h=this._hash.digest();return("rmd160"===this._alg?new RIPEMD160:sha(this._alg)).update(this._opad).update(h).digest()},module.exports=function(alg,key){return"rmd160"===(alg=alg.toLowerCase())||"ripemd160"===alg?new Hmac("rmd160",key):"md5"===alg?new Legacy(md5,key):new Hmac(alg,key)}},{"./legacy":142,"cipher-base":136,"create-hash/md5":140,inherits:220,ripemd160:365,"safe-buffer":367,"sha.js":370}],142:[function(require,module,exports){"use strict";var inherits=require("inherits"),Buffer=require("safe-buffer").Buffer,Base=require("cipher-base"),ZEROS=Buffer.alloc(128);function Hmac(alg,key){Base.call(this,"digest"),"string"==typeof key&&(key=Buffer.from(key)),this._alg=alg,64<(this._key=key).length?key=alg(key):key.length<64&&(key=Buffer.concat([key,ZEROS],64));for(var ipad=this._ipad=Buffer.allocUnsafe(64),opad=this._opad=Buffer.allocUnsafe(64),i=0;i<64;i++)ipad[i]=54^key[i],opad[i]=92^key[i];this._hash=[ipad]}inherits(Hmac,Base),Hmac.prototype._update=function(data){this._hash.push(data)},Hmac.prototype._final=function(){var h=this._alg(Buffer.concat(this._hash));return this._alg(Buffer.concat([this._opad,h]))},module.exports=Hmac},{"cipher-base":136,inherits:220,"safe-buffer":367}],143:[function(require,module,exports){"use strict";exports.randomBytes=exports.rng=exports.pseudoRandomBytes=exports.prng=require("randombytes"),exports.createHash=exports.Hash=require("create-hash"),exports.createHmac=exports.Hmac=require("create-hmac");var algos=require("browserify-sign/algos"),algos=Object.keys(algos),hashes=["sha1","sha224","sha256","sha384","sha512","md5","rmd160"].concat(algos),algos=(exports.getHashes=function(){return hashes},require("pbkdf2")),algos=(exports.pbkdf2=algos.pbkdf2,exports.pbkdf2Sync=algos.pbkdf2Sync,require("browserify-cipher")),algos=(exports.Cipher=algos.Cipher,exports.createCipher=algos.createCipher,exports.Cipheriv=algos.Cipheriv,exports.createCipheriv=algos.createCipheriv,exports.Decipher=algos.Decipher,exports.createDecipher=algos.createDecipher,exports.Decipheriv=algos.Decipheriv,exports.createDecipheriv=algos.createDecipheriv,exports.getCiphers=algos.getCiphers,exports.listCiphers=algos.listCiphers,require("diffie-hellman")),algos=(exports.DiffieHellmanGroup=algos.DiffieHellmanGroup,exports.createDiffieHellmanGroup=algos.createDiffieHellmanGroup,exports.getDiffieHellman=algos.getDiffieHellman,exports.createDiffieHellman=algos.createDiffieHellman,exports.DiffieHellman=algos.DiffieHellman,require("browserify-sign")),algos=(exports.createSign=algos.createSign,exports.Sign=algos.Sign,exports.createVerify=algos.createVerify,exports.Verify=algos.Verify,exports.createECDH=require("create-ecdh"),require("public-encrypt")),algos=(exports.publicEncrypt=algos.publicEncrypt,exports.privateEncrypt=algos.privateEncrypt,exports.publicDecrypt=algos.publicDecrypt,exports.privateDecrypt=algos.privateDecrypt,require("randomfill"));exports.randomFill=algos.randomFill,exports.randomFillSync=algos.randomFillSync,exports.createCredentials=function(){throw new Error(["sorry, createCredentials is not implemented yet","we accept pull requests","https://github.com/crypto-browserify/crypto-browserify"].join("\n"))},exports.constants={DH_CHECK_P_NOT_SAFE_PRIME:2,DH_CHECK_P_NOT_PRIME:1,DH_UNABLE_TO_CHECK_GENERATOR:4,DH_NOT_SUITABLE_GENERATOR:8,NPN_ENABLED:1,ALPN_ENABLED:1,RSA_PKCS1_PADDING:1,RSA_SSLV23_PADDING:2,RSA_NO_PADDING:3,RSA_PKCS1_OAEP_PADDING:4,RSA_X931_PADDING:5,RSA_PKCS1_PSS_PADDING:6,POINT_CONVERSION_COMPRESSED:2,POINT_CONVERSION_UNCOMPRESSED:4,POINT_CONVERSION_HYBRID:6}},{"browserify-cipher":86,"browserify-sign":93,"browserify-sign/algos":90,"create-ecdh":137,"create-hash":139,"create-hmac":141,"diffie-hellman":154,pbkdf2:348,"public-encrypt":355,randombytes:363,randomfill:364}],144:[function(require,module,exports){"use strict";require=require("abstract-leveldown").AbstractChainedBatch;const kOperations=Symbol("operations");module.exports=class extends require{constructor(db){super(db),this[kOperations]=[]}_put(key,value,options){this[kOperations].push({...options,type:"put",key:key,value:value})}_del(key,options){this[kOperations].push({...options,type:"del",key:key})}_clear(){this[kOperations]=[]}_write(options,callback){this.db.batch(this[kOperations],options,callback)}}},{"abstract-leveldown":5}],145:[function(require,module,exports){"use strict";const AbstractIterator=require("abstract-leveldown")["AbstractIterator"],inherits=require("inherits"),getCallback=require("./util").getCallback,kOptions=Symbol("options"),kIterator=Symbol("iterator"),kOperations=Symbol("operations"),kPromise=Symbol("promise");function DeferredIterator(db,options){AbstractIterator.call(this,db),this[kOptions]=options,this[kIterator]=null,this[kOperations]=[]}inherits(DeferredIterator,AbstractIterator),DeferredIterator.prototype.setDb=function(db){this[kIterator]=db.iterator(this[kOptions]);for(const op of this[kOperations].splice(0,this[kOperations].length))this[kIterator][op.method](...op.args)},DeferredIterator.prototype.next=function(...args){if("open"===this.db.status)return this[kIterator].next(...args);var callback=getCallback(args,kPromise,function(key,value){if(void 0!==key||void 0!==value)return[key,value]});return"opening"===this.db.status?this[kOperations].push({method:"next",args:args}):this._nextTick(callback,new Error("Database is not open")),callback[kPromise]||this},DeferredIterator.prototype.seek=function(...args){if("open"===this.db.status)this[kIterator].seek(...args);else{if("opening"!==this.db.status)throw new Error("Database is not open");this[kOperations].push({method:"seek",args:args})}},DeferredIterator.prototype.end=function(...args){if("open"===this.db.status)return this[kIterator].end(...args);var callback=getCallback(args,kPromise);return"opening"===this.db.status?this[kOperations].push({method:"end",args:args}):this._nextTick(callback,new Error("Database is not open")),callback[kPromise]||this};for(const method of["next","seek","end"])DeferredIterator.prototype["_"+method]=function(){throw new Error("Did not expect private method to be called: "+method)};module.exports=DeferredIterator},{"./util":147,"abstract-leveldown":5,inherits:220}],146:[function(require,module,exports){"use strict";const AbstractLevelDOWN=require("abstract-leveldown")["AbstractLevelDOWN"],inherits=require("inherits"),DeferredIterator=require("./deferred-iterator"),DeferredChainedBatch=require("./deferred-chained-batch"),getCallback=require("./util").getCallback,deferrables=["put","get","getMany","del","batch","clear"],optionalDeferrables=["approximateSize","compactRange"],kInnerDb=Symbol("innerDb"),kOperations=Symbol("operations"),kPromise=Symbol("promise");function DeferredLevelDOWN(db){AbstractLevelDOWN.call(this,db.supports||{});for(const m of optionalDeferrables)"function"!=typeof db[m]||this.supports.additionalMethods[m]||(this.supports.additionalMethods[m]=!0);this[kInnerDb]=db,this[kOperations]=[];var self=this,additionalMethods=Object.keys(self.supports.additionalMethods);for(const method of deferrables.concat(additionalMethods))self[method]=function(...args){if("batch"===method&&0===args.length)return new DeferredChainedBatch(this);if("open"===this.status)return this[kInnerDb][method](...args);var callback=getCallback(args,kPromise);return"opening"===this.status?this[kOperations].push({method:method,args:args}):this._nextTick(callback,new Error("Database is not open")),callback[kPromise]};self.iterator=function(options){if("open"===this.status)return this[kInnerDb].iterator(options);if("opening"===this.status)return options=new DeferredIterator(this,options),this[kOperations].push({iterator:options}),options;throw new Error("Database is not open")};for(const method of deferrables.concat(["iterator"]))self["_"+method]=function(){throw new Error("Did not expect private method to be called: "+method)}}inherits(DeferredLevelDOWN,AbstractLevelDOWN),DeferredLevelDOWN.prototype.type="deferred-leveldown",Object.defineProperty(DeferredLevelDOWN.prototype,"_db",{enumerable:!0,get(){return this[kInnerDb]}}),DeferredLevelDOWN.prototype._open=function(options,callback){var onopen=err=>{if(err||"open"!==this[kInnerDb].status)return callback(err||new Error("Database is not open"));err=this[kOperations];this[kOperations]=[];for(const op of err)op.iterator?op.iterator.setDb(this[kInnerDb]):this[kInnerDb][op.method](...op.args);if(0<this[kOperations].length)throw new Error("Did not expect further operations");callback()};"new"===this[kInnerDb].status||"closed"===this[kInnerDb].status?this[kInnerDb].open(options,onopen):this._nextTick(onopen)},DeferredLevelDOWN.prototype._close=function(callback){this[kInnerDb].close(callback)},DeferredLevelDOWN.prototype._isOperational=function(){return"opening"===this.status},module.exports=DeferredLevelDOWN,module.exports.DeferredIterator=DeferredIterator},{"./deferred-chained-batch":144,"./deferred-iterator":145,"./util":147,"abstract-leveldown":5,inherits:220}],147:[function(require,module,exports){"use strict";exports.getCallback=function(args,symbol,map){let callback=args[args.length-1];var promise;return"function"!=typeof callback&&(promise=new Promise((resolve,reject)=>{args.push(callback=function(err,...results){err?reject(err):resolve(map?map(...results):results[0])})}),callback[symbol]=promise),callback}},{}],148:[function(require,module,exports){"use strict";exports.utils=require("./des/utils"),exports.Cipher=require("./des/cipher"),exports.DES=require("./des/des"),exports.CBC=require("./des/cbc"),exports.EDE=require("./des/ede")},{"./des/cbc":149,"./des/cipher":150,"./des/des":151,"./des/ede":152,"./des/utils":153}],149:[function(require,module,exports){"use strict";var assert=require("minimalistic-assert"),inherits=require("inherits"),proto={};function CBCState(iv){assert.equal(iv.length,8,"Invalid IV length"),this.iv=new Array(8);for(var i=0;i<this.iv.length;i++)this.iv[i]=iv[i]}exports.instantiate=function(Base){function CBC(options){Base.call(this,options),this._cbcInit()}inherits(CBC,Base);for(var keys=Object.keys(proto),i=0;i<keys.length;i++){var key=keys[i];CBC.prototype[key]=proto[key]}return CBC.create=function(options){return new CBC(options)},CBC},proto._cbcInit=function(){var state=new CBCState(this.options.iv);this._cbcState=state},proto._update=function(inp,inOff,out,outOff){var state=this._cbcState,superProto=this.constructor.super_.prototype,iv=state.iv;if("encrypt"===this.type){for(var i=0;i<this.blockSize;i++)iv[i]^=inp[inOff+i];superProto._update.call(this,iv,0,out,outOff);for(i=0;i<this.blockSize;i++)iv[i]=out[outOff+i]}else{superProto._update.call(this,inp,inOff,out,outOff);for(i=0;i<this.blockSize;i++)out[outOff+i]^=iv[i];for(i=0;i<this.blockSize;i++)iv[i]=inp[inOff+i]}}},{inherits:220,"minimalistic-assert":265}],150:[function(require,module,exports){"use strict";var assert=require("minimalistic-assert");function Cipher(options){this.options=options,this.type=this.options.type,this.blockSize=8,this._init(),this.buffer=new Array(this.blockSize),this.bufferOff=0}(module.exports=Cipher).prototype._init=function(){},Cipher.prototype.update=function(data){return 0===data.length?[]:"decrypt"===this.type?this._updateDecrypt(data):this._updateEncrypt(data)},Cipher.prototype._buffer=function(data,off){for(var min=Math.min(this.buffer.length-this.bufferOff,data.length-off),i=0;i<min;i++)this.buffer[this.bufferOff+i]=data[off+i];return this.bufferOff+=min,min},Cipher.prototype._flushBuffer=function(out,off){return this._update(this.buffer,0,out,off),this.bufferOff=0,this.blockSize},Cipher.prototype._updateEncrypt=function(data){for(var inputOff=0,outputOff=0,count=(this.bufferOff+data.length)/this.blockSize|0,out=new Array(count*this.blockSize),max=(0!==this.bufferOff&&(inputOff+=this._buffer(data,inputOff),this.bufferOff===this.buffer.length&&(outputOff+=this._flushBuffer(out,outputOff))),data.length-(data.length-inputOff)%this.blockSize);inputOff<max;inputOff+=this.blockSize)this._update(data,inputOff,out,outputOff),outputOff+=this.blockSize;for(;inputOff<data.length;inputOff++,this.bufferOff++)this.buffer[this.bufferOff]=data[inputOff];return out},Cipher.prototype._updateDecrypt=function(data){for(var inputOff=0,outputOff=0,count=Math.ceil((this.bufferOff+data.length)/this.blockSize)-1,out=new Array(count*this.blockSize);0<count;count--)inputOff+=this._buffer(data,inputOff),outputOff+=this._flushBuffer(out,outputOff);return inputOff+=this._buffer(data,inputOff),out},Cipher.prototype.final=function(buffer){var first;return buffer&&(first=this.update(buffer)),buffer="encrypt"===this.type?this._finalEncrypt():this._finalDecrypt(),first?first.concat(buffer):buffer},Cipher.prototype._pad=function(buffer,off){if(0===off)return!1;for(;off<buffer.length;)buffer[off++]=0;return!0},Cipher.prototype._finalEncrypt=function(){if(!this._pad(this.buffer,this.bufferOff))return[];var out=new Array(this.blockSize);return this._update(this.buffer,0,out,0),out},Cipher.prototype._unpad=function(buffer){return buffer},Cipher.prototype._finalDecrypt=function(){assert.equal(this.bufferOff,this.blockSize,"Not enough data to decrypt");var out=new Array(this.blockSize);return this._flushBuffer(out,0),this._unpad(out)}},{"minimalistic-assert":265}],151:[function(require,module,exports){"use strict";var assert=require("minimalistic-assert"),inherits=require("inherits"),utils=require("./utils"),Cipher=require("./cipher");function DESState(){this.tmp=new Array(2),this.keys=null}function DES(options){Cipher.call(this,options);var state=new DESState;this._desState=state,this.deriveKeys(state,options.key)}inherits(DES,Cipher),(module.exports=DES).create=function(options){return new DES(options)};var shiftTable=[1,1,2,2,2,2,2,2,1,2,2,2,2,2,2,1];DES.prototype.deriveKeys=function(state,key){state.keys=new Array(32),assert.equal(key.length,this.blockSize,"Invalid key length");var kL=utils.readUInt32BE(key,0),kR=utils.readUInt32BE(key,4);utils.pc1(kL,kR,state.tmp,0),kL=state.tmp[0],kR=state.tmp[1];for(var i=0;i<state.keys.length;i+=2){var shift=shiftTable[i>>>1],kL=utils.r28shl(kL,shift),kR=utils.r28shl(kR,shift);utils.pc2(kL,kR,state.keys,i)}},DES.prototype._update=function(inp,inOff,out,outOff){var state=this._desState,l=utils.readUInt32BE(inp,inOff),inp=utils.readUInt32BE(inp,inOff+4);utils.ip(l,inp,state.tmp,0),l=state.tmp[0],inp=state.tmp[1],"encrypt"===this.type?this._encrypt(state,l,inp,state.tmp,0):this._decrypt(state,l,inp,state.tmp,0),l=state.tmp[0],inp=state.tmp[1],utils.writeUInt32BE(out,l,outOff),utils.writeUInt32BE(out,inp,outOff+4)},DES.prototype._pad=function(buffer,off){for(var value=buffer.length-off,i=off;i<buffer.length;i++)buffer[i]=value;return!0},DES.prototype._unpad=function(buffer){for(var pad=buffer[buffer.length-1],i=buffer.length-pad;i<buffer.length;i++)assert.equal(buffer[i],pad);return buffer.slice(0,buffer.length-pad)},DES.prototype._encrypt=function(state,lStart,rStart,out,off){for(var l=lStart,r=rStart,i=0;i<state.keys.length;i+=2)var keyL=state.keys[i],keyR=state.keys[i+1],keyL=(utils.expand(r,state.tmp,0),keyL^=state.tmp[0],keyR^=state.tmp[1],utils.substitute(keyL,keyR)),keyR=r,r=(l^utils.permute(keyL))>>>0,l=keyR;utils.rip(r,l,out,off)},DES.prototype._decrypt=function(state,lStart,rStart,out,off){for(var l=rStart,r=lStart,i=state.keys.length-2;0<=i;i-=2)var keyL=state.keys[i],keyR=state.keys[i+1],keyL=(utils.expand(l,state.tmp,0),keyL^=state.tmp[0],keyR^=state.tmp[1],utils.substitute(keyL,keyR)),keyR=l,l=(r^utils.permute(keyL))>>>0,r=keyR;utils.rip(l,r,out,off)}},{"./cipher":150,"./utils":153,inherits:220,"minimalistic-assert":265}],152:[function(require,module,exports){"use strict";var assert=require("minimalistic-assert"),inherits=require("inherits"),Cipher=require("./cipher"),DES=require("./des");function EDEState(type,key){assert.equal(key.length,24,"Invalid key length");var k1=key.slice(0,8),k2=key.slice(8,16),key=key.slice(16,24);this.ciphers="encrypt"===type?[DES.create({type:"encrypt",key:k1}),DES.create({type:"decrypt",key:k2}),DES.create({type:"encrypt",key:key})]:[DES.create({type:"decrypt",key:key}),DES.create({type:"encrypt",key:k2}),DES.create({type:"decrypt",key:k1})]}function EDE(options){Cipher.call(this,options);options=new EDEState(this.type,this.options.key);this._edeState=options}inherits(EDE,Cipher),(module.exports=EDE).create=function(options){return new EDE(options)},EDE.prototype._update=function(inp,inOff,out,outOff){var state=this._edeState;state.ciphers[0]._update(inp,inOff,out,outOff),state.ciphers[1]._update(out,outOff,out,outOff),state.ciphers[2]._update(out,outOff,out,outOff)},EDE.prototype._pad=DES.prototype._pad,EDE.prototype._unpad=DES.prototype._unpad},{"./cipher":150,"./des":151,inherits:220,"minimalistic-assert":265}],153:[function(require,module,exports){"use strict";exports.readUInt32BE=function(bytes,off){return(bytes[0+off]<<24|bytes[1+off]<<16|bytes[2+off]<<8|bytes[3+off])>>>0},exports.writeUInt32BE=function(bytes,value,off){bytes[0+off]=value>>>24,bytes[1+off]=value>>>16&255,bytes[2+off]=value>>>8&255,bytes[3+off]=255&value},exports.ip=function(inL,inR,out,off){for(var outL=0,outR=0,i=6;0<=i;i-=2){for(var j=0;j<=24;j+=8)outL=outL<<1|inR>>>j+i&1;for(j=0;j<=24;j+=8)outL=outL<<1|inL>>>j+i&1}for(i=6;0<=i;i-=2){for(j=1;j<=25;j+=8)outR=outR<<1|inR>>>j+i&1;for(j=1;j<=25;j+=8)outR=outR<<1|inL>>>j+i&1}out[off+0]=outL>>>0,out[off+1]=outR>>>0},exports.rip=function(inL,inR,out,off){for(var outL=0,outR=0,i=0;i<4;i++)for(var j=24;0<=j;j-=8)outL=(outL=outL<<1|inR>>>j+i&1)<<1|inL>>>j+i&1;for(i=4;i<8;i++)for(j=24;0<=j;j-=8)outR=(outR=outR<<1|inR>>>j+i&1)<<1|inL>>>j+i&1;out[off+0]=outL>>>0,out[off+1]=outR>>>0},exports.pc1=function(inL,inR,out,off){for(var outL=0,outR=0,i=7;5<=i;i--){for(var j=0;j<=24;j+=8)outL=outL<<1|inR>>j+i&1;for(j=0;j<=24;j+=8)outL=outL<<1|inL>>j+i&1}for(j=0;j<=24;j+=8)outL=outL<<1|inR>>j+i&1;for(i=1;i<=3;i++){for(j=0;j<=24;j+=8)outR=outR<<1|inR>>j+i&1;for(j=0;j<=24;j+=8)outR=outR<<1|inL>>j+i&1}for(j=0;j<=24;j+=8)outR=outR<<1|inL>>j+i&1;out[off+0]=outL>>>0,out[off+1]=outR>>>0},exports.r28shl=function(num,shift){return num<<shift&268435455|num>>>28-shift};var pc2table=[14,11,17,4,27,23,25,0,13,22,7,18,5,9,16,24,2,20,12,21,1,8,15,26,15,4,25,19,9,1,26,16,5,11,23,8,12,7,17,0,22,3,10,14,6,20,27,24],sTable=(exports.pc2=function(inL,inR,out,off){for(var outL=0,outR=0,len=pc2table.length>>>1,i=0;i<len;i++)outL=outL<<1|inL>>>pc2table[i]&1;for(i=len;i<pc2table.length;i++)outR=outR<<1|inR>>>pc2table[i]&1;out[off+0]=outL>>>0,out[off+1]=outR>>>0},exports.expand=function(r,out,off){for(var outL=0,outR=0,outL=(1&r)<<5|r>>>27,i=23;15<=i;i-=4)outL=outL<<6|r>>>i&63;for(i=11;3<=i;i-=4)outR=(outR|r>>>i&63)<<6;outR|=(31&r)<<1|r>>>31,out[off+0]=outL>>>0,out[off+1]=outR>>>0},[14,0,4,15,13,7,1,4,2,14,15,2,11,13,8,1,3,10,10,6,6,12,12,11,5,9,9,5,0,3,7,8,4,15,1,12,14,8,8,2,13,4,6,9,2,1,11,7,15,5,12,11,9,3,7,14,3,10,10,0,5,6,0,13,15,3,1,13,8,4,14,7,6,15,11,2,3,8,4,14,9,12,7,0,2,1,13,10,12,6,0,9,5,11,10,5,0,13,14,8,7,10,11,1,10,3,4,15,13,4,1,2,5,11,8,6,12,7,6,12,9,0,3,5,2,14,15,9,10,13,0,7,9,0,14,9,6,3,3,4,15,6,5,10,1,2,13,8,12,5,7,14,11,12,4,11,2,15,8,1,13,1,6,10,4,13,9,0,8,6,15,9,3,8,0,7,11,4,1,15,2,14,12,3,5,11,10,5,14,2,7,12,7,13,13,8,14,11,3,5,0,6,6,15,9,0,10,3,1,4,2,7,8,2,5,12,11,1,12,10,4,14,15,9,10,3,6,15,9,0,0,6,12,10,11,1,7,13,13,8,15,9,1,4,3,5,14,11,5,12,2,7,8,2,4,14,2,14,12,11,4,2,1,12,7,4,10,7,11,13,6,1,8,5,5,0,3,15,15,10,13,3,0,9,14,8,9,6,4,11,2,8,1,12,11,7,10,1,13,14,7,2,8,13,15,6,9,15,12,0,5,9,6,10,3,4,0,5,14,3,12,10,1,15,10,4,15,2,9,7,2,12,6,9,8,5,0,6,13,1,3,13,4,14,14,0,7,11,5,3,11,8,9,4,14,3,15,2,5,12,2,9,8,5,12,15,3,10,7,11,0,14,4,1,10,7,1,6,13,0,11,8,6,13,4,13,11,0,2,11,14,7,15,4,0,9,8,1,13,10,3,14,12,3,9,5,7,12,5,2,10,15,6,8,1,6,1,6,4,11,11,13,13,8,12,1,3,4,7,10,14,7,10,9,15,5,6,0,8,15,0,14,5,2,9,3,2,12,13,1,2,15,8,13,4,8,6,10,15,3,11,7,1,4,10,12,9,5,3,6,14,11,5,0,0,14,12,9,7,2,7,2,11,1,4,14,1,7,9,4,12,10,14,8,2,13,0,15,6,12,10,9,13,0,15,3,3,5,5,6,8,11]),permuteTable=(exports.substitute=function(inL,inR){for(var out=0,i=0;i<4;i++)out=out<<4|sTable[64*i+(inL>>>18-6*i&63)];for(i=0;i<4;i++)out=out<<4|sTable[256+64*i+(inR>>>18-6*i&63)];return out>>>0},[16,25,12,11,3,20,4,15,31,17,9,6,27,14,1,22,30,24,8,18,0,5,29,23,13,19,2,26,10,21,28,7]);exports.permute=function(num){for(var out=0,i=0;i<permuteTable.length;i++)out=out<<1|num>>>permuteTable[i]&1;return out>>>0},exports.padSplit=function(num,size,group){for(var str=num.toString(2);str.length<size;)str="0"+str;for(var out=[],i=0;i<size;i+=group)out.push(str.slice(i,i+group));return out.join(" ")}},{}],154:[function(require,module,exports){!function(Buffer){!function(){var generatePrime=require("./lib/generatePrime"),primes=require("./lib/primes.json"),DH=require("./lib/dh");var ENCODINGS={binary:!0,hex:!0,base64:!0};exports.DiffieHellmanGroup=exports.createDiffieHellmanGroup=exports.getDiffieHellman=function(mod){var prime=new Buffer(primes[mod].prime,"hex"),mod=new Buffer(primes[mod].gen,"hex");return new DH(prime,mod)},exports.createDiffieHellman=exports.DiffieHellman=function createDiffieHellman(prime,enc,generator,genc){return Buffer.isBuffer(enc)||void 0===ENCODINGS[enc]?createDiffieHellman(prime,"binary",enc,generator):(enc=enc||"binary",genc=genc||"binary",generator=generator||new Buffer([2]),Buffer.isBuffer(generator)||(generator=new Buffer(generator,genc)),"number"==typeof prime?new DH(generatePrime(prime,generator),generator,!0):(Buffer.isBuffer(prime)||(prime=new Buffer(prime,enc)),new DH(prime,generator,!0)))}}.call(this)}.call(this,require("buffer").Buffer)},{"./lib/dh":155,"./lib/generatePrime":156,"./lib/primes.json":157,buffer:112}],155:[function(require,module,exports){!function(Buffer){!function(){var BN=require("bn.js"),millerRabin=new(require("miller-rabin")),TWENTYFOUR=new BN(24),ELEVEN=new BN(11),TEN=new BN(10),THREE=new BN(3),SEVEN=new BN(7),primes=require("./generatePrime"),randomBytes=require("randombytes");function setPublicKey(pub,enc){return enc=enc||"utf8",Buffer.isBuffer(pub)||(pub=new Buffer(pub,enc)),this._pub=new BN(pub),this}function setPrivateKey(priv,enc){return enc=enc||"utf8",Buffer.isBuffer(priv)||(priv=new Buffer(priv,enc)),this._priv=new BN(priv),this}module.exports=DH;var primeCache={};function DH(prime,generator,malleable){this.setGenerator(generator),this.__prime=new BN(prime),this._prime=BN.mont(this.__prime),this._primeLen=prime.length,this._pub=void 0,this._priv=void 0,this._primeCode=void 0,malleable?(this.setPublicKey=setPublicKey,this.setPrivateKey=setPrivateKey):this._primeCode=8}function formatReturnValue(bn,enc){bn=new Buffer(bn.toArray());return enc?bn.toString(enc):bn}Object.defineProperty(DH.prototype,"verifyError",{enumerable:!0,get:function(){return"number"!=typeof this._primeCode&&(this._primeCode=function(prime,generator){var hex=[generator=generator.toString("hex"),prime.toString(16)].join("_");if(hex in primeCache)return primeCache[hex];var rem,error=0;if(prime.isEven()||!primes.simpleSieve||!primes.fermatTest(prime)||!millerRabin.test(prime))return primeCache[hex]=error=error+1+("02"===generator||"05"===generator?8:4);switch(millerRabin.test(prime.shrn(1))||(error+=2),generator){case"02":prime.mod(TWENTYFOUR).cmp(ELEVEN)&&(error+=8);break;case"05":(rem=prime.mod(TEN)).cmp(THREE)&&rem.cmp(SEVEN)&&(error+=8);break;default:error+=4}return primeCache[hex]=error}(this.__prime,this.__gen)),this._primeCode}}),DH.prototype.generateKeys=function(){return this._priv||(this._priv=new BN(randomBytes(this._primeLen))),this._pub=this._gen.toRed(this._prime).redPow(this._priv).fromRed(),this.getPublicKey()},DH.prototype.computeSecret=function(other){var other=(other=(other=new BN(other)).toRed(this._prime)).redPow(this._priv).fromRed(),other=new Buffer(other.toArray()),prime=this.getPrime();return other.length<prime.length&&((prime=new Buffer(prime.length-other.length)).fill(0),other=Buffer.concat([prime,other])),other},DH.prototype.getPublicKey=function(enc){return formatReturnValue(this._pub,enc)},DH.prototype.getPrivateKey=function(enc){return formatReturnValue(this._priv,enc)},DH.prototype.getPrime=function(enc){return formatReturnValue(this.__prime,enc)},DH.prototype.getGenerator=function(enc){return formatReturnValue(this._gen,enc)},DH.prototype.setGenerator=function(gen,enc){return enc=enc||"utf8",Buffer.isBuffer(gen)||(gen=new Buffer(gen,enc)),this.__gen=gen,this._gen=new BN(gen),this}}.call(this)}.call(this,require("buffer").Buffer)},{"./generatePrime":156,"bn.js":158,buffer:112,"miller-rabin":263,randombytes:363}],156:[function(require,module,exports){var randomBytes=require("randombytes"),BN=((module.exports=findPrime).simpleSieve=simpleSieve,findPrime.fermatTest=fermatTest,require("bn.js")),TWENTYFOUR=new BN(24),millerRabin=new(require("miller-rabin")),ONE=new BN(1),TWO=new BN(2),FIVE=new BN(5),TEN=(new BN(16),new BN(8),new BN(10)),THREE=new BN(3),ELEVEN=(new BN(7),new BN(11)),FOUR=new BN(4),primes=(new BN(12),null);function _getPrimes(){if(null!==primes)return primes;var res=[];res[0]=2;for(var i=1,k=3;k<1048576;k+=2){for(var sqrt=Math.ceil(Math.sqrt(k)),j=0;j<i&&res[j]<=sqrt&&k%res[j]!=0;j++);i!==j&&res[j]<=sqrt||(res[i++]=k)}return primes=res}function simpleSieve(p){for(var primes=_getPrimes(),i=0;i<primes.length;i++)if(0===p.modn(primes[i]))return 0===p.cmpn(primes[i]);return!0}function fermatTest(p){var red=BN.mont(p);return 0===TWO.toRed(red).redPow(p.subn(1)).fromRed().cmpn(1)}function findPrime(bits,gen){if(bits<16)return new BN(2===gen||5===gen?[140,123]:[140,39]);var num,n2;for(gen=new BN(gen);;){for(num=new BN(randomBytes(Math.ceil(bits/8)));num.bitLength()>bits;)num.ishrn(1);if(num.isEven()&&num.iadd(ONE),num.testn(1)||num.iadd(TWO),gen.cmp(TWO)){if(!gen.cmp(FIVE))for(;num.mod(TEN).cmp(THREE);)num.iadd(FOUR)}else for(;num.mod(TWENTYFOUR).cmp(ELEVEN);)num.iadd(FOUR);if(simpleSieve(n2=num.shrn(1))&&simpleSieve(num)&&fermatTest(n2)&&fermatTest(num)&&millerRabin.test(n2)&&millerRabin.test(num))return num}}},{"bn.js":158,"miller-rabin":263,randombytes:363}],157:[function(require,module,exports){module.exports={modp1:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a63a3620ffffffffffffffff"},modp2:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece65381ffffffffffffffff"},modp5:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca237327ffffffffffffffff"},modp14:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aacaa68ffffffffffffffff"},modp15:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aaac42dad33170d04507a33a85521abdf1cba64ecfb850458dbef0a8aea71575d060c7db3970f85a6e1e4c7abf5ae8cdb0933d71e8c94e04a25619dcee3d2261ad2ee6bf12ffa06d98a0864d87602733ec86a64521f2b18177b200cbbe117577a615d6c770988c0bad946e208e24fa074e5ab3143db5bfce0fd108e4b82d120a93ad2caffffffffffffffff"},modp16:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aaac42dad33170d04507a33a85521abdf1cba64ecfb850458dbef0a8aea71575d060c7db3970f85a6e1e4c7abf5ae8cdb0933d71e8c94e04a25619dcee3d2261ad2ee6bf12ffa06d98a0864d87602733ec86a64521f2b18177b200cbbe117577a615d6c770988c0bad946e208e24fa074e5ab3143db5bfce0fd108e4b82d120a92108011a723c12a787e6d788719a10bdba5b2699c327186af4e23c1a946834b6150bda2583e9ca2ad44ce8dbbbc2db04de8ef92e8efc141fbecaa6287c59474e6bc05d99b2964fa090c3a2233ba186515be7ed1f612970cee2d7afb81bdd762170481cd0069127d5b05aa993b4ea988d8fddc186ffb7dc90a6c08f4df435c934063199ffffffffffffffff"},modp17:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aaac42dad33170d04507a33a85521abdf1cba64ecfb850458dbef0a8aea71575d060c7db3970f85a6e1e4c7abf5ae8cdb0933d71e8c94e04a25619dcee3d2261ad2ee6bf12ffa06d98a0864d87602733ec86a64521f2b18177b200cbbe117577a615d6c770988c0bad946e208e24fa074e5ab3143db5bfce0fd108e4b82d120a92108011a723c12a787e6d788719a10bdba5b2699c327186af4e23c1a946834b6150bda2583e9ca2ad44ce8dbbbc2db04de8ef92e8efc141fbecaa6287c59474e6bc05d99b2964fa090c3a2233ba186515be7ed1f612970cee2d7afb81bdd762170481cd0069127d5b05aa993b4ea988d8fddc186ffb7dc90a6c08f4df435c93402849236c3fab4d27c7026c1d4dcb2602646dec9751e763dba37bdf8ff9406ad9e530ee5db382f413001aeb06a53ed9027d831179727b0865a8918da3edbebcf9b14ed44ce6cbaced4bb1bdb7f1447e6cc254b332051512bd7af426fb8f401378cd2bf5983ca01c64b92ecf032ea15d1721d03f482d7ce6e74fef6d55e702f46980c82b5a84031900b1c9e59e7c97fbec7e8f323a97a7e36cc88be0f1d45b7ff585ac54bd407b22b4154aacc8f6d7ebf48e1d814cc5ed20f8037e0a79715eef29be32806a1d58bb7c5da76f550aa3d8a1fbff0eb19ccb1a313d55cda56c9ec2ef29632387fe8d76e3c0468043e8f663f4860ee12bf2d5b0b7474d6e694f91e6dcc4024ffffffffffffffff"},modp18:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aaac42dad33170d04507a33a85521abdf1cba64ecfb850458dbef0a8aea71575d060c7db3970f85a6e1e4c7abf5ae8cdb0933d71e8c94e04a25619dcee3d2261ad2ee6bf12ffa06d98a0864d87602733ec86a64521f2b18177b200cbbe117577a615d6c770988c0bad946e208e24fa074e5ab3143db5bfce0fd108e4b82d120a92108011a723c12a787e6d788719a10bdba5b2699c327186af4e23c1a946834b6150bda2583e9ca2ad44ce8dbbbc2db04de8ef92e8efc141fbecaa6287c59474e6bc05d99b2964fa090c3a2233ba186515be7ed1f612970cee2d7afb81bdd762170481cd0069127d5b05aa993b4ea988d8fddc186ffb7dc90a6c08f4df435c93402849236c3fab4d27c7026c1d4dcb2602646dec9751e763dba37bdf8ff9406ad9e530ee5db382f413001aeb06a53ed9027d831179727b0865a8918da3edbebcf9b14ed44ce6cbaced4bb1bdb7f1447e6cc254b332051512bd7af426fb8f401378cd2bf5983ca01c64b92ecf032ea15d1721d03f482d7ce6e74fef6d55e702f46980c82b5a84031900b1c9e59e7c97fbec7e8f323a97a7e36cc88be0f1d45b7ff585ac54bd407b22b4154aacc8f6d7ebf48e1d814cc5ed20f8037e0a79715eef29be32806a1d58bb7c5da76f550aa3d8a1fbff0eb19ccb1a313d55cda56c9ec2ef29632387fe8d76e3c0468043e8f663f4860ee12bf2d5b0b7474d6e694f91e6dbe115974a3926f12fee5e438777cb6a932df8cd8bec4d073b931ba3bc832b68d9dd300741fa7bf8afc47ed2576f6936ba424663aab639c5ae4f5683423b4742bf1c978238f16cbe39d652de3fdb8befc848ad922222e04a4037c0713eb57a81a23f0c73473fc646cea306b4bcbc8862f8385ddfa9d4b7fa2c087e879683303ed5bdd3a062b3cf5b3a278a66d2a13f83f44f82ddf310ee074ab6a364597e899a0255dc164f31cc50846851df9ab48195ded7ea1b1d510bd7ee74d73faf36bc31ecfa268359046f4eb879f924009438b481c6cd7889a002ed5ee382bc9190da6fc026e479558e4475677e9aa9e3050e2765694dfc81f56e880b96e7160c980dd98edd3dfffffffffffffffff"}}},{}],158:[function(require,module,exports){arguments[4][22][0].apply(exports,arguments)},{buffer:68,dup:22}],159:[function(require,module,exports){"use strict";exports.version=require("../package.json").version,exports.utils=require("./elliptic/utils"),exports.rand=require("brorand"),exports.curve=require("./elliptic/curve"),exports.curves=require("./elliptic/curves"),exports.ec=require("./elliptic/ec"),exports.eddsa=require("./elliptic/eddsa")},{"../package.json":175,"./elliptic/curve":162,"./elliptic/curves":165,"./elliptic/ec":166,"./elliptic/eddsa":169,"./elliptic/utils":173,brorand:67}],160:[function(require,module,exports){"use strict";var BN=require("bn.js"),utils=require("../utils"),getNAF=utils.getNAF,getJSF=utils.getJSF,assert=utils.assert;function BaseCurve(type,conf){this.type=type,this.p=new BN(conf.p,16),this.red=conf.prime?BN.red(conf.prime):BN.mont(this.p),this.zero=new BN(0).toRed(this.red),this.one=new BN(1).toRed(this.red),this.two=new BN(2).toRed(this.red),this.n=conf.n&&new BN(conf.n,16),this.g=conf.g&&this.pointFromJSON(conf.g,conf.gRed),this._wnafT1=new Array(4),this._wnafT2=new Array(4),this._wnafT3=new Array(4),this._wnafT4=new Array(4),this._bitLength=this.n?this.n.bitLength():0;type=this.n&&this.p.div(this.n);!type||0<type.cmpn(100)?this.redN=null:(this._maxwellTrick=!0,this.redN=this.n.toRed(this.red))}function BasePoint(curve,type){this.curve=curve,this.type=type,this.precomputed=null}(module.exports=BaseCurve).prototype.point=function(){throw new Error("Not implemented")},BaseCurve.prototype.validate=function(){throw new Error("Not implemented")},BaseCurve.prototype._fixedNafMul=function(p,k){assert(p.precomputed);for(var doubles=p._getDoubles(),naf=getNAF(k,1,this._bitLength),p=(1<<doubles.step+1)-(doubles.step%2==0?2:1),repr=(p/=3,[]),j=0;j<naf.length;j+=doubles.step){for(var nafW=0,l=j+doubles.step-1;j<=l;l--)nafW=(nafW<<1)+naf[l];repr.push(nafW)}for(var a=this.jpoint(null,null,null),b=this.jpoint(null,null,null),i=p;0<i;i--){for(j=0;j<repr.length;j++)(nafW=repr[j])===i?b=b.mixedAdd(doubles.points[j]):nafW===-i&&(b=b.mixedAdd(doubles.points[j].neg()));a=a.add(b)}return a.toP()},BaseCurve.prototype._wnafMul=function(p,k){for(var nafPoints=p._getNAFPoints(4),w=nafPoints.wnd,wnd=nafPoints.points,naf=getNAF(k,w,this._bitLength),acc=this.jpoint(null,null,null),i=naf.length-1;0<=i;i--){for(var l=0;0<=i&&0===naf[i];i--)l++;if(0<=i&&l++,acc=acc.dblp(l),i<0)break;var z=naf[i];assert(0!==z),acc="affine"===p.type?0<z?acc.mixedAdd(wnd[z-1>>1]):acc.mixedAdd(wnd[-z-1>>1].neg()):0<z?acc.add(wnd[z-1>>1]):acc.add(wnd[-z-1>>1].neg())}return"affine"===p.type?acc.toP():acc},BaseCurve.prototype._wnafMulAdd=function(defW,points,coeffs,len,jacobianResult){for(var wndWidth=this._wnafT1,wnd=this._wnafT2,naf=this._wnafT3,max=0,i=0;i<len;i++){var p,nafPoints=(p=points[i])._getNAFPoints(defW);wndWidth[i]=nafPoints.wnd,wnd[i]=nafPoints.points}for(i=len-1;1<=i;i-=2){var a=i-1,b=i;if(1!==wndWidth[a]||1!==wndWidth[b])naf[a]=getNAF(coeffs[a],wndWidth[a],this._bitLength),naf[b]=getNAF(coeffs[b],wndWidth[b],this._bitLength),max=Math.max(naf[a].length,max),max=Math.max(naf[b].length,max);else{var comb=[points[a],null,null,points[b]],index=(0===points[a].y.cmp(points[b].y)?(comb[1]=points[a].add(points[b]),comb[2]=points[a].toJ().mixedAdd(points[b].neg())):0===points[a].y.cmp(points[b].y.redNeg())?(comb[1]=points[a].toJ().mixedAdd(points[b]),comb[2]=points[a].add(points[b].neg())):(comb[1]=points[a].toJ().mixedAdd(points[b]),comb[2]=points[a].toJ().mixedAdd(points[b].neg())),[-3,-1,-5,-7,0,7,5,1,3]),jsf=getJSF(coeffs[a],coeffs[b]),max=Math.max(jsf[0].length,max);for(naf[a]=new Array(max),naf[b]=new Array(max),j=0;j<max;j++){var ja=0|jsf[0][j],jb=0|jsf[1][j];naf[a][j]=index[3*(1+ja)+(1+jb)],naf[b][j]=0,wnd[a]=comb}}}var acc=this.jpoint(null,null,null),tmp=this._wnafT4;for(i=max;0<=i;i--){for(var k=0;0<=i;){for(var zero=!0,j=0;j<len;j++)tmp[j]=0|naf[j][i],0!==tmp[j]&&(zero=!1);if(!zero)break;k++,i--}if(0<=i&&k++,acc=acc.dblp(k),i<0)break;for(j=0;j<len;j++){var z=tmp[j];0!==z&&(0<z?p=wnd[j][z-1>>1]:z<0&&(p=wnd[j][-z-1>>1].neg()),acc="affine"===p.type?acc.mixedAdd(p):acc.add(p))}}for(i=0;i<len;i++)wnd[i]=null;return jacobianResult?acc:acc.toP()},(BaseCurve.BasePoint=BasePoint).prototype.eq=function(){throw new Error("Not implemented")},BasePoint.prototype.validate=function(){return this.curve.validate(this)},BaseCurve.prototype.decodePoint=function(bytes,enc){bytes=utils.toArray(bytes,enc);enc=this.p.byteLength();if((4===bytes[0]||6===bytes[0]||7===bytes[0])&&bytes.length-1==2*enc)return 6===bytes[0]?assert(bytes[bytes.length-1]%2==0):7===bytes[0]&&assert(bytes[bytes.length-1]%2==1),this.point(bytes.slice(1,1+enc),bytes.slice(1+enc,1+2*enc));if(2!==bytes[0]&&3!==bytes[0]||bytes.length-1!==enc)throw new Error("Unknown point format");return this.pointFromX(bytes.slice(1,1+enc),3===bytes[0])},BasePoint.prototype.encodeCompressed=function(enc){return this.encode(enc,!0)},BasePoint.prototype._encode=function(compact){var len=this.curve.p.byteLength(),x=this.getX().toArray("be",len);return compact?[this.getY().isEven()?2:3].concat(x):[4].concat(x,this.getY().toArray("be",len))},BasePoint.prototype.encode=function(enc,compact){return utils.encode(this._encode(compact),enc)},BasePoint.prototype.precompute=function(power){if(this.precomputed)return this;var precomputed={doubles:null,naf:null,beta:null};return precomputed.naf=this._getNAFPoints(8),precomputed.doubles=this._getDoubles(4,power),precomputed.beta=this._getBeta(),this.precomputed=precomputed,this},BasePoint.prototype._hasDoubles=function(k){if(!this.precomputed)return!1;var doubles=this.precomputed.doubles;return!!doubles&&doubles.points.length>=Math.ceil((k.bitLength()+1)/doubles.step)},BasePoint.prototype._getDoubles=function(step,power){if(this.precomputed&&this.precomputed.doubles)return this.precomputed.doubles;for(var doubles=[this],acc=this,i=0;i<power;i+=step){for(var j=0;j<step;j++)acc=acc.dbl();doubles.push(acc)}return{step:step,points:doubles}},BasePoint.prototype._getNAFPoints=function(wnd){if(this.precomputed&&this.precomputed.naf)return this.precomputed.naf;for(var res=[this],max=(1<<wnd)-1,dbl=1==max?null:this.dbl(),i=1;i<max;i++)res[i]=res[i-1].add(dbl);return{wnd:wnd,points:res}},BasePoint.prototype._getBeta=function(){return null},BasePoint.prototype.dblp=function(k){for(var r=this,i=0;i<k;i++)r=r.dbl();return r}},{"../utils":173,"bn.js":174}],161:[function(require,module,exports){"use strict";var utils=require("../utils"),BN=require("bn.js"),inherits=require("inherits"),Base=require("./base"),assert=utils.assert;function EdwardsCurve(conf){this.twisted=1!=(0|conf.a),this.mOneA=this.twisted&&-1==(0|conf.a),this.extended=this.mOneA,Base.call(this,"edwards",conf),this.a=new BN(conf.a,16).umod(this.red.m),this.a=this.a.toRed(this.red),this.c=new BN(conf.c,16).toRed(this.red),this.c2=this.c.redSqr(),this.d=new BN(conf.d,16).toRed(this.red),this.dd=this.d.redAdd(this.d),assert(!this.twisted||0===this.c.fromRed().cmpn(1)),this.oneC=1==(0|conf.c)}function Point(curve,x,y,z,t){Base.BasePoint.call(this,curve,"projective"),null===x&&null===y&&null===z?(this.x=this.curve.zero,this.y=this.curve.one,this.z=this.curve.one,this.t=this.curve.zero,this.zOne=!0):(this.x=new BN(x,16),this.y=new BN(y,16),this.z=z?new BN(z,16):this.curve.one,this.t=t&&new BN(t,16),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)),this.t&&!this.t.red&&(this.t=this.t.toRed(this.curve.red)),this.zOne=this.z===this.curve.one,this.curve.extended&&!this.t&&(this.t=this.x.redMul(this.y),this.zOne||(this.t=this.t.redMul(this.z.redInvm()))))}inherits(EdwardsCurve,Base),(module.exports=EdwardsCurve).prototype._mulA=function(num){return this.mOneA?num.redNeg():this.a.redMul(num)},EdwardsCurve.prototype._mulC=function(num){return this.oneC?num:this.c.redMul(num)},EdwardsCurve.prototype.jpoint=function(x,y,z,t){return this.point(x,y,z,t)},EdwardsCurve.prototype.pointFromX=function(x,odd){var x2=(x=(x=new BN(x,16)).red?x:x.toRed(this.red)).redSqr(),rhs=this.c2.redSub(this.a.redMul(x2)),x2=this.one.redSub(this.c2.redMul(this.d).redMul(x2)),rhs=rhs.redMul(x2.redInvm()),x2=rhs.redSqrt();if(0!==x2.redSqr().redSub(rhs).cmp(this.zero))throw new Error("invalid point");rhs=x2.fromRed().isOdd();return(odd&&!rhs||!odd&&rhs)&&(x2=x2.redNeg()),this.point(x,x2)},EdwardsCurve.prototype.pointFromY=function(y,odd){var y2=(y=(y=new BN(y,16)).red?y:y.toRed(this.red)).redSqr(),lhs=y2.redSub(this.c2),y2=y2.redMul(this.d).redMul(this.c2).redSub(this.a),lhs=lhs.redMul(y2.redInvm());if(0===lhs.cmp(this.zero)){if(odd)throw new Error("invalid point");return this.point(this.zero,y)}y2=lhs.redSqrt();if(0!==y2.redSqr().redSub(lhs).cmp(this.zero))throw new Error("invalid point");return y2.fromRed().isOdd()!==odd&&(y2=y2.redNeg()),this.point(y2,y)},EdwardsCurve.prototype.validate=function(point){if(point.isInfinity())return!0;point.normalize();var x2=point.x.redSqr(),point=point.y.redSqr(),lhs=x2.redMul(this.a).redAdd(point),x2=this.c2.redMul(this.one.redAdd(this.d.redMul(x2).redMul(point)));return 0===lhs.cmp(x2)},inherits(Point,Base.BasePoint),EdwardsCurve.prototype.pointFromJSON=function(obj){return Point.fromJSON(this,obj)},EdwardsCurve.prototype.point=function(x,y,z,t){return new Point(this,x,y,z,t)},Point.fromJSON=function(curve,obj){return new Point(curve,obj[0],obj[1],obj[2])},Point.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" y: "+this.y.fromRed().toString(16,2)+" z: "+this.z.fromRed().toString(16,2)+">"},Point.prototype.isInfinity=function(){return 0===this.x.cmpn(0)&&(0===this.y.cmp(this.z)||this.zOne&&0===this.y.cmp(this.curve.c))},Point.prototype._extDbl=function(){var a=this.x.redSqr(),b=this.y.redSqr(),c=(c=this.z.redSqr()).redIAdd(c),d=this.curve._mulA(a),a=this.x.redAdd(this.y).redSqr().redISub(a).redISub(b),g=d.redAdd(b),c=g.redSub(c),d=d.redSub(b),b=a.redMul(c),ny=g.redMul(d),a=a.redMul(d),d=c.redMul(g);return this.curve.point(b,ny,d,a)},Point.prototype._projDbl=function(){var nx,ny,h,j,e,f,b=this.x.redAdd(this.y).redSqr(),c=this.x.redSqr(),d=this.y.redSqr();return f=this.curve.twisted?(f=(e=this.curve._mulA(c)).redAdd(d),this.zOne?(nx=b.redSub(c).redSub(d).redMul(f.redSub(this.curve.two)),ny=f.redMul(e.redSub(d)),f.redSqr().redSub(f).redSub(f)):(h=this.z.redSqr(),j=f.redSub(h).redISub(h),nx=b.redSub(c).redISub(d).redMul(j),ny=f.redMul(e.redSub(d)),f.redMul(j))):(e=c.redAdd(d),h=this.curve._mulC(this.z).redSqr(),j=e.redSub(h).redSub(h),nx=this.curve._mulC(b.redISub(e)).redMul(j),ny=this.curve._mulC(e).redMul(c.redISub(d)),e.redMul(j)),this.curve.point(nx,ny,f)},Point.prototype.dbl=function(){return this.isInfinity()?this:this.curve.extended?this._extDbl():this._projDbl()},Point.prototype._extAdd=function(p){var a=this.y.redSub(this.x).redMul(p.y.redSub(p.x)),b=this.y.redAdd(this.x).redMul(p.y.redAdd(p.x)),c=this.t.redMul(this.curve.dd).redMul(p.t),p=this.z.redMul(p.z.redAdd(p.z)),e=b.redSub(a),f=p.redSub(c),p=p.redAdd(c),c=b.redAdd(a),b=e.redMul(f),a=p.redMul(c),e=e.redMul(c),c=f.redMul(p);return this.curve.point(b,a,c,e)},Point.prototype._projAdd=function(p){var ny,a=this.z.redMul(p.z),b=a.redSqr(),c=this.x.redMul(p.x),d=this.y.redMul(p.y),e=this.curve.d.redMul(c).redMul(d),f=b.redSub(e),b=b.redAdd(e),e=this.x.redAdd(this.y).redMul(p.x.redAdd(p.y)).redISub(c).redISub(d),p=a.redMul(f).redMul(e),e=this.curve.twisted?(ny=a.redMul(b).redMul(d.redSub(this.curve._mulA(c))),f.redMul(b)):(ny=a.redMul(b).redMul(d.redSub(c)),this.curve._mulC(f).redMul(b));return this.curve.point(p,ny,e)},Point.prototype.add=function(p){return this.isInfinity()?p:p.isInfinity()?this:this.curve.extended?this._extAdd(p):this._projAdd(p)},Point.prototype.mul=function(k){return this._hasDoubles(k)?this.curve._fixedNafMul(this,k):this.curve._wnafMul(this,k)},Point.prototype.mulAdd=function(k1,p,k2){return this.curve._wnafMulAdd(1,[this,p],[k1,k2],2,!1)},Point.prototype.jmulAdd=function(k1,p,k2){return this.curve._wnafMulAdd(1,[this,p],[k1,k2],2,!0)},Point.prototype.normalize=function(){if(this.zOne)return this;var zi=this.z.redInvm();return this.x=this.x.redMul(zi),this.y=this.y.redMul(zi),this.t&&(this.t=this.t.redMul(zi)),this.z=this.curve.one,this.zOne=!0,this},Point.prototype.neg=function(){return this.curve.point(this.x.redNeg(),this.y,this.z,this.t&&this.t.redNeg())},Point.prototype.getX=function(){return this.normalize(),this.x.fromRed()},Point.prototype.getY=function(){return this.normalize(),this.y.fromRed()},Point.prototype.eq=function(other){return this===other||0===this.getX().cmp(other.getX())&&0===this.getY().cmp(other.getY())},Point.prototype.eqXToP=function(x){var rx=x.toRed(this.curve.red).redMul(this.z);if(0===this.x.cmp(rx))return!0;for(var xc=x.clone(),t=this.curve.redN.redMul(this.z);;){if(xc.iadd(this.curve.n),0<=xc.cmp(this.curve.p))return!1;if(rx.redIAdd(t),0===this.x.cmp(rx))return!0}},Point.prototype.toP=Point.prototype.normalize,Point.prototype.mixedAdd=Point.prototype.add},{"../utils":173,"./base":160,"bn.js":174,inherits:220}],162:[function(require,module,exports){"use strict";exports.base=require("./base"),exports.short=require("./short"),exports.mont=require("./mont"),exports.edwards=require("./edwards")},{"./base":160,"./edwards":161,"./mont":163,"./short":164}],163:[function(require,module,exports){"use strict";var BN=require("bn.js"),inherits=require("inherits"),Base=require("./base"),utils=require("../utils");function MontCurve(conf){Base.call(this,"mont",conf),this.a=new BN(conf.a,16).toRed(this.red),this.b=new BN(conf.b,16).toRed(this.red),this.i4=new BN(4).toRed(this.red).redInvm(),this.two=new BN(2).toRed(this.red),this.a24=this.i4.redMul(this.a.redAdd(this.two))}function Point(curve,x,z){Base.BasePoint.call(this,curve,"projective"),null===x&&null===z?(this.x=this.curve.one,this.z=this.curve.zero):(this.x=new BN(x,16),this.z=new BN(z,16),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)))}inherits(MontCurve,Base),(module.exports=MontCurve).prototype.validate=function(point){var point=point.normalize().x,x2=point.redSqr(),x2=x2.redMul(point).redAdd(x2.redMul(this.a)).redAdd(point);return 0===x2.redSqrt().redSqr().cmp(x2)},inherits(Point,Base.BasePoint),MontCurve.prototype.decodePoint=function(bytes,enc){return this.point(utils.toArray(bytes,enc),1)},MontCurve.prototype.point=function(x,z){return new Point(this,x,z)},MontCurve.prototype.pointFromJSON=function(obj){return Point.fromJSON(this,obj)},Point.prototype.precompute=function(){},Point.prototype._encode=function(){return this.getX().toArray("be",this.curve.p.byteLength())},Point.fromJSON=function(curve,obj){return new Point(curve,obj[0],obj[1]||curve.one)},Point.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" z: "+this.z.fromRed().toString(16,2)+">"},Point.prototype.isInfinity=function(){return 0===this.z.cmpn(0)},Point.prototype.dbl=function(){var aa=this.x.redAdd(this.z).redSqr(),bb=this.x.redSub(this.z).redSqr(),c=aa.redSub(bb),aa=aa.redMul(bb),bb=c.redMul(bb.redAdd(this.curve.a24.redMul(c)));return this.curve.point(aa,bb)},Point.prototype.add=function(){throw new Error("Not supported on Montgomery curve")},Point.prototype.diffAdd=function(p,diff){var a=this.x.redAdd(this.z),b=this.x.redSub(this.z),c=p.x.redAdd(p.z),p=p.x.redSub(p.z).redMul(a),a=c.redMul(b),c=diff.z.redMul(p.redAdd(a).redSqr()),b=diff.x.redMul(p.redISub(a).redSqr());return this.curve.point(c,b)},Point.prototype.mul=function(k){for(var t=k.clone(),a=this,b=this.curve.point(null,null),bits=[];0!==t.cmpn(0);t.iushrn(1))bits.push(t.andln(1));for(var i=bits.length-1;0<=i;i--)0===bits[i]?(a=a.diffAdd(b,this),b=b.dbl()):(b=a.diffAdd(b,this),a=a.dbl());return b},Point.prototype.mulAdd=function(){throw new Error("Not supported on Montgomery curve")},Point.prototype.jumlAdd=function(){throw new Error("Not supported on Montgomery curve")},Point.prototype.eq=function(other){return 0===this.getX().cmp(other.getX())},Point.prototype.normalize=function(){return this.x=this.x.redMul(this.z.redInvm()),this.z=this.curve.one,this},Point.prototype.getX=function(){return this.normalize(),this.x.fromRed()}},{"../utils":173,"./base":160,"bn.js":174,inherits:220}],164:[function(require,module,exports){"use strict";var utils=require("../utils"),BN=require("bn.js"),inherits=require("inherits"),Base=require("./base"),assert=utils.assert;function ShortCurve(conf){Base.call(this,"short",conf),this.a=new BN(conf.a,16).toRed(this.red),this.b=new BN(conf.b,16).toRed(this.red),this.tinv=this.two.redInvm(),this.zeroA=0===this.a.fromRed().cmpn(0),this.threeA=0===this.a.fromRed().sub(this.p).cmpn(-3),this.endo=this._getEndomorphism(conf),this._endoWnafT1=new Array(4),this._endoWnafT2=new Array(4)}function Point(curve,x,y,isRed){Base.BasePoint.call(this,curve,"affine"),null===x&&null===y?(this.x=null,this.y=null,this.inf=!0):(this.x=new BN(x,16),this.y=new BN(y,16),isRed&&(this.x.forceRed(this.curve.red),this.y.forceRed(this.curve.red)),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.inf=!1)}function JPoint(curve,x,y,z){Base.BasePoint.call(this,curve,"jacobian"),null===x&&null===y&&null===z?(this.x=this.curve.one,this.y=this.curve.one,this.z=new BN(0)):(this.x=new BN(x,16),this.y=new BN(y,16),this.z=new BN(z,16)),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)),this.zOne=this.z===this.curve.one}inherits(ShortCurve,Base),(module.exports=ShortCurve).prototype._getEndomorphism=function(conf){var lambda,betas,lambdas;if(this.zeroA&&this.g&&this.n&&1===this.p.modn(3))return betas=(conf.beta?new BN(conf.beta,16):betas=(betas=this._getEndoRoots(this.p))[0].cmp(betas[1])<0?betas[0]:betas[1]).toRed(this.red),conf.lambda?lambda=new BN(conf.lambda,16):(lambdas=this._getEndoRoots(this.n),0===this.g.mul(lambdas[0]).x.cmp(this.g.x.redMul(betas))?lambda=lambdas[0]:(lambda=lambdas[1],assert(0===this.g.mul(lambda).x.cmp(this.g.x.redMul(betas))))),{beta:betas,lambda:lambda,basis:conf.basis?conf.basis.map(function(vec){return{a:new BN(vec.a,16),b:new BN(vec.b,16)}}):this._getEndoBasis(lambda)}},ShortCurve.prototype._getEndoRoots=function(num){var num=num===this.p?this.red:BN.mont(num),tinv=new BN(2).toRed(num).redInvm(),ntinv=tinv.redNeg(),num=new BN(3).toRed(num).redNeg().redSqrt().redMul(tinv);return[ntinv.redAdd(num).fromRed(),ntinv.redSub(num).fromRed()]},ShortCurve.prototype._getEndoBasis=function(lambda){for(var a0,b0,a1,b1,prevR,aprxSqrt=this.n.ushrn(Math.floor(this.n.bitLength()/2)),u=lambda,v=this.n.clone(),x1=new BN(1),y1=new BN(0),x2=new BN(0),y2=new BN(1),i=0;0!==u.cmpn(0);){var q=v.div(u),r=v.sub(q.mul(u)),x=x2.sub(q.mul(x1)),q=y2.sub(q.mul(y1));if(!a1&&r.cmp(aprxSqrt)<0)a0=prevR.neg(),b0=x1,a1=r.neg(),b1=x;else if(a1&&2==++i)break;v=u,u=prevR=r,x2=x1,x1=x,y2=y1,y1=q}var lambda=r.neg(),b2=x,len1=a1.sqr().add(b1.sqr());return 0<=lambda.sqr().add(b2.sqr()).cmp(len1)&&(lambda=a0,b2=b0),a1.negative&&(a1=a1.neg(),b1=b1.neg()),lambda.negative&&(lambda=lambda.neg(),b2=b2.neg()),[{a:a1,b:b1},{a:lambda,b:b2}]},ShortCurve.prototype._endoSplit=function(k){var basis=this.endo.basis,v1=basis[0],basis=basis[1],c1=basis.b.mul(k).divRound(this.n),c2=v1.b.neg().mul(k).divRound(this.n),p1=c1.mul(v1.a),p2=c2.mul(basis.a),c1=c1.mul(v1.b),v1=c2.mul(basis.b);return{k1:k.sub(p1).sub(p2),k2:c1.add(v1).neg()}},ShortCurve.prototype.pointFromX=function(x,odd){var y2=(x=(x=new BN(x,16)).red?x:x.toRed(this.red)).redSqr().redMul(x).redIAdd(x.redMul(this.a)).redIAdd(this.b),y=y2.redSqrt();if(0!==y.redSqr().redSub(y2).cmp(this.zero))throw new Error("invalid point");y2=y.fromRed().isOdd();return(odd&&!y2||!odd&&y2)&&(y=y.redNeg()),this.point(x,y)},ShortCurve.prototype.validate=function(point){if(point.inf)return!0;var x=point.x,point=point.y,ax=this.a.redMul(x),x=x.redSqr().redMul(x).redIAdd(ax).redIAdd(this.b);return 0===point.redSqr().redISub(x).cmpn(0)},ShortCurve.prototype._endoWnafMulAdd=function(points,coeffs,jacobianResult){for(var npoints=this._endoWnafT1,ncoeffs=this._endoWnafT2,i=0;i<points.length;i++){var split=this._endoSplit(coeffs[i]),p=points[i],beta=p._getBeta();split.k1.negative&&(split.k1.ineg(),p=p.neg(!0)),split.k2.negative&&(split.k2.ineg(),beta=beta.neg(!0)),npoints[2*i]=p,npoints[2*i+1]=beta,ncoeffs[2*i]=split.k1,ncoeffs[2*i+1]=split.k2}for(var jacobianResult=this._wnafMulAdd(1,npoints,ncoeffs,2*i,jacobianResult),j=0;j<2*i;j++)npoints[j]=null,ncoeffs[j]=null;return jacobianResult},inherits(Point,Base.BasePoint),ShortCurve.prototype.point=function(x,y,isRed){return new Point(this,x,y,isRed)},ShortCurve.prototype.pointFromJSON=function(obj,red){return Point.fromJSON(this,obj,red)},Point.prototype._getBeta=function(){if(this.curve.endo){var pre=this.precomputed;if(pre&&pre.beta)return pre.beta;var curve,endoMul,beta=this.curve.point(this.x.redMul(this.curve.endo.beta),this.y);return pre&&(curve=this.curve,endoMul=function(p){return curve.point(p.x.redMul(curve.endo.beta),p.y)},(pre.beta=beta).precomputed={beta:null,naf:pre.naf&&{wnd:pre.naf.wnd,points:pre.naf.points.map(endoMul)},doubles:pre.doubles&&{step:pre.doubles.step,points:pre.doubles.points.map(endoMul)}}),beta}},Point.prototype.toJSON=function(){return this.precomputed?[this.x,this.y,this.precomputed&&{doubles:this.precomputed.doubles&&{step:this.precomputed.doubles.step,points:this.precomputed.doubles.points.slice(1)},naf:this.precomputed.naf&&{wnd:this.precomputed.naf.wnd,points:this.precomputed.naf.points.slice(1)}}]:[this.x,this.y]},Point.fromJSON=function(curve,obj,red){"string"==typeof obj&&(obj=JSON.parse(obj));var res=curve.point(obj[0],obj[1],red);if(!obj[2])return res;function obj2point(obj){return curve.point(obj[0],obj[1],red)}obj=obj[2];return res.precomputed={beta:null,doubles:obj.doubles&&{step:obj.doubles.step,points:[res].concat(obj.doubles.points.map(obj2point))},naf:obj.naf&&{wnd:obj.naf.wnd,points:[res].concat(obj.naf.points.map(obj2point))}},res},Point.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" y: "+this.y.fromRed().toString(16,2)+">"},Point.prototype.isInfinity=function(){return this.inf},Point.prototype.add=function(p){if(this.inf)return p;if(p.inf)return this;if(this.eq(p))return this.dbl();if(this.neg().eq(p))return this.curve.point(null,null);if(0===this.x.cmp(p.x))return this.curve.point(null,null);var c=this.y.redSub(p.y),p=(c=0!==c.cmpn(0)?c.redMul(this.x.redSub(p.x).redInvm()):c).redSqr().redISub(this.x).redISub(p.x),c=c.redMul(this.x.redSub(p)).redISub(this.y);return this.curve.point(p,c)},Point.prototype.dbl=function(){if(this.inf)return this;var ys1=this.y.redAdd(this.y);if(0===ys1.cmpn(0))return this.curve.point(null,null);var a=this.curve.a,x2=this.x.redSqr(),ys1=ys1.redInvm(),x2=x2.redAdd(x2).redIAdd(x2).redIAdd(a).redMul(ys1),a=x2.redSqr().redISub(this.x.redAdd(this.x)),ys1=x2.redMul(this.x.redSub(a)).redISub(this.y);return this.curve.point(a,ys1)},Point.prototype.getX=function(){return this.x.fromRed()},Point.prototype.getY=function(){return this.y.fromRed()},Point.prototype.mul=function(k){return k=new BN(k,16),this.isInfinity()?this:this._hasDoubles(k)?this.curve._fixedNafMul(this,k):this.curve.endo?this.curve._endoWnafMulAdd([this],[k]):this.curve._wnafMul(this,k)},Point.prototype.mulAdd=function(k1,p2,k2){p2=[this,p2],k1=[k1,k2];return this.curve.endo?this.curve._endoWnafMulAdd(p2,k1):this.curve._wnafMulAdd(1,p2,k1,2)},Point.prototype.jmulAdd=function(k1,p2,k2){p2=[this,p2],k1=[k1,k2];return this.curve.endo?this.curve._endoWnafMulAdd(p2,k1,!0):this.curve._wnafMulAdd(1,p2,k1,2,!0)},Point.prototype.eq=function(p){return this===p||this.inf===p.inf&&(this.inf||0===this.x.cmp(p.x)&&0===this.y.cmp(p.y))},Point.prototype.neg=function(_precompute){if(this.inf)return this;var negate,res=this.curve.point(this.x,this.y.redNeg());return _precompute&&this.precomputed&&(_precompute=this.precomputed,negate=function(p){return p.neg()},res.precomputed={naf:_precompute.naf&&{wnd:_precompute.naf.wnd,points:_precompute.naf.points.map(negate)},doubles:_precompute.doubles&&{step:_precompute.doubles.step,points:_precompute.doubles.points.map(negate)}}),res},Point.prototype.toJ=function(){return this.inf?this.curve.jpoint(null,null,null):this.curve.jpoint(this.x,this.y,this.curve.one)},inherits(JPoint,Base.BasePoint),ShortCurve.prototype.jpoint=function(x,y,z){return new JPoint(this,x,y,z)},JPoint.prototype.toP=function(){if(this.isInfinity())return this.curve.point(null,null);var zinv=this.z.redInvm(),zinv2=zinv.redSqr(),ax=this.x.redMul(zinv2),zinv2=this.y.redMul(zinv2).redMul(zinv);return this.curve.point(ax,zinv2)},JPoint.prototype.neg=function(){return this.curve.jpoint(this.x,this.y.redNeg(),this.z)},JPoint.prototype.add=function(p){if(this.isInfinity())return p;if(p.isInfinity())return this;var pz2=p.z.redSqr(),z2=this.z.redSqr(),u1=this.x.redMul(pz2),u2=p.x.redMul(z2),pz2=this.y.redMul(pz2.redMul(p.z)),z2=p.y.redMul(z2.redMul(this.z)),u2=u1.redSub(u2),z2=pz2.redSub(z2);if(0===u2.cmpn(0))return 0!==z2.cmpn(0)?this.curve.jpoint(null,null,null):this.dbl();var h2=u2.redSqr(),h3=h2.redMul(u2),u1=u1.redMul(h2),h2=z2.redSqr().redIAdd(h3).redISub(u1).redISub(u1),z2=z2.redMul(u1.redISub(h2)).redISub(pz2.redMul(h3)),u1=this.z.redMul(p.z).redMul(u2);return this.curve.jpoint(h2,z2,u1)},JPoint.prototype.mixedAdd=function(p){if(this.isInfinity())return p.toJ();if(p.isInfinity())return this;var z2=this.z.redSqr(),u1=this.x,u2=p.x.redMul(z2),s1=this.y,p=p.y.redMul(z2).redMul(this.z),z2=u1.redSub(u2),u2=s1.redSub(p);if(0===z2.cmpn(0))return 0!==u2.cmpn(0)?this.curve.jpoint(null,null,null):this.dbl();var p=z2.redSqr(),h3=p.redMul(z2),u1=u1.redMul(p),p=u2.redSqr().redIAdd(h3).redISub(u1).redISub(u1),u2=u2.redMul(u1.redISub(p)).redISub(s1.redMul(h3)),u1=this.z.redMul(z2);return this.curve.jpoint(p,u2,u1)},JPoint.prototype.dblp=function(pow){if(0===pow)return this;if(this.isInfinity())return this;if(!pow)return this.dbl();if(this.curve.zeroA||this.curve.threeA){for(var r=this,i=0;i<pow;i++)r=r.dbl();return r}var a=this.curve.a,tinv=this.curve.tinv,jx=this.x,jy=this.y,jz=this.z,jz4=jz.redSqr().redSqr(),jyd=jy.redAdd(jy);for(i=0;i<pow;i++){var jx2=jx.redSqr(),jyd2=jyd.redSqr(),jyd4=jyd2.redSqr(),jx2=jx2.redAdd(jx2).redIAdd(jx2).redIAdd(a.redMul(jz4)),jyd2=jx.redMul(jyd2),nx=jx2.redSqr().redISub(jyd2.redAdd(jyd2)),jyd2=jyd2.redISub(nx),jx2=(jx2=jx2.redMul(jyd2)).redIAdd(jx2).redISub(jyd4),jyd2=jyd.redMul(jz);i+1<pow&&(jz4=jz4.redMul(jyd4)),jx=nx,jz=jyd2,jyd=jx2}return this.curve.jpoint(jx,jyd.redMul(tinv),jz)},JPoint.prototype.dbl=function(){return this.isInfinity()?this:this.curve.zeroA?this._zeroDbl():this.curve.threeA?this._threeDbl():this._dbl()},JPoint.prototype._zeroDbl=function(){var yy,xx,yyyy,t,c,f=this.zOne?(xx=this.x.redSqr(),yyyy=(yy=this.y.redSqr()).redSqr(),yy=(yy=this.x.redAdd(yy).redSqr().redISub(xx).redISub(yyyy)).redIAdd(yy),t=(xx=xx.redAdd(xx).redIAdd(xx)).redSqr().redISub(yy).redISub(yy),yyyy=(yyyy=(yyyy=yyyy.redIAdd(yyyy)).redIAdd(yyyy)).redIAdd(yyyy),yy=xx.redMul(yy.redISub(xx=t)).redISub(yyyy),this.y.redAdd(this.y)):(t=this.x.redSqr(),c=(yyyy=this.y.redSqr()).redSqr(),yyyy=(yyyy=this.x.redAdd(yyyy).redSqr().redISub(t).redISub(c)).redIAdd(yyyy),f=(t=t.redAdd(t).redIAdd(t)).redSqr(),c=(c=(c=c.redIAdd(c)).redIAdd(c)).redIAdd(c),xx=f.redISub(yyyy).redISub(yyyy),yy=t.redMul(yyyy.redISub(xx)).redISub(c),(f=this.y.redMul(this.z)).redIAdd(f));return this.curve.jpoint(xx,yy,f)},JPoint.prototype._threeDbl=function(){var yy,xx,nx,t,yyyy,alpha,beta,beta8;return this.zOne?(xx=this.x.redSqr(),yyyy=(yy=this.y.redSqr()).redSqr(),yy=(yy=this.x.redAdd(yy).redSqr().redISub(xx).redISub(yyyy)).redIAdd(yy),nx=t=(xx=xx.redAdd(xx).redIAdd(xx).redIAdd(this.curve.a)).redSqr().redISub(yy).redISub(yy),yyyy=(yyyy=(yyyy=yyyy.redIAdd(yyyy)).redIAdd(yyyy)).redIAdd(yyyy),xx=xx.redMul(yy.redISub(t)).redISub(yyyy),yy=this.y.redAdd(this.y)):(t=this.z.redSqr(),yyyy=this.y.redSqr(),beta=this.x.redMul(yyyy),alpha=(alpha=this.x.redSub(t).redMul(this.x.redAdd(t))).redAdd(alpha).redIAdd(alpha),beta8=(beta=(beta=beta.redIAdd(beta)).redIAdd(beta)).redAdd(beta),nx=alpha.redSqr().redISub(beta8),yy=this.y.redAdd(this.z).redSqr().redISub(yyyy).redISub(t),beta8=(beta8=(beta8=(beta8=yyyy.redSqr()).redIAdd(beta8)).redIAdd(beta8)).redIAdd(beta8),xx=alpha.redMul(beta.redISub(nx)).redISub(beta8)),this.curve.jpoint(nx,xx,yy)},JPoint.prototype._dbl=function(){var a=this.curve.a,jx=this.x,jy=this.y,jz=this.z,jz4=jz.redSqr().redSqr(),jx2=jx.redSqr(),jy2=jy.redSqr(),jx2=jx2.redAdd(jx2).redIAdd(jx2).redIAdd(a.redMul(jz4)),a=jx.redAdd(jx),jz4=(a=a.redIAdd(a)).redMul(jy2),jx=jx2.redSqr().redISub(jz4.redAdd(jz4)),a=jz4.redISub(jx),jz4=jy2.redSqr(),jy2=(jz4=(jz4=(jz4=jz4.redIAdd(jz4)).redIAdd(jz4)).redIAdd(jz4),jx2.redMul(a).redISub(jz4)),jx2=jy.redAdd(jy).redMul(jz);return this.curve.jpoint(jx,jy2,jx2)},JPoint.prototype.trpl=function(){if(!this.curve.zeroA)return this.dbl().add(this);var xx=this.x.redSqr(),yy=this.y.redSqr(),zz=this.z.redSqr(),yyyy=yy.redSqr(),m=xx.redAdd(xx).redIAdd(xx),mm=m.redSqr(),xx=this.x.redAdd(yy).redSqr().redISub(xx).redISub(yyyy),ee=(xx=(xx=(xx=xx.redIAdd(xx)).redAdd(xx).redIAdd(xx)).redISub(mm)).redSqr(),yyyy=yyyy.redIAdd(yyyy),m=(yyyy=(yyyy=(yyyy=yyyy.redIAdd(yyyy)).redIAdd(yyyy)).redIAdd(yyyy),m.redIAdd(xx).redSqr().redISub(mm).redISub(ee).redISub(yyyy)),mm=yy.redMul(m),yy=(mm=(mm=mm.redIAdd(mm)).redIAdd(mm),this.x.redMul(ee).redISub(mm)),mm=(yy=(yy=yy.redIAdd(yy)).redIAdd(yy),this.y.redMul(m.redMul(yyyy.redISub(m)).redISub(xx.redMul(ee)))),yyyy=(mm=(mm=(mm=mm.redIAdd(mm)).redIAdd(mm)).redIAdd(mm),this.z.redAdd(xx).redSqr().redISub(zz).redISub(ee));return this.curve.jpoint(yy,mm,yyyy)},JPoint.prototype.mul=function(k,kbase){return k=new BN(k,kbase),this.curve._wnafMul(this,k)},JPoint.prototype.eq=function(p){if("affine"===p.type)return this.eq(p.toJ());if(this===p)return!0;var z2=this.z.redSqr(),pz2=p.z.redSqr();if(0!==this.x.redMul(pz2).redISub(p.x.redMul(z2)).cmpn(0))return!1;z2=z2.redMul(this.z),pz2=pz2.redMul(p.z);return 0===this.y.redMul(pz2).redISub(p.y.redMul(z2)).cmpn(0)},JPoint.prototype.eqXToP=function(x){var zs=this.z.redSqr(),rx=x.toRed(this.curve.red).redMul(zs);if(0===this.x.cmp(rx))return!0;for(var xc=x.clone(),t=this.curve.redN.redMul(zs);;){if(xc.iadd(this.curve.n),0<=xc.cmp(this.curve.p))return!1;if(rx.redIAdd(t),0===this.x.cmp(rx))return!0}},JPoint.prototype.inspect=function(){return this.isInfinity()?"<EC JPoint Infinity>":"<EC JPoint x: "+this.x.toString(16,2)+" y: "+this.y.toString(16,2)+" z: "+this.z.toString(16,2)+">"},JPoint.prototype.isInfinity=function(){return 0===this.z.cmpn(0)}},{"../utils":173,"./base":160,"bn.js":174,inherits:220}],165:[function(require,module,exports){"use strict";var pre,curves=exports,exports=require("hash.js"),curve=require("./curve"),assert=require("./utils").assert;function PresetCurve(options){"short"===options.type?this.curve=new curve.short(options):"edwards"===options.type?this.curve=new curve.edwards(options):this.curve=new curve.mont(options),this.g=this.curve.g,this.n=this.curve.n,this.hash=options.hash,assert(this.g.validate(),"Invalid curve"),assert(this.g.mul(this.n).isInfinity(),"Invalid curve, G*N != O")}function defineCurve(name,options){Object.defineProperty(curves,name,{configurable:!0,enumerable:!0,get:function(){var curve=new PresetCurve(options);return Object.defineProperty(curves,name,{configurable:!0,enumerable:!0,value:curve}),curve}})}curves.PresetCurve=PresetCurve,defineCurve("p192",{type:"short",prime:"p192",p:"ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff",a:"ffffffff ffffffff ffffffff fffffffe ffffffff fffffffc",b:"64210519 e59c80e7 0fa7e9ab 72243049 feb8deec c146b9b1",n:"ffffffff ffffffff ffffffff 99def836 146bc9b1 b4d22831",hash:exports.sha256,gRed:!1,g:["188da80e b03090f6 7cbf20eb 43a18800 f4ff0afd 82ff1012","07192b95 ffc8da78 631011ed 6b24cdd5 73f977a1 1e794811"]}),defineCurve("p224",{type:"short",prime:"p224",p:"ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001",a:"ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff fffffffe",b:"b4050a85 0c04b3ab f5413256 5044b0b7 d7bfd8ba 270b3943 2355ffb4",n:"ffffffff ffffffff ffffffff ffff16a2 e0b8f03e 13dd2945 5c5c2a3d",hash:exports.sha256,gRed:!1,g:["b70e0cbd 6bb4bf7f 321390b9 4a03c1d3 56c21122 343280d6 115c1d21","bd376388 b5f723fb 4c22dfe6 cd4375a0 5a074764 44d58199 85007e34"]}),defineCurve("p256",{type:"short",prime:null,p:"ffffffff 00000001 00000000 00000000 00000000 ffffffff ffffffff ffffffff",a:"ffffffff 00000001 00000000 00000000 00000000 ffffffff ffffffff fffffffc",b:"5ac635d8 aa3a93e7 b3ebbd55 769886bc 651d06b0 cc53b0f6 3bce3c3e 27d2604b",n:"ffffffff 00000000 ffffffff ffffffff bce6faad a7179e84 f3b9cac2 fc632551",hash:exports.sha256,gRed:!1,g:["6b17d1f2 e12c4247 f8bce6e5 63a440f2 77037d81 2deb33a0 f4a13945 d898c296","4fe342e2 fe1a7f9b 8ee7eb4a 7c0f9e16 2bce3357 6b315ece cbb64068 37bf51f5"]}),defineCurve("p384",{type:"short",prime:null,p:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe ffffffff 00000000 00000000 ffffffff",a:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe ffffffff 00000000 00000000 fffffffc",b:"b3312fa7 e23ee7e4 988e056b e3f82d19 181d9c6e fe814112 0314088f 5013875a c656398d 8a2ed19d 2a85c8ed d3ec2aef",n:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff c7634d81 f4372ddf 581a0db2 48b0a77a ecec196a ccc52973",hash:exports.sha384,gRed:!1,g:["aa87ca22 be8b0537 8eb1c71e f320ad74 6e1d3b62 8ba79b98 59f741e0 82542a38 5502f25d bf55296c 3a545e38 72760ab7","3617de4a 96262c6f 5d9e98bf 9292dc29 f8f41dbd 289a147c e9da3113 b5f0b8c0 0a60b1ce 1d7e819d 7a431d7c 90ea0e5f"]}),defineCurve("p521",{type:"short",prime:null,p:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff",a:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffc",b:"00000051 953eb961 8e1c9a1f 929a21a0 b68540ee a2da725b 99b315f3 b8b48991 8ef109e1 56193951 ec7e937b 1652c0bd 3bb1bf07 3573df88 3d2c34f1 ef451fd4 6b503f00",n:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffa 51868783 bf2f966b 7fcc0148 f709a5d0 3bb5c9b8 899c47ae bb6fb71e 91386409",hash:exports.sha512,gRed:!1,g:["000000c6 858e06b7 0404e9cd 9e3ecb66 2395b442 9c648139 053fb521 f828af60 6b4d3dba a14b5e77 efe75928 fe1dc127 a2ffa8de 3348b3c1 856a429b f97e7e31 c2e5bd66","00000118 39296a78 9a3bc004 5c8a5fb4 2c7d1bd9 98f54449 579b4468 17afbd17 273e662c 97ee7299 5ef42640 c550b901 3fad0761 353c7086 a272c240 88be9476 9fd16650"]}),defineCurve("curve25519",{type:"mont",prime:"p25519",p:"7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed",a:"76d06",b:"1",n:"1000000000000000 0000000000000000 14def9dea2f79cd6 5812631a5cf5d3ed",hash:exports.sha256,gRed:!1,g:["9"]}),defineCurve("ed25519",{type:"edwards",prime:"p25519",p:"7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed",a:"-1",c:"1",d:"52036cee2b6ffe73 8cc740797779e898 00700a4d4141d8ab 75eb4dca135978a3",n:"1000000000000000 0000000000000000 14def9dea2f79cd6 5812631a5cf5d3ed",hash:exports.sha256,gRed:!1,g:["216936d3cd6e53fec0a4e231fdd6dc5c692cc7609525a7b2c9562d608f25d51a","6666666666666666666666666666666666666666666666666666666666666658"]});try{pre=require("./precomputed/secp256k1")}catch(e){pre=void 0}defineCurve("secp256k1",{type:"short",prime:"k256",p:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f",a:"0",b:"7",n:"ffffffff ffffffff ffffffff fffffffe baaedce6 af48a03b bfd25e8c d0364141",h:"1",hash:exports.sha256,beta:"7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee",lambda:"5363ad4cc05c30e0a5261c028812645a122e22ea20816678df02967c1b23bd72",basis:[{a:"3086d221a7d46bcde86c90e49284eb15",b:"-e4437ed6010e88286f547fa90abfe4c3"},{a:"114ca50f7a8e2f3f657c1108d9d44cfd8",b:"3086d221a7d46bcde86c90e49284eb15"}],gRed:!1,g:["79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798","483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8",pre]})},{"./curve":162,"./precomputed/secp256k1":172,"./utils":173,"hash.js":206}],166:[function(require,module,exports){"use strict";var BN=require("bn.js"),HmacDRBG=require("hmac-drbg"),utils=require("../utils"),curves=require("../curves"),rand=require("brorand"),assert=utils.assert,KeyPair=require("./key"),Signature=require("./signature");function EC(options){if(!(this instanceof EC))return new EC(options);"string"==typeof options&&(assert(Object.prototype.hasOwnProperty.call(curves,options),"Unknown curve "+options),options=curves[options]),options instanceof curves.PresetCurve&&(options={curve:options}),this.curve=options.curve.curve,this.n=this.curve.n,this.nh=this.n.ushrn(1),this.g=this.curve.g,this.g=options.curve.g,this.g.precompute(options.curve.n.bitLength()+1),this.hash=options.hash||options.curve.hash}(module.exports=EC).prototype.keyPair=function(options){return new KeyPair(this,options)},EC.prototype.keyFromPrivate=function(priv,enc){return KeyPair.fromPrivate(this,priv,enc)},EC.prototype.keyFromPublic=function(pub,enc){return KeyPair.fromPublic(this,pub,enc)},EC.prototype.genKeyPair=function(options){for(var drbg=new HmacDRBG({hash:this.hash,pers:(options=options||{}).pers,persEnc:options.persEnc||"utf8",entropy:options.entropy||rand(this.hash.hmacStrength),entropyEnc:options.entropy&&options.entropyEnc||"utf8",nonce:this.n.toArray()}),bytes=this.n.byteLength(),ns2=this.n.sub(new BN(2));;){var priv=new BN(drbg.generate(bytes));if(!(0<priv.cmp(ns2)))return priv.iaddn(1),this.keyFromPrivate(priv)}},EC.prototype._truncateToN=function(msg,truncOnly){var delta=8*msg.byteLength()-this.n.bitLength();return 0<delta&&(msg=msg.ushrn(delta)),!truncOnly&&0<=msg.cmp(this.n)?msg.sub(this.n):msg},EC.prototype.sign=function(msg,key,enc,options){"object"==typeof enc&&(options=enc,enc=null),options=options||{},key=this.keyFromPrivate(key,enc),msg=this._truncateToN(new BN(msg,16));for(var enc=this.n.byteLength(),bkey=key.getPrivate().toArray("be",enc),enc=msg.toArray("be",enc),drbg=new HmacDRBG({hash:this.hash,entropy:bkey,nonce:enc,pers:options.pers,persEnc:options.persEnc||"utf8"}),ns1=this.n.sub(new BN(1)),iter=0;;iter++){var k=options.k?options.k(iter):new BN(drbg.generate(this.n.byteLength())),k=this._truncateToN(k,!0);if(!(k.cmpn(1)<=0||0<=k.cmp(ns1))){var kp=this.g.mul(k);if(!kp.isInfinity()){var kpX=kp.getX(),r=kpX.umod(this.n);if(0!==r.cmpn(0)){k=(k=k.invm(this.n).mul(r.mul(key.getPrivate()).iadd(msg))).umod(this.n);if(0!==k.cmpn(0))return kp=(kp.getY().isOdd()?1:0)|(0!==kpX.cmp(r)?2:0),options.canonical&&0<k.cmp(this.nh)&&(k=this.n.sub(k),kp^=1),new Signature({r:r,s:k,recoveryParam:kp})}}}}},EC.prototype.verify=function(msg,signature,key,enc){msg=this._truncateToN(new BN(msg,16)),key=this.keyFromPublic(key,enc);enc=(signature=new Signature(signature,"hex")).r,signature=signature.s;if(enc.cmpn(1)<0||0<=enc.cmp(this.n))return!1;if(signature.cmpn(1)<0||0<=signature.cmp(this.n))return!1;var p,signature=signature.invm(this.n),msg=signature.mul(msg).umod(this.n),signature=signature.mul(enc).umod(this.n);return this.curve._maxwellTrick?!(p=this.g.jmulAdd(msg,key.getPublic(),signature)).isInfinity()&&p.eqXToP(enc):!(p=this.g.mulAdd(msg,key.getPublic(),signature)).isInfinity()&&0===p.getX().umod(this.n).cmp(enc)},EC.prototype.recoverPubKey=function(msg,signature,j,enc){assert((3&j)===j,"The recovery param is more than two bits"),signature=new Signature(signature,enc);var enc=this.n,msg=new BN(msg),r=signature.r,s=signature.s,isYOdd=1&j,j=j>>1;if(0<=r.cmp(this.curve.p.umod(this.curve.n))&&j)throw new Error("Unable to find sencond key candinate");r=j?this.curve.pointFromX(r.add(this.curve.n),isYOdd):this.curve.pointFromX(r,isYOdd),j=signature.r.invm(enc),isYOdd=enc.sub(msg).mul(j).umod(enc),signature=s.mul(j).umod(enc);return this.g.mulAdd(isYOdd,r,signature)},EC.prototype.getKeyRecoveryParam=function(e,signature,Q,enc){if(null!==(signature=new Signature(signature,enc)).recoveryParam)return signature.recoveryParam;for(var Qprime,i=0;i<4;i++){try{Qprime=this.recoverPubKey(e,signature,i)}catch(e){continue}if(Qprime.eq(Q))return i}throw new Error("Unable to find valid recovery factor")}},{"../curves":165,"../utils":173,"./key":167,"./signature":168,"bn.js":174,brorand:67,"hmac-drbg":218}],167:[function(require,module,exports){"use strict";var BN=require("bn.js"),assert=require("../utils").assert;function KeyPair(ec,options){this.ec=ec,this.priv=null,this.pub=null,options.priv&&this._importPrivate(options.priv,options.privEnc),options.pub&&this._importPublic(options.pub,options.pubEnc)}(module.exports=KeyPair).fromPublic=function(ec,pub,enc){return pub instanceof KeyPair?pub:new KeyPair(ec,{pub:pub,pubEnc:enc})},KeyPair.fromPrivate=function(ec,priv,enc){return priv instanceof KeyPair?priv:new KeyPair(ec,{priv:priv,privEnc:enc})},KeyPair.prototype.validate=function(){var pub=this.getPublic();return pub.isInfinity()?{result:!1,reason:"Invalid public key"}:pub.validate()?pub.mul(this.ec.curve.n).isInfinity()?{result:!0,reason:null}:{result:!1,reason:"Public key * N != O"}:{result:!1,reason:"Public key is not a point"}},KeyPair.prototype.getPublic=function(compact,enc){return"string"==typeof compact&&(enc=compact,compact=null),this.pub||(this.pub=this.ec.g.mul(this.priv)),enc?this.pub.encode(enc,compact):this.pub},KeyPair.prototype.getPrivate=function(enc){return"hex"===enc?this.priv.toString(16,2):this.priv},KeyPair.prototype._importPrivate=function(key,enc){this.priv=new BN(key,enc||16),this.priv=this.priv.umod(this.ec.curve.n)},KeyPair.prototype._importPublic=function(key,enc){if(key.x||key.y)return"mont"===this.ec.curve.type?assert(key.x,"Need x coordinate"):"short"!==this.ec.curve.type&&"edwards"!==this.ec.curve.type||assert(key.x&&key.y,"Need both x and y coordinate"),void(this.pub=this.ec.curve.point(key.x,key.y));this.pub=this.ec.curve.decodePoint(key,enc)},KeyPair.prototype.derive=function(pub){return pub.validate()||assert(pub.validate(),"public point not validated"),pub.mul(this.priv).getX()},KeyPair.prototype.sign=function(msg,enc,options){return this.ec.sign(msg,this,enc,options)},KeyPair.prototype.verify=function(msg,signature){return this.ec.verify(msg,signature,this)},KeyPair.prototype.inspect=function(){return"<Key priv: "+(this.priv&&this.priv.toString(16,2))+" pub: "+(this.pub&&this.pub.inspect())+" >"}},{"../utils":173,"bn.js":174}],168:[function(require,module,exports){"use strict";var BN=require("bn.js"),utils=require("../utils"),assert=utils.assert;function Signature(options,enc){if(options instanceof Signature)return options;this._importDER(options,enc)||(assert(options.r&&options.s,"Signature without r or s"),this.r=new BN(options.r,16),this.s=new BN(options.s,16),void 0===options.recoveryParam?this.recoveryParam=null:this.recoveryParam=options.recoveryParam)}function Position(){this.place=0}function getLength(buf,p){var initial=buf[p.place++];if(!(128&initial))return initial;var octetLen=15&initial;if(0==octetLen||4<octetLen)return!1;for(var val=0,i=0,off=p.place;i<octetLen;i++,off++)val=((val<<=8)|buf[off])>>>0;return!(val<=127)&&(p.place=off,val)}function rmPadding(buf){for(var i=0,len=buf.length-1;!buf[i]&&!(128&buf[i+1])&&i<len;)i++;return 0===i?buf:buf.slice(i)}function constructLength(arr,len){if(len<128)arr.push(len);else{var octets=1+(Math.log(len)/Math.LN2>>>3);for(arr.push(128|octets);--octets;)arr.push(len>>>(octets<<3)&255);arr.push(len)}}(module.exports=Signature).prototype._importDER=function(data,enc){data=utils.toArray(data,enc);enc=new Position;if(48!==data[enc.place++])return!1;var len=getLength(data,enc);if(!1===len)return!1;if(len+enc.place!==data.length)return!1;if(2!==data[enc.place++])return!1;len=getLength(data,enc);if(!1===len)return!1;var r=data.slice(enc.place,len+enc.place);if(enc.place+=len,2!==data[enc.place++])return!1;len=getLength(data,enc);if(!1===len)return!1;if(data.length!==len+enc.place)return!1;data=data.slice(enc.place,len+enc.place);if(0===r[0]){if(!(128&r[1]))return!1;r=r.slice(1)}if(0===data[0]){if(!(128&data[1]))return!1;data=data.slice(1)}return this.r=new BN(r),this.s=new BN(data),!(this.recoveryParam=null)},Signature.prototype.toDER=function(enc){var r=this.r.toArray(),s=this.s.toArray();for(128&r[0]&&(r=[0].concat(r)),128&s[0]&&(s=[0].concat(s)),r=rmPadding(r),s=rmPadding(s);!(s[0]||128&s[1]);)s=s.slice(1);var arr=[2],r=(constructLength(arr,r.length),(arr=arr.concat(r)).push(2),constructLength(arr,s.length),arr.concat(s)),arr=[48];return constructLength(arr,r.length),arr=arr.concat(r),utils.encode(arr,enc)}},{"../utils":173,"bn.js":174}],169:[function(require,module,exports){"use strict";var hash=require("hash.js"),curves=require("../curves"),utils=require("../utils"),assert=utils.assert,parseBytes=utils.parseBytes,KeyPair=require("./key"),Signature=require("./signature");function EDDSA(curve){if(assert("ed25519"===curve,"only tested with ed25519 so far"),!(this instanceof EDDSA))return new EDDSA(curve);curve=curves[curve].curve,this.curve=curve,this.g=curve.g,this.g.precompute(curve.n.bitLength()+1),this.pointClass=curve.point().constructor,this.encodingLength=Math.ceil(curve.n.bitLength()/8),this.hash=hash.sha512}(module.exports=EDDSA).prototype.sign=function(message,secret){message=parseBytes(message);var secret=this.keyFromSecret(secret),r=this.hashInt(secret.messagePrefix(),message),R=this.g.mul(r),Rencoded=this.encodePoint(R),message=this.hashInt(Rencoded,secret.pubBytes(),message).mul(secret.priv()),secret=r.add(message).umod(this.curve.n);return this.makeSignature({R:R,S:secret,Rencoded:Rencoded})},EDDSA.prototype.verify=function(message,sig,pub){message=parseBytes(message),sig=this.makeSignature(sig);var pub=this.keyFromPublic(pub),message=this.hashInt(sig.Rencoded(),pub.pubBytes(),message),SG=this.g.mul(sig.S());return sig.R().add(pub.pub().mul(message)).eq(SG)},EDDSA.prototype.hashInt=function(){for(var hash=this.hash(),i=0;i<arguments.length;i++)hash.update(arguments[i]);return utils.intFromLE(hash.digest()).umod(this.curve.n)},EDDSA.prototype.keyFromPublic=function(pub){return KeyPair.fromPublic(this,pub)},EDDSA.prototype.keyFromSecret=function(secret){return KeyPair.fromSecret(this,secret)},EDDSA.prototype.makeSignature=function(sig){return sig instanceof Signature?sig:new Signature(this,sig)},EDDSA.prototype.encodePoint=function(point){var enc=point.getY().toArray("le",this.encodingLength);return enc[this.encodingLength-1]|=point.getX().isOdd()?128:0,enc},EDDSA.prototype.decodePoint=function(bytes){var lastIx=(bytes=utils.parseBytes(bytes)).length-1,normed=bytes.slice(0,lastIx).concat(-129&bytes[lastIx]),bytes=0!=(128&bytes[lastIx]),lastIx=utils.intFromLE(normed);return this.curve.pointFromY(lastIx,bytes)},EDDSA.prototype.encodeInt=function(num){return num.toArray("le",this.encodingLength)},EDDSA.prototype.decodeInt=function(bytes){return utils.intFromLE(bytes)},EDDSA.prototype.isPoint=function(val){return val instanceof this.pointClass}},{"../curves":165,"../utils":173,"./key":170,"./signature":171,"hash.js":206}],170:[function(require,module,exports){"use strict";var utils=require("../utils"),assert=utils.assert,parseBytes=utils.parseBytes,require=utils.cachedProperty;function KeyPair(eddsa,params){this.eddsa=eddsa,this._secret=parseBytes(params.secret),eddsa.isPoint(params.pub)?this._pub=params.pub:this._pubBytes=parseBytes(params.pub)}KeyPair.fromPublic=function(eddsa,pub){return pub instanceof KeyPair?pub:new KeyPair(eddsa,{pub:pub})},KeyPair.fromSecret=function(eddsa,secret){return secret instanceof KeyPair?secret:new KeyPair(eddsa,{secret:secret})},KeyPair.prototype.secret=function(){return this._secret},require(KeyPair,"pubBytes",function(){return this.eddsa.encodePoint(this.pub())}),require(KeyPair,"pub",function(){return this._pubBytes?this.eddsa.decodePoint(this._pubBytes):this.eddsa.g.mul(this.priv())}),require(KeyPair,"privBytes",function(){var eddsa=this.eddsa,hash=this.hash(),lastIx=eddsa.encodingLength-1,hash=hash.slice(0,eddsa.encodingLength);return hash[0]&=248,hash[lastIx]&=127,hash[lastIx]|=64,hash}),require(KeyPair,"priv",function(){return this.eddsa.decodeInt(this.privBytes())}),require(KeyPair,"hash",function(){return this.eddsa.hash().update(this.secret()).digest()}),require(KeyPair,"messagePrefix",function(){return this.hash().slice(this.eddsa.encodingLength)}),KeyPair.prototype.sign=function(message){return assert(this._secret,"KeyPair can only verify"),this.eddsa.sign(message,this)},KeyPair.prototype.verify=function(message,sig){return this.eddsa.verify(message,sig,this)},KeyPair.prototype.getSecret=function(enc){return assert(this._secret,"KeyPair is public only"),utils.encode(this.secret(),enc)},KeyPair.prototype.getPublic=function(enc){return utils.encode(this.pubBytes(),enc)},module.exports=KeyPair},{"../utils":173}],171:[function(require,module,exports){"use strict";var BN=require("bn.js"),utils=require("../utils"),assert=utils.assert,require=utils.cachedProperty,parseBytes=utils.parseBytes;function Signature(eddsa,sig){this.eddsa=eddsa,"object"!=typeof sig&&(sig=parseBytes(sig)),Array.isArray(sig)&&(sig={R:sig.slice(0,eddsa.encodingLength),S:sig.slice(eddsa.encodingLength)}),assert(sig.R&&sig.S,"Signature without R or S"),eddsa.isPoint(sig.R)&&(this._R=sig.R),sig.S instanceof BN&&(this._S=sig.S),this._Rencoded=Array.isArray(sig.R)?sig.R:sig.Rencoded,this._Sencoded=Array.isArray(sig.S)?sig.S:sig.Sencoded}require(Signature,"S",function(){return this.eddsa.decodeInt(this.Sencoded())}),require(Signature,"R",function(){return this.eddsa.decodePoint(this.Rencoded())}),require(Signature,"Rencoded",function(){return this.eddsa.encodePoint(this.R())}),require(Signature,"Sencoded",function(){return this.eddsa.encodeInt(this.S())}),Signature.prototype.toBytes=function(){return this.Rencoded().concat(this.Sencoded())},Signature.prototype.toHex=function(){return utils.encode(this.toBytes(),"hex").toUpperCase()},module.exports=Signature},{"../utils":173,"bn.js":174}],172:[function(require,module,exports){module.exports={doubles:{step:4,points:[["e60fce93b59e9ec53011aabc21c23e97b2a31369b87a5ae9c44ee89e2a6dec0a","f7e3507399e595929db99f34f57937101296891e44d23f0be1f32cce69616821"],["8282263212c609d9ea2a6e3e172de238d8c39cabd5ac1ca10646e23fd5f51508","11f8a8098557dfe45e8256e830b60ace62d613ac2f7b17bed31b6eaff6e26caf"],["175e159f728b865a72f99cc6c6fc846de0b93833fd2222ed73fce5b551e5b739","d3506e0d9e3c79eba4ef97a51ff71f5eacb5955add24345c6efa6ffee9fed695"],["363d90d447b00c9c99ceac05b6262ee053441c7e55552ffe526bad8f83ff4640","4e273adfc732221953b445397f3363145b9a89008199ecb62003c7f3bee9de9"],["8b4b5f165df3c2be8c6244b5b745638843e4a781a15bcd1b69f79a55dffdf80c","4aad0a6f68d308b4b3fbd7813ab0da04f9e336546162ee56b3eff0c65fd4fd36"],["723cbaa6e5db996d6bf771c00bd548c7b700dbffa6c0e77bcb6115925232fcda","96e867b5595cc498a921137488824d6e2660a0653779494801dc069d9eb39f5f"],["eebfa4d493bebf98ba5feec812c2d3b50947961237a919839a533eca0e7dd7fa","5d9a8ca3970ef0f269ee7edaf178089d9ae4cdc3a711f712ddfd4fdae1de8999"],["100f44da696e71672791d0a09b7bde459f1215a29b3c03bfefd7835b39a48db0","cdd9e13192a00b772ec8f3300c090666b7ff4a18ff5195ac0fbd5cd62bc65a09"],["e1031be262c7ed1b1dc9227a4a04c017a77f8d4464f3b3852c8acde6e534fd2d","9d7061928940405e6bb6a4176597535af292dd419e1ced79a44f18f29456a00d"],["feea6cae46d55b530ac2839f143bd7ec5cf8b266a41d6af52d5e688d9094696d","e57c6b6c97dce1bab06e4e12bf3ecd5c981c8957cc41442d3155debf18090088"],["da67a91d91049cdcb367be4be6ffca3cfeed657d808583de33fa978bc1ec6cb1","9bacaa35481642bc41f463f7ec9780e5dec7adc508f740a17e9ea8e27a68be1d"],["53904faa0b334cdda6e000935ef22151ec08d0f7bb11069f57545ccc1a37b7c0","5bc087d0bc80106d88c9eccac20d3c1c13999981e14434699dcb096b022771c8"],["8e7bcd0bd35983a7719cca7764ca906779b53a043a9b8bcaeff959f43ad86047","10b7770b2a3da4b3940310420ca9514579e88e2e47fd68b3ea10047e8460372a"],["385eed34c1cdff21e6d0818689b81bde71a7f4f18397e6690a841e1599c43862","283bebc3e8ea23f56701de19e9ebf4576b304eec2086dc8cc0458fe5542e5453"],["6f9d9b803ecf191637c73a4413dfa180fddf84a5947fbc9c606ed86c3fac3a7","7c80c68e603059ba69b8e2a30e45c4d47ea4dd2f5c281002d86890603a842160"],["3322d401243c4e2582a2147c104d6ecbf774d163db0f5e5313b7e0e742d0e6bd","56e70797e9664ef5bfb019bc4ddaf9b72805f63ea2873af624f3a2e96c28b2a0"],["85672c7d2de0b7da2bd1770d89665868741b3f9af7643397721d74d28134ab83","7c481b9b5b43b2eb6374049bfa62c2e5e77f17fcc5298f44c8e3094f790313a6"],["948bf809b1988a46b06c9f1919413b10f9226c60f668832ffd959af60c82a0a","53a562856dcb6646dc6b74c5d1c3418c6d4dff08c97cd2bed4cb7f88d8c8e589"],["6260ce7f461801c34f067ce0f02873a8f1b0e44dfc69752accecd819f38fd8e8","bc2da82b6fa5b571a7f09049776a1ef7ecd292238051c198c1a84e95b2b4ae17"],["e5037de0afc1d8d43d8348414bbf4103043ec8f575bfdc432953cc8d2037fa2d","4571534baa94d3b5f9f98d09fb990bddbd5f5b03ec481f10e0e5dc841d755bda"],["e06372b0f4a207adf5ea905e8f1771b4e7e8dbd1c6a6c5b725866a0ae4fce725","7a908974bce18cfe12a27bb2ad5a488cd7484a7787104870b27034f94eee31dd"],["213c7a715cd5d45358d0bbf9dc0ce02204b10bdde2a3f58540ad6908d0559754","4b6dad0b5ae462507013ad06245ba190bb4850f5f36a7eeddff2c27534b458f2"],["4e7c272a7af4b34e8dbb9352a5419a87e2838c70adc62cddf0cc3a3b08fbd53c","17749c766c9d0b18e16fd09f6def681b530b9614bff7dd33e0b3941817dcaae6"],["fea74e3dbe778b1b10f238ad61686aa5c76e3db2be43057632427e2840fb27b6","6e0568db9b0b13297cf674deccb6af93126b596b973f7b77701d3db7f23cb96f"],["76e64113f677cf0e10a2570d599968d31544e179b760432952c02a4417bdde39","c90ddf8dee4e95cf577066d70681f0d35e2a33d2b56d2032b4b1752d1901ac01"],["c738c56b03b2abe1e8281baa743f8f9a8f7cc643df26cbee3ab150242bcbb891","893fb578951ad2537f718f2eacbfbbbb82314eef7880cfe917e735d9699a84c3"],["d895626548b65b81e264c7637c972877d1d72e5f3a925014372e9f6588f6c14b","febfaa38f2bc7eae728ec60818c340eb03428d632bb067e179363ed75d7d991f"],["b8da94032a957518eb0f6433571e8761ceffc73693e84edd49150a564f676e03","2804dfa44805a1e4d7c99cc9762808b092cc584d95ff3b511488e4e74efdf6e7"],["e80fea14441fb33a7d8adab9475d7fab2019effb5156a792f1a11778e3c0df5d","eed1de7f638e00771e89768ca3ca94472d155e80af322ea9fcb4291b6ac9ec78"],["a301697bdfcd704313ba48e51d567543f2a182031efd6915ddc07bbcc4e16070","7370f91cfb67e4f5081809fa25d40f9b1735dbf7c0a11a130c0d1a041e177ea1"],["90ad85b389d6b936463f9d0512678de208cc330b11307fffab7ac63e3fb04ed4","e507a3620a38261affdcbd9427222b839aefabe1582894d991d4d48cb6ef150"],["8f68b9d2f63b5f339239c1ad981f162ee88c5678723ea3351b7b444c9ec4c0da","662a9f2dba063986de1d90c2b6be215dbbea2cfe95510bfdf23cbf79501fff82"],["e4f3fb0176af85d65ff99ff9198c36091f48e86503681e3e6686fd5053231e11","1e63633ad0ef4f1c1661a6d0ea02b7286cc7e74ec951d1c9822c38576feb73bc"],["8c00fa9b18ebf331eb961537a45a4266c7034f2f0d4e1d0716fb6eae20eae29e","efa47267fea521a1a9dc343a3736c974c2fadafa81e36c54e7d2a4c66702414b"],["e7a26ce69dd4829f3e10cec0a9e98ed3143d084f308b92c0997fddfc60cb3e41","2a758e300fa7984b471b006a1aafbb18d0a6b2c0420e83e20e8a9421cf2cfd51"],["b6459e0ee3662ec8d23540c223bcbdc571cbcb967d79424f3cf29eb3de6b80ef","67c876d06f3e06de1dadf16e5661db3c4b3ae6d48e35b2ff30bf0b61a71ba45"],["d68a80c8280bb840793234aa118f06231d6f1fc67e73c5a5deda0f5b496943e8","db8ba9fff4b586d00c4b1f9177b0e28b5b0e7b8f7845295a294c84266b133120"],["324aed7df65c804252dc0270907a30b09612aeb973449cea4095980fc28d3d5d","648a365774b61f2ff130c0c35aec1f4f19213b0c7e332843967224af96ab7c84"],["4df9c14919cde61f6d51dfdbe5fee5dceec4143ba8d1ca888e8bd373fd054c96","35ec51092d8728050974c23a1d85d4b5d506cdc288490192ebac06cad10d5d"],["9c3919a84a474870faed8a9c1cc66021523489054d7f0308cbfc99c8ac1f98cd","ddb84f0f4a4ddd57584f044bf260e641905326f76c64c8e6be7e5e03d4fc599d"],["6057170b1dd12fdf8de05f281d8e06bb91e1493a8b91d4cc5a21382120a959e5","9a1af0b26a6a4807add9a2daf71df262465152bc3ee24c65e899be932385a2a8"],["a576df8e23a08411421439a4518da31880cef0fba7d4df12b1a6973eecb94266","40a6bf20e76640b2c92b97afe58cd82c432e10a7f514d9f3ee8be11ae1b28ec8"],["7778a78c28dec3e30a05fe9629de8c38bb30d1f5cf9a3a208f763889be58ad71","34626d9ab5a5b22ff7098e12f2ff580087b38411ff24ac563b513fc1fd9f43ac"],["928955ee637a84463729fd30e7afd2ed5f96274e5ad7e5cb09eda9c06d903ac","c25621003d3f42a827b78a13093a95eeac3d26efa8a8d83fc5180e935bcd091f"],["85d0fef3ec6db109399064f3a0e3b2855645b4a907ad354527aae75163d82751","1f03648413a38c0be29d496e582cf5663e8751e96877331582c237a24eb1f962"],["ff2b0dce97eece97c1c9b6041798b85dfdfb6d8882da20308f5404824526087e","493d13fef524ba188af4c4dc54d07936c7b7ed6fb90e2ceb2c951e01f0c29907"],["827fbbe4b1e880ea9ed2b2e6301b212b57f1ee148cd6dd28780e5e2cf856e241","c60f9c923c727b0b71bef2c67d1d12687ff7a63186903166d605b68baec293ec"],["eaa649f21f51bdbae7be4ae34ce6e5217a58fdce7f47f9aa7f3b58fa2120e2b3","be3279ed5bbbb03ac69a80f89879aa5a01a6b965f13f7e59d47a5305ba5ad93d"],["e4a42d43c5cf169d9391df6decf42ee541b6d8f0c9a137401e23632dda34d24f","4d9f92e716d1c73526fc99ccfb8ad34ce886eedfa8d8e4f13a7f7131deba9414"],["1ec80fef360cbdd954160fadab352b6b92b53576a88fea4947173b9d4300bf19","aeefe93756b5340d2f3a4958a7abbf5e0146e77f6295a07b671cdc1cc107cefd"],["146a778c04670c2f91b00af4680dfa8bce3490717d58ba889ddb5928366642be","b318e0ec3354028add669827f9d4b2870aaa971d2f7e5ed1d0b297483d83efd0"],["fa50c0f61d22e5f07e3acebb1aa07b128d0012209a28b9776d76a8793180eef9","6b84c6922397eba9b72cd2872281a68a5e683293a57a213b38cd8d7d3f4f2811"],["da1d61d0ca721a11b1a5bf6b7d88e8421a288ab5d5bba5220e53d32b5f067ec2","8157f55a7c99306c79c0766161c91e2966a73899d279b48a655fba0f1ad836f1"],["a8e282ff0c9706907215ff98e8fd416615311de0446f1e062a73b0610d064e13","7f97355b8db81c09abfb7f3c5b2515888b679a3e50dd6bd6cef7c73111f4cc0c"],["174a53b9c9a285872d39e56e6913cab15d59b1fa512508c022f382de8319497c","ccc9dc37abfc9c1657b4155f2c47f9e6646b3a1d8cb9854383da13ac079afa73"],["959396981943785c3d3e57edf5018cdbe039e730e4918b3d884fdff09475b7ba","2e7e552888c331dd8ba0386a4b9cd6849c653f64c8709385e9b8abf87524f2fd"],["d2a63a50ae401e56d645a1153b109a8fcca0a43d561fba2dbb51340c9d82b151","e82d86fb6443fcb7565aee58b2948220a70f750af484ca52d4142174dcf89405"],["64587e2335471eb890ee7896d7cfdc866bacbdbd3839317b3436f9b45617e073","d99fcdd5bf6902e2ae96dd6447c299a185b90a39133aeab358299e5e9faf6589"],["8481bde0e4e4d885b3a546d3e549de042f0aa6cea250e7fd358d6c86dd45e458","38ee7b8cba5404dd84a25bf39cecb2ca900a79c42b262e556d64b1b59779057e"],["13464a57a78102aa62b6979ae817f4637ffcfed3c4b1ce30bcd6303f6caf666b","69be159004614580ef7e433453ccb0ca48f300a81d0942e13f495a907f6ecc27"],["bc4a9df5b713fe2e9aef430bcc1dc97a0cd9ccede2f28588cada3a0d2d83f366","d3a81ca6e785c06383937adf4b798caa6e8a9fbfa547b16d758d666581f33c1"],["8c28a97bf8298bc0d23d8c749452a32e694b65e30a9472a3954ab30fe5324caa","40a30463a3305193378fedf31f7cc0eb7ae784f0451cb9459e71dc73cbef9482"],["8ea9666139527a8c1dd94ce4f071fd23c8b350c5a4bb33748c4ba111faccae0","620efabbc8ee2782e24e7c0cfb95c5d735b783be9cf0f8e955af34a30e62b945"],["dd3625faef5ba06074669716bbd3788d89bdde815959968092f76cc4eb9a9787","7a188fa3520e30d461da2501045731ca941461982883395937f68d00c644a573"],["f710d79d9eb962297e4f6232b40e8f7feb2bc63814614d692c12de752408221e","ea98e67232d3b3295d3b535532115ccac8612c721851617526ae47a9c77bfc82"]]},naf:{wnd:7,points:[["f9308a019258c31049344f85f89d5229b531c845836f99b08601f113bce036f9","388f7b0f632de8140fe337e62a37f3566500a99934c2231b6cb9fd7584b8e672"],["2f8bde4d1a07209355b4a7250a5c5128e88b84bddc619ab7cba8d569b240efe4","d8ac222636e5e3d6d4dba9dda6c9c426f788271bab0d6840dca87d3aa6ac62d6"],["5cbdf0646e5db4eaa398f365f2ea7a0e3d419b7e0330e39ce92bddedcac4f9bc","6aebca40ba255960a3178d6d861a54dba813d0b813fde7b5a5082628087264da"],["acd484e2f0c7f65309ad178a9f559abde09796974c57e714c35f110dfc27ccbe","cc338921b0a7d9fd64380971763b61e9add888a4375f8e0f05cc262ac64f9c37"],["774ae7f858a9411e5ef4246b70c65aac5649980be5c17891bbec17895da008cb","d984a032eb6b5e190243dd56d7b7b365372db1e2dff9d6a8301d74c9c953c61b"],["f28773c2d975288bc7d1d205c3748651b075fbc6610e58cddeeddf8f19405aa8","ab0902e8d880a89758212eb65cdaf473a1a06da521fa91f29b5cb52db03ed81"],["d7924d4f7d43ea965a465ae3095ff41131e5946f3c85f79e44adbcf8e27e080e","581e2872a86c72a683842ec228cc6defea40af2bd896d3a5c504dc9ff6a26b58"],["defdea4cdb677750a420fee807eacf21eb9898ae79b9768766e4faa04a2d4a34","4211ab0694635168e997b0ead2a93daeced1f4a04a95c0f6cfb199f69e56eb77"],["2b4ea0a797a443d293ef5cff444f4979f06acfebd7e86d277475656138385b6c","85e89bc037945d93b343083b5a1c86131a01f60c50269763b570c854e5c09b7a"],["352bbf4a4cdd12564f93fa332ce333301d9ad40271f8107181340aef25be59d5","321eb4075348f534d59c18259dda3e1f4a1b3b2e71b1039c67bd3d8bcf81998c"],["2fa2104d6b38d11b0230010559879124e42ab8dfeff5ff29dc9cdadd4ecacc3f","2de1068295dd865b64569335bd5dd80181d70ecfc882648423ba76b532b7d67"],["9248279b09b4d68dab21a9b066edda83263c3d84e09572e269ca0cd7f5453714","73016f7bf234aade5d1aa71bdea2b1ff3fc0de2a887912ffe54a32ce97cb3402"],["daed4f2be3a8bf278e70132fb0beb7522f570e144bf615c07e996d443dee8729","a69dce4a7d6c98e8d4a1aca87ef8d7003f83c230f3afa726ab40e52290be1c55"],["c44d12c7065d812e8acf28d7cbb19f9011ecd9e9fdf281b0e6a3b5e87d22e7db","2119a460ce326cdc76c45926c982fdac0e106e861edf61c5a039063f0e0e6482"],["6a245bf6dc698504c89a20cfded60853152b695336c28063b61c65cbd269e6b4","e022cf42c2bd4a708b3f5126f16a24ad8b33ba48d0423b6efd5e6348100d8a82"],["1697ffa6fd9de627c077e3d2fe541084ce13300b0bec1146f95ae57f0d0bd6a5","b9c398f186806f5d27561506e4557433a2cf15009e498ae7adee9d63d01b2396"],["605bdb019981718b986d0f07e834cb0d9deb8360ffb7f61df982345ef27a7479","2972d2de4f8d20681a78d93ec96fe23c26bfae84fb14db43b01e1e9056b8c49"],["62d14dab4150bf497402fdc45a215e10dcb01c354959b10cfe31c7e9d87ff33d","80fc06bd8cc5b01098088a1950eed0db01aa132967ab472235f5642483b25eaf"],["80c60ad0040f27dade5b4b06c408e56b2c50e9f56b9b8b425e555c2f86308b6f","1c38303f1cc5c30f26e66bad7fe72f70a65eed4cbe7024eb1aa01f56430bd57a"],["7a9375ad6167ad54aa74c6348cc54d344cc5dc9487d847049d5eabb0fa03c8fb","d0e3fa9eca8726909559e0d79269046bdc59ea10c70ce2b02d499ec224dc7f7"],["d528ecd9b696b54c907a9ed045447a79bb408ec39b68df504bb51f459bc3ffc9","eecf41253136e5f99966f21881fd656ebc4345405c520dbc063465b521409933"],["49370a4b5f43412ea25f514e8ecdad05266115e4a7ecb1387231808f8b45963","758f3f41afd6ed428b3081b0512fd62a54c3f3afbb5b6764b653052a12949c9a"],["77f230936ee88cbbd73df930d64702ef881d811e0e1498e2f1c13eb1fc345d74","958ef42a7886b6400a08266e9ba1b37896c95330d97077cbbe8eb3c7671c60d6"],["f2dac991cc4ce4b9ea44887e5c7c0bce58c80074ab9d4dbaeb28531b7739f530","e0dedc9b3b2f8dad4da1f32dec2531df9eb5fbeb0598e4fd1a117dba703a3c37"],["463b3d9f662621fb1b4be8fbbe2520125a216cdfc9dae3debcba4850c690d45b","5ed430d78c296c3543114306dd8622d7c622e27c970a1de31cb377b01af7307e"],["f16f804244e46e2a09232d4aff3b59976b98fac14328a2d1a32496b49998f247","cedabd9b82203f7e13d206fcdf4e33d92a6c53c26e5cce26d6579962c4e31df6"],["caf754272dc84563b0352b7a14311af55d245315ace27c65369e15f7151d41d1","cb474660ef35f5f2a41b643fa5e460575f4fa9b7962232a5c32f908318a04476"],["2600ca4b282cb986f85d0f1709979d8b44a09c07cb86d7c124497bc86f082120","4119b88753c15bd6a693b03fcddbb45d5ac6be74ab5f0ef44b0be9475a7e4b40"],["7635ca72d7e8432c338ec53cd12220bc01c48685e24f7dc8c602a7746998e435","91b649609489d613d1d5e590f78e6d74ecfc061d57048bad9e76f302c5b9c61"],["754e3239f325570cdbbf4a87deee8a66b7f2b33479d468fbc1a50743bf56cc18","673fb86e5bda30fb3cd0ed304ea49a023ee33d0197a695d0c5d98093c536683"],["e3e6bd1071a1e96aff57859c82d570f0330800661d1c952f9fe2694691d9b9e8","59c9e0bba394e76f40c0aa58379a3cb6a5a2283993e90c4167002af4920e37f5"],["186b483d056a033826ae73d88f732985c4ccb1f32ba35f4b4cc47fdcf04aa6eb","3b952d32c67cf77e2e17446e204180ab21fb8090895138b4a4a797f86e80888b"],["df9d70a6b9876ce544c98561f4be4f725442e6d2b737d9c91a8321724ce0963f","55eb2dafd84d6ccd5f862b785dc39d4ab157222720ef9da217b8c45cf2ba2417"],["5edd5cc23c51e87a497ca815d5dce0f8ab52554f849ed8995de64c5f34ce7143","efae9c8dbc14130661e8cec030c89ad0c13c66c0d17a2905cdc706ab7399a868"],["290798c2b6476830da12fe02287e9e777aa3fba1c355b17a722d362f84614fba","e38da76dcd440621988d00bcf79af25d5b29c094db2a23146d003afd41943e7a"],["af3c423a95d9f5b3054754efa150ac39cd29552fe360257362dfdecef4053b45","f98a3fd831eb2b749a93b0e6f35cfb40c8cd5aa667a15581bc2feded498fd9c6"],["766dbb24d134e745cccaa28c99bf274906bb66b26dcf98df8d2fed50d884249a","744b1152eacbe5e38dcc887980da38b897584a65fa06cedd2c924f97cbac5996"],["59dbf46f8c94759ba21277c33784f41645f7b44f6c596a58ce92e666191abe3e","c534ad44175fbc300f4ea6ce648309a042ce739a7919798cd85e216c4a307f6e"],["f13ada95103c4537305e691e74e9a4a8dd647e711a95e73cb62dc6018cfd87b8","e13817b44ee14de663bf4bc808341f326949e21a6a75c2570778419bdaf5733d"],["7754b4fa0e8aced06d4167a2c59cca4cda1869c06ebadfb6488550015a88522c","30e93e864e669d82224b967c3020b8fa8d1e4e350b6cbcc537a48b57841163a2"],["948dcadf5990e048aa3874d46abef9d701858f95de8041d2a6828c99e2262519","e491a42537f6e597d5d28a3224b1bc25df9154efbd2ef1d2cbba2cae5347d57e"],["7962414450c76c1689c7b48f8202ec37fb224cf5ac0bfa1570328a8a3d7c77ab","100b610ec4ffb4760d5c1fc133ef6f6b12507a051f04ac5760afa5b29db83437"],["3514087834964b54b15b160644d915485a16977225b8847bb0dd085137ec47ca","ef0afbb2056205448e1652c48e8127fc6039e77c15c2378b7e7d15a0de293311"],["d3cc30ad6b483e4bc79ce2c9dd8bc54993e947eb8df787b442943d3f7b527eaf","8b378a22d827278d89c5e9be8f9508ae3c2ad46290358630afb34db04eede0a4"],["1624d84780732860ce1c78fcbfefe08b2b29823db913f6493975ba0ff4847610","68651cf9b6da903e0914448c6cd9d4ca896878f5282be4c8cc06e2a404078575"],["733ce80da955a8a26902c95633e62a985192474b5af207da6df7b4fd5fc61cd4","f5435a2bd2badf7d485a4d8b8db9fcce3e1ef8e0201e4578c54673bc1dc5ea1d"],["15d9441254945064cf1a1c33bbd3b49f8966c5092171e699ef258dfab81c045c","d56eb30b69463e7234f5137b73b84177434800bacebfc685fc37bbe9efe4070d"],["a1d0fcf2ec9de675b612136e5ce70d271c21417c9d2b8aaaac138599d0717940","edd77f50bcb5a3cab2e90737309667f2641462a54070f3d519212d39c197a629"],["e22fbe15c0af8ccc5780c0735f84dbe9a790badee8245c06c7ca37331cb36980","a855babad5cd60c88b430a69f53a1a7a38289154964799be43d06d77d31da06"],["311091dd9860e8e20ee13473c1155f5f69635e394704eaa74009452246cfa9b3","66db656f87d1f04fffd1f04788c06830871ec5a64feee685bd80f0b1286d8374"],["34c1fd04d301be89b31c0442d3e6ac24883928b45a9340781867d4232ec2dbdf","9414685e97b1b5954bd46f730174136d57f1ceeb487443dc5321857ba73abee"],["f219ea5d6b54701c1c14de5b557eb42a8d13f3abbcd08affcc2a5e6b049b8d63","4cb95957e83d40b0f73af4544cccf6b1f4b08d3c07b27fb8d8c2962a400766d1"],["d7b8740f74a8fbaab1f683db8f45de26543a5490bca627087236912469a0b448","fa77968128d9c92ee1010f337ad4717eff15db5ed3c049b3411e0315eaa4593b"],["32d31c222f8f6f0ef86f7c98d3a3335ead5bcd32abdd94289fe4d3091aa824bf","5f3032f5892156e39ccd3d7915b9e1da2e6dac9e6f26e961118d14b8462e1661"],["7461f371914ab32671045a155d9831ea8793d77cd59592c4340f86cbc18347b5","8ec0ba238b96bec0cbdddcae0aa442542eee1ff50c986ea6b39847b3cc092ff6"],["ee079adb1df1860074356a25aa38206a6d716b2c3e67453d287698bad7b2b2d6","8dc2412aafe3be5c4c5f37e0ecc5f9f6a446989af04c4e25ebaac479ec1c8c1e"],["16ec93e447ec83f0467b18302ee620f7e65de331874c9dc72bfd8616ba9da6b5","5e4631150e62fb40d0e8c2a7ca5804a39d58186a50e497139626778e25b0674d"],["eaa5f980c245f6f038978290afa70b6bd8855897f98b6aa485b96065d537bd99","f65f5d3e292c2e0819a528391c994624d784869d7e6ea67fb18041024edc07dc"],["78c9407544ac132692ee1910a02439958ae04877151342ea96c4b6b35a49f51","f3e0319169eb9b85d5404795539a5e68fa1fbd583c064d2462b675f194a3ddb4"],["494f4be219a1a77016dcd838431aea0001cdc8ae7a6fc688726578d9702857a5","42242a969283a5f339ba7f075e36ba2af925ce30d767ed6e55f4b031880d562c"],["a598a8030da6d86c6bc7f2f5144ea549d28211ea58faa70ebf4c1e665c1fe9b5","204b5d6f84822c307e4b4a7140737aec23fc63b65b35f86a10026dbd2d864e6b"],["c41916365abb2b5d09192f5f2dbeafec208f020f12570a184dbadc3e58595997","4f14351d0087efa49d245b328984989d5caf9450f34bfc0ed16e96b58fa9913"],["841d6063a586fa475a724604da03bc5b92a2e0d2e0a36acfe4c73a5514742881","73867f59c0659e81904f9a1c7543698e62562d6744c169ce7a36de01a8d6154"],["5e95bb399a6971d376026947f89bde2f282b33810928be4ded112ac4d70e20d5","39f23f366809085beebfc71181313775a99c9aed7d8ba38b161384c746012865"],["36e4641a53948fd476c39f8a99fd974e5ec07564b5315d8bf99471bca0ef2f66","d2424b1b1abe4eb8164227b085c9aa9456ea13493fd563e06fd51cf5694c78fc"],["336581ea7bfbbb290c191a2f507a41cf5643842170e914faeab27c2c579f726","ead12168595fe1be99252129b6e56b3391f7ab1410cd1e0ef3dcdcabd2fda224"],["8ab89816dadfd6b6a1f2634fcf00ec8403781025ed6890c4849742706bd43ede","6fdcef09f2f6d0a044e654aef624136f503d459c3e89845858a47a9129cdd24e"],["1e33f1a746c9c5778133344d9299fcaa20b0938e8acff2544bb40284b8c5fb94","60660257dd11b3aa9c8ed618d24edff2306d320f1d03010e33a7d2057f3b3b6"],["85b7c1dcb3cec1b7ee7f30ded79dd20a0ed1f4cc18cbcfcfa410361fd8f08f31","3d98a9cdd026dd43f39048f25a8847f4fcafad1895d7a633c6fed3c35e999511"],["29df9fbd8d9e46509275f4b125d6d45d7fbe9a3b878a7af872a2800661ac5f51","b4c4fe99c775a606e2d8862179139ffda61dc861c019e55cd2876eb2a27d84b"],["a0b1cae06b0a847a3fea6e671aaf8adfdfe58ca2f768105c8082b2e449fce252","ae434102edde0958ec4b19d917a6a28e6b72da1834aff0e650f049503a296cf2"],["4e8ceafb9b3e9a136dc7ff67e840295b499dfb3b2133e4ba113f2e4c0e121e5","cf2174118c8b6d7a4b48f6d534ce5c79422c086a63460502b827ce62a326683c"],["d24a44e047e19b6f5afb81c7ca2f69080a5076689a010919f42725c2b789a33b","6fb8d5591b466f8fc63db50f1c0f1c69013f996887b8244d2cdec417afea8fa3"],["ea01606a7a6c9cdd249fdfcfacb99584001edd28abbab77b5104e98e8e3b35d4","322af4908c7312b0cfbfe369f7a7b3cdb7d4494bc2823700cfd652188a3ea98d"],["af8addbf2b661c8a6c6328655eb96651252007d8c5ea31be4ad196de8ce2131f","6749e67c029b85f52a034eafd096836b2520818680e26ac8f3dfbcdb71749700"],["e3ae1974566ca06cc516d47e0fb165a674a3dabcfca15e722f0e3450f45889","2aeabe7e4531510116217f07bf4d07300de97e4874f81f533420a72eeb0bd6a4"],["591ee355313d99721cf6993ffed1e3e301993ff3ed258802075ea8ced397e246","b0ea558a113c30bea60fc4775460c7901ff0b053d25ca2bdeee98f1a4be5d196"],["11396d55fda54c49f19aa97318d8da61fa8584e47b084945077cf03255b52984","998c74a8cd45ac01289d5833a7beb4744ff536b01b257be4c5767bea93ea57a4"],["3c5d2a1ba39c5a1790000738c9e0c40b8dcdfd5468754b6405540157e017aa7a","b2284279995a34e2f9d4de7396fc18b80f9b8b9fdd270f6661f79ca4c81bd257"],["cc8704b8a60a0defa3a99a7299f2e9c3fbc395afb04ac078425ef8a1793cc030","bdd46039feed17881d1e0862db347f8cf395b74fc4bcdc4e940b74e3ac1f1b13"],["c533e4f7ea8555aacd9777ac5cad29b97dd4defccc53ee7ea204119b2889b197","6f0a256bc5efdf429a2fb6242f1a43a2d9b925bb4a4b3a26bb8e0f45eb596096"],["c14f8f2ccb27d6f109f6d08d03cc96a69ba8c34eec07bbcf566d48e33da6593","c359d6923bb398f7fd4473e16fe1c28475b740dd098075e6c0e8649113dc3a38"],["a6cbc3046bc6a450bac24789fa17115a4c9739ed75f8f21ce441f72e0b90e6ef","21ae7f4680e889bb130619e2c0f95a360ceb573c70603139862afd617fa9b9f"],["347d6d9a02c48927ebfb86c1359b1caf130a3c0267d11ce6344b39f99d43cc38","60ea7f61a353524d1c987f6ecec92f086d565ab687870cb12689ff1e31c74448"],["da6545d2181db8d983f7dcb375ef5866d47c67b1bf31c8cf855ef7437b72656a","49b96715ab6878a79e78f07ce5680c5d6673051b4935bd897fea824b77dc208a"],["c40747cc9d012cb1a13b8148309c6de7ec25d6945d657146b9d5994b8feb1111","5ca560753be2a12fc6de6caf2cb489565db936156b9514e1bb5e83037e0fa2d4"],["4e42c8ec82c99798ccf3a610be870e78338c7f713348bd34c8203ef4037f3502","7571d74ee5e0fb92a7a8b33a07783341a5492144cc54bcc40a94473693606437"],["3775ab7089bc6af823aba2e1af70b236d251cadb0c86743287522a1b3b0dedea","be52d107bcfa09d8bcb9736a828cfa7fac8db17bf7a76a2c42ad961409018cf7"],["cee31cbf7e34ec379d94fb814d3d775ad954595d1314ba8846959e3e82f74e26","8fd64a14c06b589c26b947ae2bcf6bfa0149ef0be14ed4d80f448a01c43b1c6d"],["b4f9eaea09b6917619f6ea6a4eb5464efddb58fd45b1ebefcdc1a01d08b47986","39e5c9925b5a54b07433a4f18c61726f8bb131c012ca542eb24a8ac07200682a"],["d4263dfc3d2df923a0179a48966d30ce84e2515afc3dccc1b77907792ebcc60e","62dfaf07a0f78feb30e30d6295853ce189e127760ad6cf7fae164e122a208d54"],["48457524820fa65a4f8d35eb6930857c0032acc0a4a2de422233eeda897612c4","25a748ab367979d98733c38a1fa1c2e7dc6cc07db2d60a9ae7a76aaa49bd0f77"],["dfeeef1881101f2cb11644f3a2afdfc2045e19919152923f367a1767c11cceda","ecfb7056cf1de042f9420bab396793c0c390bde74b4bbdff16a83ae09a9a7517"],["6d7ef6b17543f8373c573f44e1f389835d89bcbc6062ced36c82df83b8fae859","cd450ec335438986dfefa10c57fea9bcc521a0959b2d80bbf74b190dca712d10"],["e75605d59102a5a2684500d3b991f2e3f3c88b93225547035af25af66e04541f","f5c54754a8f71ee540b9b48728473e314f729ac5308b06938360990e2bfad125"],["eb98660f4c4dfaa06a2be453d5020bc99a0c2e60abe388457dd43fefb1ed620c","6cb9a8876d9cb8520609af3add26cd20a0a7cd8a9411131ce85f44100099223e"],["13e87b027d8514d35939f2e6892b19922154596941888336dc3563e3b8dba942","fef5a3c68059a6dec5d624114bf1e91aac2b9da568d6abeb2570d55646b8adf1"],["ee163026e9fd6fe017c38f06a5be6fc125424b371ce2708e7bf4491691e5764a","1acb250f255dd61c43d94ccc670d0f58f49ae3fa15b96623e5430da0ad6c62b2"],["b268f5ef9ad51e4d78de3a750c2dc89b1e626d43505867999932e5db33af3d80","5f310d4b3c99b9ebb19f77d41c1dee018cf0d34fd4191614003e945a1216e423"],["ff07f3118a9df035e9fad85eb6c7bfe42b02f01ca99ceea3bf7ffdba93c4750d","438136d603e858a3a5c440c38eccbaddc1d2942114e2eddd4740d098ced1f0d8"],["8d8b9855c7c052a34146fd20ffb658bea4b9f69e0d825ebec16e8c3ce2b526a1","cdb559eedc2d79f926baf44fb84ea4d44bcf50fee51d7ceb30e2e7f463036758"],["52db0b5384dfbf05bfa9d472d7ae26dfe4b851ceca91b1eba54263180da32b63","c3b997d050ee5d423ebaf66a6db9f57b3180c902875679de924b69d84a7b375"],["e62f9490d3d51da6395efd24e80919cc7d0f29c3f3fa48c6fff543becbd43352","6d89ad7ba4876b0b22c2ca280c682862f342c8591f1daf5170e07bfd9ccafa7d"],["7f30ea2476b399b4957509c88f77d0191afa2ff5cb7b14fd6d8e7d65aaab1193","ca5ef7d4b231c94c3b15389a5f6311e9daff7bb67b103e9880ef4bff637acaec"],["5098ff1e1d9f14fb46a210fada6c903fef0fb7b4a1dd1d9ac60a0361800b7a00","9731141d81fc8f8084d37c6e7542006b3ee1b40d60dfe5362a5b132fd17ddc0"],["32b78c7de9ee512a72895be6b9cbefa6e2f3c4ccce445c96b9f2c81e2778ad58","ee1849f513df71e32efc3896ee28260c73bb80547ae2275ba497237794c8753c"],["e2cb74fddc8e9fbcd076eef2a7c72b0ce37d50f08269dfc074b581550547a4f7","d3aa2ed71c9dd2247a62df062736eb0baddea9e36122d2be8641abcb005cc4a4"],["8438447566d4d7bedadc299496ab357426009a35f235cb141be0d99cd10ae3a8","c4e1020916980a4da5d01ac5e6ad330734ef0d7906631c4f2390426b2edd791f"],["4162d488b89402039b584c6fc6c308870587d9c46f660b878ab65c82c711d67e","67163e903236289f776f22c25fb8a3afc1732f2b84b4e95dbda47ae5a0852649"],["3fad3fa84caf0f34f0f89bfd2dcf54fc175d767aec3e50684f3ba4a4bf5f683d","cd1bc7cb6cc407bb2f0ca647c718a730cf71872e7d0d2a53fa20efcdfe61826"],["674f2600a3007a00568c1a7ce05d0816c1fb84bf1370798f1c69532faeb1a86b","299d21f9413f33b3edf43b257004580b70db57da0b182259e09eecc69e0d38a5"],["d32f4da54ade74abb81b815ad1fb3b263d82d6c692714bcff87d29bd5ee9f08f","f9429e738b8e53b968e99016c059707782e14f4535359d582fc416910b3eea87"],["30e4e670435385556e593657135845d36fbb6931f72b08cb1ed954f1e3ce3ff6","462f9bce619898638499350113bbc9b10a878d35da70740dc695a559eb88db7b"],["be2062003c51cc3004682904330e4dee7f3dcd10b01e580bf1971b04d4cad297","62188bc49d61e5428573d48a74e1c655b1c61090905682a0d5558ed72dccb9bc"],["93144423ace3451ed29e0fb9ac2af211cb6e84a601df5993c419859fff5df04a","7c10dfb164c3425f5c71a3f9d7992038f1065224f72bb9d1d902a6d13037b47c"],["b015f8044f5fcbdcf21ca26d6c34fb8197829205c7b7d2a7cb66418c157b112c","ab8c1e086d04e813744a655b2df8d5f83b3cdc6faa3088c1d3aea1454e3a1d5f"],["d5e9e1da649d97d89e4868117a465a3a4f8a18de57a140d36b3f2af341a21b52","4cb04437f391ed73111a13cc1d4dd0db1693465c2240480d8955e8592f27447a"],["d3ae41047dd7ca065dbf8ed77b992439983005cd72e16d6f996a5316d36966bb","bd1aeb21ad22ebb22a10f0303417c6d964f8cdd7df0aca614b10dc14d125ac46"],["463e2763d885f958fc66cdd22800f0a487197d0a82e377b49f80af87c897b065","bfefacdb0e5d0fd7df3a311a94de062b26b80c61fbc97508b79992671ef7ca7f"],["7985fdfd127c0567c6f53ec1bb63ec3158e597c40bfe747c83cddfc910641917","603c12daf3d9862ef2b25fe1de289aed24ed291e0ec6708703a5bd567f32ed03"],["74a1ad6b5f76e39db2dd249410eac7f99e74c59cb83d2d0ed5ff1543da7703e9","cc6157ef18c9c63cd6193d83631bbea0093e0968942e8c33d5737fd790e0db08"],["30682a50703375f602d416664ba19b7fc9bab42c72747463a71d0896b22f6da3","553e04f6b018b4fa6c8f39e7f311d3176290d0e0f19ca73f17714d9977a22ff8"],["9e2158f0d7c0d5f26c3791efefa79597654e7a2b2464f52b1ee6c1347769ef57","712fcdd1b9053f09003a3481fa7762e9ffd7c8ef35a38509e2fbf2629008373"],["176e26989a43c9cfeba4029c202538c28172e566e3c4fce7322857f3be327d66","ed8cc9d04b29eb877d270b4878dc43c19aefd31f4eee09ee7b47834c1fa4b1c3"],["75d46efea3771e6e68abb89a13ad747ecf1892393dfc4f1b7004788c50374da8","9852390a99507679fd0b86fd2b39a868d7efc22151346e1a3ca4726586a6bed8"],["809a20c67d64900ffb698c4c825f6d5f2310fb0451c869345b7319f645605721","9e994980d9917e22b76b061927fa04143d096ccc54963e6a5ebfa5f3f8e286c1"],["1b38903a43f7f114ed4500b4eac7083fdefece1cf29c63528d563446f972c180","4036edc931a60ae889353f77fd53de4a2708b26b6f5da72ad3394119daf408f9"]]}}},{}],173:[function(require,module,exports){"use strict";var utils=exports,BN=require("bn.js"),exports=require("minimalistic-assert"),require=require("minimalistic-crypto-utils");utils.assert=exports,utils.toArray=require.toArray,utils.zero2=require.zero2,utils.toHex=require.toHex,utils.encode=require.encode,utils.getNAF=function(num,w,bits){for(var naf=new Array(Math.max(num.bitLength(),bits)+1),ws=(naf.fill(0),1<<w+1),k=num.clone(),i=0;i<naf.length;i++){var z,mod=k.andln(ws-1);k.isOdd()?k.isubn(z=(ws>>1)-1<mod?(ws>>1)-mod:mod):z=0,naf[i]=z,k.iushrn(1)}return naf},utils.getJSF=function(k1,k2){for(var m8,jsf=[[],[]],d1=(k1=k1.clone(),k2=k2.clone(),0),d2=0;0<k1.cmpn(-d1)||0<k2.cmpn(-d2);){var u1,m14=k1.andln(3)+d1&3,m24=k2.andln(3)+d2&3;3===m24&&(m24=-1),u1=0==(1&(m14=3===m14?-1:m14))?0:3!==(m8=k1.andln(7)+d1&7)&&5!==m8||2!==m24?m14:-m14,jsf[0].push(u1),m14=0==(1&m24)?0:3!==(m8=k2.andln(7)+d2&7)&&5!==m8||2!==m14?m24:-m24,jsf[1].push(m14),2*d1===u1+1&&(d1=1-d1),2*d2===m14+1&&(d2=1-d2),k1.iushrn(1),k2.iushrn(1)}return jsf},utils.cachedProperty=function(obj,name,computer){var key="_"+name;obj.prototype[name]=function(){return void 0!==this[key]?this[key]:this[key]=computer.call(this)}},utils.parseBytes=function(bytes){return"string"==typeof bytes?utils.toArray(bytes,"hex"):bytes},utils.intFromLE=function(bytes){return new BN(bytes,"hex","le")}},{"bn.js":174,"minimalistic-assert":265,"minimalistic-crypto-utils":266}],174:[function(require,module,exports){arguments[4][22][0].apply(exports,arguments)},{buffer:68,dup:22}],175:[function(require,module,exports){module.exports={name:"elliptic",version:"6.5.4",description:"EC cryptography",main:"lib/elliptic.js",files:["lib"],scripts:{lint:"eslint lib test","lint:fix":"npm run lint -- --fix",unit:"istanbul test _mocha --reporter=spec test/index.js",test:"npm run lint && npm run unit",version:"grunt dist && git add dist/"},repository:{type:"git",url:"git@github.com:indutny/elliptic"},keywords:["EC","Elliptic","curve","Cryptography"],author:"Fedor Indutny <fedor@indutny.com>",license:"MIT",bugs:{url:"https://github.com/indutny/elliptic/issues"},homepage:"https://github.com/indutny/elliptic",devDependencies:{brfs:"^2.0.2",coveralls:"^3.1.0",eslint:"^7.6.0",grunt:"^1.2.1","grunt-browserify":"^5.3.0","grunt-cli":"^1.3.2","grunt-contrib-connect":"^3.0.0","grunt-contrib-copy":"^1.0.0","grunt-contrib-uglify":"^5.0.0","grunt-mocha-istanbul":"^5.0.2","grunt-saucelabs":"^9.0.1",istanbul:"^0.4.5",mocha:"^8.0.1"},dependencies:{"bn.js":"^4.11.9",brorand:"^1.1.0","hash.js":"^1.0.0","hmac-drbg":"^1.0.1",inherits:"^2.0.4","minimalistic-assert":"^1.0.1","minimalistic-crypto-utils":"^1.0.1"}}},{}],176:[function(require,module,exports){"use strict";const AbstractLevelDOWN=require("abstract-leveldown").AbstractLevelDOWN,AbstractChainedBatch=require("abstract-leveldown").AbstractChainedBatch,AbstractIterator=require("abstract-leveldown").AbstractIterator,inherits=require("inherits"),Codec=require("level-codec"),EncodingError=require("level-errors").EncodingError,rangeMethods=["approximateSize","compactRange"];function DB(db,opts){if(!(this instanceof DB))return new DB(db,opts);var manifest=db.supports||{};const additionalMethods=manifest.additionalMethods||{};AbstractLevelDOWN.call(this,manifest),this.supports.encodings=!0,this.supports.additionalMethods={},rangeMethods.forEach(function(m){var fallback="function"==typeof db[m];(additionalMethods[m]||fallback)&&(this.supports.additionalMethods[m]=!0,this[m]=function(start,end,opts,cb){return start=this.codec.encodeKey(start,opts),end=this.codec.encodeKey(end,opts),this.db[m](start,end,opts,cb)})},this),void 0===(opts=opts||{}).keyEncoding&&(opts.keyEncoding="utf8"),void 0===opts.valueEncoding&&(opts.valueEncoding="utf8"),this.db=db,this.codec=new Codec(opts)}function Iterator(db,opts){AbstractIterator.call(this,db),this.codec=db.codec,this.keys=opts.keys,this.values=opts.values,this.opts=this.codec.encodeLtgt(opts),this.it=db.db.iterator(this.opts)}function Batch(db,codec){AbstractChainedBatch.call(this,db),this.codec=db.codec,this.batch=db.db.batch()}module.exports=DB,inherits(DB,AbstractLevelDOWN),DB.prototype.type="encoding-down",DB.prototype._serializeKey=DB.prototype._serializeValue=function(datum){return datum},DB.prototype._open=function(opts,cb){this.db.open(opts,cb)},DB.prototype._close=function(cb){this.db.close(cb)},DB.prototype._put=function(key,value,opts,cb){key=this.codec.encodeKey(key,opts),value=this.codec.encodeValue(value,opts),this.db.put(key,value,opts,cb)},DB.prototype._get=function(key,opts,cb){key=this.codec.encodeKey(key,opts),opts.asBuffer=this.codec.valueAsBuffer(opts),this.db.get(key,opts,(err,value)=>{if(err)return cb(err);try{value=this.codec.decodeValue(value,opts)}catch(err){return cb(new EncodingError(err))}cb(null,value)})},DB.prototype._getMany=function(keys,opts,cb){keys=keys.map(key=>this.codec.encodeKey(key,opts)),opts.asBuffer=this.codec.valueAsBuffer(opts),this.db.getMany(keys,opts,(err,values)=>{if(err)return cb(err);const decoded=new Array(values.length);for(let i=0;i<values.length;i++)if(void 0===values[i])decoded[i]=void 0;else try{decoded[i]=this.codec.decodeValue(values[i],opts)}catch(err){return cb(new EncodingError(err))}cb(null,decoded)})},DB.prototype._del=function(key,opts,cb){key=this.codec.encodeKey(key,opts),this.db.del(key,opts,cb)},DB.prototype._chainedBatch=function(){return new Batch(this)},DB.prototype._batch=function(ops,opts,cb){ops=this.codec.encodeBatch(ops,opts),this.db.batch(ops,opts,cb)},DB.prototype._iterator=function(opts){return opts.keyAsBuffer=this.codec.keyAsBuffer(opts),opts.valueAsBuffer=this.codec.valueAsBuffer(opts),new Iterator(this,opts)},DB.prototype._clear=function(opts,callback){opts=this.codec.encodeLtgt(opts),this.db.clear(opts,callback)},inherits(Iterator,AbstractIterator),Iterator.prototype._next=function(cb){this.it.next((err,key,value)=>{if(err)return cb(err);try{key=this.keys&&void 0!==key?this.codec.decodeKey(key,this.opts):void 0,value=this.values&&void 0!==value?this.codec.decodeValue(value,this.opts):void 0}catch(err){return cb(new EncodingError(err))}cb(null,key,value)})},Iterator.prototype._seek=function(key){key=this.codec.encodeKey(key,this.opts),this.it.seek(key)},Iterator.prototype._end=function(cb){this.it.end(cb)},inherits(Batch,AbstractChainedBatch),Batch.prototype._put=function(key,value,options){key=this.codec.encodeKey(key,options),value=this.codec.encodeValue(value,options),this.batch.put(key,value)},Batch.prototype._del=function(key,options){key=this.codec.encodeKey(key,options),this.batch.del(key)},Batch.prototype._clear=function(){this.batch.clear()},Batch.prototype._write=function(opts,cb){this.batch.write(opts,cb)}},{"abstract-leveldown":5,inherits:220,"level-codec":227,"level-errors":229}],177:[function(require,module,exports){"use strict";require=require("get-intrinsic")("%Object.getOwnPropertyDescriptor%",!0);if(require)try{require([],"length")}catch(e){require=null}module.exports=require},{"get-intrinsic":184}],178:[function(require,module,exports){"use strict";var R="object"==typeof Reflect?Reflect:null,ReflectApply=R&&"function"==typeof R.apply?R.apply:function(target,receiver,args){return Function.prototype.apply.call(target,receiver,args)};var ReflectOwnKeys=R&&"function"==typeof R.ownKeys?R.ownKeys:Object.getOwnPropertySymbols?function(target){return Object.getOwnPropertyNames(target).concat(Object.getOwnPropertySymbols(target))}:function(target){return Object.getOwnPropertyNames(target)},NumberIsNaN=Number.isNaN||function(value){return value!=value};function EventEmitter(){EventEmitter.init.call(this)}module.exports=EventEmitter,module.exports.once=function(emitter,name){return new Promise(function(resolve,reject){function errorListener(err){emitter.removeListener(name,resolver),reject(err)}function resolver(){"function"==typeof emitter.removeListener&&emitter.removeListener("error",errorListener),resolve([].slice.call(arguments))}eventTargetAgnosticAddListener(emitter,name,resolver,{once:!0}),"error"!==name&&function(emitter,handler,flags){"function"==typeof emitter.on&&eventTargetAgnosticAddListener(emitter,"error",handler,flags)}(emitter,errorListener,{once:!0})})},(EventEmitter.EventEmitter=EventEmitter).prototype._events=void 0,EventEmitter.prototype._eventsCount=0,EventEmitter.prototype._maxListeners=void 0;var defaultMaxListeners=10;function checkListener(listener){if("function"!=typeof listener)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof listener)}function _getMaxListeners(that){return void 0===that._maxListeners?EventEmitter.defaultMaxListeners:that._maxListeners}function _addListener(target,type,listener,prepend){var events,existing;return checkListener(listener),void 0===(events=target._events)?(events=target._events=Object.create(null),target._eventsCount=0):(void 0!==events.newListener&&(target.emit("newListener",type,listener.listener||listener),events=target._events),existing=events[type]),void 0===existing?(existing=events[type]=listener,++target._eventsCount):("function"==typeof existing?existing=events[type]=prepend?[listener,existing]:[existing,listener]:prepend?existing.unshift(listener):existing.push(listener),0<(events=_getMaxListeners(target))&&existing.length>events&&!existing.warned&&(existing.warned=!0,(prepend=new Error("Possible EventEmitter memory leak detected. "+existing.length+" "+String(type)+" listeners added. Use emitter.setMaxListeners() to increase limit")).name="MaxListenersExceededWarning",prepend.emitter=target,prepend.type=type,prepend.count=existing.length,listener=prepend,console&&console.warn&&console.warn(listener))),target}function _onceWrap(target,type,listener){target={fired:!1,wrapFn:void 0,target:target,type:type,listener:listener},type=function(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}.bind(target);return type.listener=listener,target.wrapFn=type}function _listeners(target,type,unwrap){target=target._events;if(void 0===target)return[];target=target[type];{if(void 0===target)return[];if("function"==typeof target)return unwrap?[target.listener||target]:[target];if(unwrap){for(var arr=target,ret=new Array(arr.length),i=0;i<ret.length;++i)ret[i]=arr[i].listener||arr[i];return ret}return arrayClone(target,target.length)}}function listenerCount(type){var events=this._events;if(void 0!==events){events=events[type];if("function"==typeof events)return 1;if(void 0!==events)return events.length}return 0}function arrayClone(arr,n){for(var copy=new Array(n),i=0;i<n;++i)copy[i]=arr[i];return copy}function eventTargetAgnosticAddListener(emitter,name,listener,flags){if("function"==typeof emitter.on)flags.once?emitter.once(name,listener):emitter.on(name,listener);else{if("function"!=typeof emitter.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof emitter);emitter.addEventListener(name,function wrapListener(arg){flags.once&&emitter.removeEventListener(name,wrapListener),listener(arg)})}}Object.defineProperty(EventEmitter,"defaultMaxListeners",{enumerable:!0,get:function(){return defaultMaxListeners},set:function(arg){if("number"!=typeof arg||arg<0||NumberIsNaN(arg))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+arg+".");defaultMaxListeners=arg}}),EventEmitter.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},EventEmitter.prototype.setMaxListeners=function(n){if("number"!=typeof n||n<0||NumberIsNaN(n))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+n+".");return this._maxListeners=n,this},EventEmitter.prototype.getMaxListeners=function(){return _getMaxListeners(this)},EventEmitter.prototype.emit=function(type){for(var args=[],i=1;i<arguments.length;i++)args.push(arguments[i]);var doError="error"===type,events=this._events;if(void 0!==events)doError=doError&&void 0===events.error;else if(!doError)return!1;if(doError){if((er=0<args.length?args[0]:er)instanceof Error)throw er;doError=new Error("Unhandled error."+(er?" ("+er.message+")":""));throw doError.context=er,doError}var er=events[type];if(void 0===er)return!1;if("function"==typeof er)ReflectApply(er,this,args);else for(var len=er.length,listeners=arrayClone(er,len),i=0;i<len;++i)ReflectApply(listeners[i],this,args);return!0},EventEmitter.prototype.on=EventEmitter.prototype.addListener=function(type,listener){return _addListener(this,type,listener,!1)},EventEmitter.prototype.prependListener=function(type,listener){return _addListener(this,type,listener,!0)},EventEmitter.prototype.once=function(type,listener){return checkListener(listener),this.on(type,_onceWrap(this,type,listener)),this},EventEmitter.prototype.prependOnceListener=function(type,listener){return checkListener(listener),this.prependListener(type,_onceWrap(this,type,listener)),this},EventEmitter.prototype.off=EventEmitter.prototype.removeListener=function(type,listener){var list,events,position,i,originalListener;if(checkListener(listener),void 0===(events=this._events))return this;if(void 0===(list=events[type]))return this;if(list===listener||list.listener===listener)0==--this._eventsCount?this._events=Object.create(null):(delete events[type],events.removeListener&&this.emit("removeListener",type,list.listener||listener));else if("function"!=typeof list){for(position=-1,i=list.length-1;0<=i;i--)if(list[i]===listener||list[i].listener===listener){originalListener=list[i].listener,position=i;break}if(position<0)return this;0===position?list.shift():function(list,index){for(;index+1<list.length;index++)list[index]=list[index+1];list.pop()}(list,position),1===list.length&&(events[type]=list[0]),void 0!==events.removeListener&&this.emit("removeListener",type,originalListener||listener)}return this},EventEmitter.prototype.removeAllListeners=function(type){var listeners,events=this._events;if(void 0===events)return this;if(void 0===events.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==events[type]&&(0==--this._eventsCount?this._events=Object.create(null):delete events[type]),this;if(0===arguments.length){for(var key,keys=Object.keys(events),i=0;i<keys.length;++i)"removeListener"!==(key=keys[i])&&this.removeAllListeners(key);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(listeners=events[type]))this.removeListener(type,listeners);else if(void 0!==listeners)for(i=listeners.length-1;0<=i;i--)this.removeListener(type,listeners[i]);return this},EventEmitter.prototype.listeners=function(type){return _listeners(this,type,!0)},EventEmitter.prototype.rawListeners=function(type){return _listeners(this,type,!1)},EventEmitter.listenerCount=function(emitter,type){return"function"==typeof emitter.listenerCount?emitter.listenerCount(type):listenerCount.call(emitter,type)},EventEmitter.prototype.listenerCount=listenerCount,EventEmitter.prototype.eventNames=function(){return 0<this._eventsCount?ReflectOwnKeys(this._events):[]}},{}],179:[function(require,module,exports){var Buffer=require("safe-buffer").Buffer,MD5=require("md5.js");module.exports=function(password,salt,keyBits,ivLen){if(Buffer.isBuffer(password)||(password=Buffer.from(password,"binary")),salt&&8!==(salt=Buffer.isBuffer(salt)?salt:Buffer.from(salt,"binary")).length)throw new RangeError("salt should be Buffer with 8 byte length");for(var keyLen=keyBits/8,key=Buffer.alloc(keyLen),iv=Buffer.alloc(ivLen||0),tmp=Buffer.alloc(0);0<keyLen||0<ivLen;){var keyStart,length,hash=new MD5,hash=(hash.update(tmp),hash.update(password),salt&&hash.update(salt),tmp=hash.digest(),0);0<keyLen&&(keyStart=key.length-keyLen,hash=Math.min(keyLen,tmp.length),tmp.copy(key,keyStart,0,hash),keyLen-=hash),hash<tmp.length&&0<ivLen&&(keyStart=iv.length-ivLen,length=Math.min(ivLen,tmp.length-hash),tmp.copy(iv,keyStart,hash,hash+length),ivLen-=length)}return tmp.fill(0),{key:key,iv:iv}}},{"md5.js":262,"safe-buffer":367}],180:[function(require,module,exports){!function(root){var k,exports={},sha256=(!function(exports){"use strict";exports.__esModule=true,exports.digestLength=32,exports.blockSize=64;var K=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]);function hashBlocks(w,v,p,pos,len){var a,b,c,d,e,f,g,h,u,i,j,t1,t2;while(len>=64){a=v[0];b=v[1];c=v[2];d=v[3];e=v[4];f=v[5];g=v[6];h=v[7];for(i=0;i<16;i++){j=pos+i*4;w[i]=(p[j]&255)<<24|(p[j+1]&255)<<16|(p[j+2]&255)<<8|p[j+3]&255}for(i=16;i<64;i++){u=w[i-2];t1=(u>>>17|u<<32-17)^(u>>>19|u<<32-19)^u>>>10;u=w[i-15];t2=(u>>>7|u<<32-7)^(u>>>18|u<<32-18)^u>>>3;w[i]=(t1+w[i-7]|0)+(t2+w[i-16]|0)}for(i=0;i<64;i++){t1=(((e>>>6|e<<32-6)^(e>>>11|e<<32-11)^(e>>>25|e<<32-25))+(e&f^~e&g)|0)+(h+(K[i]+w[i]|0)|0)|0;t2=((a>>>2|a<<32-2)^(a>>>13|a<<32-13)^(a>>>22|a<<32-22))+(a&b^a&c^b&c)|0;h=g;g=f;f=e;e=d+t1|0;d=c;c=b;b=a;a=t1+t2|0}v[0]+=a;v[1]+=b;v[2]+=c;v[3]+=d;v[4]+=e;v[5]+=f;v[6]+=g;v[7]+=h;pos+=64;len-=64}return pos}var Hash=function(){function Hash(){this.digestLength=exports.digestLength;this.blockSize=exports.blockSize;this.state=new Int32Array(8);this.temp=new Int32Array(64);this.buffer=new Uint8Array(128);this.bufferLength=0;this.bytesHashed=0;this.finished=false;this.reset()}Hash.prototype.reset=function(){this.state[0]=1779033703;this.state[1]=3144134277;this.state[2]=1013904242;this.state[3]=2773480762;this.state[4]=1359893119;this.state[5]=2600822924;this.state[6]=528734635;this.state[7]=1541459225;this.bufferLength=0;this.bytesHashed=0;this.finished=false;return this};Hash.prototype.clean=function(){for(var i=0;i<this.buffer.length;i++)this.buffer[i]=0;for(var i=0;i<this.temp.length;i++)this.temp[i]=0;this.reset()};Hash.prototype.update=function(data,dataLength){if(dataLength===void 0)dataLength=data.length;if(this.finished)throw new Error("SHA256: can't update because hash was finished.");var dataPos=0;this.bytesHashed+=dataLength;if(this.bufferLength>0){while(this.bufferLength<64&&dataLength>0){this.buffer[this.bufferLength++]=data[dataPos++];dataLength--}if(this.bufferLength===64){hashBlocks(this.temp,this.state,this.buffer,0,64);this.bufferLength=0}}if(dataLength>=64){dataPos=hashBlocks(this.temp,this.state,data,dataPos,dataLength);dataLength%=64}while(dataLength>0){this.buffer[this.bufferLength++]=data[dataPos++];dataLength--}return this};Hash.prototype.finish=function(out){if(!this.finished){var bytesHashed=this.bytesHashed;var left=this.bufferLength;var bitLenHi=bytesHashed/536870912|0;var bitLenLo=bytesHashed<<3;var padLength=bytesHashed%64<56?64:128;this.buffer[left]=128;for(var i=left+1;i<padLength-8;i++)this.buffer[i]=0;this.buffer[padLength-8]=bitLenHi>>>24&255;this.buffer[padLength-7]=bitLenHi>>>16&255;this.buffer[padLength-6]=bitLenHi>>>8&255;this.buffer[padLength-5]=bitLenHi>>>0&255;this.buffer[padLength-4]=bitLenLo>>>24&255;this.buffer[padLength-3]=bitLenLo>>>16&255;this.buffer[padLength-2]=bitLenLo>>>8&255;this.buffer[padLength-1]=bitLenLo>>>0&255;hashBlocks(this.temp,this.state,this.buffer,0,padLength);this.finished=true}for(var i=0;i<8;i++){out[i*4+0]=this.state[i]>>>24&255;out[i*4+1]=this.state[i]>>>16&255;out[i*4+2]=this.state[i]>>>8&255;out[i*4+3]=this.state[i]>>>0&255}return this};Hash.prototype.digest=function(){var out=new Uint8Array(this.digestLength);this.finish(out);return out};Hash.prototype._saveState=function(out){for(var i=0;i<this.state.length;i++)out[i]=this.state[i]};Hash.prototype._restoreState=function(from,bytesHashed){for(var i=0;i<this.state.length;i++)this.state[i]=from[i];this.bytesHashed=bytesHashed;this.finished=false;this.bufferLength=0};return Hash}(),HMAC=(exports.Hash=Hash,function(){function HMAC(key){this.inner=new Hash;this.outer=new Hash;this.blockSize=this.inner.blockSize;this.digestLength=this.inner.digestLength;var pad=new Uint8Array(this.blockSize);if(key.length>this.blockSize)(new Hash).update(key).finish(pad).clean();else for(var i=0;i<key.length;i++)pad[i]=key[i];for(var i=0;i<pad.length;i++)pad[i]^=54;this.inner.update(pad);for(var i=0;i<pad.length;i++)pad[i]^=54^92;this.outer.update(pad);this.istate=new Uint32Array(8);this.ostate=new Uint32Array(8);this.inner._saveState(this.istate);this.outer._saveState(this.ostate);for(var i=0;i<pad.length;i++)pad[i]=0}HMAC.prototype.reset=function(){this.inner._restoreState(this.istate,this.inner.blockSize);this.outer._restoreState(this.ostate,this.outer.blockSize);return this};HMAC.prototype.clean=function(){for(var i=0;i<this.istate.length;i++)this.ostate[i]=this.istate[i]=0;this.inner.clean();this.outer.clean()};HMAC.prototype.update=function(data){this.inner.update(data);return this};HMAC.prototype.finish=function(out){if(this.outer.finished)this.outer.finish(out);else{this.inner.finish(out);this.outer.update(out,this.digestLength).finish(out)}return this};HMAC.prototype.digest=function(){var out=new Uint8Array(this.digestLength);this.finish(out);return out};return HMAC}());function hash(data){var h=(new Hash).update(data);var digest=h.digest();h.clean();return digest}function hmac(key,data){var h=new HMAC(key).update(data);var digest=h.digest();h.clean();return digest}function fillBuffer(buffer,hmac,info,counter){var num=counter[0];if(num===0)throw new Error("hkdf: cannot expand more");hmac.reset();if(num>1)hmac.update(buffer);if(info)hmac.update(info);hmac.update(counter);hmac.finish(buffer);counter[0]++}exports.HMAC=HMAC,exports.hash=hash,exports["default"]=hash,exports.hmac=hmac;var hkdfSalt=new Uint8Array(exports.digestLength);function hkdf(key,salt,info,length){if(salt===void 0)salt=hkdfSalt;if(length===void 0)length=32;var counter=new Uint8Array([1]);var okm=hmac(salt,key);var hmac_=new HMAC(okm);var buffer=new Uint8Array(hmac_.digestLength);var bufpos=buffer.length;var out=new Uint8Array(length);for(var i=0;i<length;i++){if(bufpos===buffer.length){fillBuffer(buffer,hmac_,info,counter);bufpos=0}out[i]=buffer[bufpos++]}hmac_.clean();buffer.fill(0);counter.fill(0);return out}function pbkdf2(password,salt,iterations,dkLen){var prf=new HMAC(password);var len=prf.digestLength;var ctr=new Uint8Array(4);var t=new Uint8Array(len);var u=new Uint8Array(len);var dk=new Uint8Array(dkLen);for(var i=0;i*len<dkLen;i++){var c=i+1;ctr[0]=c>>>24&255;ctr[1]=c>>>16&255;ctr[2]=c>>>8&255;ctr[3]=c>>>0&255;prf.reset();prf.update(salt);prf.update(ctr);prf.finish(u);for(var j=0;j<len;j++)t[j]=u[j];for(var j=2;j<=iterations;j++){prf.reset();prf.update(u).finish(u);for(var k=0;k<len;k++)t[k]^=u[k]}for(var j=0;j<len&&i*len+j<dkLen;j++)dk[i*len+j]=t[j]}for(var i=0;i<len;i++)t[i]=u[i]=0;for(var i=0;i<4;i++)ctr[i]=0;prf.clean();return dk}exports.hkdf=hkdf,exports.pbkdf2=pbkdf2}(exports),exports.default);for(k in exports)sha256[k]=exports[k];"object"==typeof module&&"object"==typeof module.exports?module.exports=sha256:root.sha256=sha256}(this)},{}],181:[function(require,module,exports){"use strict";var isCallable=require("is-callable"),toStr=Object.prototype.toString,hasOwnProperty=Object.prototype.hasOwnProperty;module.exports=function(list,iterator,thisArg){if(!isCallable(iterator))throw new TypeError("iterator must be a function");var receiver;3<=arguments.length&&(receiver=thisArg),("[object Array]"===toStr.call(list)?function(array,iterator,receiver){for(var i=0,len=array.length;i<len;i++)hasOwnProperty.call(array,i)&&(null==receiver?iterator(array[i],i,array):iterator.call(receiver,array[i],i,array))}:"string"==typeof list?function(string,iterator,receiver){for(var i=0,len=string.length;i<len;i++)null==receiver?iterator(string.charAt(i),i,string):iterator.call(receiver,string.charAt(i),i,string)}:function(object,iterator,receiver){for(var k in object)hasOwnProperty.call(object,k)&&(null==receiver?iterator(object[k],k,object):iterator.call(receiver,object[k],k,object))})(list,iterator,receiver)}},{"is-callable":224}],182:[function(require,module,exports){"use strict";var slice=Array.prototype.slice,toStr=Object.prototype.toString;module.exports=function(that){var target=this;if("function"!=typeof target||"[object Function]"!==toStr.call(target))throw new TypeError("Function.prototype.bind called on incompatible "+target);for(var bound,Empty,args=slice.call(arguments,1),boundLength=Math.max(0,target.length-args.length),boundArgs=[],i=0;i<boundLength;i++)boundArgs.push("$"+i);return bound=Function("binder","return function ("+boundArgs.join(",")+"){ return binder.apply(this,arguments); }")(function(){var result;return this instanceof bound?(result=target.apply(this,args.concat(slice.call(arguments))),Object(result)===result?result:this):target.apply(that,args.concat(slice.call(arguments)))}),target.prototype&&((Empty=function(){}).prototype=target.prototype,bound.prototype=new Empty,Empty.prototype=null),bound}},{}],183:[function(require,module,exports){"use strict";require=require("./implementation");module.exports=Function.prototype.bind||require},{"./implementation":182}],184:[function(require,module,exports){"use strict";var $SyntaxError=SyntaxError,$Function=Function,$TypeError=TypeError,getEvalledConstructor=function(expressionSyntax){try{return $Function('"use strict"; return ('+expressionSyntax+").constructor;")()}catch(e){}},$gOPD=Object.getOwnPropertyDescriptor;if($gOPD)try{$gOPD({},"")}catch(e){$gOPD=null}function throwTypeError(){throw new $TypeError}function doEval(name){var value,fn;return"%AsyncFunction%"===name?value=getEvalledConstructor("async function () {}"):"%GeneratorFunction%"===name?value=getEvalledConstructor("function* () {}"):"%AsyncGeneratorFunction%"===name?value=getEvalledConstructor("async function* () {}"):"%AsyncGenerator%"===name?(fn=doEval("%AsyncGeneratorFunction%"))&&(value=fn.prototype):"%AsyncIteratorPrototype%"===name&&(fn=doEval("%AsyncGenerator%"))&&(value=getProto(fn.prototype)),INTRINSICS[name]=value}var ThrowTypeError=$gOPD?function(){try{return throwTypeError}catch(calleeThrows){try{return $gOPD(arguments,"callee").get}catch(gOPDthrows){return throwTypeError}}}():throwTypeError,hasSymbols=require("has-symbols")(),getProto=Object.getPrototypeOf||function(x){return x.__proto__},needsEval={},TypedArray="undefined"==typeof Uint8Array?void 0:getProto(Uint8Array),INTRINSICS={"%AggregateError%":"undefined"==typeof AggregateError?void 0:AggregateError,"%Array%":Array,"%ArrayBuffer%":"undefined"==typeof ArrayBuffer?void 0:ArrayBuffer,"%ArrayIteratorPrototype%":hasSymbols?getProto([][Symbol.iterator]()):void 0,"%AsyncFromSyncIteratorPrototype%":void 0,"%AsyncFunction%":needsEval,"%AsyncGenerator%":needsEval,"%AsyncGeneratorFunction%":needsEval,"%AsyncIteratorPrototype%":needsEval,"%Atomics%":"undefined"==typeof Atomics?void 0:Atomics,"%BigInt%":"undefined"==typeof BigInt?void 0:BigInt,"%Boolean%":Boolean,"%DataView%":"undefined"==typeof DataView?void 0:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":Error,"%eval%":eval,"%EvalError%":EvalError,"%Float32Array%":"undefined"==typeof Float32Array?void 0:Float32Array,"%Float64Array%":"undefined"==typeof Float64Array?void 0:Float64Array,"%FinalizationRegistry%":"undefined"==typeof FinalizationRegistry?void 0:FinalizationRegistry,"%Function%":$Function,"%GeneratorFunction%":needsEval,"%Int8Array%":"undefined"==typeof Int8Array?void 0:Int8Array,"%Int16Array%":"undefined"==typeof Int16Array?void 0:Int16Array,"%Int32Array%":"undefined"==typeof Int32Array?void 0:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":hasSymbols?getProto(getProto([][Symbol.iterator]())):void 0,"%JSON%":"object"==typeof JSON?JSON:void 0,"%Map%":"undefined"==typeof Map?void 0:Map,"%MapIteratorPrototype%":"undefined"!=typeof Map&&hasSymbols?getProto((new Map)[Symbol.iterator]()):void 0,"%Math%":Math,"%Number%":Number,"%Object%":Object,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":"undefined"==typeof Promise?void 0:Promise,"%Proxy%":"undefined"==typeof Proxy?void 0:Proxy,"%RangeError%":RangeError,"%ReferenceError%":ReferenceError,"%Reflect%":"undefined"==typeof Reflect?void 0:Reflect,"%RegExp%":RegExp,"%Set%":"undefined"==typeof Set?void 0:Set,"%SetIteratorPrototype%":"undefined"!=typeof Set&&hasSymbols?getProto((new Set)[Symbol.iterator]()):void 0,"%SharedArrayBuffer%":"undefined"==typeof SharedArrayBuffer?void 0:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":hasSymbols?getProto(""[Symbol.iterator]()):void 0,"%Symbol%":hasSymbols?Symbol:void 0,"%SyntaxError%":$SyntaxError,"%ThrowTypeError%":ThrowTypeError,"%TypedArray%":TypedArray,"%TypeError%":$TypeError,"%Uint8Array%":"undefined"==typeof Uint8Array?void 0:Uint8Array,"%Uint8ClampedArray%":"undefined"==typeof Uint8ClampedArray?void 0:Uint8ClampedArray,"%Uint16Array%":"undefined"==typeof Uint16Array?void 0:Uint16Array,"%Uint32Array%":"undefined"==typeof Uint32Array?void 0:Uint32Array,"%URIError%":URIError,"%WeakMap%":"undefined"==typeof WeakMap?void 0:WeakMap,"%WeakRef%":"undefined"==typeof WeakRef?void 0:WeakRef,"%WeakSet%":"undefined"==typeof WeakSet?void 0:WeakSet},LEGACY_ALIASES={"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},hasSymbols=require("function-bind"),hasOwn=require("has"),$concat=hasSymbols.call(Function.call,Array.prototype.concat),$spliceApply=hasSymbols.call(Function.apply,Array.prototype.splice),$replace=hasSymbols.call(Function.call,String.prototype.replace),$strSlice=hasSymbols.call(Function.call,String.prototype.slice),rePropName=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,reEscapeChar=/\\(\\)?/g;module.exports=function(name,allowMissing){if("string"!=typeof name||0===name.length)throw new $TypeError("intrinsic name must be a non-empty string");if(1<arguments.length&&"boolean"!=typeof allowMissing)throw new $TypeError('"allowMissing" argument must be a boolean');var parts=function(string){var first=$strSlice(string,0,1),last=$strSlice(string,-1);if("%"===first&&"%"!==last)throw new $SyntaxError("invalid intrinsic syntax, expected closing `%`");if("%"===last&&"%"!==first)throw new $SyntaxError("invalid intrinsic syntax, expected opening `%`");var result=[];return $replace(string,rePropName,function(match,number,quote,subString){result[result.length]=quote?$replace(subString,reEscapeChar,"$1"):number||match}),result}(name),intrinsicBaseName=0<parts.length?parts[0]:"",intrinsic=function(name,allowMissing){var alias,intrinsicName=name;if(hasOwn(LEGACY_ALIASES,intrinsicName)&&(intrinsicName="%"+(alias=LEGACY_ALIASES[intrinsicName])[0]+"%"),hasOwn(INTRINSICS,intrinsicName)){var value=INTRINSICS[intrinsicName];if(void 0!==(value=value===needsEval?doEval(intrinsicName):value)||allowMissing)return{alias:alias,name:intrinsicName,value:value};throw new $TypeError("intrinsic "+name+" exists, but is not available. Please file an issue!")}throw new $SyntaxError("intrinsic "+name+" does not exist!")}("%"+intrinsicBaseName+"%",allowMissing),value=(intrinsic.name,intrinsic.value),skipFurtherCaching=!1,intrinsic=intrinsic.alias;intrinsic&&(intrinsicBaseName=intrinsic[0],$spliceApply(parts,$concat([0,1],intrinsic)));for(var i=1,isOwn=!0;i<parts.length;i+=1){var part=parts[i],first=$strSlice(part,0,1),last=$strSlice(part,-1);if(('"'===first||"'"===first||"`"===first||'"'===last||"'"===last||"`"===last)&&first!==last)throw new $SyntaxError("property names with quotes must have matching quotes");if("constructor"!==part&&isOwn||(skipFurtherCaching=!0),hasOwn(INTRINSICS,first="%"+(intrinsicBaseName+="."+part)+"%"))value=INTRINSICS[first];else if(null!=value){if(!(part in value)){if(allowMissing)return;throw new $TypeError("base intrinsic for "+name+" exists, but the property is not available.")}value=$gOPD&&i+1>=parts.length?(isOwn=!!(last=$gOPD(value,part)))&&"get"in last&&!("originalValue"in last.get)?last.get:value[part]:(isOwn=hasOwn(value,part),value[part]),isOwn&&!skipFurtherCaching&&(INTRINSICS[first]=value)}}return value}},{"function-bind":183,has:188,"has-symbols":185}],185:[function(require,module,exports){"use strict";var origSymbol="undefined"!=typeof Symbol&&Symbol,hasSymbolSham=require("./shams");module.exports=function(){return"function"==typeof origSymbol&&("function"==typeof Symbol&&("symbol"==typeof origSymbol("foo")&&("symbol"==typeof Symbol("bar")&&hasSymbolSham())))}},{"./shams":186}],186:[function(require,module,exports){"use strict";module.exports=function(){if("function"!=typeof Symbol||"function"!=typeof Object.getOwnPropertySymbols)return!1;if("symbol"==typeof Symbol.iterator)return!0;var obj={},sym=Symbol("test"),symObj=Object(sym);if("string"==typeof sym)return!1;if("[object Symbol]"!==Object.prototype.toString.call(sym))return!1;if("[object Symbol]"!==Object.prototype.toString.call(symObj))return!1;for(sym in obj[sym]=42,obj)return!1;if("function"==typeof Object.keys&&0!==Object.keys(obj).length)return!1;if("function"==typeof Object.getOwnPropertyNames&&0!==Object.getOwnPropertyNames(obj).length)return!1;symObj=Object.getOwnPropertySymbols(obj);if(1!==symObj.length||symObj[0]!==sym)return!1;if(!Object.prototype.propertyIsEnumerable.call(obj,sym))return!1;if("function"==typeof Object.getOwnPropertyDescriptor){symObj=Object.getOwnPropertyDescriptor(obj,sym);if(42!==symObj.value||!0!==symObj.enumerable)return!1}return!0}},{}],187:[function(require,module,exports){"use strict";var hasSymbols=require("has-symbols/shams");module.exports=function(){return hasSymbols()&&!!Symbol.toStringTag}},{"has-symbols/shams":186}],188:[function(require,module,exports){"use strict";require=require("function-bind");module.exports=require.call(Function.call,Object.prototype.hasOwnProperty)},{"function-bind":183}],189:[function(require,module,exports){"use strict";var Buffer=require("safe-buffer").Buffer,Transform=require("readable-stream").Transform;function HashBase(blockSize){Transform.call(this),this._block=Buffer.allocUnsafe(blockSize),this._blockSize=blockSize,this._blockOffset=0,this._length=[0,0,0,0],this._finalized=!1}require("inherits")(HashBase,Transform),HashBase.prototype._transform=function(chunk,encoding,callback){var error=null;try{this.update(chunk,encoding)}catch(err){error=err}callback(error)},HashBase.prototype._flush=function(callback){var error=null;try{this.push(this.digest())}catch(err){error=err}callback(error)},HashBase.prototype.update=function(data,encoding){var val=data,prefix="Data";if(!Buffer.isBuffer(val)&&"string"!=typeof val)throw new TypeError(prefix+" must be a string or a buffer");if(this._finalized)throw new Error("Digest already called");Buffer.isBuffer(data)||(data=Buffer.from(data,encoding));for(var block=this._block,offset=0;this._blockOffset+data.length-offset>=this._blockSize;){for(var i=this._blockOffset;i<this._blockSize;)block[i++]=data[offset++];this._update(),this._blockOffset=0}for(;offset<data.length;)block[this._blockOffset++]=data[offset++];for(var j=0,carry=8*data.length;0<carry;++j)this._length[j]+=carry,0<(carry=this._length[j]/4294967296|0)&&(this._length[j]-=4294967296*carry);return this},HashBase.prototype._update=function(){throw new Error("_update is not implemented")},HashBase.prototype.digest=function(encoding){if(this._finalized)throw new Error("Digest already called");this._finalized=!0;var digest=this._digest();void 0!==encoding&&(digest=digest.toString(encoding)),this._block.fill(0);for(var i=this._blockOffset=0;i<4;++i)this._length[i]=0;return digest},HashBase.prototype._digest=function(){throw new Error("_digest is not implemented")},module.exports=HashBase},{inherits:220,"readable-stream":204,"safe-buffer":205}],190:[function(require,module,exports){arguments[4][96][0].apply(exports,arguments)},{dup:96}],191:[function(require,module,exports){arguments[4][97][0].apply(exports,arguments)},{"./_stream_readable":193,"./_stream_writable":195,_process:354,dup:97,inherits:220}],192:[function(require,module,exports){arguments[4][98][0].apply(exports,arguments)},{"./_stream_transform":194,dup:98,inherits:220}],193:[function(require,module,exports){arguments[4][99][0].apply(exports,arguments)},{"../errors":190,"./_stream_duplex":191,"./internal/streams/async_iterator":196,"./internal/streams/buffer_list":197,"./internal/streams/destroy":198,"./internal/streams/from":200,"./internal/streams/state":202,"./internal/streams/stream":203,_process:354,buffer:112,dup:99,events:178,inherits:220,"string_decoder/":377,util:68}],194:[function(require,module,exports){arguments[4][100][0].apply(exports,arguments)},{"../errors":190,"./_stream_duplex":191,dup:100,inherits:220}],195:[function(require,module,exports){arguments[4][101][0].apply(exports,arguments)},{"../errors":190,"./_stream_duplex":191,"./internal/streams/destroy":198,"./internal/streams/state":202,"./internal/streams/stream":203,_process:354,buffer:112,dup:101,inherits:220,"util-deprecate":378}],196:[function(require,module,exports){arguments[4][102][0].apply(exports,arguments)},{"./end-of-stream":199,_process:354,dup:102}],197:[function(require,module,exports){arguments[4][103][0].apply(exports,arguments)},{buffer:112,dup:103,util:68}],198:[function(require,module,exports){arguments[4][104][0].apply(exports,arguments)},{_process:354,dup:104}],199:[function(require,module,exports){arguments[4][105][0].apply(exports,arguments)},{"../../../errors":190,dup:105}],200:[function(require,module,exports){arguments[4][106][0].apply(exports,arguments)},{dup:106}],201:[function(require,module,exports){arguments[4][107][0].apply(exports,arguments)},{"../../../errors":190,"./end-of-stream":199,dup:107}],202:[function(require,module,exports){arguments[4][108][0].apply(exports,arguments)},{"../../../errors":190,dup:108}],203:[function(require,module,exports){arguments[4][109][0].apply(exports,arguments)},{dup:109,events:178}],204:[function(require,module,exports){arguments[4][110][0].apply(exports,arguments)},{"./lib/_stream_duplex.js":191,"./lib/_stream_passthrough.js":192,"./lib/_stream_readable.js":193,"./lib/_stream_transform.js":194,"./lib/_stream_writable.js":195,"./lib/internal/streams/end-of-stream.js":199,"./lib/internal/streams/pipeline.js":201,dup:110}],205:[function(require,module,exports){arguments[4][111][0].apply(exports,arguments)},{buffer:112,dup:111}],206:[function(require,module,exports){exports.utils=require("./hash/utils"),exports.common=require("./hash/common"),exports.sha=require("./hash/sha"),exports.ripemd=require("./hash/ripemd"),exports.hmac=require("./hash/hmac"),exports.sha1=exports.sha.sha1,exports.sha256=exports.sha.sha256,exports.sha224=exports.sha.sha224,exports.sha384=exports.sha.sha384,exports.sha512=exports.sha.sha512,exports.ripemd160=exports.ripemd.ripemd160},{"./hash/common":207,"./hash/hmac":208,"./hash/ripemd":209,"./hash/sha":210,"./hash/utils":217}],207:[function(require,module,exports){"use strict";var utils=require("./utils"),assert=require("minimalistic-assert");function BlockHash(){this.pending=null,this.pendingTotal=0,this.blockSize=this.constructor.blockSize,this.outSize=this.constructor.outSize,this.hmacStrength=this.constructor.hmacStrength,this.padLength=this.constructor.padLength/8,this.endian="big",this._delta8=this.blockSize/8,this._delta32=this.blockSize/32}(exports.BlockHash=BlockHash).prototype.update=function(msg,enc){if(msg=utils.toArray(msg,enc),this.pending?this.pending=this.pending.concat(msg):this.pending=msg,this.pendingTotal+=msg.length,this.pending.length>=this._delta8){enc=(msg=this.pending).length%this._delta8;this.pending=msg.slice(msg.length-enc,msg.length),0===this.pending.length&&(this.pending=null),msg=utils.join32(msg,0,msg.length-enc,this.endian);for(var i=0;i<msg.length;i+=this._delta32)this._update(msg,i,i+this._delta32)}return this},BlockHash.prototype.digest=function(enc){return this.update(this._pad()),assert(null===this.pending),this._digest(enc)},BlockHash.prototype._pad=function(){var len=this.pendingTotal,bytes=this._delta8,k=bytes-(len+this.padLength)%bytes,res=new Array(k+this.padLength);res[0]=128;for(var i=1;i<k;i++)res[i]=0;if(len<<=3,"big"===this.endian){for(var t=8;t<this.padLength;t++)res[i++]=0;res[i++]=0,res[i++]=0,res[i++]=0,res[i++]=0,res[i++]=len>>>24&255,res[i++]=len>>>16&255,res[i++]=len>>>8&255,res[i++]=255&len}else for(res[i++]=255&len,res[i++]=len>>>8&255,res[i++]=len>>>16&255,res[i++]=len>>>24&255,res[i++]=0,res[i++]=0,res[i++]=0,res[i++]=0,t=8;t<this.padLength;t++)res[i++]=0;return res}},{"./utils":217,"minimalistic-assert":265}],208:[function(require,module,exports){"use strict";var utils=require("./utils"),assert=require("minimalistic-assert");function Hmac(hash,key,enc){if(!(this instanceof Hmac))return new Hmac(hash,key,enc);this.Hash=hash,this.blockSize=hash.blockSize/8,this.outSize=hash.outSize/8,this.inner=null,this.outer=null,this._init(utils.toArray(key,enc))}(module.exports=Hmac).prototype._init=function(key){key.length>this.blockSize&&(key=(new this.Hash).update(key).digest()),assert(key.length<=this.blockSize);for(var i=key.length;i<this.blockSize;i++)key.push(0);for(i=0;i<key.length;i++)key[i]^=54;for(this.inner=(new this.Hash).update(key),i=0;i<key.length;i++)key[i]^=106;this.outer=(new this.Hash).update(key)},Hmac.prototype.update=function(msg,enc){return this.inner.update(msg,enc),this},Hmac.prototype.digest=function(enc){return this.outer.update(this.inner.digest()),this.outer.digest(enc)}},{"./utils":217,"minimalistic-assert":265}],209:[function(require,module,exports){"use strict";var utils=require("./utils"),require=require("./common"),rotl32=utils.rotl32,sum32=utils.sum32,sum32_3=utils.sum32_3,sum32_4=utils.sum32_4,BlockHash=require.BlockHash;function RIPEMD160(){if(!(this instanceof RIPEMD160))return new RIPEMD160;BlockHash.call(this),this.h=[1732584193,4023233417,2562383102,271733878,3285377520],this.endian="little"}function f(j,x,y,z){return j<=15?x^y^z:j<=31?x&y|~x&z:j<=47?(x|~y)^z:j<=63?x&z|y&~z:x^(y|~z)}utils.inherits(RIPEMD160,BlockHash),(exports.ripemd160=RIPEMD160).blockSize=512,RIPEMD160.outSize=160,RIPEMD160.hmacStrength=192,RIPEMD160.padLength=64,RIPEMD160.prototype._update=function(msg,start){for(var Ah=A=this.h[0],Bh=B=this.h[1],Ch=C=this.h[2],Dh=D=this.h[3],Eh=E=this.h[4],j=0;j<80;j++)var T=sum32(rotl32(sum32_4(A,f(j,B,C,D),msg[r[j]+start],function(j){return j<=15?0:j<=31?1518500249:j<=47?1859775393:j<=63?2400959708:2840853838}(j)),s[j]),E),A=E,E=D,D=rotl32(C,10),C=B,B=T,T=sum32(rotl32(sum32_4(Ah,f(79-j,Bh,Ch,Dh),msg[rh[j]+start],function(j){return j<=15?1352829926:j<=31?1548603684:j<=47?1836072691:j<=63?2053994217:0}(j)),sh[j]),Eh),Ah=Eh,Eh=Dh,Dh=rotl32(Ch,10),Ch=Bh,Bh=T;T=sum32_3(this.h[1],C,Dh),this.h[1]=sum32_3(this.h[2],D,Eh),this.h[2]=sum32_3(this.h[3],E,Ah),this.h[3]=sum32_3(this.h[4],A,Bh),this.h[4]=sum32_3(this.h[0],B,Ch),this.h[0]=T},RIPEMD160.prototype._digest=function(enc){return"hex"===enc?utils.toHex32(this.h,"little"):utils.split32(this.h,"little")};var r=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13],rh=[5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11],s=[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6],sh=[8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11]},{"./common":207,"./utils":217}],210:[function(require,module,exports){"use strict";exports.sha1=require("./sha/1"),exports.sha224=require("./sha/224"),exports.sha256=require("./sha/256"),exports.sha384=require("./sha/384"),exports.sha512=require("./sha/512")},{"./sha/1":211,"./sha/224":212,"./sha/256":213,"./sha/384":214,"./sha/512":215}],211:[function(require,module,exports){"use strict";var utils=require("../utils"),common=require("../common"),require=require("./common"),rotl32=utils.rotl32,sum32=utils.sum32,sum32_5=utils.sum32_5,ft_1=require.ft_1,BlockHash=common.BlockHash,sha1_K=[1518500249,1859775393,2400959708,3395469782];function SHA1(){if(!(this instanceof SHA1))return new SHA1;BlockHash.call(this),this.h=[1732584193,4023233417,2562383102,271733878,3285377520],this.W=new Array(80)}utils.inherits(SHA1,BlockHash),(module.exports=SHA1).blockSize=512,SHA1.outSize=160,SHA1.hmacStrength=80,SHA1.padLength=64,SHA1.prototype._update=function(msg,start){for(var W=this.W,i=0;i<16;i++)W[i]=msg[start+i];for(;i<W.length;i++)W[i]=rotl32(W[i-3]^W[i-8]^W[i-14]^W[i-16],1);for(var a=this.h[0],b=this.h[1],c=this.h[2],d=this.h[3],e=this.h[4],i=0;i<W.length;i++)var s=~~(i/20),s=sum32_5(rotl32(a,5),ft_1(s,b,c,d),e,W[i],sha1_K[s]),e=d,d=c,c=rotl32(b,30),b=a,a=s;this.h[0]=sum32(this.h[0],a),this.h[1]=sum32(this.h[1],b),this.h[2]=sum32(this.h[2],c),this.h[3]=sum32(this.h[3],d),this.h[4]=sum32(this.h[4],e)},SHA1.prototype._digest=function(enc){return"hex"===enc?utils.toHex32(this.h,"big"):utils.split32(this.h,"big")}},{"../common":207,"../utils":217,"./common":216}],212:[function(require,module,exports){"use strict";var utils=require("../utils"),SHA256=require("./256");function SHA224(){if(!(this instanceof SHA224))return new SHA224;SHA256.call(this),this.h=[3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428]}utils.inherits(SHA224,SHA256),(module.exports=SHA224).blockSize=512,SHA224.outSize=224,SHA224.hmacStrength=192,SHA224.padLength=64,SHA224.prototype._digest=function(enc){return"hex"===enc?utils.toHex32(this.h.slice(0,7),"big"):utils.split32(this.h.slice(0,7),"big")}},{"../utils":217,"./256":213}],213:[function(require,module,exports){"use strict";var utils=require("../utils"),common=require("../common"),shaCommon=require("./common"),assert=require("minimalistic-assert"),sum32=utils.sum32,sum32_4=utils.sum32_4,sum32_5=utils.sum32_5,ch32=shaCommon.ch32,maj32=shaCommon.maj32,s0_256=shaCommon.s0_256,s1_256=shaCommon.s1_256,g0_256=shaCommon.g0_256,g1_256=shaCommon.g1_256,BlockHash=common.BlockHash,sha256_K=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298];function SHA256(){if(!(this instanceof SHA256))return new SHA256;BlockHash.call(this),this.h=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],this.k=sha256_K,this.W=new Array(64)}utils.inherits(SHA256,BlockHash),(module.exports=SHA256).blockSize=512,SHA256.outSize=256,SHA256.hmacStrength=192,SHA256.padLength=64,SHA256.prototype._update=function(msg,start){for(var W=this.W,i=0;i<16;i++)W[i]=msg[start+i];for(;i<W.length;i++)W[i]=sum32_4(g1_256(W[i-2]),W[i-7],g0_256(W[i-15]),W[i-16]);var a=this.h[0],b=this.h[1],c=this.h[2],d=this.h[3],e=this.h[4],f=this.h[5],g=this.h[6],h=this.h[7];for(assert(this.k.length===W.length),i=0;i<W.length;i++)var T1=sum32_5(h,s1_256(e),ch32(e,f,g),this.k[i],W[i]),T2=sum32(s0_256(a),maj32(a,b,c)),h=g,g=f,f=e,e=sum32(d,T1),d=c,c=b,b=a,a=sum32(T1,T2);this.h[0]=sum32(this.h[0],a),this.h[1]=sum32(this.h[1],b),this.h[2]=sum32(this.h[2],c),this.h[3]=sum32(this.h[3],d),this.h[4]=sum32(this.h[4],e),this.h[5]=sum32(this.h[5],f),this.h[6]=sum32(this.h[6],g),this.h[7]=sum32(this.h[7],h)},SHA256.prototype._digest=function(enc){return"hex"===enc?utils.toHex32(this.h,"big"):utils.split32(this.h,"big")}},{"../common":207,"../utils":217,"./common":216,"minimalistic-assert":265}],214:[function(require,module,exports){"use strict";var utils=require("../utils"),SHA512=require("./512");function SHA384(){if(!(this instanceof SHA384))return new SHA384;SHA512.call(this),this.h=[3418070365,3238371032,1654270250,914150663,2438529370,812702999,355462360,4144912697,1731405415,4290775857,2394180231,1750603025,3675008525,1694076839,1203062813,3204075428]}utils.inherits(SHA384,SHA512),(module.exports=SHA384).blockSize=1024,SHA384.outSize=384,SHA384.hmacStrength=192,SHA384.padLength=128,SHA384.prototype._digest=function(enc){return"hex"===enc?utils.toHex32(this.h.slice(0,12),"big"):utils.split32(this.h.slice(0,12),"big")}},{"../utils":217,"./512":215}],215:[function(require,module,exports){"use strict";var utils=require("../utils"),common=require("../common"),assert=require("minimalistic-assert"),rotr64_hi=utils.rotr64_hi,rotr64_lo=utils.rotr64_lo,shr64_hi=utils.shr64_hi,shr64_lo=utils.shr64_lo,sum64=utils.sum64,sum64_hi=utils.sum64_hi,sum64_lo=utils.sum64_lo,sum64_4_hi=utils.sum64_4_hi,sum64_4_lo=utils.sum64_4_lo,sum64_5_hi=utils.sum64_5_hi,sum64_5_lo=utils.sum64_5_lo,BlockHash=common.BlockHash,sha512_K=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591];function SHA512(){if(!(this instanceof SHA512))return new SHA512;BlockHash.call(this),this.h=[1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209],this.k=sha512_K,this.W=new Array(160)}utils.inherits(SHA512,BlockHash),(module.exports=SHA512).blockSize=1024,SHA512.outSize=512,SHA512.hmacStrength=192,SHA512.padLength=128,SHA512.prototype._prepareBlock=function(msg,start){for(var W=this.W,i=0;i<32;i++)W[i]=msg[start+i];for(;i<W.length;i+=2){var c0_hi=function(xh,xl){var c0_hi=rotr64_hi(xh,xl,19),c1_hi=rotr64_hi(xl,xh,29),xh=shr64_hi(xh,xl,6),xl=c0_hi^c1_hi^xh;xl<0&&(xl+=4294967296);return xl}(W[i-4],W[i-3]),c0_lo=function(xh,xl){var c0_lo=rotr64_lo(xh,xl,19),c1_lo=rotr64_lo(xl,xh,29),xh=shr64_lo(xh,xl,6),xl=c0_lo^c1_lo^xh;xl<0&&(xl+=4294967296);return xl}(W[i-4],W[i-3]),c1_hi=W[i-14],c1_lo=W[i-13],c2_hi=function(xh,xl){var c0_hi=rotr64_hi(xh,xl,1),c1_hi=rotr64_hi(xh,xl,8),xh=shr64_hi(xh,xl,7),xl=c0_hi^c1_hi^xh;xl<0&&(xl+=4294967296);return xl}(W[i-30],W[i-29]),c2_lo=function(xh,xl){var c0_lo=rotr64_lo(xh,xl,1),c1_lo=rotr64_lo(xh,xl,8),xh=shr64_lo(xh,xl,7),xl=c0_lo^c1_lo^xh;xl<0&&(xl+=4294967296);return xl}(W[i-30],W[i-29]),c3_hi=W[i-32],c3_lo=W[i-31];W[i]=sum64_4_hi(c0_hi,c0_lo,c1_hi,c1_lo,c2_hi,c2_lo,c3_hi,c3_lo),W[i+1]=sum64_4_lo(c0_hi,c0_lo,c1_hi,c1_lo,c2_hi,c2_lo,c3_hi,c3_lo)}},SHA512.prototype._update=function(msg,start){this._prepareBlock(msg,start);var W=this.W,ah=this.h[0],al=this.h[1],bh=this.h[2],bl=this.h[3],ch=this.h[4],cl=this.h[5],dh=this.h[6],dl=this.h[7],eh=this.h[8],el=this.h[9],fh=this.h[10],fl=this.h[11],gh=this.h[12],gl=this.h[13],hh=this.h[14],hl=this.h[15];assert(this.k.length===W.length);for(var i=0;i<W.length;i+=2)var c0_hi=hh,c0_lo=hl,c1_hi=function(xh,xl){var c0_hi=rotr64_hi(xh,xl,14),c1_hi=rotr64_hi(xh,xl,18),xl=rotr64_hi(xl,xh,9),xh=c0_hi^c1_hi^xl;xh<0&&(xh+=4294967296);return xh}(eh,el),c1_lo=function(xh,xl){var c0_lo=rotr64_lo(xh,xl,14),c1_lo=rotr64_lo(xh,xl,18),xl=rotr64_lo(xl,xh,9),xh=c0_lo^c1_lo^xl;xh<0&&(xh+=4294967296);return xh}(eh,el),c2_hi=function(xh,yh,zh){yh=xh&yh^~xh&zh;yh<0&&(yh+=4294967296);return yh}(eh,fh,gh),c2_lo=function(xl,yl,zl){yl=xl&yl^~xl&zl;yl<0&&(yl+=4294967296);return yl}(el,fl,gl),c3_hi=this.k[i],c3_lo=this.k[i+1],c4_hi=W[i],c4_lo=W[i+1],T1_hi=sum64_5_hi(c0_hi,c0_lo,c1_hi,c1_lo,c2_hi,c2_lo,c3_hi,c3_lo,c4_hi,c4_lo),c2_hi=sum64_5_lo(c0_hi,c0_lo,c1_hi,c1_lo,c2_hi,c2_lo,c3_hi,c3_lo,c4_hi,c4_lo),c0_hi=function(xh,xl){var c0_hi=rotr64_hi(xh,xl,28),c1_hi=rotr64_hi(xl,xh,2),xl=rotr64_hi(xl,xh,7),xh=c0_hi^c1_hi^xl;xh<0&&(xh+=4294967296);return xh}(ah,al),c0_lo=function(xh,xl){var c0_lo=rotr64_lo(xh,xl,28),c1_lo=rotr64_lo(xl,xh,2),xl=rotr64_lo(xl,xh,7),xh=c0_lo^c1_lo^xl;xh<0&&(xh+=4294967296);return xh}(ah,al),c1_hi=function(xh,yh,zh){xh=xh&yh^xh&zh^yh&zh;xh<0&&(xh+=4294967296);return xh}(ah,bh,ch),c1_lo=function(xl,yl,zl){xl=xl&yl^xl&zl^yl&zl;xl<0&&(xl+=4294967296);return xl}(al,bl,cl),c2_lo=sum64_hi(c0_hi,c0_lo,c1_hi,c1_lo),c3_hi=sum64_lo(c0_hi,c0_lo,c1_hi,c1_lo),hh=gh,hl=gl,gh=fh,gl=fl,fh=eh,fl=el,eh=sum64_hi(dh,dl,T1_hi,c2_hi),el=sum64_lo(dl,dl,T1_hi,c2_hi),dh=ch,dl=cl,ch=bh,cl=bl,bh=ah,bl=al,ah=sum64_hi(T1_hi,c2_hi,c2_lo,c3_hi),al=sum64_lo(T1_hi,c2_hi,c2_lo,c3_hi);sum64(this.h,0,ah,al),sum64(this.h,2,bh,bl),sum64(this.h,4,ch,cl),sum64(this.h,6,dh,dl),sum64(this.h,8,eh,el),sum64(this.h,10,fh,fl),sum64(this.h,12,gh,gl),sum64(this.h,14,hh,hl)},SHA512.prototype._digest=function(enc){return"hex"===enc?utils.toHex32(this.h,"big"):utils.split32(this.h,"big")}},{"../common":207,"../utils":217,"minimalistic-assert":265}],216:[function(require,module,exports){"use strict";var rotr32=require("../utils").rotr32;function ch32(x,y,z){return x&y^~x&z}function maj32(x,y,z){return x&y^x&z^y&z}function p32(x,y,z){return x^y^z}exports.ft_1=function(s,x,y,z){return 0===s?ch32(x,y,z):1===s||3===s?x^y^z:2===s?maj32(x,y,z):void 0},exports.ch32=ch32,exports.maj32=maj32,exports.p32=p32,exports.s0_256=function(x){return rotr32(x,2)^rotr32(x,13)^rotr32(x,22)},exports.s1_256=function(x){return rotr32(x,6)^rotr32(x,11)^rotr32(x,25)},exports.g0_256=function(x){return rotr32(x,7)^rotr32(x,18)^x>>>3},exports.g1_256=function(x){return rotr32(x,17)^rotr32(x,19)^x>>>10}},{"../utils":217}],217:[function(require,module,exports){"use strict";var assert=require("minimalistic-assert"),require=require("inherits");function htonl(w){return(w>>>24|w>>>8&65280|w<<8&16711680|(255&w)<<24)>>>0}function zero2(word){return 1===word.length?"0"+word:word}function zero8(word){return 7===word.length?"0"+word:6===word.length?"00"+word:5===word.length?"000"+word:4===word.length?"0000"+word:3===word.length?"00000"+word:2===word.length?"000000"+word:1===word.length?"0000000"+word:word}exports.inherits=require,exports.toArray=function(msg,enc){if(Array.isArray(msg))return msg.slice();if(!msg)return[];var res=[];if("string"==typeof msg)if(enc){if("hex"===enc)for((msg=msg.replace(/[^a-z0-9]+/gi,"")).length%2!=0&&(msg="0"+msg),i=0;i<msg.length;i+=2)res.push(parseInt(msg[i]+msg[i+1],16))}else for(var p=0,i=0;i<msg.length;i++){var c=msg.charCodeAt(i);c<128?res[p++]=c:(c<2048?res[p++]=c>>6|192:(!function(msg,i){return 55296==(64512&msg.charCodeAt(i))&&(!(i<0||i+1>=msg.length)&&56320==(64512&msg.charCodeAt(i+1)))}(msg,i)?res[p++]=c>>12|224:(c=65536+((1023&c)<<10)+(1023&msg.charCodeAt(++i)),res[p++]=c>>18|240,res[p++]=c>>12&63|128),res[p++]=c>>6&63|128),res[p++]=63&c|128)}else for(i=0;i<msg.length;i++)res[i]=0|msg[i];return res},exports.toHex=function(msg){for(var res="",i=0;i<msg.length;i++)res+=zero2(msg[i].toString(16));return res},exports.htonl=htonl,exports.toHex32=function(msg,endian){for(var res="",i=0;i<msg.length;i++){var w=msg[i];res+=zero8((w="little"===endian?htonl(w):w).toString(16))}return res},exports.zero2=zero2,exports.zero8=zero8,exports.join32=function(msg,start,end,endian){assert((end=end-start)%4==0);for(var res=new Array(end/4),i=0,k=start;i<res.length;i++,k+=4){var w="big"===endian?msg[k]<<24|msg[k+1]<<16|msg[k+2]<<8|msg[k+3]:msg[k+3]<<24|msg[k+2]<<16|msg[k+1]<<8|msg[k];res[i]=w>>>0}return res},exports.split32=function(msg,endian){for(var res=new Array(4*msg.length),i=0,k=0;i<msg.length;i++,k+=4){var m=msg[i];"big"===endian?(res[k]=m>>>24,res[k+1]=m>>>16&255,res[k+2]=m>>>8&255,res[k+3]=255&m):(res[k+3]=m>>>24,res[k+2]=m>>>16&255,res[k+1]=m>>>8&255,res[k]=255&m)}return res},exports.rotr32=function(w,b){return w>>>b|w<<32-b},exports.rotl32=function(w,b){return w<<b|w>>>32-b},exports.sum32=function(a,b){return a+b>>>0},exports.sum32_3=function(a,b,c){return a+b+c>>>0},exports.sum32_4=function(a,b,c,d){return a+b+c+d>>>0},exports.sum32_5=function(a,b,c,d,e){return a+b+c+d+e>>>0},exports.sum64=function(buf,pos,ah,al){var bh=buf[pos],lo=al+buf[pos+1]>>>0;buf[pos]=(lo<al?1:0)+ah+bh>>>0,buf[pos+1]=lo},exports.sum64_hi=function(ah,al,bh,bl){return(al+bl>>>0<al?1:0)+ah+bh>>>0},exports.sum64_lo=function(ah,al,bh,bl){return al+bl>>>0},exports.sum64_4_hi=function(ah,al,bh,bl,ch,cl,dh,dl){var carry=0;return ah+bh+ch+dh+((carry+=(ah=al+bl>>>0)<al?1:0)+((ah=ah+cl>>>0)<cl?1:0)+(ah+dl>>>0<dl?1:0))>>>0},exports.sum64_4_lo=function(ah,al,bh,bl,ch,cl,dh,dl){return al+bl+cl+dl>>>0},exports.sum64_5_hi=function(ah,al,bh,bl,ch,cl,dh,dl,eh,el){var carry=0;return ah+bh+ch+dh+eh+(carry+((ah=al+bl>>>0)<al?1:0)+((ah=ah+cl>>>0)<cl?1:0)+((ah=ah+dl>>>0)<dl?1:0)+(ah+el>>>0<el?1:0))>>>0},exports.sum64_5_lo=function(ah,al,bh,bl,ch,cl,dh,dl,eh,el){return al+bl+cl+dl+el>>>0},exports.rotr64_hi=function(ah,al,num){return(al<<32-num|ah>>>num)>>>0},exports.rotr64_lo=function(ah,al,num){return(ah<<32-num|al>>>num)>>>0},exports.shr64_hi=function(ah,al,num){return ah>>>num},exports.shr64_lo=function(ah,al,num){return(ah<<32-num|al>>>num)>>>0}},{inherits:220,"minimalistic-assert":265}],218:[function(require,module,exports){"use strict";var hash=require("hash.js"),utils=require("minimalistic-crypto-utils"),assert=require("minimalistic-assert");function HmacDRBG(options){if(!(this instanceof HmacDRBG))return new HmacDRBG(options);this.hash=options.hash,this.predResist=!!options.predResist,this.outLen=this.hash.outSize,this.minEntropy=options.minEntropy||this.hash.hmacStrength,this._reseed=null,this.reseedInterval=null,this.K=null,this.V=null;var entropy=utils.toArray(options.entropy,options.entropyEnc||"hex"),nonce=utils.toArray(options.nonce,options.nonceEnc||"hex"),options=utils.toArray(options.pers,options.persEnc||"hex");assert(entropy.length>=this.minEntropy/8,"Not enough entropy. Minimum is: "+this.minEntropy+" bits"),this._init(entropy,nonce,options)}(module.exports=HmacDRBG).prototype._init=function(entropy,nonce,pers){entropy=entropy.concat(nonce).concat(pers);this.K=new Array(this.outLen/8),this.V=new Array(this.outLen/8);for(var i=0;i<this.V.length;i++)this.K[i]=0,this.V[i]=1;this._update(entropy),this._reseed=1,this.reseedInterval=281474976710656},HmacDRBG.prototype._hmac=function(){return new hash.hmac(this.hash,this.K)},HmacDRBG.prototype._update=function(seed){var kmac=this._hmac().update(this.V).update([0]);seed&&(kmac=kmac.update(seed)),this.K=kmac.digest(),this.V=this._hmac().update(this.V).digest(),seed&&(this.K=this._hmac().update(this.V).update([1]).update(seed).digest(),this.V=this._hmac().update(this.V).digest())},HmacDRBG.prototype.reseed=function(entropy,entropyEnc,add,addEnc){"string"!=typeof entropyEnc&&(addEnc=add,add=entropyEnc,entropyEnc=null),entropy=utils.toArray(entropy,entropyEnc),add=utils.toArray(add,addEnc),assert(entropy.length>=this.minEntropy/8,"Not enough entropy. Minimum is: "+this.minEntropy+" bits"),this._update(entropy.concat(add||[])),this._reseed=1},HmacDRBG.prototype.generate=function(len,enc,add,addEnc){if(this._reseed>this.reseedInterval)throw new Error("Reseed is required");"string"!=typeof enc&&(addEnc=add,add=enc,enc=null),add&&(add=utils.toArray(add,addEnc||"hex"),this._update(add));for(var temp=[];temp.length<len;)this.V=this._hmac().update(this.V).digest(),temp=temp.concat(this.V);addEnc=temp.slice(0,len);return this._update(add),this._reseed++,utils.encode(addEnc,enc)}},{"hash.js":206,"minimalistic-assert":265,"minimalistic-crypto-utils":266}],219:[function(require,module,exports){exports.read=function(buffer,offset,isLE,mLen,nBytes){var e,m,eLen=8*nBytes-mLen-1,eMax=(1<<eLen)-1,eBias=eMax>>1,nBits=-7,i=isLE?nBytes-1:0,d=isLE?-1:1,nBytes=buffer[offset+i];for(i+=d,e=nBytes&(1<<-nBits)-1,nBytes>>=-nBits,nBits+=eLen;0<nBits;e=256*e+buffer[offset+i],i+=d,nBits-=8);for(m=e&(1<<-nBits)-1,e>>=-nBits,nBits+=mLen;0<nBits;m=256*m+buffer[offset+i],i+=d,nBits-=8);if(0===e)e=1-eBias;else{if(e===eMax)return m?NaN:1/0*(nBytes?-1:1);m+=Math.pow(2,mLen),e-=eBias}return(nBytes?-1:1)*m*Math.pow(2,e-mLen)},exports.write=function(buffer,value,offset,isLE,mLen,nBytes){var e,m,eLen=8*nBytes-mLen-1,eMax=(1<<eLen)-1,eBias=eMax>>1,rt=23===mLen?Math.pow(2,-24)-Math.pow(2,-77):0,i=isLE?0:nBytes-1,d=isLE?1:-1,nBytes=value<0||0===value&&1/value<0?1:0;for(value=Math.abs(value),isNaN(value)||value===1/0?(m=isNaN(value)?1:0,e=eMax):(e=Math.floor(Math.log(value)/Math.LN2),value*(isLE=Math.pow(2,-e))<1&&(e--,isLE*=2),2<=(value+=1<=e+eBias?rt/isLE:rt*Math.pow(2,1-eBias))*isLE&&(e++,isLE/=2),eMax<=e+eBias?(m=0,e=eMax):1<=e+eBias?(m=(value*isLE-1)*Math.pow(2,mLen),e+=eBias):(m=value*Math.pow(2,eBias-1)*Math.pow(2,mLen),e=0));8<=mLen;buffer[offset+i]=255&m,i+=d,m/=256,mLen-=8);for(e=e<<mLen|m,eLen+=mLen;0<eLen;buffer[offset+i]=255&e,i+=d,e/=256,eLen-=8);buffer[offset+i-d]|=128*nBytes}},{}],220:[function(require,module,exports){"function"==typeof Object.create?module.exports=function(ctor,superCtor){superCtor&&(ctor.super_=superCtor,ctor.prototype=Object.create(superCtor.prototype,{constructor:{value:ctor,enumerable:!1,writable:!0,configurable:!0}}))}:module.exports=function(ctor,superCtor){var TempCtor;superCtor&&(ctor.super_=superCtor,(TempCtor=function(){}).prototype=superCtor.prototype,ctor.prototype=new TempCtor,ctor.prototype.constructor=ctor)}},{}],221:[function(require,module,exports){function isBuffer(obj){return!!obj.constructor&&"function"==typeof obj.constructor.isBuffer&&obj.constructor.isBuffer(obj)}module.exports=function(obj){return null!=obj&&(isBuffer(obj)||function(obj){return"function"==typeof obj.readFloatLE&&"function"==typeof obj.slice&&isBuffer(obj.slice(0,0))}(obj)||!!obj._isBuffer)}},{}],222:[function(require,module,exports){"use strict";function isStandardArguments(value){return!(hasToStringTag&&value&&"object"==typeof value&&Symbol.toStringTag in value)&&"[object Arguments]"===$toString(value)}function isLegacyArguments(value){return!!isStandardArguments(value)||null!==value&&"object"==typeof value&&"number"==typeof value.length&&0<=value.length&&"[object Array]"!==$toString(value)&&"[object Function]"===$toString(value.callee)}var hasToStringTag=require("has-tostringtag/shams")(),$toString=require("call-bind/callBound")("Object.prototype.toString"),require=function(){return isStandardArguments(arguments)}();isStandardArguments.isLegacyArguments=isLegacyArguments,module.exports=require?isStandardArguments:isLegacyArguments},{"call-bind/callBound":132,"has-tostringtag/shams":187}],223:[function(require,module,exports){module.exports=function(obj){return null!=obj&&null!=obj.constructor&&"function"==typeof obj.constructor.isBuffer&&obj.constructor.isBuffer(obj)}},{}],224:[function(require,module,exports){"use strict";var badArrayLike,isCallableMarker,fnToStr=Function.prototype.toString,reflectApply="object"==typeof Reflect&&null!==Reflect&&Reflect.apply;if("function"==typeof reflectApply&&"function"==typeof Object.defineProperty)try{badArrayLike=Object.defineProperty({},"length",{get:function(){throw isCallableMarker}}),isCallableMarker={},reflectApply(function(){throw 42},null,badArrayLike)}catch(_){_!==isCallableMarker&&(reflectApply=null)}else reflectApply=null;function isES6ClassFn(value){try{var fnStr=fnToStr.call(value);return constructorRegex.test(fnStr)}catch(e){return}}var constructorRegex=/^\s*class\b/,toStr=Object.prototype.toString,hasToStringTag="function"==typeof Symbol&&!!Symbol.toStringTag,documentDotAll="object"==typeof document&&void 0===document.all&&void 0!==document.all?document.all:{};module.exports=reflectApply?function(value){if(value===documentDotAll)return!0;if(!value)return!1;if("function"!=typeof value&&"object"!=typeof value)return!1;if("function"==typeof value&&!value.prototype)return!0;try{reflectApply(value,null,badArrayLike)}catch(e){if(e!==isCallableMarker)return!1}return!isES6ClassFn(value)}:function(value){if(value===documentDotAll)return!0;if(!value)return!1;if("function"!=typeof value&&"object"!=typeof value)return!1;if("function"==typeof value&&!value.prototype)return!0;if(hasToStringTag)return function(value){try{return isES6ClassFn(value)?!1:(fnToStr.call(value),!0)}catch(e){return!1}}(value);if(isES6ClassFn(value))return!1;value=toStr.call(value);return"[object Function]"===value||"[object GeneratorFunction]"===value}},{}],225:[function(require,module,exports){"use strict";var GeneratorFunction,toStr=Object.prototype.toString,fnToStr=Function.prototype.toString,isFnRegex=/^\s*(?:function)?\*/,hasToStringTag=require("has-tostringtag/shams")(),getProto=Object.getPrototypeOf;module.exports=function(fn){return"function"==typeof fn&&(!!isFnRegex.test(fnToStr.call(fn))||(hasToStringTag?!!getProto&&(void 0===GeneratorFunction&&(generatorFunc=function(){if(!hasToStringTag)return!1;try{return Function("return function*() {}")()}catch(e){}}(),GeneratorFunction=!!generatorFunc&&getProto(generatorFunc)),getProto(fn)===GeneratorFunction):"[object GeneratorFunction]"===toStr.call(fn)));var generatorFunc}},{"has-tostringtag/shams":187}],226:[function(require,module,exports){!function(global){!function(){"use strict";var forEach=require("for-each"),availableTypedArrays=require("available-typed-arrays"),callBound=require("call-bind/callBound"),$toString=callBound("Object.prototype.toString"),hasToStringTag=require("has-tostringtag/shams")(),g="undefined"==typeof globalThis?global:globalThis,typedArrays=availableTypedArrays(),$indexOf=callBound("Array.prototype.indexOf",!0)||function(array,value){for(var i=0;i<array.length;i+=1)if(array[i]===value)return i;return-1},$slice=callBound("String.prototype.slice"),toStrTags={},gOPD=require("es-abstract/helpers/getOwnPropertyDescriptor"),getPrototypeOf=Object.getPrototypeOf;hasToStringTag&&gOPD&&getPrototypeOf&&forEach(typedArrays,function(typedArray){var descriptor,arr=new g[typedArray];Symbol.toStringTag in arr&&(arr=getPrototypeOf(arr),(descriptor=gOPD(arr,Symbol.toStringTag))||(arr=getPrototypeOf(arr),descriptor=gOPD(arr,Symbol.toStringTag)),toStrTags[typedArray]=descriptor.get)});module.exports=function(value){return!(!value||"object"!=typeof value)&&(hasToStringTag&&Symbol.toStringTag in value?!!gOPD&&function(value){var anyTrue=!1;return forEach(toStrTags,function(getter,typedArray){if(!anyTrue)try{anyTrue=getter.call(value)===typedArray}catch(e){}}),anyTrue}(value):(value=$slice($toString(value),8,-1),-1<$indexOf(typedArrays,value)))}}.call(this)}.call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"available-typed-arrays":64,"call-bind/callBound":132,"es-abstract/helpers/getOwnPropertyDescriptor":177,"for-each":181,"has-tostringtag/shams":187}],227:[function(require,module,exports){"use strict";const encodings=require("./lib/encodings"),rangeOptions=new Set(["lt","gt","lte","gte"]);function Codec(opts){if(!(this instanceof Codec))return new Codec(opts);this.opts=opts||{},this.encodings=encodings}(module.exports=Codec).prototype._encoding=function(encoding){return encoding=(encoding="string"==typeof encoding?encodings[encoding]:encoding)||encodings.id},Codec.prototype._keyEncoding=function(opts,batchOpts){return this._encoding(batchOpts&&batchOpts.keyEncoding||opts&&opts.keyEncoding||this.opts.keyEncoding)},Codec.prototype._valueEncoding=function(opts,batchOpts){return this._encoding(batchOpts&&(batchOpts.valueEncoding||batchOpts.encoding)||opts&&(opts.valueEncoding||opts.encoding)||this.opts.valueEncoding||this.opts.encoding)},Codec.prototype.encodeKey=function(key,opts,batchOpts){return this._keyEncoding(opts,batchOpts).encode(key)},Codec.prototype.encodeValue=function(value,opts,batchOpts){return this._valueEncoding(opts,batchOpts).encode(value)},Codec.prototype.decodeKey=function(key,opts){return this._keyEncoding(opts).decode(key)},Codec.prototype.decodeValue=function(value,opts){return this._valueEncoding(opts).decode(value)},Codec.prototype.encodeBatch=function(ops,opts){return ops.map(_op=>{const op={type:_op.type,key:this.encodeKey(_op.key,opts,_op)};return this.keyAsBuffer(opts,_op)&&(op.keyEncoding="binary"),_op.prefix&&(op.prefix=_op.prefix),"value"in _op&&(op.value=this.encodeValue(_op.value,opts,_op),this.valueAsBuffer(opts,_op)&&(op.valueEncoding="binary")),op})},Codec.prototype.encodeLtgt=function(ltgt){const ret={};for(const key of Object.keys(ltgt)){if("start"===key||"end"===key)throw new Error('Legacy range options ("start" and "end") have been removed');ret[key]=rangeOptions.has(key)?this.encodeKey(ltgt[key],ltgt):ltgt[key]}return ret},Codec.prototype.createStreamDecoder=function(opts){return opts.keys&&opts.values?(key,value)=>({key:this.decodeKey(key,opts),value:this.decodeValue(value,opts)}):opts.keys?key=>this.decodeKey(key,opts):opts.values?(_,value)=>this.decodeValue(value,opts):function(){}},Codec.prototype.keyAsBuffer=function(opts){return this._keyEncoding(opts).buffer},Codec.prototype.valueAsBuffer=function(opts){return this._valueEncoding(opts).buffer}},{"./lib/encodings":228}],228:[function(require,module,exports){"use strict";const Buffer=require("buffer")["Buffer"];exports.utf8=exports["utf-8"]={encode:function(data){return isBinary(data)?data:String(data)},decode:identity,buffer:!1,type:"utf8"},exports.json={encode:JSON.stringify,decode:JSON.parse,buffer:!1,type:"json"},exports.binary={encode:function(data){return isBinary(data)?data:Buffer.from(data)},decode:identity,buffer:!0,type:"binary"},exports.none={encode:identity,decode:identity,buffer:!1,type:"id"},exports.id=exports.none;for(const type of["hex","ascii","base64","ucs2","ucs-2","utf16le","utf-16le"])exports[type]={encode:function(data){return isBinary(data)?data:Buffer.from(data,type)},decode:function(buffer){return buffer.toString(type)},buffer:!0,type:type};function identity(value){return value}function isBinary(data){return null==data||Buffer.isBuffer(data)}},{buffer:112}],229:[function(require,module,exports){"use strict";function createError(type,Proto){function Err(message,cause){if("object"==typeof message&&null!==message&&(cause=cause||message,message=message.message||message.name),message=message||"","object"==typeof(cause=cause||void 0)&&cause.type===type&&cause.message===message)return cause;Object.defineProperty(this,"type",{value:type,enumerable:!1,writable:!0,configurable:!0}),Object.defineProperty(this,"name",{value:type,enumerable:!1,writable:!0,configurable:!0}),Object.defineProperty(this,"cause",{value:cause,enumerable:!1,writable:!0,configurable:!0}),Object.defineProperty(this,"message",{value:message,enumerable:!1,writable:!0,configurable:!0}),Error.call(this),"function"==typeof Error.captureStackTrace&&Error.captureStackTrace(this,Err)}return Err.prototype=new Proto,Err}var LevelUPError=createError("LevelUPError",Error);module.exports={LevelUPError:LevelUPError,InitializationError:createError("InitializationError",LevelUPError),OpenError:createError("OpenError",LevelUPError),ReadError:createError("ReadError",LevelUPError),WriteError:createError("WriteError",LevelUPError),NotFoundError:createError("NotFoundError",LevelUPError),EncodingError:createError("EncodingError",LevelUPError)},module.exports.NotFoundError.prototype.notFound=!0,module.exports.NotFoundError.prototype.status=404},{}],230:[function(require,module,exports){"use strict";const inherits=require("inherits"),Readable=require("readable-stream")["Readable"];function ReadStream(iterator,options){if(!(this instanceof ReadStream))return new ReadStream(iterator,options);options=options||{},Readable.call(this,Object.assign({},options,{objectMode:!0})),this._iterator=iterator,this._options=options,this.on("end",this.destroy.bind(this,null,null))}module.exports=ReadStream,inherits(ReadStream,Readable),ReadStream.prototype._read=function(){this.destroyed||this._iterator.next((err,key,value)=>{if(!this.destroyed)return err?this.destroy(err):void(void 0===key&&void 0===value?this.push(null):!1!==this._options.keys&&!1===this._options.values?this.push(key):!1===this._options.keys&&!1!==this._options.values?this.push(value):this.push({key:key,value:value}))})},ReadStream.prototype._destroy=function(err,callback){this._iterator.end(function(err2){callback(err||err2)})}},{inherits:220,"readable-stream":245}],231:[function(require,module,exports){arguments[4][96][0].apply(exports,arguments)},{dup:96}],232:[function(require,module,exports){!function(process){!function(){"use strict";var objectKeys=Object.keys||function(obj){var key,keys=[];for(key in obj)keys.push(key);return keys},Readable=(module.exports=Duplex,require("./_stream_readable")),Writable=require("./_stream_writable");require("inherits")(Duplex,Readable);for(var keys=objectKeys(Writable.prototype),v=0;v<keys.length;v++){var method=keys[v];Duplex.prototype[method]||(Duplex.prototype[method]=Writable.prototype[method])}function Duplex(options){if(!(this instanceof Duplex))return new Duplex(options);Readable.call(this,options),Writable.call(this,options),this.allowHalfOpen=!0,options&&(!1===options.readable&&(this.readable=!1),!1===options.writable&&(this.writable=!1),!1===options.allowHalfOpen&&(this.allowHalfOpen=!1,this.once("end",onend)))}function onend(){this._writableState.ended||process.nextTick(onEndNT,this)}function onEndNT(self){self.end()}Object.defineProperty(Duplex.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(Duplex.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(Duplex.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(Duplex.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed&&this._writableState.destroyed)},set:function(value){void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed=value,this._writableState.destroyed=value)}})}.call(this)}.call(this,require("_process"))},{"./_stream_readable":234,"./_stream_writable":236,_process:354,inherits:220}],233:[function(require,module,exports){"use strict";module.exports=PassThrough;var Transform=require("./_stream_transform");function PassThrough(options){if(!(this instanceof PassThrough))return new PassThrough(options);Transform.call(this,options)}require("inherits")(PassThrough,Transform),PassThrough.prototype._transform=function(chunk,encoding,cb){cb(null,chunk)}},{"./_stream_transform":235,inherits:220}],234:[function(require,module,exports){!function(process,global){!function(){"use strict";function EElistenerCount(emitter,type){return emitter.listeners(type).length}(module.exports=Readable).ReadableState=ReadableState,require("events").EventEmitter;var Duplex,Stream=require("./internal/streams/stream"),Buffer=require("buffer").Buffer,OurUint8Array=(void 0!==global?global:"undefined"!=typeof window?window:"undefined"!=typeof self?self:{}).Uint8Array||function(){};var StringDecoder,createReadableStreamAsyncIterator,from,debugUtil=require("util"),debug=debugUtil&&debugUtil.debuglog?debugUtil.debuglog("stream"):function(){},BufferList=require("./internal/streams/buffer_list"),debugUtil=require("./internal/streams/destroy"),getHighWaterMark=require("./internal/streams/state").getHighWaterMark,_require$codes=require("../errors").codes,ERR_INVALID_ARG_TYPE=_require$codes.ERR_INVALID_ARG_TYPE,ERR_STREAM_PUSH_AFTER_EOF=_require$codes.ERR_STREAM_PUSH_AFTER_EOF,ERR_METHOD_NOT_IMPLEMENTED=_require$codes.ERR_METHOD_NOT_IMPLEMENTED,ERR_STREAM_UNSHIFT_AFTER_END_EVENT=_require$codes.ERR_STREAM_UNSHIFT_AFTER_END_EVENT,errorOrDestroy=(require("inherits")(Readable,Stream),debugUtil.errorOrDestroy),kProxyEvents=["error","close","destroy","pause","resume"];function ReadableState(options,stream,isDuplex){Duplex=Duplex||require("./_stream_duplex"),"boolean"!=typeof isDuplex&&(isDuplex=stream instanceof Duplex),this.objectMode=!!(options=options||{}).objectMode,isDuplex&&(this.objectMode=this.objectMode||!!options.readableObjectMode),this.highWaterMark=getHighWaterMark(this,options,"readableHighWaterMark",isDuplex),this.buffer=new BufferList,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=!1!==options.emitClose,this.autoDestroy=!!options.autoDestroy,this.destroyed=!1,this.defaultEncoding=options.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,options.encoding&&(StringDecoder=StringDecoder||require("string_decoder/").StringDecoder,this.decoder=new StringDecoder(options.encoding),this.encoding=options.encoding)}function Readable(options){if(Duplex=Duplex||require("./_stream_duplex"),!(this instanceof Readable))return new Readable(options);var isDuplex=this instanceof Duplex;this._readableState=new ReadableState(options,this,isDuplex),this.readable=!0,options&&("function"==typeof options.read&&(this._read=options.read),"function"==typeof options.destroy&&(this._destroy=options.destroy)),Stream.call(this)}function readableAddChunk(stream,chunk,encoding,addToFront,skipChunkCheck){debug("readableAddChunk",chunk);var er,state=stream._readableState;if(null===chunk)state.reading=!1,!function(stream,state){var chunk;debug("onEofChunk"),state.ended||(state.decoder&&(chunk=state.decoder.end())&&chunk.length&&(state.buffer.push(chunk),state.length+=state.objectMode?1:chunk.length),state.ended=!0,state.sync?emitReadable(stream):(state.needReadable=!1,state.emittedReadable||(state.emittedReadable=!0,emitReadable_(stream))))}(stream,state);else if(er=skipChunkCheck?er:function(state,chunk){var er;!function(obj){return Buffer.isBuffer(obj)||obj instanceof OurUint8Array}(chunk)&&"string"!=typeof chunk&&void 0!==chunk&&!state.objectMode&&(er=new ERR_INVALID_ARG_TYPE("chunk",["string","Buffer","Uint8Array"],chunk));return er}(state,chunk))errorOrDestroy(stream,er);else if(state.objectMode||chunk&&0<chunk.length)if("string"==typeof chunk||state.objectMode||Object.getPrototypeOf(chunk)===Buffer.prototype||(chunk=function(chunk){return Buffer.from(chunk)}(chunk)),addToFront)state.endEmitted?errorOrDestroy(stream,new ERR_STREAM_UNSHIFT_AFTER_END_EVENT):addChunk(stream,state,chunk,!0);else if(state.ended)errorOrDestroy(stream,new ERR_STREAM_PUSH_AFTER_EOF);else{if(state.destroyed)return!1;state.reading=!1,state.decoder&&!encoding?(chunk=state.decoder.write(chunk),state.objectMode||0!==chunk.length?addChunk(stream,state,chunk,!1):maybeReadMore(stream,state)):addChunk(stream,state,chunk,!1)}else addToFront||(state.reading=!1,maybeReadMore(stream,state));return!state.ended&&(state.length<state.highWaterMark||0===state.length)}function addChunk(stream,state,chunk,addToFront){state.flowing&&0===state.length&&!state.sync?(state.awaitDrain=0,stream.emit("data",chunk)):(state.length+=state.objectMode?1:chunk.length,addToFront?state.buffer.unshift(chunk):state.buffer.push(chunk),state.needReadable&&emitReadable(stream)),maybeReadMore(stream,state)}Object.defineProperty(Readable.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._readableState&&this._readableState.destroyed},set:function(value){this._readableState&&(this._readableState.destroyed=value)}}),Readable.prototype.destroy=debugUtil.destroy,Readable.prototype._undestroy=debugUtil.undestroy,Readable.prototype._destroy=function(err,cb){cb(err)},Readable.prototype.push=function(chunk,encoding){var skipChunkCheck,state=this._readableState;return state.objectMode?skipChunkCheck=!0:"string"==typeof chunk&&((encoding=encoding||state.defaultEncoding)!==state.encoding&&(chunk=Buffer.from(chunk,encoding),encoding=""),skipChunkCheck=!0),readableAddChunk(this,chunk,encoding,!1,skipChunkCheck)},Readable.prototype.unshift=function(chunk){return readableAddChunk(this,chunk,null,!0,!1)},Readable.prototype.isPaused=function(){return!1===this._readableState.flowing},Readable.prototype.setEncoding=function(enc){for(var decoder=new(StringDecoder=StringDecoder||require("string_decoder/").StringDecoder)(enc),p=(this._readableState.decoder=decoder,this._readableState.encoding=this._readableState.decoder.encoding,this._readableState.buffer.head),content="";null!==p;)content+=decoder.write(p.data),p=p.next;return this._readableState.buffer.clear(),""!==content&&this._readableState.buffer.push(content),this._readableState.length=content.length,this};var MAX_HWM=1073741824;function howMuchToRead(n,state){return n<=0||0===state.length&&state.ended?0:state.objectMode?1:n!=n?(state.flowing&&state.length?state.buffer.head.data:state).length:(n>state.highWaterMark&&(state.highWaterMark=function(n){return MAX_HWM<=n?n=MAX_HWM:(n--,n=(n=(n=(n=(n|=n>>>1)|n>>>2)|n>>>4)|n>>>8)|n>>>16,n++),n}(n)),n<=state.length?n:state.ended?state.length:(state.needReadable=!0,0))}function emitReadable(stream){var state=stream._readableState;debug("emitReadable",state.needReadable,state.emittedReadable),state.needReadable=!1,state.emittedReadable||(debug("emitReadable",state.flowing),state.emittedReadable=!0,process.nextTick(emitReadable_,stream))}function emitReadable_(stream){var state=stream._readableState;debug("emitReadable_",state.destroyed,state.length,state.ended),state.destroyed||!state.length&&!state.ended||(stream.emit("readable"),state.emittedReadable=!1),state.needReadable=!state.flowing&&!state.ended&&state.length<=state.highWaterMark,flow(stream)}function maybeReadMore(stream,state){state.readingMore||(state.readingMore=!0,process.nextTick(maybeReadMore_,stream,state))}function maybeReadMore_(stream,state){for(;!state.reading&&!state.ended&&(state.length<state.highWaterMark||state.flowing&&0===state.length);){var len=state.length;if(debug("maybeReadMore read 0"),stream.read(0),len===state.length)break}state.readingMore=!1}function updateReadableListening(self){var state=self._readableState;state.readableListening=0<self.listenerCount("readable"),state.resumeScheduled&&!state.paused?state.flowing=!0:0<self.listenerCount("data")&&self.resume()}function nReadingNextTick(self){debug("readable nexttick read 0"),self.read(0)}function resume_(stream,state){debug("resume",state.reading),state.reading||stream.read(0),state.resumeScheduled=!1,stream.emit("resume"),flow(stream),state.flowing&&!state.reading&&stream.read(0)}function flow(stream){var state=stream._readableState;for(debug("flow",state.flowing);state.flowing&&null!==stream.read(););}function fromList(n,state){return 0===state.length?null:(state.objectMode?ret=state.buffer.shift():!n||n>=state.length?(ret=state.decoder?state.buffer.join(""):1===state.buffer.length?state.buffer.first():state.buffer.concat(state.length),state.buffer.clear()):ret=state.buffer.consume(n,state.decoder),ret);var ret}function endReadable(stream){var state=stream._readableState;debug("endReadable",state.endEmitted),state.endEmitted||(state.ended=!0,process.nextTick(endReadableNT,state,stream))}function endReadableNT(state,stream){debug("endReadableNT",state.endEmitted,state.length),state.endEmitted||0!==state.length||(state.endEmitted=!0,stream.readable=!1,stream.emit("end"),state.autoDestroy&&(!(state=stream._writableState)||state.autoDestroy&&state.finished)&&stream.destroy())}function indexOf(xs,x){for(var i=0,l=xs.length;i<l;i++)if(xs[i]===x)return i;return-1}Readable.prototype.read=function(n){debug("read",n),n=parseInt(n,10);var state=this._readableState,nOrig=n;if(0!==n&&(state.emittedReadable=!1),0===n&&state.needReadable&&((0!==state.highWaterMark?state.length>=state.highWaterMark:0<state.length)||state.ended))return debug("read: emitReadable",state.length,state.ended),(0===state.length&&state.ended?endReadable:emitReadable)(this),null;if(0===(n=howMuchToRead(n,state))&&state.ended)return 0===state.length&&endReadable(this),null;var doRead=state.needReadable;return debug("need readable",doRead),(0===state.length||state.length-n<state.highWaterMark)&&debug("length less than watermark",doRead=!0),state.ended||state.reading?debug("reading or ended",doRead=!1):doRead&&(debug("do read"),state.reading=!0,state.sync=!0,0===state.length&&(state.needReadable=!0),this._read(state.highWaterMark),state.sync=!1,state.reading||(n=howMuchToRead(nOrig,state))),null===(doRead=0<n?fromList(n,state):null)?(state.needReadable=state.length<=state.highWaterMark,n=0):(state.length-=n,state.awaitDrain=0),0===state.length&&(state.ended||(state.needReadable=!0),nOrig!==n&&state.ended&&endReadable(this)),null!==doRead&&this.emit("data",doRead),doRead},Readable.prototype._read=function(n){errorOrDestroy(this,new ERR_METHOD_NOT_IMPLEMENTED("_read()"))},Readable.prototype.pipe=function(dest,pipeOpts){var src=this,state=this._readableState;switch(state.pipesCount){case 0:state.pipes=dest;break;case 1:state.pipes=[state.pipes,dest];break;default:state.pipes.push(dest)}state.pipesCount+=1,debug("pipe count=%d opts=%j",state.pipesCount,pipeOpts);pipeOpts=(!pipeOpts||!1!==pipeOpts.end)&&dest!==process.stdout&&dest!==process.stderr?onend:unpipe;function onunpipe(readable,unpipeInfo){debug("onunpipe"),readable===src&&unpipeInfo&&!1===unpipeInfo.hasUnpiped&&(unpipeInfo.hasUnpiped=!0,debug("cleanup"),dest.removeListener("close",onclose),dest.removeListener("finish",onfinish),dest.removeListener("drain",ondrain),dest.removeListener("error",onerror),dest.removeListener("unpipe",onunpipe),src.removeListener("end",onend),src.removeListener("end",unpipe),src.removeListener("data",ondata),cleanedUp=!0,!state.awaitDrain||dest._writableState&&!dest._writableState.needDrain||ondrain())}function onend(){debug("onend"),dest.end()}state.endEmitted?process.nextTick(pipeOpts):src.once("end",pipeOpts),dest.on("unpipe",onunpipe);var ondrain=function(src){return function(){var state=src._readableState;debug("pipeOnDrain",state.awaitDrain),state.awaitDrain&&state.awaitDrain--,0===state.awaitDrain&&EElistenerCount(src,"data")&&(state.flowing=!0,flow(src))}}(src),cleanedUp=(dest.on("drain",ondrain),!1);function ondata(chunk){debug("ondata");chunk=dest.write(chunk);debug("dest.write",chunk),!1===chunk&&((1===state.pipesCount&&state.pipes===dest||1<state.pipesCount&&-1!==indexOf(state.pipes,dest))&&!cleanedUp&&(debug("false write response, pause",state.awaitDrain),state.awaitDrain++),src.pause())}function onerror(er){debug("onerror",er),unpipe(),dest.removeListener("error",onerror),0===EElistenerCount(dest,"error")&&errorOrDestroy(dest,er)}function onclose(){dest.removeListener("finish",onfinish),unpipe()}function onfinish(){debug("onfinish"),dest.removeListener("close",onclose),unpipe()}function unpipe(){debug("unpipe"),src.unpipe(dest)}return src.on("data",ondata),function(emitter,event,fn){if("function"==typeof emitter.prependListener)return emitter.prependListener(event,fn);emitter._events&&emitter._events[event]?Array.isArray(emitter._events[event])?emitter._events[event].unshift(fn):emitter._events[event]=[fn,emitter._events[event]]:emitter.on(event,fn)}(dest,"error",onerror),dest.once("close",onclose),dest.once("finish",onfinish),dest.emit("pipe",src),state.flowing||(debug("pipe resume"),src.resume()),dest},Readable.prototype.unpipe=function(dest){var state=this._readableState,unpipeInfo={hasUnpiped:!1};if(0===state.pipesCount)return this;if(1===state.pipesCount)return dest&&dest!==state.pipes||(dest=dest||state.pipes,state.pipes=null,state.pipesCount=0,state.flowing=!1,dest&&dest.emit("unpipe",this,unpipeInfo)),this;if(!dest){var dests=state.pipes,len=state.pipesCount;state.pipes=null,state.pipesCount=0,state.flowing=!1;for(var i=0;i<len;i++)dests[i].emit("unpipe",this,{hasUnpiped:!1});return this}var index=indexOf(state.pipes,dest);return-1===index||(state.pipes.splice(index,1),--state.pipesCount,1===state.pipesCount&&(state.pipes=state.pipes[0]),dest.emit("unpipe",this,unpipeInfo)),this},Readable.prototype.addListener=Readable.prototype.on=function(ev,fn){var fn=Stream.prototype.on.call(this,ev,fn),state=this._readableState;return"data"===ev?(state.readableListening=0<this.listenerCount("readable"),!1!==state.flowing&&this.resume()):"readable"!==ev||state.endEmitted||state.readableListening||(state.readableListening=state.needReadable=!0,state.flowing=!1,state.emittedReadable=!1,debug("on readable",state.length,state.reading),state.length?emitReadable(this):state.reading||process.nextTick(nReadingNextTick,this)),fn},Readable.prototype.removeListener=function(ev,fn){fn=Stream.prototype.removeListener.call(this,ev,fn);return"readable"===ev&&process.nextTick(updateReadableListening,this),fn},Readable.prototype.removeAllListeners=function(ev){var res=Stream.prototype.removeAllListeners.apply(this,arguments);return"readable"!==ev&&void 0!==ev||process.nextTick(updateReadableListening,this),res},Readable.prototype.resume=function(){var state=this._readableState;return state.flowing||(debug("resume"),state.flowing=!state.readableListening,function(stream,state){state.resumeScheduled||(state.resumeScheduled=!0,process.nextTick(resume_,stream,state))}(this,state)),state.paused=!1,this},Readable.prototype.pause=function(){return debug("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(debug("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this},Readable.prototype.wrap=function(stream){var i,_this=this,state=this._readableState,paused=!1;for(i in stream.on("end",function(){var chunk;debug("wrapped end"),state.decoder&&!state.ended&&(chunk=state.decoder.end())&&chunk.length&&_this.push(chunk),_this.push(null)}),stream.on("data",function(chunk){debug("wrapped data"),state.decoder&&(chunk=state.decoder.write(chunk)),state.objectMode&&null==chunk||(state.objectMode||chunk&&chunk.length)&&!_this.push(chunk)&&(paused=!0,stream.pause())}),stream)void 0===this[i]&&"function"==typeof stream[i]&&(this[i]=function(method){return function(){return stream[method].apply(stream,arguments)}}(i));for(var n=0;n<kProxyEvents.length;n++)stream.on(kProxyEvents[n],this.emit.bind(this,kProxyEvents[n]));return this._read=function(n){debug("wrapped _read",n),paused&&(paused=!1,stream.resume())},this},"function"==typeof Symbol&&(Readable.prototype[Symbol.asyncIterator]=function(){return(createReadableStreamAsyncIterator=void 0===createReadableStreamAsyncIterator?require("./internal/streams/async_iterator"):createReadableStreamAsyncIterator)(this)}),Object.defineProperty(Readable.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),Object.defineProperty(Readable.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}}),Object.defineProperty(Readable.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(state){this._readableState&&(this._readableState.flowing=state)}}),Readable._fromList=fromList,Object.defineProperty(Readable.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}}),"function"==typeof Symbol&&(Readable.from=function(iterable,opts){return(from=void 0===from?require("./internal/streams/from"):from)(Readable,iterable,opts)})}.call(this)}.call(this,require("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../errors":231,"./_stream_duplex":232,"./internal/streams/async_iterator":237,"./internal/streams/buffer_list":238,"./internal/streams/destroy":239,"./internal/streams/from":241,"./internal/streams/state":243,"./internal/streams/stream":244,_process:354,buffer:112,events:178,inherits:220,"string_decoder/":377,util:68}],235:[function(require,module,exports){"use strict";module.exports=Transform;var module=require("../errors").codes,ERR_METHOD_NOT_IMPLEMENTED=module.ERR_METHOD_NOT_IMPLEMENTED,ERR_MULTIPLE_CALLBACK=module.ERR_MULTIPLE_CALLBACK,ERR_TRANSFORM_ALREADY_TRANSFORMING=module.ERR_TRANSFORM_ALREADY_TRANSFORMING,ERR_TRANSFORM_WITH_LENGTH_0=module.ERR_TRANSFORM_WITH_LENGTH_0,Duplex=require("./_stream_duplex");function Transform(options){if(!(this instanceof Transform))return new Transform(options);Duplex.call(this,options),this._transformState={afterTransform:function(er,data){var ts=this._transformState,cb=(ts.transforming=!1,ts.writecb);if(null===cb)return this.emit("error",new ERR_MULTIPLE_CALLBACK);ts.writechunk=null,(ts.writecb=null)!=data&&this.push(data),cb(er),(ts=this._readableState).reading=!1,(ts.needReadable||ts.length<ts.highWaterMark)&&this._read(ts.highWaterMark)}.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,options&&("function"==typeof options.transform&&(this._transform=options.transform),"function"==typeof options.flush&&(this._flush=options.flush)),this.on("prefinish",prefinish)}function prefinish(){var _this=this;"function"!=typeof this._flush||this._readableState.destroyed?done(this,null,null):this._flush(function(er,data){done(_this,er,data)})}function done(stream,er,data){if(er)return stream.emit("error",er);if(null!=data&&stream.push(data),stream._writableState.length)throw new ERR_TRANSFORM_WITH_LENGTH_0;if(stream._transformState.transforming)throw new ERR_TRANSFORM_ALREADY_TRANSFORMING;stream.push(null)}require("inherits")(Transform,Duplex),Transform.prototype.push=function(chunk,encoding){return this._transformState.needTransform=!1,Duplex.prototype.push.call(this,chunk,encoding)},Transform.prototype._transform=function(chunk,encoding,cb){cb(new ERR_METHOD_NOT_IMPLEMENTED("_transform()"))},Transform.prototype._write=function(chunk,encoding,cb){var ts=this._transformState;ts.writecb=cb,ts.writechunk=chunk,ts.writeencoding=encoding,ts.transforming||(cb=this._readableState,(ts.needTransform||cb.needReadable||cb.length<cb.highWaterMark)&&this._read(cb.highWaterMark))},Transform.prototype._read=function(n){var ts=this._transformState;null===ts.writechunk||ts.transforming?ts.needTransform=!0:(ts.transforming=!0,this._transform(ts.writechunk,ts.writeencoding,ts.afterTransform))},Transform.prototype._destroy=function(err,cb){Duplex.prototype._destroy.call(this,err,function(err2){cb(err2)})}},{"../errors":231,"./_stream_duplex":232,inherits:220}],236:[function(require,module,exports){!function(process,global){!function(){"use strict";function CorkedRequest(state){var _this=this;this.next=null,this.entry=null,this.finish=function(){!function(corkReq,state,err){var entry=corkReq.entry;corkReq.entry=null;for(;entry;){var cb=entry.callback;state.pendingcb--,cb(err),entry=entry.next}state.corkedRequestsFree.next=corkReq}(_this,state)}}(module.exports=Writable).WritableState=WritableState;var Duplex,internalUtil={deprecate:require("util-deprecate")},Stream=require("./internal/streams/stream"),Buffer=require("buffer").Buffer,OurUint8Array=(void 0!==global?global:"undefined"!=typeof window?window:"undefined"!=typeof self?self:{}).Uint8Array||function(){};var realHasInstance,destroyImpl=require("./internal/streams/destroy"),getHighWaterMark=require("./internal/streams/state").getHighWaterMark,_require$codes=require("../errors").codes,ERR_INVALID_ARG_TYPE=_require$codes.ERR_INVALID_ARG_TYPE,ERR_METHOD_NOT_IMPLEMENTED=_require$codes.ERR_METHOD_NOT_IMPLEMENTED,ERR_MULTIPLE_CALLBACK=_require$codes.ERR_MULTIPLE_CALLBACK,ERR_STREAM_CANNOT_PIPE=_require$codes.ERR_STREAM_CANNOT_PIPE,ERR_STREAM_DESTROYED=_require$codes.ERR_STREAM_DESTROYED,ERR_STREAM_NULL_VALUES=_require$codes.ERR_STREAM_NULL_VALUES,ERR_STREAM_WRITE_AFTER_END=_require$codes.ERR_STREAM_WRITE_AFTER_END,ERR_UNKNOWN_ENCODING=_require$codes.ERR_UNKNOWN_ENCODING,errorOrDestroy=destroyImpl.errorOrDestroy;function nop(){}function WritableState(options,stream,isDuplex){Duplex=Duplex||require("./_stream_duplex"),"boolean"!=typeof isDuplex&&(isDuplex=stream instanceof Duplex),this.objectMode=!!(options=options||{}).objectMode,isDuplex&&(this.objectMode=this.objectMode||!!options.writableObjectMode),this.highWaterMark=getHighWaterMark(this,options,"writableHighWaterMark",isDuplex),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1;isDuplex=(this.destroyed=!1)===options.decodeStrings;this.decodeStrings=!isDuplex,this.defaultEncoding=options.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(er){!function(stream,er){var state=stream._writableState,sync=state.sync,cb=state.writecb;if("function"!=typeof cb)throw new ERR_MULTIPLE_CALLBACK;(function(state){state.writing=!1,state.writecb=null,state.length-=state.writelen,state.writelen=0})(state),er?function(stream,state,sync,er,cb){--state.pendingcb,sync?(process.nextTick(cb,er),process.nextTick(finishMaybe,stream,state),stream._writableState.errorEmitted=!0,errorOrDestroy(stream,er)):(cb(er),stream._writableState.errorEmitted=!0,errorOrDestroy(stream,er),finishMaybe(stream,state))}(stream,state,sync,er,cb):((er=needFinish(state)||stream.destroyed)||state.corked||state.bufferProcessing||!state.bufferedRequest||clearBuffer(stream,state),sync?process.nextTick(afterWrite,stream,state,er,cb):afterWrite(stream,state,er,cb))}(stream,er)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=!1!==options.emitClose,this.autoDestroy=!!options.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new CorkedRequest(this)}require("inherits")(Writable,Stream),WritableState.prototype.getBuffer=function(){for(var current=this.bufferedRequest,out=[];current;)out.push(current),current=current.next;return out};try{Object.defineProperty(WritableState.prototype,"buffer",{get:internalUtil.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch(_){}function Writable(options){var isDuplex=this instanceof(Duplex=Duplex||require("./_stream_duplex"));if(!isDuplex&&!realHasInstance.call(Writable,this))return new Writable(options);this._writableState=new WritableState(options,this,isDuplex),this.writable=!0,options&&("function"==typeof options.write&&(this._write=options.write),"function"==typeof options.writev&&(this._writev=options.writev),"function"==typeof options.destroy&&(this._destroy=options.destroy),"function"==typeof options.final&&(this._final=options.final)),Stream.call(this)}function doWrite(stream,state,writev,len,chunk,encoding,cb){state.writelen=len,state.writecb=cb,state.writing=!0,state.sync=!0,state.destroyed?state.onwrite(new ERR_STREAM_DESTROYED("write")):writev?stream._writev(chunk,state.onwrite):stream._write(chunk,encoding,state.onwrite),state.sync=!1}function afterWrite(stream,state,finished,cb){finished||!function(stream,state){0===state.length&&state.needDrain&&(state.needDrain=!1,stream.emit("drain"))}(stream,state),state.pendingcb--,cb(),finishMaybe(stream,state)}function clearBuffer(stream,state){state.bufferProcessing=!0;var entry=state.bufferedRequest;if(stream._writev&&entry&&entry.next){for(var l=state.bufferedRequestCount,buffer=new Array(l),l=state.corkedRequestsFree,count=(l.entry=entry,0),allBuffers=!0;entry;)(buffer[count]=entry).isBuf||(allBuffers=!1),entry=entry.next,count+=1;buffer.allBuffers=allBuffers,doWrite(stream,state,!0,state.length,buffer,"",l.finish),state.pendingcb++,state.lastBufferedRequest=null,l.next?(state.corkedRequestsFree=l.next,l.next=null):state.corkedRequestsFree=new CorkedRequest(state),state.bufferedRequestCount=0}else{for(;entry;){var chunk=entry.chunk,encoding=entry.encoding,cb=entry.callback;if(doWrite(stream,state,!1,state.objectMode?1:chunk.length,chunk,encoding,cb),entry=entry.next,state.bufferedRequestCount--,state.writing)break}null===entry&&(state.lastBufferedRequest=null)}state.bufferedRequest=entry,state.bufferProcessing=!1}function needFinish(state){return state.ending&&0===state.length&&null===state.bufferedRequest&&!state.finished&&!state.writing}function callFinal(stream,state){stream._final(function(err){state.pendingcb--,err&&errorOrDestroy(stream,err),state.prefinished=!0,stream.emit("prefinish"),finishMaybe(stream,state)})}function finishMaybe(stream,state){var need=needFinish(state);return need&&(function(stream,state){state.prefinished||state.finalCalled||("function"!=typeof stream._final||state.destroyed?(state.prefinished=!0,stream.emit("prefinish")):(state.pendingcb++,state.finalCalled=!0,process.nextTick(callFinal,stream,state)))}(stream,state),0===state.pendingcb&&(state.finished=!0,stream.emit("finish"),state.autoDestroy&&(!(state=stream._readableState)||state.autoDestroy&&state.endEmitted)&&stream.destroy())),need}"function"==typeof Symbol&&Symbol.hasInstance&&"function"==typeof Function.prototype[Symbol.hasInstance]?(realHasInstance=Function.prototype[Symbol.hasInstance],Object.defineProperty(Writable,Symbol.hasInstance,{value:function(object){return!!realHasInstance.call(this,object)||this===Writable&&(object&&object._writableState instanceof WritableState)}})):realHasInstance=function(object){return object instanceof this},Writable.prototype.pipe=function(){errorOrDestroy(this,new ERR_STREAM_CANNOT_PIPE)},Writable.prototype.write=function(chunk,encoding,cb){var state=this._writableState,ret=!1,obj=!state.objectMode&&(obj=chunk,Buffer.isBuffer(obj)||obj instanceof OurUint8Array);return obj&&!Buffer.isBuffer(chunk)&&(chunk=function(chunk){return Buffer.from(chunk)}(chunk)),"function"==typeof encoding&&(cb=encoding,encoding=null),encoding=obj?"buffer":encoding||state.defaultEncoding,"function"!=typeof cb&&(cb=nop),state.ending?function(stream,cb){var er=new ERR_STREAM_WRITE_AFTER_END;errorOrDestroy(stream,er),process.nextTick(cb,er)}(this,cb):(obj||function(stream,state,chunk,cb){var er;return null===chunk?er=new ERR_STREAM_NULL_VALUES:"string"==typeof chunk||state.objectMode||(er=new ERR_INVALID_ARG_TYPE("chunk",["string","Buffer"],chunk)),!er||(errorOrDestroy(stream,er),void process.nextTick(cb,er))}(this,state,chunk,cb))&&(state.pendingcb++,ret=function(stream,state,isBuf,chunk,encoding,cb){isBuf||(newChunk=function(state,chunk,encoding){state.objectMode||!1===state.decodeStrings||"string"!=typeof chunk||(chunk=Buffer.from(chunk,encoding));return chunk}(state,chunk,encoding),chunk!==newChunk&&(isBuf=!0,encoding="buffer",chunk=newChunk));var newChunk=state.objectMode?1:chunk.length,ret=(state.length+=newChunk,state.length<state.highWaterMark);ret||(state.needDrain=!0);{var last;state.writing||state.corked?(last=state.lastBufferedRequest,state.lastBufferedRequest={chunk:chunk,encoding:encoding,isBuf:isBuf,callback:cb,next:null},last?last.next=state.lastBufferedRequest:state.bufferedRequest=state.lastBufferedRequest,state.bufferedRequestCount+=1):doWrite(stream,state,!1,newChunk,chunk,encoding,cb)}return ret}(this,state,obj,chunk,encoding,cb)),ret},Writable.prototype.cork=function(){this._writableState.corked++},Writable.prototype.uncork=function(){var state=this._writableState;state.corked&&(state.corked--,state.writing||state.corked||state.bufferProcessing||!state.bufferedRequest||clearBuffer(this,state))},Writable.prototype.setDefaultEncoding=function(encoding){if("string"==typeof encoding&&(encoding=encoding.toLowerCase()),-1<["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((encoding+"").toLowerCase()))return this._writableState.defaultEncoding=encoding,this;throw new ERR_UNKNOWN_ENCODING(encoding)},Object.defineProperty(Writable.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(Writable.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Writable.prototype._write=function(chunk,encoding,cb){cb(new ERR_METHOD_NOT_IMPLEMENTED("_write()"))},Writable.prototype._writev=null,Writable.prototype.end=function(chunk,encoding,cb){var state=this._writableState;return"function"==typeof chunk?(cb=chunk,encoding=chunk=null):"function"==typeof encoding&&(cb=encoding,encoding=null),null!=chunk&&this.write(chunk,encoding),state.corked&&(state.corked=1,this.uncork()),state.ending||function(stream,state,cb){state.ending=!0,finishMaybe(stream,state),cb&&(state.finished?process.nextTick(cb):stream.once("finish",cb));state.ended=!0,stream.writable=!1}(this,state,cb),this},Object.defineProperty(Writable.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(Writable.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._writableState&&this._writableState.destroyed},set:function(value){this._writableState&&(this._writableState.destroyed=value)}}),Writable.prototype.destroy=destroyImpl.destroy,Writable.prototype._undestroy=destroyImpl.undestroy,Writable.prototype._destroy=function(err,cb){cb(err)}}.call(this)}.call(this,require("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../errors":231,"./_stream_duplex":232,"./internal/streams/destroy":239,"./internal/streams/state":243,"./internal/streams/stream":244,_process:354,buffer:112,inherits:220,"util-deprecate":378}],237:[function(require,module,exports){!function(process){!function(){"use strict";var _Object$setPrototypeO;function _defineProperty(obj,key,value){(key=function(arg){arg=function(input,hint){if("object"!=typeof input||null===input)return input;var prim=input[Symbol.toPrimitive];if(void 0===prim)return("string"===hint?String:Number)(input);prim=prim.call(input,hint||"default");if("object"!=typeof prim)return prim;throw new TypeError("@@toPrimitive must return a primitive value.")}(arg,"string");return"symbol"==typeof arg?arg:String(arg)}(key))in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value}var finished=require("./end-of-stream"),kLastResolve=Symbol("lastResolve"),kLastReject=Symbol("lastReject"),kError=Symbol("error"),kEnded=Symbol("ended"),kLastPromise=Symbol("lastPromise"),kHandlePromise=Symbol("handlePromise"),kStream=Symbol("stream");function readAndResolve(iter){var data,resolve=iter[kLastResolve];null!==resolve&&null!==(data=iter[kStream].read())&&(iter[kLastPromise]=null,iter[kLastResolve]=null,iter[kLastReject]=null,resolve({value:data,done:!1}))}var AsyncIteratorPrototype=Object.getPrototypeOf(function(){}),ReadableStreamAsyncIteratorPrototype=Object.setPrototypeOf((_defineProperty(_Object$setPrototypeO={get stream(){return this[kStream]},next:function(){var _this=this,error=this[kError];if(null!==error)return Promise.reject(error);if(this[kEnded])return Promise.resolve({value:void 0,done:!0});if(this[kStream].destroyed)return new Promise(function(resolve,reject){process.nextTick(function(){_this[kError]?reject(_this[kError]):resolve({value:void 0,done:!0})})});var promise,error=this[kLastPromise];if(error)promise=new Promise(function(lastPromise,iter){return function(resolve,reject){lastPromise.then(function(){iter[kEnded]?resolve({value:void 0,done:!0}):iter[kHandlePromise](resolve,reject)},reject)}}(error,this));else{error=this[kStream].read();if(null!==error)return Promise.resolve({value:error,done:!1});promise=new Promise(this[kHandlePromise])}return this[kLastPromise]=promise}},Symbol.asyncIterator,function(){return this}),_defineProperty(_Object$setPrototypeO,"return",function(){var _this2=this;return new Promise(function(resolve,reject){_this2[kStream].destroy(null,function(err){err?reject(err):resolve({value:void 0,done:!0})})})}),_Object$setPrototypeO),AsyncIteratorPrototype);module.exports=function(stream){var _Object$create,iterator=Object.create(ReadableStreamAsyncIteratorPrototype,(_defineProperty(_Object$create={},kStream,{value:stream,writable:!0}),_defineProperty(_Object$create,kLastResolve,{value:null,writable:!0}),_defineProperty(_Object$create,kLastReject,{value:null,writable:!0}),_defineProperty(_Object$create,kError,{value:null,writable:!0}),_defineProperty(_Object$create,kEnded,{value:stream._readableState.endEmitted,writable:!0}),_defineProperty(_Object$create,kHandlePromise,{value:function(resolve,reject){var data=iterator[kStream].read();data?(iterator[kLastPromise]=null,iterator[kLastResolve]=null,iterator[kLastReject]=null,resolve({value:data,done:!1})):(iterator[kLastResolve]=resolve,iterator[kLastReject]=reject)},writable:!0}),_Object$create));return iterator[kLastPromise]=null,finished(stream,function(err){if(err&&"ERR_STREAM_PREMATURE_CLOSE"!==err.code)return null!==(reject=iterator[kLastReject])&&(iterator[kLastPromise]=null,iterator[kLastResolve]=null,iterator[kLastReject]=null,reject(err)),void(iterator[kError]=err);var reject=iterator[kLastResolve];null!==reject&&(iterator[kLastPromise]=null,iterator[kLastResolve]=null,reject({value:void 0,done:!(iterator[kLastReject]=null)})),iterator[kEnded]=!0}),stream.on("readable",function(iter){process.nextTick(readAndResolve,iter)}.bind(null,iterator)),iterator}}.call(this)}.call(this,require("_process"))},{"./end-of-stream":240,_process:354}],238:[function(require,module,exports){"use strict";function ownKeys(object,enumerableOnly){var symbols,keys=Object.keys(object);return Object.getOwnPropertySymbols&&(symbols=Object.getOwnPropertySymbols(object),enumerableOnly&&(symbols=symbols.filter(function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable})),keys.push.apply(keys,symbols)),keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?ownKeys(Object(source),!0).forEach(function(key){!function(obj,key,value){(key=_toPropertyKey(key))in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value}(target,key,source[key])}):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):ownKeys(Object(source)).forEach(function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))})}return target}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,_toPropertyKey(descriptor.key),descriptor)}}function _toPropertyKey(arg){arg=function(input,hint){if("object"!=typeof input||null===input)return input;var prim=input[Symbol.toPrimitive];if(void 0===prim)return("string"===hint?String:Number)(input);prim=prim.call(input,hint||"default");if("object"!=typeof prim)return prim;throw new TypeError("@@toPrimitive must return a primitive value.")}(arg,"string");return"symbol"==typeof arg?arg:String(arg)}var Buffer=require("buffer").Buffer,inspect=require("util").inspect,custom=inspect&&inspect.custom||"inspect";module.exports=function(){function BufferList(){if(!(this instanceof BufferList))throw new TypeError("Cannot call a class as a function");this.head=null,this.tail=null,this.length=0}var Constructor,protoProps,staticProps;return Constructor=BufferList,(protoProps=[{key:"push",value:function(v){v={data:v,next:null};0<this.length?this.tail.next=v:this.head=v,this.tail=v,++this.length}},{key:"unshift",value:function(v){v={data:v,next:this.head};0===this.length&&(this.tail=v),this.head=v,++this.length}},{key:"shift",value:function(){var ret;if(0!==this.length)return ret=this.head.data,1===this.length?this.head=this.tail=null:this.head=this.head.next,--this.length,ret}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(s){if(0===this.length)return"";for(var p=this.head,ret=""+p.data;p=p.next;)ret+=s+p.data;return ret}},{key:"concat",value:function(n){if(0===this.length)return Buffer.alloc(0);for(var src,offset,ret=Buffer.allocUnsafe(n>>>0),p=this.head,i=0;p;)src=p.data,offset=i,Buffer.prototype.copy.call(src,ret,offset),i+=p.data.length,p=p.next;return ret}},{key:"consume",value:function(n,hasStrings){var ret;return n<this.head.data.length?(ret=this.head.data.slice(0,n),this.head.data=this.head.data.slice(n)):ret=n===this.head.data.length?this.shift():hasStrings?this._getString(n):this._getBuffer(n),ret}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(n){var p=this.head,c=1,ret=p.data;for(n-=ret.length;p=p.next;){var str=p.data,nb=n>str.length?str.length:n;if(nb===str.length?ret+=str:ret+=str.slice(0,n),0===(n-=nb)){nb===str.length?(++c,p.next?this.head=p.next:this.head=this.tail=null):(this.head=p).data=str.slice(nb);break}++c}return this.length-=c,ret}},{key:"_getBuffer",value:function(n){var ret=Buffer.allocUnsafe(n),p=this.head,c=1;for(p.data.copy(ret),n-=p.data.length;p=p.next;){var buf=p.data,nb=n>buf.length?buf.length:n;if(buf.copy(ret,ret.length-n,0,nb),0===(n-=nb)){nb===buf.length?(++c,p.next?this.head=p.next:this.head=this.tail=null):(this.head=p).data=buf.slice(nb);break}++c}return this.length-=c,ret}},{key:custom,value:function(_,options){return inspect(this,_objectSpread(_objectSpread({},options),{},{depth:0,customInspect:!1}))}}])&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),Object.defineProperty(Constructor,"prototype",{writable:!1}),BufferList}()},{buffer:112,util:68}],239:[function(require,module,exports){!function(process){!function(){"use strict";function emitErrorAndCloseNT(self,err){emitErrorNT(self,err),emitCloseNT(self)}function emitCloseNT(self){self._writableState&&!self._writableState.emitClose||self._readableState&&!self._readableState.emitClose||self.emit("close")}function emitErrorNT(self,err){self.emit("error",err)}module.exports={destroy:function(err,cb){var _this=this,readableDestroyed=this._readableState&&this._readableState.destroyed,writableDestroyed=this._writableState&&this._writableState.destroyed;return readableDestroyed||writableDestroyed?cb?cb(err):err&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,process.nextTick(emitErrorNT,this,err)):process.nextTick(emitErrorNT,this,err)):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(err||null,function(err){!cb&&err?_this._writableState?_this._writableState.errorEmitted?process.nextTick(emitCloseNT,_this):(_this._writableState.errorEmitted=!0,process.nextTick(emitErrorAndCloseNT,_this,err)):process.nextTick(emitErrorAndCloseNT,_this,err):cb?(process.nextTick(emitCloseNT,_this),cb(err)):process.nextTick(emitCloseNT,_this)})),this},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)},errorOrDestroy:function(stream,err){var rState=stream._readableState,wState=stream._writableState;rState&&rState.autoDestroy||wState&&wState.autoDestroy?stream.destroy(err):stream.emit("error",err)}}}.call(this)}.call(this,require("_process"))},{_process:354}],240:[function(require,module,exports){"use strict";var ERR_STREAM_PREMATURE_CLOSE=require("../../../errors").codes.ERR_STREAM_PREMATURE_CLOSE;function noop(){}module.exports=function eos(stream,opts,callback){if("function"==typeof opts)return eos(stream,null,opts);callback=function(callback){var called=!1;return function(){if(!called){called=!0;for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++)args[_key]=arguments[_key];callback.apply(this,args)}}}(callback||noop);function onlegacyfinish(){stream.writable||onfinish()}function onfinish(){writableEnded=!(writable=!1),readable||callback.call(stream)}function onend(){readableEnded=!(readable=!1),writable||callback.call(stream)}function onerror(err){callback.call(stream,err)}function onclose(){var err;return readable&&!readableEnded?(stream._readableState&&stream._readableState.ended||(err=new ERR_STREAM_PREMATURE_CLOSE),callback.call(stream,err)):writable&&!writableEnded?(stream._writableState&&stream._writableState.ended||(err=new ERR_STREAM_PREMATURE_CLOSE),callback.call(stream,err)):void 0}function onrequest(){stream.req.on("finish",onfinish)}var readable=(opts=opts||{}).readable||!1!==opts.readable&&stream.readable,writable=opts.writable||!1!==opts.writable&&stream.writable,writableEnded=stream._writableState&&stream._writableState.finished,readableEnded=stream._readableState&&stream._readableState.endEmitted;return function(stream){return stream.setHeader&&"function"==typeof stream.abort}(stream)?(stream.on("complete",onfinish),stream.on("abort",onclose),stream.req?onrequest():stream.on("request",onrequest)):writable&&!stream._writableState&&(stream.on("end",onlegacyfinish),stream.on("close",onlegacyfinish)),stream.on("end",onend),stream.on("finish",onfinish),!1!==opts.error&&stream.on("error",onerror),stream.on("close",onclose),function(){stream.removeListener("complete",onfinish),stream.removeListener("abort",onclose),stream.removeListener("request",onrequest),stream.req&&stream.req.removeListener("finish",onfinish),stream.removeListener("end",onlegacyfinish),stream.removeListener("close",onlegacyfinish),stream.removeListener("finish",onfinish),stream.removeListener("end",onend),stream.removeListener("error",onerror),stream.removeListener("close",onclose)}}},{"../../../errors":231}],241:[function(require,module,exports){arguments[4][106][0].apply(exports,arguments)},{dup:106}],242:[function(require,module,exports){"use strict";var eos;var _require$codes=require("../../../errors").codes,ERR_MISSING_ARGS=_require$codes.ERR_MISSING_ARGS,ERR_STREAM_DESTROYED=_require$codes.ERR_STREAM_DESTROYED;function noop(err){if(err)throw err}function destroyer(stream,reading,writing,callback){callback=function(callback){var called=!1;return function(){called||(called=!0,callback.apply(void 0,arguments))}}(callback);var closed=!1,destroyed=(stream.on("close",function(){closed=!0}),(eos=void 0===eos?require("./end-of-stream"):eos)(stream,{readable:reading,writable:writing},function(err){if(err)return callback(err);closed=!0,callback()}),!1);return function(err){if(!closed&&!destroyed)return destroyed=!0,function(stream){return stream.setHeader&&"function"==typeof stream.abort}(stream)?stream.abort():"function"==typeof stream.destroy?stream.destroy():void callback(err||new ERR_STREAM_DESTROYED("pipe"))}}function call(fn){fn()}function pipe(from,to){return from.pipe(to)}module.exports=function(){for(var _len=arguments.length,streams=new Array(_len),_key=0;_key<_len;_key++)streams[_key]=arguments[_key];var error,callback=function(streams){return!streams.length||"function"!=typeof streams[streams.length-1]?noop:streams.pop()}(streams);if((streams=Array.isArray(streams[0])?streams[0]:streams).length<2)throw new ERR_MISSING_ARGS("streams");var destroys=streams.map(function(stream,i){var reading=i<streams.length-1;return destroyer(stream,reading,0<i,function(err){error=error||err,err&&destroys.forEach(call),reading||(destroys.forEach(call),callback(error))})});return streams.reduce(pipe)}},{"../../../errors":231,"./end-of-stream":240}],243:[function(require,module,exports){"use strict";var ERR_INVALID_OPT_VALUE=require("../../../errors").codes.ERR_INVALID_OPT_VALUE;module.exports={getHighWaterMark:function(state,options,duplexKey,isDuplex){if(null==(options=function(options,isDuplex,duplexKey){return null!=options.highWaterMark?options.highWaterMark:isDuplex?options[duplexKey]:null}(options,isDuplex,duplexKey)))return state.objectMode?16:16384;if(!isFinite(options)||Math.floor(options)!==options||options<0)throw new ERR_INVALID_OPT_VALUE(isDuplex?duplexKey:"highWaterMark",options);return Math.floor(options)}}},{"../../../errors":231}],244:[function(require,module,exports){arguments[4][109][0].apply(exports,arguments)},{dup:109,events:178}],245:[function(require,module,exports){arguments[4][110][0].apply(exports,arguments)},{"./lib/_stream_duplex.js":232,"./lib/_stream_passthrough.js":233,"./lib/_stream_readable.js":234,"./lib/_stream_transform.js":235,"./lib/_stream_writable.js":236,"./lib/internal/streams/end-of-stream.js":240,"./lib/internal/streams/pipeline.js":242,dup:110}],246:[function(require,module,exports){"use strict";module.exports=Level;const AbstractLevelDOWN=require("abstract-leveldown").AbstractLevelDOWN,inherits=require("inherits"),parallel=require("run-parallel-limit"),Iterator=require("./iterator"),serialize=require("./util/serialize"),deserialize=require("./util/deserialize"),support=require("./util/support"),clear=require("./util/clear"),createKeyRange=require("./util/key-range"),DEFAULT_PREFIX="level-js-";function Level(location,opts){if(!(this instanceof Level))return new Level(location,opts);if(AbstractLevelDOWN.call(this,{bufferKeys:support.bufferKeys(indexedDB),snapshots:!0,permanence:!0,clear:!0,getMany:!0}),opts=opts||{},"string"!=typeof location)throw new Error("constructor requires a location string argument");this.location=location,this.prefix=null==opts.prefix?DEFAULT_PREFIX:opts.prefix,this.version=parseInt(opts.version||1,10)}inherits(Level,AbstractLevelDOWN),Level.prototype.type="level-js",Level.prototype._open=function(options,callback){const req=indexedDB.open(this.prefix+this.location,this.version);req.onerror=function(){callback(req.error||new Error("unknown error"))},req.onsuccess=()=>{this.db=req.result,callback()},req.onupgradeneeded=ev=>{const db=ev.target.result;db.objectStoreNames.contains(this.location)||db.createObjectStore(this.location)}},Level.prototype.store=function(mode){const transaction=this.db.transaction([this.location],mode);return transaction.objectStore(this.location)},Level.prototype.await=function(request,callback){const transaction=request.transaction;transaction.onabort=function(){callback(transaction.error||new Error("aborted by user"))},transaction.oncomplete=function(){callback(null,request.result)}},Level.prototype._get=function(key,options,callback){const store=this.store("readonly");let req;try{req=store.get(key)}catch(err){return this._nextTick(callback,err)}this.await(req,function(err,value){return err?callback(err):void 0===value?callback(new Error("NotFound")):void callback(null,deserialize(value,options.asBuffer))})},Level.prototype._getMany=function(keys,options,callback){const asBuffer=options.asBuffer,store=this.store("readonly");options=keys.map(key=>next=>{let request;try{request=store.get(key)}catch(err){return next(err)}request.onsuccess=()=>{var value=request.result;next(null,void 0===value?value:deserialize(value,asBuffer))},request.onerror=ev=>{ev.stopPropagation(),next(request.error)}});parallel(options,16,callback)},Level.prototype._del=function(key,options,callback){const store=this.store("readwrite");let req;try{req=store.delete(key)}catch(err){return this._nextTick(callback,err)}this.await(req,callback)},Level.prototype._put=function(key,value,options,callback){const store=this.store("readwrite");let req;try{req=store.put(value,key)}catch(err){return this._nextTick(callback,err)}this.await(req,callback)},Level.prototype._serializeKey=function(key){return serialize(key,this.supports.bufferKeys)},Level.prototype._serializeValue=function(value){return serialize(value,!0)},Level.prototype._iterator=function(options){return new Iterator(this,this.location,options)},Level.prototype._batch=function(operations,options,callback){if(0===operations.length)return this._nextTick(callback);const store=this.store("readwrite"),transaction=store.transaction;let index=0,error;transaction.onabort=function(){callback(error||transaction.error||new Error("aborted by user"))},transaction.oncomplete=function(){callback()},function loop(){var op=operations[index++],key=op.key;let req;try{req="del"===op.type?store.delete(key):store.put(op.value,key)}catch(err){return error=err,void transaction.abort()}index<operations.length&&(req.onsuccess=loop)}()},Level.prototype._clear=function(options,callback){let keyRange,req;try{keyRange=createKeyRange(options)}catch(e){return this._nextTick(callback)}if(0<=options.limit)return clear(this,this.location,keyRange,options,callback);try{const store=this.store("readwrite");req=keyRange?store.delete(keyRange):store.clear()}catch(err){return this._nextTick(callback,err)}this.await(req,callback)},Level.prototype._close=function(callback){this.db.close(),this._nextTick(callback)},Level.prototype.upgrade=function(callback){if("open"!==this.status)return this._nextTick(callback,new Error("cannot upgrade() before open()"));const it=this.iterator(),batchOptions={},self=this;function next(err){if(err)return finish(err);it.next(each)}function each(err,key,value){if(err||void 0===key)return finish(err);err=self._serializeKey(deserialize(key,!0)),value=self._serializeValue(deserialize(value,!0));self._batch([{type:"del",key:key},{type:"put",key:err,value:value}],batchOptions,next)}function finish(err){it.end(function(err2){callback(err||err2)})}it._deserializeKey=it._deserializeValue=function(data){return data},next()},Level.destroy=function(location,prefix,callback){"function"==typeof prefix&&(callback=prefix,prefix=DEFAULT_PREFIX);const request=indexedDB.deleteDatabase(prefix+location);request.onsuccess=function(){callback()},request.onerror=function(err){callback(err)}}},{"./iterator":247,"./util/clear":248,"./util/deserialize":249,"./util/key-range":250,"./util/serialize":251,"./util/support":252,"abstract-leveldown":5,inherits:220,"run-parallel-limit":366}],247:[function(require,module,exports){"use strict";const inherits=require("inherits"),AbstractIterator=require("abstract-leveldown").AbstractIterator,createKeyRange=require("./util/key-range");require=require("./util/deserialize");function noop(){}function Iterator(db,location,options){if(AbstractIterator.call(this,db),this._limit=options.limit,this._count=0,this._callback=null,this._cache=[],this._completed=!1,this._aborted=!1,this._error=null,this._transaction=null,this._keys=options.keys,this._values=options.values,this._keyAsBuffer=options.keyAsBuffer,this._valueAsBuffer=options.valueAsBuffer,0===this._limit)this._completed=!0;else{let keyRange;try{keyRange=createKeyRange(options)}catch(e){return void(this._completed=!0)}this.createIterator(location,keyRange,options.reverse)}}module.exports=Iterator,inherits(Iterator,AbstractIterator),Iterator.prototype.createIterator=function(location,keyRange,reverse){const transaction=this.db.db.transaction([location],"readonly"),store=transaction.objectStore(location),req=store.openCursor(keyRange,reverse?"prev":"next");req.onsuccess=ev=>{ev=ev.target.result;ev&&this.onItem(ev)},(this._transaction=transaction).onabort=()=>{this.onAbort(this._transaction.error||new Error("aborted by user"))},transaction.oncomplete=()=>{this.onComplete()}},Iterator.prototype.onItem=function(cursor){this._cache.push(cursor.key,cursor.value),(this._limit<=0||++this._count<this._limit)&&cursor.continue(),this.maybeNext()},Iterator.prototype.onAbort=function(err){this._aborted=!0,this._error=err,this.maybeNext()},Iterator.prototype.onComplete=function(){this._completed=!0,this.maybeNext()},Iterator.prototype.maybeNext=function(){this._callback&&(this._next(this._callback),this._callback=null)},Iterator.prototype._next=function(callback){if(this._aborted){var err=this._error;this._error=null,this._nextTick(callback,err)}else if(0<this._cache.length){let key=this._cache.shift(),value=this._cache.shift();key=this._keys&&void 0!==key?this._deserializeKey(key,this._keyAsBuffer):void 0,value=this._values&&void 0!==value?this._deserializeValue(value,this._valueAsBuffer):void 0,this._nextTick(callback,null,key,value)}else this._completed?this._nextTick(callback):this._callback=callback},Iterator.prototype._deserializeKey=require,Iterator.prototype._deserializeValue=require,Iterator.prototype._end=function(callback){if(this._aborted||this._completed)return this._nextTick(callback,this._error);this.onItem=noop,this.onAbort=callback,this.onComplete=callback}},{"./util/deserialize":249,"./util/key-range":250,"abstract-leveldown":5,inherits:220}],248:[function(require,module,exports){"use strict";module.exports=function(db,location,keyRange,options,callback){if(0===options.limit)return db._nextTick(callback);const transaction=db.db.transaction([location],"readwrite"),store=transaction.objectStore(location);let count=0;transaction.oncomplete=function(){callback()},transaction.onabort=function(){callback(transaction.error||new Error("aborted by user"))};db=store.openKeyCursor?"openKeyCursor":"openCursor",location=options.reverse?"prev":"next";store[db](keyRange,location).onsuccess=function(ev){const cursor=ev.target.result;cursor&&(store.delete(cursor.key).onsuccess=function(){(options.limit<=0||++count<options.limit)&&cursor.continue()})}}},{}],249:[function(require,module,exports){!function(global){!function(){"use strict";const Buffer=require("buffer").Buffer,ta2str=function(){if(global.TextDecoder){const decoder=new TextDecoder("utf-8");return decoder.decode.bind(decoder)}return function(ta){return ta2buf(ta).toString()}}(),ab2str=function(){if(global.TextDecoder){const decoder=new TextDecoder("utf-8");return decoder.decode.bind(decoder)}return function(ab){return Buffer.from(ab).toString()}}();function ta2buf(ta){const buf=Buffer.from(ta.buffer);return ta.byteLength===ta.buffer.byteLength?buf:buf.slice(ta.byteOffset,ta.byteOffset+ta.byteLength)}module.exports=function(data,asBuffer){return data instanceof Uint8Array?(asBuffer?ta2buf:ta2str)(data):data instanceof ArrayBuffer?asBuffer?Buffer.from(data):ab2str(data):asBuffer?Buffer.from(String(data)):String(data)}}.call(this)}.call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{buffer:112}],250:[function(require,module,exports){"use strict";const ltgt=require("ltgt"),NONE=Symbol("none");module.exports=function(options){var lower=ltgt.lowerBound(options,NONE),upper=ltgt.upperBound(options,NONE),lowerOpen=ltgt.lowerBoundExclusive(options,NONE),options=ltgt.upperBoundExclusive(options,NONE);return lower!==NONE&&upper!==NONE?IDBKeyRange.bound(lower,upper,lowerOpen,options):lower!==NONE?IDBKeyRange.lowerBound(lower,lowerOpen):upper!==NONE?IDBKeyRange.upperBound(upper,options):null}},{ltgt:261}],251:[function(require,module,exports){!function(global){!function(){"use strict";const Buffer=require("buffer").Buffer,str2bin=function(){if(global.TextEncoder){const encoder=new TextEncoder("utf-8");return encoder.encode.bind(encoder)}return Buffer.from}();module.exports=function(data,asBuffer){return asBuffer?Buffer.isBuffer(data)?data:str2bin(String(data)):String(data)}}.call(this)}.call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{buffer:112}],252:[function(require,module,exports){"use strict";const Buffer=require("buffer").Buffer;exports.test=function(key){return function(impl){try{return impl.cmp(key,0),!0}catch(err){return!1}}},exports.bufferKeys=exports.test(Buffer.alloc(0))},{buffer:112}],253:[function(require,module,exports){"use strict";const levelup=require("levelup"),encode=require("encoding-down");module.exports=function(leveldown){function Level(location,options,callback){return"function"==typeof location?callback=location:"function"==typeof options&&(callback=options),isObject(options)||(options=isObject(location)?location:{}),levelup(encode(leveldown(location,options),options),options,callback)}function isObject(o){return"object"==typeof o&&null!==o}for(const m of["destroy","repair"])"function"==typeof leveldown[m]&&(Level[m]=function(...args){leveldown[m](...args)});return Level.errors=levelup.errors,Level}},{"encoding-down":176,levelup:258}],254:[function(require,module,exports){"use strict";function maybeObject(value){return!!value&&Object.assign({},value)}module.exports=function(...manifests){manifests=manifests.reduce((acc,m)=>Object.assign(acc,m),{});return Object.assign(manifests,{bufferKeys:manifests.bufferKeys||!1,snapshots:manifests.snapshots||!1,permanence:manifests.permanence||!1,seek:manifests.seek||!1,clear:manifests.clear||!1,getMany:manifests.getMany||!1,keyIterator:manifests.keyIterator||!1,valueIterator:manifests.valueIterator||!1,iteratorNextv:manifests.iteratorNextv||!1,iteratorAll:manifests.iteratorAll||!1,status:manifests.status||!1,idempotentOpen:manifests.idempotentOpen||!1,passiveOpen:manifests.passiveOpen||!1,serialize:manifests.serialize||!1,createIfMissing:manifests.createIfMissing||!1,errorIfExists:manifests.errorIfExists||!1,deferredOpen:manifests.deferredOpen||!1,openCallback:manifests.openCallback||!1,promises:manifests.promises||!1,streams:manifests.streams||!1,encodings:maybeObject(manifests.encodings),events:maybeObject(manifests.events),additionalMethods:Object.assign({},manifests.additionalMethods)})}},{}],255:[function(require,module,exports){module.exports=require("level-packager")(require("level-js"))},{"level-js":246,"level-packager":253}],256:[function(require,module,exports){"use strict";const WriteError=require("level-errors").WriteError,catering=require("catering"),getCallback=require("./common").getCallback,getOptions=require("./common").getOptions;function Batch(levelup){this.db=levelup,this.batch=levelup.db.batch(),this.ops=[],this.length=0}Batch.prototype.put=function(key,value,options){try{this.batch.put(key,value,options)}catch(e){throw new WriteError(e)}return this.ops.push({...options,type:"put",key:key,value:value}),this.length++,this},Batch.prototype.del=function(key,options){try{this.batch.del(key,options)}catch(err){throw new WriteError(err)}return this.ops.push({...options,type:"del",key:key}),this.length++,this},Batch.prototype.clear=function(){try{this.batch.clear()}catch(err){throw new WriteError(err)}return this.ops=[],this.length=0,this},Batch.prototype.write=function(options,callback){const levelup=this.db,ops=this.ops;callback=getCallback(options,callback),callback=catering.fromCallback(callback),options=getOptions(options);try{this.batch.write(options,function(err){if(err)return callback(new WriteError(err));levelup.emit("batch",ops),callback()})}catch(err){throw new WriteError(err)}return callback.promise},module.exports=Batch},{"./common":257,catering:134,"level-errors":229}],257:[function(require,module,exports){arguments[4][6][0].apply(exports,arguments)},{dup:6}],258:[function(require,module,exports){"use strict";const EventEmitter=require("events").EventEmitter,inherits=require("util").inherits,DeferredLevelDOWN=require("deferred-leveldown"),IteratorStream=require("level-iterator-stream"),Batch=require("./batch");var errors=require("level-errors");const supports=require("level-supports"),catering=require("catering"),getCallback=require("./common").getCallback,getOptions=require("./common").getOptions,nextTick=require("./next-tick"),WriteError=errors.WriteError,ReadError=errors.ReadError,NotFoundError=errors.NotFoundError,OpenError=errors.OpenError,InitializationError=errors.InitializationError;function LevelUP(db,options,callback){if(!(this instanceof LevelUP))return new LevelUP(db,options,callback);var error;if(EventEmitter.call(this),this.setMaxListeners(1/0),"function"==typeof options&&(callback=options,options={}),options=options||{},!db||"object"!=typeof db){if(error=new InitializationError("First argument must be an abstract-leveldown compliant store"),"function"==typeof callback)return nextTick(callback,error);throw error}if("string"!=typeof db.status)throw new Error(".status required, old abstract-leveldown");this.options=getOptions(options),this._db=db,this.db=null,this.open(callback||(err=>{err&&this.emit("error",err)})),this.supports=supports(this.db.supports,{status:!0,deferredOpen:!0,openCallback:!0,promises:!0,streams:!0});for(const method of Object.keys(this.supports.additionalMethods))null==this[method]&&(this[method]=function(...args){return this.db[method](...args)})}function maybeError(db,callback){return!db.isOperational()&&(nextTick(callback,new ReadError("Database is not open")),1)}LevelUP.prototype.emit=EventEmitter.prototype.emit,LevelUP.prototype.once=EventEmitter.prototype.once,inherits(LevelUP,EventEmitter),Object.defineProperty(LevelUP.prototype,"status",{enumerable:!0,get(){return this.db.status}}),LevelUP.prototype.isOperational=function(){return"open"===this.db.status||"opening"===this.db.status},LevelUP.prototype.open=function(opts,callback){return"function"==typeof opts&&(callback=opts,opts=null),callback=catering.fromCallback(callback),opts=opts||this.options,this.db&&this.isOpen()?nextTick(callback,null,this):this.db&&this._isOpening()?this.once("open",()=>{callback(null,this)}):(this.db=new DeferredLevelDOWN(this._db),this.emit("opening"),this.db.open(opts,err=>{if(err)return callback(new OpenError(err));this.db=this._db,callback(null,this),this.emit("open"),this.emit("ready")})),callback.promise},LevelUP.prototype.close=function(callback){return callback=catering.fromCallback(callback),this.isOpen()?(this.db.close((err,...rest)=>{this.emit("closed"),callback(err,...rest)}),this.emit("closing")):this.isClosed()?nextTick(callback):"closing"===this.db.status?this.once("closed",callback):this._isOpening()&&this.once("open",()=>{this.close(callback)}),callback.promise},LevelUP.prototype.isOpen=function(){return"open"===this.db.status},LevelUP.prototype._isOpening=function(){return"opening"===this.db.status},LevelUP.prototype.isClosed=function(){return/^clos|new/.test(this.db.status)},LevelUP.prototype.get=function(key,options,callback){return callback=getCallback(options,callback),maybeError(this,callback=catering.fromCallback(callback))||(options=getOptions(options),this.db.get(key,options,function(err,value){if(err)return err=/notfound/i.test(err)||err.notFound?new NotFoundError("Key not found in database ["+key+"]",err):new ReadError(err),callback(err);callback(null,value)})),callback.promise},LevelUP.prototype.getMany=function(keys,options,callback){return this.db.getMany(keys,options,callback)},LevelUP.prototype.put=function(key,value,options,callback){return callback=getCallback(options,callback),maybeError(this,callback=catering.fromCallback(callback))||(options=getOptions(options),this.db.put(key,value,options,err=>{if(err)return callback(new WriteError(err));this.emit("put",key,value),callback()})),callback.promise},LevelUP.prototype.del=function(key,options,callback){return callback=getCallback(options,callback),maybeError(this,callback=catering.fromCallback(callback))||(options=getOptions(options),this.db.del(key,options,err=>{if(err)return callback(new WriteError(err));this.emit("del",key),callback()})),callback.promise},LevelUP.prototype.batch=function(arr,options,callback){return arguments.length?(callback="function"==typeof arr?arr:getCallback(options,callback),maybeError(this,callback=catering.fromCallback(callback))||(options=getOptions(options),this.db.batch(arr,options,err=>{if(err)return callback(new WriteError(err));this.emit("batch",arr),callback()})),callback.promise):new Batch(this)},LevelUP.prototype.iterator=function(options){return this.db.iterator(options)},LevelUP.prototype.clear=function(options,callback){return callback=getCallback(options,callback),options=getOptions(options),maybeError(this,callback=catering.fromCallback(callback))||this.db.clear(options,err=>{if(err)return callback(new WriteError(err));this.emit("clear",options),callback()}),callback.promise},LevelUP.prototype.readStream=LevelUP.prototype.createReadStream=function(options){return"number"!=typeof(options=Object.assign({keys:!0,values:!0},options)).limit&&(options.limit=-1),new IteratorStream(this.db.iterator(options),options)},LevelUP.prototype.keyStream=LevelUP.prototype.createKeyStream=function(options){return this.createReadStream(Object.assign({},options,{keys:!0,values:!1}))},LevelUP.prototype.valueStream=LevelUP.prototype.createValueStream=function(options){return this.createReadStream(Object.assign({},options,{keys:!1,values:!0}))},LevelUP.prototype.toString=function(){return"LevelUP"},LevelUP.prototype.type="levelup",LevelUP.prototype._nextTick=nextTick,LevelUP.errors=errors,module.exports=LevelUP},{"./batch":256,"./common":257,"./next-tick":259,catering:134,"deferred-leveldown":146,events:178,"level-errors":229,"level-iterator-stream":230,"level-supports":254,util:130}],259:[function(require,module,exports){arguments[4][7][0].apply(exports,arguments)},{dup:7,"queue-microtask":362}],260:[function(require,module,exports){!function(global){!function(){!function(){var undefined,FUNC_ERROR_TEXT="Expected a function",PLACEHOLDER="__lodash_placeholder__",NAN=NaN,wrapFlags=[["ary",128],["bind",1],["bindKey",2],["curry",8],["curryRight",16],["flip",512],["partial",32],["partialRight",64],["rearg",256]],argsTag="[object Arguments]",arrayTag="[object Array]",boolTag="[object Boolean]",dateTag="[object Date]",errorTag="[object Error]",funcTag="[object Function]",genTag="[object GeneratorFunction]",mapTag="[object Map]",numberTag="[object Number]",objectTag="[object Object]",regexpTag="[object RegExp]",setTag="[object Set]",stringTag="[object String]",symbolTag="[object Symbol]",weakMapTag="[object WeakMap]",arrayBufferTag="[object ArrayBuffer]",dataViewTag="[object DataView]",float32Tag="[object Float32Array]",float64Tag="[object Float64Array]",int8Tag="[object Int8Array]",int16Tag="[object Int16Array]",int32Tag="[object Int32Array]",uint8Tag="[object Uint8Array]",uint16Tag="[object Uint16Array]",uint32Tag="[object Uint32Array]",reEmptyStringLeading=/\b__p \+= '';/g,reEmptyStringMiddle=/\b(__p \+=) '' \+/g,reEmptyStringTrailing=/(__e\(.*?\)|\b__t\)) \+\n'';/g,reEscapedHtml=/&(?:amp|lt|gt|quot|#39);/g,reUnescapedHtml=/[&<>"']/g,reHasEscapedHtml=RegExp(reEscapedHtml.source),reHasUnescapedHtml=RegExp(reUnescapedHtml.source),reEscape=/<%-([\s\S]+?)%>/g,reEvaluate=/<%([\s\S]+?)%>/g,reInterpolate=/<%=([\s\S]+?)%>/g,reIsDeepProp=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,reIsPlainProp=/^\w*$/,rePropName=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,reRegExpChar=/[\\^$.*+?()[\]{}|]/g,reHasRegExpChar=RegExp(reRegExpChar.source),reTrimStart=/^\s+/,reWhitespace=/\s/,reWrapComment=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,reWrapDetails=/\{\n\/\* \[wrapped with (.+)\] \*/,reSplitDetails=/,? & /,reAsciiWord=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,reForbiddenIdentifierChars=/[()=,{}\[\]\/\s]/,reEscapeChar=/\\(\\)?/g,reEsTemplate=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,reFlags=/\w*$/,reIsBadHex=/^[-+]0x[0-9a-f]+$/i,reIsBinary=/^0b[01]+$/i,reIsHostCtor=/^\[object .+?Constructor\]$/,reIsOctal=/^0o[0-7]+$/i,reIsUint=/^(?:0|[1-9]\d*)$/,reLatin=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,reNoMatch=/($^)/,reUnescapedString=/['\n\r\u2028\u2029\\]/g,rsComboRange="\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff",rsBreakRange="\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",rsAstral="[\\ud800-\\udfff]",rsBreak="["+rsBreakRange+"]",rsCombo="["+rsComboRange+"]",rsDingbat="[\\u2700-\\u27bf]",rsLower="[a-z\\xdf-\\xf6\\xf8-\\xff]",rsBreakRange="[^\\ud800-\\udfff"+rsBreakRange+"\\d+\\u2700-\\u27bfa-z\\xdf-\\xf6\\xf8-\\xffA-Z\\xc0-\\xd6\\xd8-\\xde]",rsFitz="\\ud83c[\\udffb-\\udfff]",rsNonAstral="[^\\ud800-\\udfff]",rsRegional="(?:\\ud83c[\\udde6-\\uddff]){2}",rsSurrPair="[\\ud800-\\udbff][\\udc00-\\udfff]",rsUpper="[A-Z\\xc0-\\xd6\\xd8-\\xde]",rsBreakRange="(?:"+rsLower+"|"+rsBreakRange+")",reOptMod="(?:"+rsCombo+"|"+rsFitz+")"+"?",reOptMod="[\\ufe0e\\ufe0f]?"+reOptMod+("(?:\\u200d(?:"+[rsNonAstral,rsRegional,rsSurrPair].join("|")+")[\\ufe0e\\ufe0f]?"+reOptMod+")*"),rsDingbat="(?:"+[rsDingbat,rsRegional,rsSurrPair].join("|")+")"+reOptMod,rsNonAstral="(?:"+[rsNonAstral+rsCombo+"?",rsCombo,rsRegional,rsSurrPair,rsAstral].join("|")+")",reApos=RegExp("['’]","g"),reComboMark=RegExp(rsCombo,"g"),reUnicode=RegExp(rsFitz+"(?="+rsFitz+")|"+rsNonAstral+reOptMod,"g"),reUnicodeWord=RegExp([rsUpper+"?"+rsLower+"+(?:['’](?:d|ll|m|re|s|t|ve))?(?="+[rsBreak,rsUpper,"$"].join("|")+")","(?:[A-Z\\xc0-\\xd6\\xd8-\\xde]|[^\\ud800-\\udfff\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000\\d+\\u2700-\\u27bfa-z\\xdf-\\xf6\\xf8-\\xffA-Z\\xc0-\\xd6\\xd8-\\xde])+(?:['’](?:D|LL|M|RE|S|T|VE))?(?="+[rsBreak,rsUpper+rsBreakRange,"$"].join("|")+")",rsUpper+"?"+rsBreakRange+"+(?:['’](?:d|ll|m|re|s|t|ve))?",rsUpper+"+(?:['’](?:D|LL|M|RE|S|T|VE))?","\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])","\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])","\\d+",rsDingbat].join("|"),"g"),reHasUnicode=RegExp("[\\u200d\\ud800-\\udfff"+rsComboRange+"\\ufe0e\\ufe0f]"),reHasUnicodeWord=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,contextProps=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],templateCounter=-1,typedArrayTags={},cloneableTags=(typedArrayTags[float32Tag]=typedArrayTags[float64Tag]=typedArrayTags[int8Tag]=typedArrayTags[int16Tag]=typedArrayTags[int32Tag]=typedArrayTags[uint8Tag]=typedArrayTags["[object Uint8ClampedArray]"]=typedArrayTags[uint16Tag]=typedArrayTags[uint32Tag]=!0,typedArrayTags[argsTag]=typedArrayTags[arrayTag]=typedArrayTags[arrayBufferTag]=typedArrayTags[boolTag]=typedArrayTags[dataViewTag]=typedArrayTags[dateTag]=typedArrayTags[errorTag]=typedArrayTags[funcTag]=typedArrayTags[mapTag]=typedArrayTags[numberTag]=typedArrayTags[objectTag]=typedArrayTags[regexpTag]=typedArrayTags[setTag]=typedArrayTags[stringTag]=typedArrayTags[weakMapTag]=!1,{}),stringEscapes=(cloneableTags[argsTag]=cloneableTags[arrayTag]=cloneableTags[arrayBufferTag]=cloneableTags[dataViewTag]=cloneableTags[boolTag]=cloneableTags[dateTag]=cloneableTags[float32Tag]=cloneableTags[float64Tag]=cloneableTags[int8Tag]=cloneableTags[int16Tag]=cloneableTags[int32Tag]=cloneableTags[mapTag]=cloneableTags[numberTag]=cloneableTags[objectTag]=cloneableTags[regexpTag]=cloneableTags[setTag]=cloneableTags[stringTag]=cloneableTags[symbolTag]=cloneableTags[uint8Tag]=cloneableTags["[object Uint8ClampedArray]"]=cloneableTags[uint16Tag]=cloneableTags[uint32Tag]=!0,cloneableTags[errorTag]=cloneableTags[funcTag]=cloneableTags[weakMapTag]=!1,{"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"}),freeParseFloat=parseFloat,freeParseInt=parseInt,rsRegional="object"==typeof global&&global&&global.Object===Object&&global,rsSurrPair="object"==typeof self&&self&&self.Object===Object&&self,root=rsRegional||rsSurrPair||Function("return this")(),rsAstral="object"==typeof exports&&exports&&!exports.nodeType&&exports,freeModule=rsAstral&&"object"==typeof module&&module&&!module.nodeType&&module,moduleExports=freeModule&&freeModule.exports===rsAstral,freeProcess=moduleExports&&rsRegional.process,rsCombo=function(){try{var types=freeModule&&freeModule.require&&freeModule.require("util").types;return types?types:freeProcess&&freeProcess.binding&&freeProcess.binding("util")}catch(e){}}(),nodeIsArrayBuffer=rsCombo&&rsCombo.isArrayBuffer,nodeIsDate=rsCombo&&rsCombo.isDate,nodeIsMap=rsCombo&&rsCombo.isMap,nodeIsRegExp=rsCombo&&rsCombo.isRegExp,nodeIsSet=rsCombo&&rsCombo.isSet,nodeIsTypedArray=rsCombo&&rsCombo.isTypedArray;function apply(func,thisArg,args){switch(args.length){case 0:return func.call(thisArg);case 1:return func.call(thisArg,args[0]);case 2:return func.call(thisArg,args[0],args[1]);case 3:return func.call(thisArg,args[0],args[1],args[2])}return func.apply(thisArg,args)}function arrayAggregator(array,setter,iteratee,accumulator){for(var index=-1,length=null==array?0:array.length;++index<length;){var value=array[index];setter(accumulator,value,iteratee(value),array)}return accumulator}function arrayEach(array,iteratee){for(var index=-1,length=null==array?0:array.length;++index<length&&!1!==iteratee(array[index],index,array););return array}function arrayEachRight(array,iteratee){for(var length=null==array?0:array.length;length--&&!1!==iteratee(array[length],length,array););return array}function arrayEvery(array,predicate){for(var index=-1,length=null==array?0:array.length;++index<length;)if(!predicate(array[index],index,array))return!1;return!0}function arrayFilter(array,predicate){for(var index=-1,length=null==array?0:array.length,resIndex=0,result=[];++index<length;){var value=array[index];predicate(value,index,array)&&(result[resIndex++]=value)}return result}function arrayIncludes(array,value){return!!(null==array?0:array.length)&&-1<baseIndexOf(array,value,0)}function arrayIncludesWith(array,value,comparator){for(var index=-1,length=null==array?0:array.length;++index<length;)if(comparator(value,array[index]))return!0;return!1}function arrayMap(array,iteratee){for(var index=-1,length=null==array?0:array.length,result=Array(length);++index<length;)result[index]=iteratee(array[index],index,array);return result}function arrayPush(array,values){for(var index=-1,length=values.length,offset=array.length;++index<length;)array[offset+index]=values[index];return array}function arrayReduce(array,iteratee,accumulator,initAccum){var index=-1,length=null==array?0:array.length;for(initAccum&&length&&(accumulator=array[++index]);++index<length;)accumulator=iteratee(accumulator,array[index],index,array);return accumulator}function arrayReduceRight(array,iteratee,accumulator,initAccum){var length=null==array?0:array.length;for(initAccum&&length&&(accumulator=array[--length]);length--;)accumulator=iteratee(accumulator,array[length],length,array);return accumulator}function arraySome(array,predicate){for(var index=-1,length=null==array?0:array.length;++index<length;)if(predicate(array[index],index,array))return!0;return!1}var asciiSize=baseProperty("length");function baseFindKey(collection,predicate,eachFunc){var result;return eachFunc(collection,function(value,key,collection){if(predicate(value,key,collection))return result=key,!1}),result}function baseFindIndex(array,predicate,fromIndex,fromRight){for(var length=array.length,index=fromIndex+(fromRight?1:-1);fromRight?index--:++index<length;)if(predicate(array[index],index,array))return index;return-1}function baseIndexOf(array,value,fromIndex){return value==value?function(array,value,fromIndex){var index=fromIndex-1,length=array.length;for(;++index<length;)if(array[index]===value)return index;return-1}(array,value,fromIndex):baseFindIndex(array,baseIsNaN,fromIndex)}function baseIndexOfWith(array,value,fromIndex,comparator){for(var index=fromIndex-1,length=array.length;++index<length;)if(comparator(array[index],value))return index;return-1}function baseIsNaN(value){return value!=value}function baseMean(array,iteratee){var length=null==array?0:array.length;return length?baseSum(array,iteratee)/length:NAN}function baseProperty(key){return function(object){return null==object?undefined:object[key]}}function basePropertyOf(object){return function(key){return null==object?undefined:object[key]}}function baseReduce(collection,iteratee,accumulator,initAccum,eachFunc){return eachFunc(collection,function(value,index,collection){accumulator=initAccum?(initAccum=!1,value):iteratee(accumulator,value,index,collection)}),accumulator}function baseSum(array,iteratee){for(var result,index=-1,length=array.length;++index<length;){var current=iteratee(array[index]);current!==undefined&&(result=result===undefined?current:result+current)}return result}function baseTimes(n,iteratee){for(var index=-1,result=Array(n);++index<n;)result[index]=iteratee(index);return result}function baseTrim(string){return string&&string.slice(0,trimmedEndIndex(string)+1).replace(reTrimStart,"")}function baseUnary(func){return function(value){return func(value)}}function baseValues(object,props){return arrayMap(props,function(key){return object[key]})}function cacheHas(cache,key){return cache.has(key)}function charsStartIndex(strSymbols,chrSymbols){for(var index=-1,length=strSymbols.length;++index<length&&-1<baseIndexOf(chrSymbols,strSymbols[index],0););return index}function charsEndIndex(strSymbols,chrSymbols){for(var index=strSymbols.length;index--&&-1<baseIndexOf(chrSymbols,strSymbols[index],0););return index}var deburrLetter=basePropertyOf({"À":"A","Á":"A","Â":"A","Ã":"A","Ä":"A","Å":"A","à":"a","á":"a","â":"a","ã":"a","ä":"a","å":"a","Ç":"C","ç":"c","Ð":"D","ð":"d","È":"E","É":"E","Ê":"E","Ë":"E","è":"e","é":"e","ê":"e","ë":"e","Ì":"I","Í":"I","Î":"I","Ï":"I","ì":"i","í":"i","î":"i","ï":"i","Ñ":"N","ñ":"n","Ò":"O","Ó":"O","Ô":"O","Õ":"O","Ö":"O","Ø":"O","ò":"o","ó":"o","ô":"o","õ":"o","ö":"o","ø":"o","Ù":"U","Ú":"U","Û":"U","Ü":"U","ù":"u","ú":"u","û":"u","ü":"u","Ý":"Y","ý":"y","ÿ":"y","Æ":"Ae","æ":"ae","Þ":"Th","þ":"th","ß":"ss","Ā":"A","Ă":"A","Ą":"A","ā":"a","ă":"a","ą":"a","Ć":"C","Ĉ":"C","Ċ":"C","Č":"C","ć":"c","ĉ":"c","ċ":"c","č":"c","Ď":"D","Đ":"D","ď":"d","đ":"d","Ē":"E","Ĕ":"E","Ė":"E","Ę":"E","Ě":"E","ē":"e","ĕ":"e","ė":"e","ę":"e","ě":"e","Ĝ":"G","Ğ":"G","Ġ":"G","Ģ":"G","ĝ":"g","ğ":"g","ġ":"g","ģ":"g","Ĥ":"H","Ħ":"H","ĥ":"h","ħ":"h","Ĩ":"I","Ī":"I","Ĭ":"I","Į":"I","İ":"I","ĩ":"i","ī":"i","ĭ":"i","į":"i","ı":"i","Ĵ":"J","ĵ":"j","Ķ":"K","ķ":"k","ĸ":"k","Ĺ":"L","Ļ":"L","Ľ":"L","Ŀ":"L","Ł":"L","ĺ":"l","ļ":"l","ľ":"l","ŀ":"l","ł":"l","Ń":"N","Ņ":"N","Ň":"N","Ŋ":"N","ń":"n","ņ":"n","ň":"n","ŋ":"n","Ō":"O","Ŏ":"O","Ő":"O","ō":"o","ŏ":"o","ő":"o","Ŕ":"R","Ŗ":"R","Ř":"R","ŕ":"r","ŗ":"r","ř":"r","Ś":"S","Ŝ":"S","Ş":"S","Š":"S","ś":"s","ŝ":"s","ş":"s","š":"s","Ţ":"T","Ť":"T","Ŧ":"T","ţ":"t","ť":"t","ŧ":"t","Ũ":"U","Ū":"U","Ŭ":"U","Ů":"U","Ű":"U","Ų":"U","ũ":"u","ū":"u","ŭ":"u","ů":"u","ű":"u","ų":"u","Ŵ":"W","ŵ":"w","Ŷ":"Y","ŷ":"y","Ÿ":"Y","Ź":"Z","Ż":"Z","Ž":"Z","ź":"z","ż":"z","ž":"z","Ĳ":"IJ","ĳ":"ij","Œ":"Oe","œ":"oe","ŉ":"'n","ſ":"s"}),escapeHtmlChar=basePropertyOf({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"});function escapeStringChar(chr){return"\\"+stringEscapes[chr]}function hasUnicode(string){return reHasUnicode.test(string)}function mapToArray(map){var index=-1,result=Array(map.size);return map.forEach(function(value,key){result[++index]=[key,value]}),result}function overArg(func,transform){return function(arg){return func(transform(arg))}}function replaceHolders(array,placeholder){for(var index=-1,length=array.length,resIndex=0,result=[];++index<length;){var value=array[index];value!==placeholder&&value!==PLACEHOLDER||(array[index]=PLACEHOLDER,result[resIndex++]=index)}return result}function setToArray(set){var index=-1,result=Array(set.size);return set.forEach(function(value){result[++index]=value}),result}function setToPairs(set){var index=-1,result=Array(set.size);return set.forEach(function(value){result[++index]=[value,value]}),result}function stringSize(string){return(hasUnicode(string)?function(string){var result=reUnicode.lastIndex=0;for(;reUnicode.test(string);)++result;return result}:asciiSize)(string)}function stringToArray(string){return hasUnicode(string)?function(string){return string.match(reUnicode)||[]}(string):string.split("")}function trimmedEndIndex(string){for(var index=string.length;index--&&reWhitespace.test(string.charAt(index)););return index}var unescapeHtmlChar=basePropertyOf({"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"});var _=function runInContext(context){var Array=(context=null==context?root:_.defaults(root.Object(),context,_.pick(root,contextProps))).Array,Date=context.Date,Error=context.Error,Function=context.Function,Math=context.Math,Object=context.Object,RegExp=context.RegExp,String=context.String,TypeError=context.TypeError,arrayProto=Array.prototype,funcProto=Function.prototype,objectProto=Object.prototype,coreJsData=context["__core-js_shared__"],funcToString=funcProto.toString,hasOwnProperty=objectProto.hasOwnProperty,idCounter=0,maskSrcKey=(funcProto=/[^.]+$/.exec(coreJsData&&coreJsData.keys&&coreJsData.keys.IE_PROTO||""))?"Symbol(src)_1."+funcProto:"",nativeObjectToString=objectProto.toString,objectCtorString=funcToString.call(Object),oldDash=root._,reIsNative=RegExp("^"+funcToString.call(hasOwnProperty).replace(reRegExpChar,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),funcProto=moduleExports?context.Buffer:undefined,Symbol=context.Symbol,Uint8Array=context.Uint8Array,allocUnsafe=funcProto?funcProto.allocUnsafe:undefined,getPrototype=overArg(Object.getPrototypeOf,Object),objectCreate=Object.create,propertyIsEnumerable=objectProto.propertyIsEnumerable,splice=arrayProto.splice,spreadableSymbol=Symbol?Symbol.isConcatSpreadable:undefined,symIterator=Symbol?Symbol.iterator:undefined,symToStringTag=Symbol?Symbol.toStringTag:undefined,defineProperty=function(){try{var func=getNative(Object,"defineProperty");return func({},"",{}),func}catch(e){}}(),ctxClearTimeout=context.clearTimeout!==root.clearTimeout&&context.clearTimeout,ctxNow=Date&&Date.now!==root.Date.now&&Date.now,ctxSetTimeout=context.setTimeout!==root.setTimeout&&context.setTimeout,nativeCeil=Math.ceil,nativeFloor=Math.floor,nativeGetSymbols=Object.getOwnPropertySymbols,funcProto=funcProto?funcProto.isBuffer:undefined,nativeIsFinite=context.isFinite,nativeJoin=arrayProto.join,nativeKeys=overArg(Object.keys,Object),nativeMax=Math.max,nativeMin=Math.min,nativeNow=Date.now,nativeParseInt=context.parseInt,nativeRandom=Math.random,nativeReverse=arrayProto.reverse,Date=getNative(context,"DataView"),Map=getNative(context,"Map"),Promise=getNative(context,"Promise"),Set=getNative(context,"Set"),context=getNative(context,"WeakMap"),nativeCreate=getNative(Object,"create"),metaMap=context&&new context,realNames={},dataViewCtorString=toSource(Date),mapCtorString=toSource(Map),promiseCtorString=toSource(Promise),setCtorString=toSource(Set),weakMapCtorString=toSource(context),Symbol=Symbol?Symbol.prototype:undefined,symbolValueOf=Symbol?Symbol.valueOf:undefined,symbolToString=Symbol?Symbol.toString:undefined;function lodash(value){if(isObjectLike(value)&&!isArray(value)&&!(value instanceof LazyWrapper)){if(value instanceof LodashWrapper)return value;if(hasOwnProperty.call(value,"__wrapped__"))return wrapperClone(value)}return new LodashWrapper(value)}var baseCreate=function(proto){if(!isObject(proto))return{};if(objectCreate)return objectCreate(proto);object.prototype=proto;proto=new object;return object.prototype=undefined,proto};function object(){}function baseLodash(){}function LodashWrapper(value,chainAll){this.__wrapped__=value,this.__actions__=[],this.__chain__=!!chainAll,this.__index__=0,this.__values__=undefined}function LazyWrapper(value){this.__wrapped__=value,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=4294967295,this.__views__=[]}function Hash(entries){var index=-1,length=null==entries?0:entries.length;for(this.clear();++index<length;){var entry=entries[index];this.set(entry[0],entry[1])}}function ListCache(entries){var index=-1,length=null==entries?0:entries.length;for(this.clear();++index<length;){var entry=entries[index];this.set(entry[0],entry[1])}}function MapCache(entries){var index=-1,length=null==entries?0:entries.length;for(this.clear();++index<length;){var entry=entries[index];this.set(entry[0],entry[1])}}function SetCache(values){var index=-1,length=null==values?0:values.length;for(this.__data__=new MapCache;++index<length;)this.add(values[index])}function Stack(entries){entries=this.__data__=new ListCache(entries);this.size=entries.size}function arrayLikeKeys(value,inherited){var key,isArr=isArray(value),isArg=!isArr&&isArguments(value),isBuff=!isArr&&!isArg&&isBuffer(value),isType=!isArr&&!isArg&&!isBuff&&isTypedArray(value),skipIndexes=isArr||isArg||isBuff||isType,result=skipIndexes?baseTimes(value.length,String):[],length=result.length;for(key in value)!inherited&&!hasOwnProperty.call(value,key)||skipIndexes&&("length"==key||isBuff&&("offset"==key||"parent"==key)||isType&&("buffer"==key||"byteLength"==key||"byteOffset"==key)||isIndex(key,length))||result.push(key);return result}function arraySample(array){var length=array.length;return length?array[baseRandom(0,length-1)]:undefined}function arraySampleSize(array,n){return shuffleSelf(copyArray(array),baseClamp(n,0,array.length))}function arrayShuffle(array){return shuffleSelf(copyArray(array))}function assignMergeValue(object,key,value){(value===undefined||eq(object[key],value))&&(value!==undefined||key in object)||baseAssignValue(object,key,value)}function assignValue(object,key,value){var objValue=object[key];hasOwnProperty.call(object,key)&&eq(objValue,value)&&(value!==undefined||key in object)||baseAssignValue(object,key,value)}function assocIndexOf(array,key){for(var length=array.length;length--;)if(eq(array[length][0],key))return length;return-1}function baseAggregator(collection,setter,iteratee,accumulator){return baseEach(collection,function(value,key,collection){setter(accumulator,value,iteratee(value),collection)}),accumulator}function baseAssign(object,source){return object&&copyObject(source,keys(source),object)}function baseAssignValue(object,key,value){"__proto__"==key&&defineProperty?defineProperty(object,key,{configurable:!0,enumerable:!0,value:value,writable:!0}):object[key]=value}function baseAt(object,paths){for(var index=-1,length=paths.length,result=Array(length),skip=null==object;++index<length;)result[index]=skip?undefined:get(object,paths[index]);return result}function baseClamp(number,lower,upper){return number==number&&(upper!==undefined&&(number=number<=upper?number:upper),lower!==undefined&&(number=lower<=number?number:lower)),number}function baseClone(value,bitmask,customizer,key,object,stack){var result,isDeep=1&bitmask,isFlat=2&bitmask,isFull=4&bitmask;if((result=customizer?object?customizer(value,key,object,stack):customizer(value):result)!==undefined)return result;if(!isObject(value))return value;key=isArray(value);if(key){if(result=function(array){var length=array.length,result=new array.constructor(length);length&&"string"==typeof array[0]&&hasOwnProperty.call(array,"index")&&(result.index=array.index,result.input=array.input);return result}(value),!isDeep)return copyArray(value,result)}else{var tag=getTag(value),isFunc=tag==funcTag||tag==genTag;if(isBuffer(value))return cloneBuffer(value,isDeep);if(tag==objectTag||tag==argsTag||isFunc&&!object){if(result=isFlat||isFunc?{}:initCloneObject(value),!isDeep)return isFlat?function(source,object){return copyObject(source,getSymbolsIn(source),object)}(value,function(object,source){return object&&copyObject(source,keysIn(source),object)}(result,value)):function(source,object){return copyObject(source,getSymbols(source),object)}(value,baseAssign(result,value))}else{if(!cloneableTags[tag])return object?value:{};result=function(object,tag,isDeep){var Ctor=object.constructor;switch(tag){case arrayBufferTag:return cloneArrayBuffer(object);case boolTag:case dateTag:return new Ctor(+object);case dataViewTag:return function(dataView,isDeep){isDeep=isDeep?cloneArrayBuffer(dataView.buffer):dataView.buffer;return new dataView.constructor(isDeep,dataView.byteOffset,dataView.byteLength)}(object,isDeep);case float32Tag:case float64Tag:case int8Tag:case int16Tag:case int32Tag:case uint8Tag:case"[object Uint8ClampedArray]":case uint16Tag:case uint32Tag:return cloneTypedArray(object,isDeep);case mapTag:return new Ctor;case numberTag:case stringTag:return new Ctor(object);case regexpTag:return function(regexp){var result=new regexp.constructor(regexp.source,reFlags.exec(regexp));return result.lastIndex=regexp.lastIndex,result}(object);case setTag:return new Ctor;case symbolTag:return function(symbol){return symbolValueOf?Object(symbolValueOf.call(symbol)):{}}(object)}}(value,tag,isDeep)}}isFunc=(stack=stack||new Stack).get(value);if(isFunc)return isFunc;stack.set(value,result),isSet(value)?value.forEach(function(subValue){result.add(baseClone(subValue,bitmask,customizer,subValue,value,stack))}):isMap(value)&&value.forEach(function(subValue,key){result.set(key,baseClone(subValue,bitmask,customizer,key,value,stack))});var props=key?undefined:(isFull?isFlat?getAllKeysIn:getAllKeys:isFlat?keysIn:keys)(value);return arrayEach(props||value,function(subValue,key){props&&(subValue=value[key=subValue]),assignValue(result,key,baseClone(subValue,bitmask,customizer,key,value,stack))}),result}function baseConformsTo(object,source,props){var length=props.length;if(null==object)return!length;for(object=Object(object);length--;){var key=props[length],predicate=source[key],value=object[key];if(value===undefined&&!(key in object)||!predicate(value))return!1}return!0}function baseDelay(func,wait,args){if("function"!=typeof func)throw new TypeError(FUNC_ERROR_TEXT);return setTimeout(function(){func.apply(undefined,args)},wait)}function baseDifference(array,values,iteratee,comparator){var index=-1,includes=arrayIncludes,isCommon=!0,length=array.length,result=[],valuesLength=values.length;if(!length)return result;iteratee&&(values=arrayMap(values,baseUnary(iteratee))),comparator?(includes=arrayIncludesWith,isCommon=!1):200<=values.length&&(includes=cacheHas,isCommon=!1,values=new SetCache(values));outer:for(;++index<length;){var value=array[index],computed=null==iteratee?value:iteratee(value),value=comparator||0!==value?value:0;if(isCommon&&computed==computed){for(var valuesIndex=valuesLength;valuesIndex--;)if(values[valuesIndex]===computed)continue outer;result.push(value)}else includes(values,computed,comparator)||result.push(value)}return result}lodash.templateSettings={escape:reEscape,evaluate:reEvaluate,interpolate:reInterpolate,variable:"",imports:{_:lodash}},(lodash.prototype=baseLodash.prototype).constructor=lodash,(LodashWrapper.prototype=baseCreate(baseLodash.prototype)).constructor=LodashWrapper,(LazyWrapper.prototype=baseCreate(baseLodash.prototype)).constructor=LazyWrapper,Hash.prototype.clear=function(){this.__data__=nativeCreate?nativeCreate(null):{},this.size=0},Hash.prototype.delete=function(key){return key=this.has(key)&&delete this.__data__[key],this.size-=key?1:0,key},Hash.prototype.get=function(key){var result,data=this.__data__;return nativeCreate?"__lodash_hash_undefined__"===(result=data[key])?undefined:result:hasOwnProperty.call(data,key)?data[key]:undefined},Hash.prototype.has=function(key){var data=this.__data__;return nativeCreate?data[key]!==undefined:hasOwnProperty.call(data,key)},Hash.prototype.set=function(key,value){var data=this.__data__;return this.size+=this.has(key)?0:1,data[key]=nativeCreate&&value===undefined?"__lodash_hash_undefined__":value,this},ListCache.prototype.clear=function(){this.__data__=[],this.size=0},ListCache.prototype.delete=function(key){var data=this.__data__;return!((key=assocIndexOf(data,key))<0)&&(key==data.length-1?data.pop():splice.call(data,key,1),--this.size,!0)},ListCache.prototype.get=function(key){var data=this.__data__;return(key=assocIndexOf(data,key))<0?undefined:data[key][1]},ListCache.prototype.has=function(key){return-1<assocIndexOf(this.__data__,key)},ListCache.prototype.set=function(key,value){var data=this.__data__,index=assocIndexOf(data,key);return index<0?(++this.size,data.push([key,value])):data[index][1]=value,this},MapCache.prototype.clear=function(){this.size=0,this.__data__={hash:new Hash,map:new(Map||ListCache),string:new Hash}},MapCache.prototype.delete=function(key){return key=getMapData(this,key).delete(key),this.size-=key?1:0,key},MapCache.prototype.get=function(key){return getMapData(this,key).get(key)},MapCache.prototype.has=function(key){return getMapData(this,key).has(key)},MapCache.prototype.set=function(key,value){var data=getMapData(this,key),size=data.size;return data.set(key,value),this.size+=data.size==size?0:1,this},SetCache.prototype.add=SetCache.prototype.push=function(value){return this.__data__.set(value,"__lodash_hash_undefined__"),this},SetCache.prototype.has=function(value){return this.__data__.has(value)},Stack.prototype.clear=function(){this.__data__=new ListCache,this.size=0},Stack.prototype.delete=function(key){var data=this.__data__,key=data.delete(key);return this.size=data.size,key},Stack.prototype.get=function(key){return this.__data__.get(key)},Stack.prototype.has=function(key){return this.__data__.has(key)},Stack.prototype.set=function(key,value){var data=this.__data__;if(data instanceof ListCache){var pairs=data.__data__;if(!Map||pairs.length<199)return pairs.push([key,value]),this.size=++data.size,this;data=this.__data__=new MapCache(pairs)}return data.set(key,value),this.size=data.size,this};var baseEach=createBaseEach(baseForOwn),baseEachRight=createBaseEach(baseForOwnRight,!0);function baseEvery(collection,predicate){var result=!0;return baseEach(collection,function(value,index,collection){return result=!!predicate(value,index,collection)}),result}function baseExtremum(array,iteratee,comparator){for(var index=-1,length=array.length;++index<length;){var computed,result,value=array[index],current=iteratee(value);null!=current&&(computed===undefined?current==current&&!isSymbol(current):comparator(current,computed))&&(computed=current,result=value)}return result}function baseFilter(collection,predicate){var result=[];return baseEach(collection,function(value,index,collection){predicate(value,index,collection)&&result.push(value)}),result}function baseFlatten(array,depth,predicate,isStrict,result){var index=-1,length=array.length;for(predicate=predicate||isFlattenable,result=result||[];++index<length;){var value=array[index];0<depth&&predicate(value)?1<depth?baseFlatten(value,depth-1,predicate,isStrict,result):arrayPush(result,value):isStrict||(result[result.length]=value)}return result}var baseFor=createBaseFor(),baseForRight=createBaseFor(!0);function baseForOwn(object,iteratee){return object&&baseFor(object,iteratee,keys)}function baseForOwnRight(object,iteratee){return object&&baseForRight(object,iteratee,keys)}function baseFunctions(object,props){return arrayFilter(props,function(key){return isFunction(object[key])})}function baseGet(object,path){for(var index=0,length=(path=castPath(path,object)).length;null!=object&&index<length;)object=object[toKey(path[index++])];return index&&index==length?object:undefined}function baseGetAllKeys(object,keysFunc,symbolsFunc){keysFunc=keysFunc(object);return isArray(object)?keysFunc:arrayPush(keysFunc,symbolsFunc(object))}function baseGetTag(value){return null==value?value===undefined?"[object Undefined]":"[object Null]":(symToStringTag&&symToStringTag in Object(value)?function(value){var isOwn=hasOwnProperty.call(value,symToStringTag),tag=value[symToStringTag];try{value[symToStringTag]=undefined;var unmasked=!0}catch(e){}var result=nativeObjectToString.call(value);unmasked&&(isOwn?value[symToStringTag]=tag:delete value[symToStringTag]);return result}:function(value){return nativeObjectToString.call(value)})(value)}function baseGt(value,other){return other<value}function baseHas(object,key){return null!=object&&hasOwnProperty.call(object,key)}function baseHasIn(object,key){return null!=object&&key in Object(object)}function baseIntersection(arrays,iteratee,comparator){for(var includes=comparator?arrayIncludesWith:arrayIncludes,length=arrays[0].length,othLength=arrays.length,othIndex=othLength,caches=Array(othLength),maxLength=1/0,result=[];othIndex--;){var array=arrays[othIndex];othIndex&&iteratee&&(array=arrayMap(array,baseUnary(iteratee))),maxLength=nativeMin(array.length,maxLength),caches[othIndex]=!comparator&&(iteratee||120<=length&&120<=array.length)?new SetCache(othIndex&&array):undefined}var array=arrays[0],index=-1,seen=caches[0];outer:for(;++index<length&&result.length<maxLength;){var value=array[index],computed=iteratee?iteratee(value):value,value=comparator||0!==value?value:0;if(!(seen?cacheHas(seen,computed):includes(result,computed,comparator))){for(othIndex=othLength;--othIndex;){var cache=caches[othIndex];if(!(cache?cacheHas(cache,computed):includes(arrays[othIndex],computed,comparator)))continue outer}seen&&seen.push(computed),result.push(value)}}return result}function baseInvoke(object,path,args){path=null==(object=parent(object,path=castPath(path,object)))?object:object[toKey(last(path))];return null==path?undefined:apply(path,object,args)}function baseIsArguments(value){return isObjectLike(value)&&baseGetTag(value)==argsTag}function baseIsEqual(value,other,bitmask,customizer,stack){return value===other||(null==value||null==other||!isObjectLike(value)&&!isObjectLike(other)?value!=value&&other!=other:function(object,other,bitmask,customizer,equalFunc,stack){var objIsArr=isArray(object),othIsArr=isArray(other),objTag=objIsArr?arrayTag:getTag(object),othIsArr=othIsArr?arrayTag:getTag(other),objIsObj=(objTag=objTag==argsTag?objectTag:objTag)==objectTag,othIsObj=(othIsArr=othIsArr==argsTag?objectTag:othIsArr)==objectTag,othIsArr=objTag==othIsArr;if(othIsArr&&isBuffer(object)){if(!isBuffer(other))return!1;objIsObj=!(objIsArr=!0)}if(othIsArr&&!objIsObj)return stack=stack||new Stack,objIsArr||isTypedArray(object)?equalArrays(object,other,bitmask,customizer,equalFunc,stack):function(object,other,tag,bitmask,customizer,equalFunc,stack){switch(tag){case dataViewTag:if(object.byteLength!=other.byteLength||object.byteOffset!=other.byteOffset)return!1;object=object.buffer,other=other.buffer;case arrayBufferTag:return object.byteLength==other.byteLength&&equalFunc(new Uint8Array(object),new Uint8Array(other))?!0:!1;case boolTag:case dateTag:case numberTag:return eq(+object,+other);case errorTag:return object.name==other.name&&object.message==other.message;case regexpTag:case stringTag:return object==other+"";case mapTag:var convert=mapToArray;case setTag:var isPartial=1&bitmask;if(convert=convert||setToArray,object.size!=other.size&&!isPartial)return!1;isPartial=stack.get(object);if(isPartial)return isPartial==other;bitmask|=2,stack.set(object,other);isPartial=equalArrays(convert(object),convert(other),bitmask,customizer,equalFunc,stack);return stack.delete(object),isPartial;case symbolTag:if(symbolValueOf)return symbolValueOf.call(object)==symbolValueOf.call(other)}return!1}(object,other,objTag,bitmask,customizer,equalFunc,stack);if(!(1&bitmask)){objIsArr=objIsObj&&hasOwnProperty.call(object,"__wrapped__"),objTag=othIsObj&&hasOwnProperty.call(other,"__wrapped__");if(objIsArr||objTag)return objIsObj=objIsArr?object.value():object,othIsObj=objTag?other.value():other,stack=stack||new Stack,equalFunc(objIsObj,othIsObj,bitmask,customizer,stack)}return othIsArr&&(stack=stack||new Stack,function(object,other,bitmask,customizer,equalFunc,stack){var isPartial=1&bitmask,objProps=getAllKeys(object),objLength=objProps.length,othLength=getAllKeys(other).length;if(objLength!=othLength&&!isPartial)return!1;var index=objLength;for(;index--;){var key=objProps[index];if(!(isPartial?key in other:hasOwnProperty.call(other,key)))return!1}var othLength=stack.get(object),othStacked=stack.get(other);if(othLength&&othStacked)return othLength==other&&othStacked==object;var result=!0,skipCtor=(stack.set(object,other),stack.set(other,object),isPartial);for(;++index<objLength;){key=objProps[index];var compared,objValue=object[key],othValue=other[key];if(!((compared=customizer?isPartial?customizer(othValue,objValue,key,other,object,stack):customizer(objValue,othValue,key,object,other,stack):compared)===undefined?objValue===othValue||equalFunc(objValue,othValue,bitmask,customizer,stack):compared)){result=!1;break}skipCtor=skipCtor||"constructor"==key}result&&!skipCtor&&(othLength=object.constructor,othStacked=other.constructor,othLength!=othStacked&&"constructor"in object&&"constructor"in other&&!("function"==typeof othLength&&othLength instanceof othLength&&"function"==typeof othStacked&&othStacked instanceof othStacked)&&(result=!1));return stack.delete(object),stack.delete(other),result}(object,other,bitmask,customizer,equalFunc,stack))}(value,other,bitmask,customizer,baseIsEqual,stack))}function baseIsMatch(object,source,matchData,customizer){var index=matchData.length,length=index,noCustomizer=!customizer;if(null==object)return!length;for(object=Object(object);index--;){var data=matchData[index];if(noCustomizer&&data[2]?data[1]!==object[data[0]]:!(data[0]in object))return!1}for(;++index<length;){var key=(data=matchData[index])[0],objValue=object[key],srcValue=data[1];if(noCustomizer&&data[2]){if(objValue===undefined&&!(key in object))return!1}else{var result,stack=new Stack;if(!((result=customizer?customizer(objValue,srcValue,key,object,source,stack):result)===undefined?baseIsEqual(srcValue,objValue,3,customizer,stack):result))return!1}}return!0}function baseIsNative(value){return!(!isObject(value)||(func=value,maskSrcKey&&maskSrcKey in func))&&(isFunction(value)?reIsNative:reIsHostCtor).test(toSource(value));var func}function baseIteratee(value){return"function"==typeof value?value:null==value?identity:"object"==typeof value?isArray(value)?baseMatchesProperty(value[0],value[1]):baseMatches(value):property(value)}function baseKeys(object){if(!isPrototype(object))return nativeKeys(object);var key,result=[];for(key in Object(object))hasOwnProperty.call(object,key)&&"constructor"!=key&&result.push(key);return result}function baseKeysIn(object){if(!isObject(object))return function(object){var result=[];if(null!=object)for(var key in Object(object))result.push(key);return result}(object);var key,isProto=isPrototype(object),result=[];for(key in object)("constructor"!=key||!isProto&&hasOwnProperty.call(object,key))&&result.push(key);return result}function baseLt(value,other){return value<other}function baseMap(collection,iteratee){var index=-1,result=isArrayLike(collection)?Array(collection.length):[];return baseEach(collection,function(value,key,collection){result[++index]=iteratee(value,key,collection)}),result}function baseMatches(source){var matchData=getMatchData(source);return 1==matchData.length&&matchData[0][2]?matchesStrictComparable(matchData[0][0],matchData[0][1]):function(object){return object===source||baseIsMatch(object,source,matchData)}}function baseMatchesProperty(path,srcValue){return isKey(path)&&isStrictComparable(srcValue)?matchesStrictComparable(toKey(path),srcValue):function(object){var objValue=get(object,path);return objValue===undefined&&objValue===srcValue?hasIn(object,path):baseIsEqual(srcValue,objValue,3)}}function baseMerge(object,source,srcIndex,customizer,stack){object!==source&&baseFor(source,function(srcValue,key){var newValue;stack=stack||new Stack,isObject(srcValue)?function(object,source,key,srcIndex,mergeFunc,customizer,stack){var isArr,isBuff,isTyped,objValue=safeGet(object,key),srcValue=safeGet(source,key),stacked=stack.get(srcValue);stacked?assignMergeValue(object,key,stacked):(stacked=customizer?customizer(objValue,srcValue,key+"",object,source,stack):undefined,(source=stacked===undefined)&&(isArr=isArray(srcValue),isBuff=!isArr&&isBuffer(srcValue),isTyped=!isArr&&!isBuff&&isTypedArray(srcValue),stacked=srcValue,isArr||isBuff||isTyped?stacked=isArray(objValue)?objValue:isArrayLikeObject(objValue)?copyArray(objValue):isBuff?cloneBuffer(srcValue,!(source=!1)):isTyped?cloneTypedArray(srcValue,!(source=!1)):[]:isPlainObject(srcValue)||isArguments(srcValue)?isArguments(stacked=objValue)?stacked=toPlainObject(objValue):isObject(objValue)&&!isFunction(objValue)||(stacked=initCloneObject(srcValue)):source=!1),source&&(stack.set(srcValue,stacked),mergeFunc(stacked,srcValue,srcIndex,customizer,stack),stack.delete(srcValue)),assignMergeValue(object,key,stacked))}(object,source,key,srcIndex,baseMerge,customizer,stack):(newValue=customizer?customizer(safeGet(object,key),srcValue,key+"",object,source,stack):undefined,assignMergeValue(object,key,newValue=newValue===undefined?srcValue:newValue))},keysIn)}function baseNth(array,n){var length=array.length;if(length)return isIndex(n+=n<0?length:0,length)?array[n]:undefined}function baseOrderBy(collection,iteratees,orders){iteratees=iteratees.length?arrayMap(iteratees,function(iteratee){return isArray(iteratee)?function(value){return baseGet(value,1===iteratee.length?iteratee[0]:iteratee)}:iteratee}):[identity];var index=-1;iteratees=arrayMap(iteratees,baseUnary(getIteratee()));var array=baseMap(collection,function(value,key,collection){return{criteria:arrayMap(iteratees,function(iteratee){return iteratee(value)}),index:++index,value:value}}),collection=function(object,other){return function(object,other,orders){var index=-1,objCriteria=object.criteria,othCriteria=other.criteria,length=objCriteria.length,ordersLength=orders.length;for(;++index<length;){var result=compareAscending(objCriteria[index],othCriteria[index]);if(result){if(ordersLength<=index)return result;var order=orders[index];return result*("desc"==order?-1:1)}}return object.index-other.index}(object,other,orders)},length=array.length;for(array.sort(collection);length--;)array[length]=array[length].value;return array}function basePickBy(object,paths,predicate){for(var index=-1,length=paths.length,result={};++index<length;){var path=paths[index],value=baseGet(object,path);predicate(value,path)&&baseSet(result,castPath(path,object),value)}return result}function basePullAll(array,values,iteratee,comparator){var indexOf=comparator?baseIndexOfWith:baseIndexOf,index=-1,length=values.length,seen=array;for(array===values&&(values=copyArray(values)),iteratee&&(seen=arrayMap(array,baseUnary(iteratee)));++index<length;)for(var fromIndex=0,value=values[index],computed=iteratee?iteratee(value):value;-1<(fromIndex=indexOf(seen,computed,fromIndex,comparator));)seen!==array&&splice.call(seen,fromIndex,1),splice.call(array,fromIndex,1);return array}function basePullAt(array,indexes){for(var length=array?indexes.length:0,lastIndex=length-1;length--;){var previous,index=indexes[length];length!=lastIndex&&index===previous||(isIndex(previous=index)?splice.call(array,index,1):baseUnset(array,index))}}function baseRandom(lower,upper){return lower+nativeFloor(nativeRandom()*(upper-lower+1))}function baseRepeat(string,n){var result="";if(!string||n<1||9007199254740991<n)return result;for(;n%2&&(result+=string),(n=nativeFloor(n/2))&&(string+=string),n;);return result}function baseRest(func,start){return setToString(overRest(func,start,identity),func+"")}function baseSample(collection){return arraySample(values(collection))}function baseSampleSize(collection,n){collection=values(collection);return shuffleSelf(collection,baseClamp(n,0,collection.length))}function baseSet(object,path,value,customizer){if(!isObject(object))return object;for(var index=-1,length=(path=castPath(path,object)).length,lastIndex=length-1,nested=object;null!=nested&&++index<length;){var objValue,key=toKey(path[index]),newValue=value;if("__proto__"===key||"constructor"===key||"prototype"===key)return object;index!=lastIndex&&(objValue=nested[key],(newValue=customizer?customizer(objValue,key,nested):undefined)===undefined&&(newValue=isObject(objValue)?objValue:isIndex(path[index+1])?[]:{})),assignValue(nested,key,newValue),nested=nested[key]}return object}var baseSetData=metaMap?function(func,data){return metaMap.set(func,data),func}:identity,Symbol=defineProperty?function(func,string){return defineProperty(func,"toString",{configurable:!0,enumerable:!1,value:constant(string),writable:!0})}:identity;function baseShuffle(collection){return shuffleSelf(values(collection))}function baseSlice(array,start,end){for(var index=-1,length=array.length,result=((end=length<end?length:end)<0&&(end+=length),length=end<(start=start<0?length<-start?0:length+start:start)?0:end-start>>>0,start>>>=0,Array(length));++index<length;)result[index]=array[index+start];return result}function baseSome(collection,predicate){var result;return baseEach(collection,function(value,index,collection){return!(result=predicate(value,index,collection))}),!!result}function baseSortedIndex(array,value,retHighest){var low=0,high=null==array?low:array.length;if("number"==typeof value&&value==value&&high<=2147483647){for(;low<high;){var mid=low+high>>>1,computed=array[mid];null!==computed&&!isSymbol(computed)&&(retHighest?computed<=value:computed<value)?low=1+mid:high=mid}return high}return baseSortedIndexBy(array,value,identity,retHighest)}function baseSortedIndexBy(array,value,iteratee,retHighest){var low=0,high=null==array?0:array.length;if(0===high)return 0;for(var valIsNaN=(value=iteratee(value))!=value,valIsNull=null===value,valIsSymbol=isSymbol(value),valIsUndefined=value===undefined;low<high;){var mid=nativeFloor((low+high)/2),computed=iteratee(array[mid]),othIsDefined=computed!==undefined,othIsNull=null===computed,othIsReflexive=computed==computed,othIsSymbol=isSymbol(computed),othIsReflexive=valIsNaN?retHighest||othIsReflexive:valIsUndefined?othIsReflexive&&(retHighest||othIsDefined):valIsNull?othIsReflexive&&othIsDefined&&(retHighest||!othIsNull):valIsSymbol?othIsReflexive&&othIsDefined&&!othIsNull&&(retHighest||!othIsSymbol):!othIsNull&&!othIsSymbol&&(retHighest?computed<=value:computed<value);othIsReflexive?low=mid+1:high=mid}return nativeMin(high,4294967294)}function baseSortedUniq(array,iteratee){for(var index=-1,length=array.length,resIndex=0,result=[];++index<length;){var seen,value=array[index],computed=iteratee?iteratee(value):value;index&&eq(computed,seen)||(seen=computed,result[resIndex++]=0===value?0:value)}return result}function baseToNumber(value){return"number"==typeof value?value:isSymbol(value)?NAN:+value}function baseToString(value){if("string"==typeof value)return value;if(isArray(value))return arrayMap(value,baseToString)+"";if(isSymbol(value))return symbolToString?symbolToString.call(value):"";var result=value+"";return"0"==result&&1/value==-1/0?"-0":result}function baseUniq(array,iteratee,comparator){var index=-1,includes=arrayIncludes,length=array.length,isCommon=!0,result=[],seen=result;if(comparator)isCommon=!1,includes=arrayIncludesWith;else if(200<=length){var set=iteratee?null:createSet(array);if(set)return setToArray(set);isCommon=!1,includes=cacheHas,seen=new SetCache}else seen=iteratee?[]:result;outer:for(;++index<length;){var value=array[index],computed=iteratee?iteratee(value):value,value=comparator||0!==value?value:0;if(isCommon&&computed==computed){for(var seenIndex=seen.length;seenIndex--;)if(seen[seenIndex]===computed)continue outer;iteratee&&seen.push(computed),result.push(value)}else includes(seen,computed,comparator)||(seen!==result&&seen.push(computed),result.push(value))}return result}function baseUnset(object,path){return null==(object=parent(object,path=castPath(path,object)))||delete object[toKey(last(path))]}function baseUpdate(object,path,updater,customizer){return baseSet(object,path,updater(baseGet(object,path)),customizer)}function baseWhile(array,predicate,isDrop,fromRight){for(var length=array.length,index=fromRight?length:-1;(fromRight?index--:++index<length)&&predicate(array[index],index,array););return isDrop?baseSlice(array,fromRight?0:index,fromRight?index+1:length):baseSlice(array,fromRight?index+1:0,fromRight?length:index)}function baseWrapperValue(value,actions){var result=value;return arrayReduce(actions,function(result,action){return action.func.apply(action.thisArg,arrayPush([result],action.args))},result=value instanceof LazyWrapper?value.value():result)}function baseXor(arrays,iteratee,comparator){var length=arrays.length;if(length<2)return length?baseUniq(arrays[0]):[];for(var index=-1,result=Array(length);++index<length;)for(var array=arrays[index],othIndex=-1;++othIndex<length;)othIndex!=index&&(result[index]=baseDifference(result[index]||array,arrays[othIndex],iteratee,comparator));return baseUniq(baseFlatten(result,1),iteratee,comparator)}function baseZipObject(props,values,assignFunc){for(var index=-1,length=props.length,valsLength=values.length,result={};++index<length;){var value=index<valsLength?values[index]:undefined;assignFunc(result,props[index],value)}return result}function castArrayLikeObject(value){return isArrayLikeObject(value)?value:[]}function castFunction(value){return"function"==typeof value?value:identity}function castPath(value,object){return isArray(value)?value:isKey(value,object)?[value]:stringToPath(toString(value))}var castRest=baseRest;function castSlice(array,start,end){var length=array.length;return end=end===undefined?length:end,!start&&length<=end?array:baseSlice(array,start,end)}var clearTimeout=ctxClearTimeout||function(id){return root.clearTimeout(id)};function cloneBuffer(buffer,isDeep){if(isDeep)return buffer.slice();isDeep=buffer.length,isDeep=allocUnsafe?allocUnsafe(isDeep):new buffer.constructor(isDeep);return buffer.copy(isDeep),isDeep}function cloneArrayBuffer(arrayBuffer){var result=new arrayBuffer.constructor(arrayBuffer.byteLength);return new Uint8Array(result).set(new Uint8Array(arrayBuffer)),result}function cloneTypedArray(typedArray,isDeep){isDeep=isDeep?cloneArrayBuffer(typedArray.buffer):typedArray.buffer;return new typedArray.constructor(isDeep,typedArray.byteOffset,typedArray.length)}function compareAscending(value,other){if(value!==other){var valIsDefined=value!==undefined,valIsNull=null===value,valIsReflexive=value==value,valIsSymbol=isSymbol(value),othIsDefined=other!==undefined,othIsNull=null===other,othIsReflexive=other==other,othIsSymbol=isSymbol(other);if(!othIsNull&&!othIsSymbol&&!valIsSymbol&&other<value||valIsSymbol&&othIsDefined&&othIsReflexive&&!othIsNull&&!othIsSymbol||valIsNull&&othIsDefined&&othIsReflexive||!valIsDefined&&othIsReflexive||!valIsReflexive)return 1;if(!valIsNull&&!valIsSymbol&&!othIsSymbol&&value<other||othIsSymbol&&valIsDefined&&valIsReflexive&&!valIsNull&&!valIsSymbol||othIsNull&&valIsDefined&&valIsReflexive||!othIsDefined&&valIsReflexive||!othIsReflexive)return-1}return 0}function composeArgs(args,partials,holders,isCurried){for(var argsIndex=-1,argsLength=args.length,holdersLength=holders.length,leftIndex=-1,leftLength=partials.length,rangeLength=nativeMax(argsLength-holdersLength,0),result=Array(leftLength+rangeLength),isUncurried=!isCurried;++leftIndex<leftLength;)result[leftIndex]=partials[leftIndex];for(;++argsIndex<holdersLength;)(isUncurried||argsIndex<argsLength)&&(result[holders[argsIndex]]=args[argsIndex]);for(;rangeLength--;)result[leftIndex++]=args[argsIndex++];return result}function composeArgsRight(args,partials,holders,isCurried){for(var argsIndex=-1,argsLength=args.length,holdersIndex=-1,holdersLength=holders.length,rightIndex=-1,rightLength=partials.length,rangeLength=nativeMax(argsLength-holdersLength,0),result=Array(rangeLength+rightLength),isUncurried=!isCurried;++argsIndex<rangeLength;)result[argsIndex]=args[argsIndex];for(var offset=argsIndex;++rightIndex<rightLength;)result[offset+rightIndex]=partials[rightIndex];for(;++holdersIndex<holdersLength;)(isUncurried||argsIndex<argsLength)&&(result[offset+holders[holdersIndex]]=args[argsIndex++]);return result}function copyArray(source,array){var index=-1,length=source.length;for(array=array||Array(length);++index<length;)array[index]=source[index];return array}function copyObject(source,props,object,customizer){for(var isNew=!object,index=(object=object||{},-1),length=props.length;++index<length;){var key=props[index],newValue=customizer?customizer(object[key],source[key],key,object,source):undefined;(isNew?baseAssignValue:assignValue)(object,key,newValue=newValue===undefined?source[key]:newValue)}return object}function createAggregator(setter,initializer){return function(collection,iteratee){var func=isArray(collection)?arrayAggregator:baseAggregator,accumulator=initializer?initializer():{};return func(collection,setter,getIteratee(iteratee,2),accumulator)}}function createAssigner(assigner){return baseRest(function(object,sources){var index=-1,length=sources.length,customizer=1<length?sources[length-1]:undefined,guard=2<length?sources[2]:undefined,customizer=3<assigner.length&&"function"==typeof customizer?(length--,customizer):undefined;for(guard&&isIterateeCall(sources[0],sources[1],guard)&&(customizer=length<3?undefined:customizer,length=1),object=Object(object);++index<length;){var source=sources[index];source&&assigner(object,source,index,customizer)}return object})}function createBaseEach(eachFunc,fromRight){return function(collection,iteratee){if(null==collection)return collection;if(!isArrayLike(collection))return eachFunc(collection,iteratee);for(var length=collection.length,index=fromRight?length:-1,iterable=Object(collection);(fromRight?index--:++index<length)&&!1!==iteratee(iterable[index],index,iterable););return collection}}function createBaseFor(fromRight){return function(object,iteratee,keysFunc){for(var index=-1,iterable=Object(object),props=keysFunc(object),length=props.length;length--;){var key=props[fromRight?length:++index];if(!1===iteratee(iterable[key],key,iterable))break}return object}}function createCaseFirst(methodName){return function(string){var strSymbols=hasUnicode(string=toString(string))?stringToArray(string):undefined,chr=strSymbols?strSymbols[0]:string.charAt(0),strSymbols=strSymbols?castSlice(strSymbols,1).join(""):string.slice(1);return chr[methodName]()+strSymbols}}function createCompounder(callback){return function(string){return arrayReduce(words(deburr(string).replace(reApos,"")),callback,"")}}function createCtor(Ctor){return function(){var args=arguments;switch(args.length){case 0:return new Ctor;case 1:return new Ctor(args[0]);case 2:return new Ctor(args[0],args[1]);case 3:return new Ctor(args[0],args[1],args[2]);case 4:return new Ctor(args[0],args[1],args[2],args[3]);case 5:return new Ctor(args[0],args[1],args[2],args[3],args[4]);case 6:return new Ctor(args[0],args[1],args[2],args[3],args[4],args[5]);case 7:return new Ctor(args[0],args[1],args[2],args[3],args[4],args[5],args[6])}var thisBinding=baseCreate(Ctor.prototype),result=Ctor.apply(thisBinding,args);return isObject(result)?result:thisBinding}}function createCurry(func,bitmask,arity){var Ctor=createCtor(func);return function wrapper(){for(var length=arguments.length,args=Array(length),index=length,placeholder=getHolder(wrapper);index--;)args[index]=arguments[index];placeholder=length<3&&args[0]!==placeholder&&args[length-1]!==placeholder?[]:replaceHolders(args,placeholder);return(length-=placeholder.length)<arity?createRecurry(func,bitmask,createHybrid,wrapper.placeholder,undefined,args,placeholder,undefined,undefined,arity-length):apply(this&&this!==root&&this instanceof wrapper?Ctor:func,this,args)}}function createFind(findIndexFunc){return function(collection,predicate,fromIndex){var iteratee,iterable=Object(collection),predicate=(isArrayLike(collection)||(iteratee=getIteratee(predicate,3),collection=keys(collection),predicate=function(key){return iteratee(iterable[key],key,iterable)}),findIndexFunc(collection,predicate,fromIndex));return-1<predicate?iterable[iteratee?collection[predicate]:predicate]:undefined}}function createFlow(fromRight){return flatRest(function(funcs){var length=funcs.length,index=length,prereq=LodashWrapper.prototype.thru;for(fromRight&&funcs.reverse();index--;){var func=funcs[index];if("function"!=typeof func)throw new TypeError(FUNC_ERROR_TEXT);prereq&&!wrapper&&"wrapper"==getFuncName(func)&&(wrapper=new LodashWrapper([],!0))}for(index=wrapper?index:length;++index<length;)var funcName=getFuncName(func=funcs[index]),data="wrapper"==funcName?getData(func):undefined,wrapper=data&&isLaziable(data[0])&&424==data[1]&&!data[4].length&&1==data[9]?wrapper[getFuncName(data[0])].apply(wrapper,data[3]):1==func.length&&isLaziable(func)?wrapper[funcName]():wrapper.thru(func);return function(){var args=arguments,value=args[0];if(wrapper&&1==args.length&&isArray(value))return wrapper.plant(value).value();for(var index=0,result=length?funcs[index].apply(this,args):value;++index<length;)result=funcs[index].call(this,result);return result}})}function createHybrid(func,bitmask,thisArg,partials,holders,partialsRight,holdersRight,argPos,ary,arity){var isAry=128&bitmask,isBind=1&bitmask,isBindKey=2&bitmask,isCurried=24&bitmask,isFlip=512&bitmask,Ctor=isBindKey?undefined:createCtor(func);return function wrapper(){for(var args=Array(length=arguments.length),index=length;index--;)args[index]=arguments[index];if(isCurried&&(holdersCount=function(array,placeholder){for(var length=array.length,result=0;length--;)array[length]===placeholder&&++result;return result}(args,placeholder=getHolder(wrapper))),partials&&(args=composeArgs(args,partials,holders,isCurried)),partialsRight&&(args=composeArgsRight(args,partialsRight,holdersRight,isCurried)),length-=holdersCount,isCurried&&length<arity)return holdersCount=replaceHolders(args,placeholder),createRecurry(func,bitmask,createHybrid,wrapper.placeholder,thisArg,args,holdersCount,argPos,ary,arity-length);var placeholder=isBind?thisArg:this,holdersCount=isBindKey?placeholder[func]:func,length=args.length;return argPos?args=function(array,indexes){for(var arrLength=array.length,length=nativeMin(indexes.length,arrLength),oldArray=copyArray(array);length--;){var index=indexes[length];array[length]=isIndex(index,arrLength)?oldArray[index]:undefined}return array}(args,argPos):isFlip&&1<length&&args.reverse(),isAry&&ary<length&&(args.length=ary),(holdersCount=this&&this!==root&&this instanceof wrapper?Ctor||createCtor(holdersCount):holdersCount).apply(placeholder,args)}}function createInverter(setter,toIteratee){return function(object,iteratee){return function(object,setter,iteratee,accumulator){return baseForOwn(object,function(value,key,object){setter(accumulator,iteratee(value),key,object)}),accumulator}(object,setter,toIteratee(iteratee),{})}}function createMathOperation(operator,defaultValue){return function(value,other){var result;if(value===undefined&&other===undefined)return defaultValue;if(value!==undefined&&(result=value),other!==undefined){if(result===undefined)return other;other="string"==typeof value||"string"==typeof other?(value=baseToString(value),baseToString(other)):(value=baseToNumber(value),baseToNumber(other)),result=operator(value,other)}return result}}function createOver(arrayFunc){return flatRest(function(iteratees){return iteratees=arrayMap(iteratees,baseUnary(getIteratee())),baseRest(function(args){var thisArg=this;return arrayFunc(iteratees,function(iteratee){return apply(iteratee,thisArg,args)})})})}function createPadding(length,chars){var charsLength=(chars=chars===undefined?" ":baseToString(chars)).length;if(charsLength<2)return charsLength?baseRepeat(chars,length):chars;charsLength=baseRepeat(chars,nativeCeil(length/stringSize(chars)));return hasUnicode(chars)?castSlice(stringToArray(charsLength),0,length).join(""):charsLength.slice(0,length)}function createPartial(func,bitmask,thisArg,partials){var isBind=1&bitmask,Ctor=createCtor(func);return function wrapper(){for(var argsIndex=-1,argsLength=arguments.length,leftIndex=-1,leftLength=partials.length,args=Array(leftLength+argsLength),fn=this&&this!==root&&this instanceof wrapper?Ctor:func;++leftIndex<leftLength;)args[leftIndex]=partials[leftIndex];for(;argsLength--;)args[leftIndex++]=arguments[++argsIndex];return apply(fn,isBind?thisArg:this,args)}}function createRange(fromRight){return function(start,end,step){return step&&"number"!=typeof step&&isIterateeCall(start,end,step)&&(end=step=undefined),start=toFinite(start),end===undefined?(end=start,start=0):end=toFinite(end),function(start,end,step,fromRight){for(var index=-1,length=nativeMax(nativeCeil((end-start)/(step||1)),0),result=Array(length);length--;)result[fromRight?length:++index]=start,start+=step;return result}(start,end,step=step===undefined?start<end?1:-1:toFinite(step),fromRight)}}function createRelationalOperation(operator){return function(value,other){return"string"==typeof value&&"string"==typeof other||(value=toNumber(value),other=toNumber(other)),operator(value,other)}}function createRecurry(func,bitmask,wrapFunc,placeholder,thisArg,partials,holders,argPos,ary,arity){var isCurry=8&bitmask,thisArg=(4&(bitmask=(bitmask|(isCurry?32:64))&~(isCurry?64:32))||(bitmask&=-4),[func,bitmask,thisArg,isCurry?partials:undefined,isCurry?holders:undefined,isCurry?undefined:partials,isCurry?undefined:holders,argPos,ary,arity]),partials=wrapFunc.apply(undefined,thisArg);return isLaziable(func)&&setData(partials,thisArg),partials.placeholder=placeholder,setWrapToString(partials,func,bitmask)}function createRound(methodName){var func=Math[methodName];return function(number,precision){var pair;return number=toNumber(number),(precision=null==precision?0:nativeMin(toInteger(precision),292))&&nativeIsFinite(number)?(pair=(toString(number)+"e").split("e"),+((pair=(toString(func(pair[0]+"e"+(+pair[1]+precision)))+"e").split("e"))[0]+"e"+(+pair[1]-precision))):func(number)}}var createSet=Set&&1/setToArray(new Set([,-0]))[1]==1/0?function(values){return new Set(values)}:noop;function createToPairs(keysFunc){return function(object){var tag=getTag(object);return tag==mapTag?mapToArray(object):tag==setTag?setToPairs(object):function(object,props){return arrayMap(props,function(key){return[key,object[key]]})}(object,keysFunc(object))}}function createWrap(func,bitmask,thisArg,partials,holders,argPos,ary,arity){var isBindKey=2&bitmask;if(!isBindKey&&"function"!=typeof func)throw new TypeError(FUNC_ERROR_TEXT);var holdersRight,length=partials?partials.length:0,data=(length||(bitmask&=-97,partials=holders=undefined),ary=ary===undefined?ary:nativeMax(toInteger(ary),0),arity=arity===undefined?arity:toInteger(arity),length-=holders?holders.length:0,64&bitmask&&(partialsRight=partials,holdersRight=holders,partials=holders=undefined),isBindKey?undefined:getData(func)),partialsRight=[func,bitmask,thisArg,partials,holders,partialsRight,holdersRight,argPos,ary,arity];return data&&function(data,source){var bitmask=data[1],srcBitmask=source[1],newBitmask=bitmask|srcBitmask,isCommon=newBitmask<131,isCombo=128==srcBitmask&&8==bitmask||128==srcBitmask&&256==bitmask&&data[7].length<=source[8]||384==srcBitmask&&source[7].length<=source[8]&&8==bitmask;if(!isCommon&&!isCombo)return;1&srcBitmask&&(data[2]=source[2],newBitmask|=1&bitmask?0:4);isCommon=source[3];{var partials;isCommon&&(partials=data[3],data[3]=partials?composeArgs(partials,isCommon,source[4]):isCommon,data[4]=partials?replaceHolders(data[3],PLACEHOLDER):source[4])}(isCommon=source[5])&&(partials=data[5],data[5]=partials?composeArgsRight(partials,isCommon,source[6]):isCommon,data[6]=partials?replaceHolders(data[5],PLACEHOLDER):source[6]);(isCommon=source[7])&&(data[7]=isCommon);128&srcBitmask&&(data[8]=null==data[8]?source[8]:nativeMin(data[8],source[8]));null==data[9]&&(data[9]=source[9]);data[0]=source[0],data[1]=newBitmask}(partialsRight,data),func=partialsRight[0],bitmask=partialsRight[1],thisArg=partialsRight[2],partials=partialsRight[3],holders=partialsRight[4],!(arity=partialsRight[9]=partialsRight[9]===undefined?isBindKey?0:func.length:nativeMax(partialsRight[9]-length,0))&&24&bitmask&&(bitmask&=-25),holdersRight=bitmask&&1!=bitmask?8==bitmask||16==bitmask?createCurry(func,bitmask,arity):32!=bitmask&&33!=bitmask||holders.length?createHybrid.apply(undefined,partialsRight):createPartial(func,bitmask,thisArg,partials):function(func,bitmask,thisArg){var isBind=1&bitmask,Ctor=createCtor(func);return function wrapper(){return(this&&this!==root&&this instanceof wrapper?Ctor:func).apply(isBind?thisArg:this,arguments)}}(func,bitmask,thisArg),setWrapToString((data?baseSetData:setData)(holdersRight,partialsRight),func,bitmask)}function customDefaultsAssignIn(objValue,srcValue,key,object){return objValue===undefined||eq(objValue,objectProto[key])&&!hasOwnProperty.call(object,key)?srcValue:objValue}function customDefaultsMerge(objValue,srcValue,key,object,source,stack){return isObject(objValue)&&isObject(srcValue)&&(stack.set(srcValue,objValue),baseMerge(objValue,srcValue,undefined,customDefaultsMerge,stack),stack.delete(srcValue)),objValue}function customOmitClone(value){return isPlainObject(value)?undefined:value}function equalArrays(array,other,bitmask,customizer,equalFunc,stack){var isPartial=1&bitmask,arrLength=array.length,othLength=other.length;if(arrLength!=othLength&&!(isPartial&&arrLength<othLength))return!1;var othLength=stack.get(array),othStacked=stack.get(other);if(othLength&&othStacked)return othLength==other&&othStacked==array;var index=-1,result=!0,seen=2&bitmask?new SetCache:undefined;for(stack.set(array,other),stack.set(other,array);++index<arrLength;){var compared,arrValue=array[index],othValue=other[index];if((compared=customizer?isPartial?customizer(othValue,arrValue,index,other,array,stack):customizer(arrValue,othValue,index,array,other,stack):compared)!==undefined){if(compared)continue;result=!1;break}if(seen){if(!arraySome(other,function(othValue,othIndex){return!cacheHas(seen,othIndex)&&(arrValue===othValue||equalFunc(arrValue,othValue,bitmask,customizer,stack))&&seen.push(othIndex)})){result=!1;break}}else if(arrValue!==othValue&&!equalFunc(arrValue,othValue,bitmask,customizer,stack)){result=!1;break}}return stack.delete(array),stack.delete(other),result}function flatRest(func){return setToString(overRest(func,undefined,flatten),func+"")}function getAllKeys(object){return baseGetAllKeys(object,keys,getSymbols)}function getAllKeysIn(object){return baseGetAllKeys(object,keysIn,getSymbolsIn)}var getData=metaMap?function(func){return metaMap.get(func)}:noop;function getFuncName(func){for(var result=func.name+"",array=realNames[result],length=hasOwnProperty.call(realNames,result)?array.length:0;length--;){var data=array[length],otherFunc=data.func;if(null==otherFunc||otherFunc==func)return data.name}return result}function getHolder(func){return(hasOwnProperty.call(lodash,"placeholder")?lodash:func).placeholder}function getIteratee(){var result=(result=lodash.iteratee||iteratee)===iteratee?baseIteratee:result;return arguments.length?result(arguments[0],arguments[1]):result}function getMapData(map,key){var value,type,map=map.__data__;return("string"==(type=typeof(value=key))||"number"==type||"symbol"==type||"boolean"==type?"__proto__"!==value:null===value)?map["string"==typeof key?"string":"hash"]:map.map}function getMatchData(object){for(var result=keys(object),length=result.length;length--;){var key=result[length],value=object[key];result[length]=[key,value,isStrictComparable(value)]}return result}function getNative(object,key){object=function(object,key){return null==object?undefined:object[key]}(object,key);return baseIsNative(object)?object:undefined}var getSymbols=nativeGetSymbols?function(object){return null==object?[]:(object=Object(object),arrayFilter(nativeGetSymbols(object),function(symbol){return propertyIsEnumerable.call(object,symbol)}))}:stubArray,getSymbolsIn=nativeGetSymbols?function(object){for(var result=[];object;)arrayPush(result,getSymbols(object)),object=getPrototype(object);return result}:stubArray,getTag=baseGetTag;function hasPath(object,path,hasFunc){for(var index=-1,length=(path=castPath(path,object)).length,result=!1;++index<length;){var key=toKey(path[index]);if(!(result=null!=object&&hasFunc(object,key)))break;object=object[key]}return result||++index!=length?result:!!(length=null==object?0:object.length)&&isLength(length)&&isIndex(key,length)&&(isArray(object)||isArguments(object))}function initCloneObject(object){return"function"!=typeof object.constructor||isPrototype(object)?{}:baseCreate(getPrototype(object))}function isFlattenable(value){return isArray(value)||isArguments(value)||!!(spreadableSymbol&&value&&value[spreadableSymbol])}function isIndex(value,length){var type=typeof value;return!!(length=null==length?9007199254740991:length)&&("number"==type||"symbol"!=type&&reIsUint.test(value))&&-1<value&&value%1==0&&value<length}function isIterateeCall(value,index,object){var type;if(isObject(object))return type=typeof index,("number"==type?isArrayLike(object)&&isIndex(index,object.length):"string"==type&&index in object)&&eq(object[index],value)}function isKey(value,object){var type;if(!isArray(value))return type=typeof value,"number"==type||"symbol"==type||"boolean"==type||null==value||isSymbol(value)||(reIsPlainProp.test(value)||!reIsDeepProp.test(value)||null!=object&&value in Object(object))}function isLaziable(func){var funcName=getFuncName(func),other=lodash[funcName];if("function"==typeof other&&funcName in LazyWrapper.prototype){if(func===other)return 1;funcName=getData(other);return funcName&&func===funcName[0]}}(Date&&getTag(new Date(new ArrayBuffer(1)))!=dataViewTag||Map&&getTag(new Map)!=mapTag||Promise&&"[object Promise]"!=getTag(Promise.resolve())||Set&&getTag(new Set)!=setTag||context&&getTag(new context)!=weakMapTag)&&(getTag=function(value){var result=baseGetTag(value),value=result==objectTag?value.constructor:undefined,value=value?toSource(value):"";if(value)switch(value){case dataViewCtorString:return dataViewTag;case mapCtorString:return mapTag;case promiseCtorString:return"[object Promise]";case setCtorString:return setTag;case weakMapCtorString:return weakMapTag}return result});var isMaskable=coreJsData?isFunction:stubFalse;function isPrototype(value){var Ctor=value&&value.constructor;return value===("function"==typeof Ctor&&Ctor.prototype||objectProto)}function isStrictComparable(value){return value==value&&!isObject(value)}function matchesStrictComparable(key,srcValue){return function(object){return null!=object&&(object[key]===srcValue&&(srcValue!==undefined||key in Object(object)))}}function overRest(func,start,transform){return start=nativeMax(start===undefined?func.length-1:start,0),function(){for(var args=arguments,index=-1,length=nativeMax(args.length-start,0),array=Array(length);++index<length;)array[index]=args[start+index];for(var index=-1,otherArgs=Array(start+1);++index<start;)otherArgs[index]=args[index];return otherArgs[start]=transform(array),apply(func,this,otherArgs)}}function parent(object,path){return path.length<2?object:baseGet(object,baseSlice(path,0,-1))}function safeGet(object,key){if(("constructor"!==key||"function"!=typeof object[key])&&"__proto__"!=key)return object[key]}var setData=shortOut(baseSetData),setTimeout=ctxSetTimeout||function(func,wait){return root.setTimeout(func,wait)},setToString=shortOut(Symbol);function setWrapToString(wrapper,reference,bitmask){reference+="";return setToString(wrapper,function(source,details){var length=details.length;if(!length)return source;var lastIndex=length-1;return details[lastIndex]=(1<length?"& ":"")+details[lastIndex],details=details.join(2<length?", ":" "),source.replace(reWrapComment,"{\n/* [wrapped with "+details+"] */\n")}(reference,function(details,bitmask){return arrayEach(wrapFlags,function(pair){var value="_."+pair[0];bitmask&pair[1]&&!arrayIncludes(details,value)&&details.push(value)}),details.sort()}(function(source){return(source=source.match(reWrapDetails))?source[1].split(reSplitDetails):[]}(reference),bitmask)))}function shortOut(func){var count=0,lastCalled=0;return function(){var stamp=nativeNow(),remaining=16-(stamp-lastCalled);if(lastCalled=stamp,0<remaining){if(800<=++count)return arguments[0]}else count=0;return func.apply(undefined,arguments)}}function shuffleSelf(array,size){var index=-1,length=array.length,lastIndex=length-1;for(size=size===undefined?length:size;++index<size;){var rand=baseRandom(index,lastIndex),value=array[rand];array[rand]=array[index],array[index]=value}return array.length=size,array}cache=(ctxClearTimeout=memoize(ctxClearTimeout=function(string){var result=[];return 46===string.charCodeAt(0)&&result.push(""),string.replace(rePropName,function(match,number,quote,subString){result.push(quote?subString.replace(reEscapeChar,"$1"):number||match)}),result},function(key){return 500===cache.size&&cache.clear(),key})).cache;var cache,stringToPath=ctxClearTimeout;function toKey(value){if("string"==typeof value||isSymbol(value))return value;var result=value+"";return"0"==result&&1/value==-1/0?"-0":result}function toSource(func){if(null!=func){try{return funcToString.call(func)}catch(e){}try{return func+""}catch(e){}}return""}function wrapperClone(wrapper){if(wrapper instanceof LazyWrapper)return wrapper.clone();var result=new LodashWrapper(wrapper.__wrapped__,wrapper.__chain__);return result.__actions__=copyArray(wrapper.__actions__),result.__index__=wrapper.__index__,result.__values__=wrapper.__values__,result}Date=baseRest(function(array,values){return isArrayLikeObject(array)?baseDifference(array,baseFlatten(values,1,isArrayLikeObject,!0)):[]}),Promise=baseRest(function(array,values){var iteratee=last(values);return isArrayLikeObject(iteratee)&&(iteratee=undefined),isArrayLikeObject(array)?baseDifference(array,baseFlatten(values,1,isArrayLikeObject,!0),getIteratee(iteratee,2)):[]}),context=baseRest(function(array,values){var comparator=last(values);return isArrayLikeObject(comparator)&&(comparator=undefined),isArrayLikeObject(array)?baseDifference(array,baseFlatten(values,1,isArrayLikeObject,!0),undefined,comparator):[]});function findIndex(array,predicate,fromIndex){var length=null==array?0:array.length;if(!length)return-1;fromIndex=null==fromIndex?0:toInteger(fromIndex);return fromIndex<0&&(fromIndex=nativeMax(length+fromIndex,0)),baseFindIndex(array,getIteratee(predicate,3),fromIndex)}function findLastIndex(array,predicate,fromIndex){var length=null==array?0:array.length;if(!length)return-1;var index=length-1;return fromIndex!==undefined&&(index=toInteger(fromIndex),index=fromIndex<0?nativeMax(length+index,0):nativeMin(index,length-1)),baseFindIndex(array,getIteratee(predicate,3),index,!0)}function flatten(array){return(null==array?0:array.length)?baseFlatten(array,1):[]}function head(array){return array&&array.length?array[0]:undefined}coreJsData=baseRest(function(arrays){var mapped=arrayMap(arrays,castArrayLikeObject);return mapped.length&&mapped[0]===arrays[0]?baseIntersection(mapped):[]}),ctxSetTimeout=baseRest(function(arrays){var iteratee=last(arrays),mapped=arrayMap(arrays,castArrayLikeObject);return iteratee===last(mapped)?iteratee=undefined:mapped.pop(),mapped.length&&mapped[0]===arrays[0]?baseIntersection(mapped,getIteratee(iteratee,2)):[]}),Symbol=baseRest(function(arrays){var comparator=last(arrays),mapped=arrayMap(arrays,castArrayLikeObject);return(comparator="function"==typeof comparator?comparator:undefined)&&mapped.pop(),mapped.length&&mapped[0]===arrays[0]?baseIntersection(mapped,undefined,comparator):[]});function last(array){var length=null==array?0:array.length;return length?array[length-1]:undefined}ctxClearTimeout=baseRest(pullAll);function pullAll(array,values){return array&&array.length&&values&&values.length?basePullAll(array,values):array}var pullAt=flatRest(function(array,indexes){var length=null==array?0:array.length,result=baseAt(array,indexes);return basePullAt(array,arrayMap(indexes,function(index){return isIndex(index,length)?+index:index}).sort(compareAscending)),result});function reverse(array){return null==array?array:nativeReverse.call(array)}var union=baseRest(function(arrays){return baseUniq(baseFlatten(arrays,1,isArrayLikeObject,!0))}),unionBy=baseRest(function(arrays){var iteratee=last(arrays);return isArrayLikeObject(iteratee)&&(iteratee=undefined),baseUniq(baseFlatten(arrays,1,isArrayLikeObject,!0),getIteratee(iteratee,2))}),unionWith=baseRest(function(arrays){var comparator="function"==typeof(comparator=last(arrays))?comparator:undefined;return baseUniq(baseFlatten(arrays,1,isArrayLikeObject,!0),undefined,comparator)});function unzip(array){if(!array||!array.length)return[];var length=0;return array=arrayFilter(array,function(group){return isArrayLikeObject(group)&&(length=nativeMax(group.length,length),1)}),baseTimes(length,function(index){return arrayMap(array,baseProperty(index))})}function unzipWith(array,iteratee){if(!array||!array.length)return[];array=unzip(array);return null==iteratee?array:arrayMap(array,function(group){return apply(iteratee,undefined,group)})}var without=baseRest(function(array,values){return isArrayLikeObject(array)?baseDifference(array,values):[]}),xor=baseRest(function(arrays){return baseXor(arrayFilter(arrays,isArrayLikeObject))}),xorBy=baseRest(function(arrays){var iteratee=last(arrays);return isArrayLikeObject(iteratee)&&(iteratee=undefined),baseXor(arrayFilter(arrays,isArrayLikeObject),getIteratee(iteratee,2))}),xorWith=baseRest(function(arrays){var comparator="function"==typeof(comparator=last(arrays))?comparator:undefined;return baseXor(arrayFilter(arrays,isArrayLikeObject),undefined,comparator)}),zip=baseRest(unzip);var zipWith=baseRest(function(arrays){var length=arrays.length,length="function"==typeof(length=1<length?arrays[length-1]:undefined)?(arrays.pop(),length):undefined;return unzipWith(arrays,length)});function chain(value){value=lodash(value);return value.__chain__=!0,value}function thru(value,interceptor){return interceptor(value)}var wrapperAt=flatRest(function(paths){function interceptor(object){return baseAt(object,paths)}var length=paths.length,start=length?paths[0]:0,value=this.__wrapped__;return!(1<length||this.__actions__.length)&&value instanceof LazyWrapper&&isIndex(start)?((value=value.slice(start,+start+(length?1:0))).__actions__.push({func:thru,args:[interceptor],thisArg:undefined}),new LodashWrapper(value,this.__chain__).thru(function(array){return length&&!array.length&&array.push(undefined),array})):this.thru(interceptor)});var countBy=createAggregator(function(result,value,key){hasOwnProperty.call(result,key)?++result[key]:baseAssignValue(result,key,1)});var find=createFind(findIndex),findLast=createFind(findLastIndex);function forEach(collection,iteratee){return(isArray(collection)?arrayEach:baseEach)(collection,getIteratee(iteratee,3))}function forEachRight(collection,iteratee){return(isArray(collection)?arrayEachRight:baseEachRight)(collection,getIteratee(iteratee,3))}var groupBy=createAggregator(function(result,value,key){hasOwnProperty.call(result,key)?result[key].push(value):baseAssignValue(result,key,[value])});var invokeMap=baseRest(function(collection,path,args){var index=-1,isFunc="function"==typeof path,result=isArrayLike(collection)?Array(collection.length):[];return baseEach(collection,function(value){result[++index]=isFunc?apply(path,value,args):baseInvoke(value,path,args)}),result}),keyBy=createAggregator(function(result,value,key){baseAssignValue(result,key,value)});function map(collection,iteratee){return(isArray(collection)?arrayMap:baseMap)(collection,getIteratee(iteratee,3))}var partition=createAggregator(function(result,value,key){result[key?0:1].push(value)},function(){return[[],[]]});var sortBy=baseRest(function(collection,iteratees){if(null==collection)return[];var length=iteratees.length;return 1<length&&isIterateeCall(collection,iteratees[0],iteratees[1])?iteratees=[]:2<length&&isIterateeCall(iteratees[0],iteratees[1],iteratees[2])&&(iteratees=[iteratees[0]]),baseOrderBy(collection,baseFlatten(iteratees,1),[])}),now=ctxNow||function(){return root.Date.now()};function ary(func,n,guard){return n=guard?undefined:n,n=func&&null==n?func.length:n,createWrap(func,128,undefined,undefined,undefined,undefined,n)}function before(n,func){var result;if("function"!=typeof func)throw new TypeError(FUNC_ERROR_TEXT);return n=toInteger(n),function(){return 0<--n&&(result=func.apply(this,arguments)),n<=1&&(func=undefined),result}}var bind=baseRest(function(func,thisArg,partials){var holders,bitmask=1;return partials.length&&(holders=replaceHolders(partials,getHolder(bind)),bitmask|=32),createWrap(func,bitmask,thisArg,partials,holders)}),bindKey=baseRest(function(object,key,partials){var holders,bitmask=3;return partials.length&&(holders=replaceHolders(partials,getHolder(bindKey)),bitmask|=32),createWrap(key,bitmask,object,partials,holders)});function debounce(func,wait,options){var lastArgs,lastThis,maxWait,result,timerId,lastCallTime,lastInvokeTime=0,leading=!1,maxing=!1,trailing=!0;if("function"!=typeof func)throw new TypeError(FUNC_ERROR_TEXT);function invokeFunc(time){var args=lastArgs,thisArg=lastThis;return lastArgs=lastThis=undefined,lastInvokeTime=time,result=func.apply(thisArg,args)}function shouldInvoke(time){var timeSinceLastCall=time-lastCallTime;return lastCallTime===undefined||wait<=timeSinceLastCall||timeSinceLastCall<0||maxing&&maxWait<=time-lastInvokeTime}function timerExpired(){var time=now();if(shouldInvoke(time))return trailingEdge(time);timerId=setTimeout(timerExpired,function(time){var timeWaiting=wait-(time-lastCallTime);return maxing?nativeMin(timeWaiting,maxWait-(time-lastInvokeTime)):timeWaiting}(time))}function trailingEdge(time){return timerId=undefined,trailing&&lastArgs?invokeFunc(time):(lastArgs=lastThis=undefined,result)}function debounced(){var time=now(),isInvoking=shouldInvoke(time);if(lastArgs=arguments,lastThis=this,lastCallTime=time,isInvoking){if(timerId===undefined)return function(time){return lastInvokeTime=time,timerId=setTimeout(timerExpired,wait),leading?invokeFunc(time):result}(lastCallTime);if(maxing)return clearTimeout(timerId),timerId=setTimeout(timerExpired,wait),invokeFunc(lastCallTime)}return timerId===undefined&&(timerId=setTimeout(timerExpired,wait)),result}return wait=toNumber(wait)||0,isObject(options)&&(leading=!!options.leading,maxing="maxWait"in options,maxWait=maxing?nativeMax(toNumber(options.maxWait)||0,wait):maxWait,trailing="trailing"in options?!!options.trailing:trailing),debounced.cancel=function(){timerId!==undefined&&clearTimeout(timerId),lastInvokeTime=0,lastArgs=lastCallTime=lastThis=timerId=undefined},debounced.flush=function(){return timerId===undefined?result:trailingEdge(now())},debounced}var ctxNow=baseRest(function(func,args){return baseDelay(func,1,args)}),delay=baseRest(function(func,wait,args){return baseDelay(func,toNumber(wait)||0,args)});function memoize(func,resolver){if("function"!=typeof func||null!=resolver&&"function"!=typeof resolver)throw new TypeError(FUNC_ERROR_TEXT);function memoized(){var args=arguments,key=resolver?resolver.apply(this,args):args[0],cache=memoized.cache;return cache.has(key)?cache.get(key):(args=func.apply(this,args),memoized.cache=cache.set(key,args)||cache,args)}return memoized.cache=new(memoize.Cache||MapCache),memoized}function negate(predicate){if("function"!=typeof predicate)throw new TypeError(FUNC_ERROR_TEXT);return function(){var args=arguments;switch(args.length){case 0:return!predicate.call(this);case 1:return!predicate.call(this,args[0]);case 2:return!predicate.call(this,args[0],args[1]);case 3:return!predicate.call(this,args[0],args[1],args[2])}return!predicate.apply(this,args)}}memoize.Cache=MapCache;var castRest=castRest(function(func,transforms){var funcsLength=(transforms=1==transforms.length&&isArray(transforms[0])?arrayMap(transforms[0],baseUnary(getIteratee())):arrayMap(baseFlatten(transforms,1),baseUnary(getIteratee()))).length;return baseRest(function(args){for(var index=-1,length=nativeMin(args.length,funcsLength);++index<length;)args[index]=transforms[index].call(this,args[index]);return apply(func,this,args)})}),partial=baseRest(function(func,partials){var holders=replaceHolders(partials,getHolder(partial));return createWrap(func,32,undefined,partials,holders)}),partialRight=baseRest(function(func,partials){var holders=replaceHolders(partials,getHolder(partialRight));return createWrap(func,64,undefined,partials,holders)}),rearg=flatRest(function(func,indexes){return createWrap(func,256,undefined,undefined,undefined,indexes)});function eq(value,other){return value===other||value!=value&&other!=other}var gt=createRelationalOperation(baseGt),gte=createRelationalOperation(function(value,other){return other<=value}),isArguments=baseIsArguments(function(){return arguments}())?baseIsArguments:function(value){return isObjectLike(value)&&hasOwnProperty.call(value,"callee")&&!propertyIsEnumerable.call(value,"callee")},isArray=Array.isArray,isArrayBuffer=nodeIsArrayBuffer?baseUnary(nodeIsArrayBuffer):function(value){return isObjectLike(value)&&baseGetTag(value)==arrayBufferTag};function isArrayLike(value){return null!=value&&isLength(value.length)&&!isFunction(value)}function isArrayLikeObject(value){return isObjectLike(value)&&isArrayLike(value)}var isBuffer=funcProto||stubFalse,funcProto=nodeIsDate?baseUnary(nodeIsDate):function(value){return isObjectLike(value)&&baseGetTag(value)==dateTag};function isError(value){if(!isObjectLike(value))return!1;var tag=baseGetTag(value);return tag==errorTag||"[object DOMException]"==tag||"string"==typeof value.message&&"string"==typeof value.name&&!isPlainObject(value)}function isFunction(value){if(!isObject(value))return!1;value=baseGetTag(value);return value==funcTag||value==genTag||"[object AsyncFunction]"==value||"[object Proxy]"==value}function isInteger(value){return"number"==typeof value&&value==toInteger(value)}function isLength(value){return"number"==typeof value&&-1<value&&value%1==0&&value<=9007199254740991}function isObject(value){var type=typeof value;return null!=value&&("object"==type||"function"==type)}function isObjectLike(value){return null!=value&&"object"==typeof value}var isMap=nodeIsMap?baseUnary(nodeIsMap):function(value){return isObjectLike(value)&&getTag(value)==mapTag};function isNumber(value){return"number"==typeof value||isObjectLike(value)&&baseGetTag(value)==numberTag}function isPlainObject(value){if(!isObjectLike(value)||baseGetTag(value)!=objectTag)return!1;value=getPrototype(value);if(null===value)return!0;value=hasOwnProperty.call(value,"constructor")&&value.constructor;return"function"==typeof value&&value instanceof value&&funcToString.call(value)==objectCtorString}var isRegExp=nodeIsRegExp?baseUnary(nodeIsRegExp):function(value){return isObjectLike(value)&&baseGetTag(value)==regexpTag};var isSet=nodeIsSet?baseUnary(nodeIsSet):function(value){return isObjectLike(value)&&getTag(value)==setTag};function isString(value){return"string"==typeof value||!isArray(value)&&isObjectLike(value)&&baseGetTag(value)==stringTag}function isSymbol(value){return"symbol"==typeof value||isObjectLike(value)&&baseGetTag(value)==symbolTag}var isTypedArray=nodeIsTypedArray?baseUnary(nodeIsTypedArray):function(value){return isObjectLike(value)&&isLength(value.length)&&!!typedArrayTags[baseGetTag(value)]};var lt=createRelationalOperation(baseLt),lte=createRelationalOperation(function(value,other){return value<=other});function toArray(value){if(!value)return[];if(isArrayLike(value))return(isString(value)?stringToArray:copyArray)(value);if(symIterator&&value[symIterator]){for(var data,iterator=value[symIterator](),result=[];!(data=iterator.next()).done;)result.push(data.value);return result}var tag=getTag(value);return(tag==mapTag?mapToArray:tag==setTag?setToArray:values)(value)}function toFinite(value){return value?(value=toNumber(value))===1/0||value===-1/0?17976931348623157e292*(value<0?-1:1):value==value?value:0:0===value?value:0}function toInteger(value){var value=toFinite(value),remainder=value%1;return value==value?remainder?value-remainder:value:0}function toLength(value){return value?baseClamp(toInteger(value),0,4294967295):0}function toNumber(value){if("number"==typeof value)return value;if(isSymbol(value))return NAN;if("string"!=typeof(value=isObject(value)?isObject(other="function"==typeof value.valueOf?value.valueOf():value)?other+"":other:value))return 0===value?value:+value;value=baseTrim(value);var other=reIsBinary.test(value);return other||reIsOctal.test(value)?freeParseInt(value.slice(2),other?2:8):reIsBadHex.test(value)?NAN:+value}function toPlainObject(value){return copyObject(value,keysIn(value))}function toString(value){return null==value?"":baseToString(value)}var assign=createAssigner(function(object,source){if(isPrototype(source)||isArrayLike(source))copyObject(source,keys(source),object);else for(var key in source)hasOwnProperty.call(source,key)&&assignValue(object,key,source[key])}),assignIn=createAssigner(function(object,source){copyObject(source,keysIn(source),object)}),assignInWith=createAssigner(function(object,source,srcIndex,customizer){copyObject(source,keysIn(source),object,customizer)}),assignWith=createAssigner(function(object,source,srcIndex,customizer){copyObject(source,keys(source),object,customizer)}),at=flatRest(baseAt);var defaults=baseRest(function(object,sources){object=Object(object);var index=-1,length=sources.length,guard=2<length?sources[2]:undefined;for(guard&&isIterateeCall(sources[0],sources[1],guard)&&(length=1);++index<length;)for(var source=sources[index],props=keysIn(source),propsIndex=-1,propsLength=props.length;++propsIndex<propsLength;){var key=props[propsIndex],value=object[key];(value===undefined||eq(value,objectProto[key])&&!hasOwnProperty.call(object,key))&&(object[key]=source[key])}return object}),defaultsDeep=baseRest(function(args){return args.push(undefined,customDefaultsMerge),apply(mergeWith,undefined,args)});function get(object,path,defaultValue){object=null==object?undefined:baseGet(object,path);return object===undefined?defaultValue:object}function hasIn(object,path){return null!=object&&hasPath(object,path,baseHasIn)}var invert=createInverter(function(result,value,key){result[value=null!=value&&"function"!=typeof value.toString?nativeObjectToString.call(value):value]=key},constant(identity)),invertBy=createInverter(function(result,value,key){null!=value&&"function"!=typeof value.toString&&(value=nativeObjectToString.call(value)),hasOwnProperty.call(result,value)?result[value].push(key):result[value]=[key]},getIteratee),invoke=baseRest(baseInvoke);function keys(object){return(isArrayLike(object)?arrayLikeKeys:baseKeys)(object)}function keysIn(object){return isArrayLike(object)?arrayLikeKeys(object,!0):baseKeysIn(object)}var merge=createAssigner(function(object,source,srcIndex){baseMerge(object,source,srcIndex)}),mergeWith=createAssigner(function(object,source,srcIndex,customizer){baseMerge(object,source,srcIndex,customizer)}),omit=flatRest(function(object,paths){var result={};if(null==object)return result;for(var isDeep=!1,length=(paths=arrayMap(paths,function(path){return path=castPath(path,object),isDeep=isDeep||1<path.length,path}),copyObject(object,getAllKeysIn(object),result),isDeep&&(result=baseClone(result,7,customOmitClone)),paths.length);length--;)baseUnset(result,paths[length]);return result});var pick=flatRest(function(object,paths){return null==object?{}:function(object,paths){return basePickBy(object,paths,function(value,path){return hasIn(object,path)})}(object,paths)});function pickBy(object,predicate){if(null==object)return{};var props=arrayMap(getAllKeysIn(object),function(prop){return[prop]});return predicate=getIteratee(predicate),basePickBy(object,props,function(value,path){return predicate(value,path[0])})}var toPairs=createToPairs(keys),toPairsIn=createToPairs(keysIn);function values(object){return null==object?[]:baseValues(object,keys(object))}var camelCase=createCompounder(function(result,word,index){return word=word.toLowerCase(),result+(index?capitalize(word):word)});function capitalize(string){return upperFirst(toString(string).toLowerCase())}function deburr(string){return(string=toString(string))&&string.replace(reLatin,deburrLetter).replace(reComboMark,"")}var kebabCase=createCompounder(function(result,word,index){return result+(index?"-":"")+word.toLowerCase()}),lowerCase=createCompounder(function(result,word,index){return result+(index?" ":"")+word.toLowerCase()}),lowerFirst=createCaseFirst("toLowerCase");var snakeCase=createCompounder(function(result,word,index){return result+(index?"_":"")+word.toLowerCase()});var startCase=createCompounder(function(result,word,index){return result+(index?" ":"")+upperFirst(word)});var upperCase=createCompounder(function(result,word,index){return result+(index?" ":"")+word.toUpperCase()}),upperFirst=createCaseFirst("toUpperCase");function words(string,pattern,guard){return string=toString(string),(pattern=guard?undefined:pattern)===undefined?(function(string){return reHasUnicodeWord.test(string)}(string)?function(string){return string.match(reUnicodeWord)||[]}:function(string){return string.match(reAsciiWord)||[]})(string):string.match(pattern)||[]}var attempt=baseRest(function(func,args){try{return apply(func,undefined,args)}catch(e){return isError(e)?e:new Error(e)}}),bindAll=flatRest(function(object,methodNames){return arrayEach(methodNames,function(key){key=toKey(key),baseAssignValue(object,key,bind(object[key],object))}),object});function constant(value){return function(){return value}}var flow=createFlow(),flowRight=createFlow(!0);function identity(value){return value}function iteratee(func){return baseIteratee("function"==typeof func?func:baseClone(func,1))}var method=baseRest(function(path,args){return function(object){return baseInvoke(object,path,args)}}),methodOf=baseRest(function(object,args){return function(path){return baseInvoke(object,path,args)}});function mixin(object,source,options){var props=keys(source),methodNames=baseFunctions(source,props),chain=(null!=options||isObject(source)&&(methodNames.length||!props.length)||(options=source,source=object,object=this,methodNames=baseFunctions(source,keys(source))),!(isObject(options)&&"chain"in options&&!options.chain)),isFunc=isFunction(object);return arrayEach(methodNames,function(methodName){var func=source[methodName];object[methodName]=func,isFunc&&(object.prototype[methodName]=function(){var result,chainAll=this.__chain__;return chain||chainAll?(((result=object(this.__wrapped__)).__actions__=copyArray(this.__actions__)).push({func:func,args:arguments,thisArg:object}),result.__chain__=chainAll,result):func.apply(object,arrayPush([this.value()],arguments))})}),object}function noop(){}var over=createOver(arrayMap),overEvery=createOver(arrayEvery),overSome=createOver(arraySome);function property(path){return isKey(path)?baseProperty(toKey(path)):function(path){return function(object){return baseGet(object,path)}}(path)}var range=createRange(),rangeRight=createRange(!0);function stubArray(){return[]}function stubFalse(){return!1}var add=createMathOperation(function(augend,addend){return augend+addend},0),ceil=createRound("ceil"),divide=createMathOperation(function(dividend,divisor){return dividend/divisor},1),floor=createRound("floor");var source,multiply=createMathOperation(function(multiplier,multiplicand){return multiplier*multiplicand},1),round=createRound("round"),subtract=createMathOperation(function(minuend,subtrahend){return minuend-subtrahend},0);return lodash.after=function(n,func){if("function"!=typeof func)throw new TypeError(FUNC_ERROR_TEXT);return n=toInteger(n),function(){if(--n<1)return func.apply(this,arguments)}},lodash.ary=ary,lodash.assign=assign,lodash.assignIn=assignIn,lodash.assignInWith=assignInWith,lodash.assignWith=assignWith,lodash.at=at,lodash.before=before,lodash.bind=bind,lodash.bindAll=bindAll,lodash.bindKey=bindKey,lodash.castArray=function(){if(!arguments.length)return[];var value=arguments[0];return isArray(value)?value:[value]},lodash.chain=chain,lodash.chunk=function(array,size,guard){size=(guard?isIterateeCall(array,size,guard):size===undefined)?1:nativeMax(toInteger(size),0);var length=null==array?0:array.length;if(!length||size<1)return[];for(var index=0,resIndex=0,result=Array(nativeCeil(length/size));index<length;)result[resIndex++]=baseSlice(array,index,index+=size);return result},lodash.compact=function(array){for(var index=-1,length=null==array?0:array.length,resIndex=0,result=[];++index<length;){var value=array[index];value&&(result[resIndex++]=value)}return result},lodash.concat=function(){var length=arguments.length;if(!length)return[];for(var args=Array(length-1),array=arguments[0],index=length;index--;)args[index-1]=arguments[index];return arrayPush(isArray(array)?copyArray(array):[array],baseFlatten(args,1))},lodash.cond=function(pairs){var length=null==pairs?0:pairs.length,toIteratee=getIteratee();return pairs=length?arrayMap(pairs,function(pair){if("function"!=typeof pair[1])throw new TypeError(FUNC_ERROR_TEXT);return[toIteratee(pair[0]),pair[1]]}):[],baseRest(function(args){for(var index=-1;++index<length;){var pair=pairs[index];if(apply(pair[0],this,args))return apply(pair[1],this,args)}})},lodash.conforms=function(source){return function(source){var props=keys(source);return function(object){return baseConformsTo(object,source,props)}}(baseClone(source,1))},lodash.constant=constant,lodash.countBy=countBy,lodash.create=function(prototype,properties){return prototype=baseCreate(prototype),null==properties?prototype:baseAssign(prototype,properties)},lodash.curry=function curry(func,arity,guard){func=createWrap(func,8,undefined,undefined,undefined,undefined,undefined,arity=guard?undefined:arity);return func.placeholder=curry.placeholder,func},lodash.curryRight=function curryRight(func,arity,guard){func=createWrap(func,16,undefined,undefined,undefined,undefined,undefined,arity=guard?undefined:arity);return func.placeholder=curryRight.placeholder,func},lodash.debounce=debounce,lodash.defaults=defaults,lodash.defaultsDeep=defaultsDeep,lodash.defer=ctxNow,lodash.delay=delay,lodash.difference=Date,lodash.differenceBy=Promise,lodash.differenceWith=context,lodash.drop=function(array,n,guard){var length=null==array?0:array.length;return length?baseSlice(array,(n=guard||n===undefined?1:toInteger(n))<0?0:n,length):[]},lodash.dropRight=function(array,n,guard){var length=null==array?0:array.length;return length?baseSlice(array,0,(n=length-(n=guard||n===undefined?1:toInteger(n)))<0?0:n):[]},lodash.dropRightWhile=function(array,predicate){return array&&array.length?baseWhile(array,getIteratee(predicate,3),!0,!0):[]},lodash.dropWhile=function(array,predicate){return array&&array.length?baseWhile(array,getIteratee(predicate,3),!0):[]},lodash.fill=function(array,value,start,end){var length=null==array?0:array.length;return length?(start&&"number"!=typeof start&&isIterateeCall(array,value,start)&&(start=0,end=length),function(array,value,start,end){var length=array.length;for((start=toInteger(start))<0&&(start=length<-start?0:length+start),(end=end===undefined||length<end?length:toInteger(end))<0&&(end+=length),end=end<start?0:toLength(end);start<end;)array[start++]=value;return array}(array,value,start,end)):[]},lodash.filter=function(collection,predicate){return(isArray(collection)?arrayFilter:baseFilter)(collection,getIteratee(predicate,3))},lodash.flatMap=function(collection,iteratee){return baseFlatten(map(collection,iteratee),1)},lodash.flatMapDeep=function(collection,iteratee){return baseFlatten(map(collection,iteratee),1/0)},lodash.flatMapDepth=function(collection,iteratee,depth){return depth=depth===undefined?1:toInteger(depth),baseFlatten(map(collection,iteratee),depth)},lodash.flatten=flatten,lodash.flattenDeep=function(array){return(null==array?0:array.length)?baseFlatten(array,1/0):[]},lodash.flattenDepth=function(array,depth){return(null==array?0:array.length)?baseFlatten(array,depth=depth===undefined?1:toInteger(depth)):[]},lodash.flip=function(func){return createWrap(func,512)},lodash.flow=flow,lodash.flowRight=flowRight,lodash.fromPairs=function(pairs){for(var index=-1,length=null==pairs?0:pairs.length,result={};++index<length;){var pair=pairs[index];result[pair[0]]=pair[1]}return result},lodash.functions=function(object){return null==object?[]:baseFunctions(object,keys(object))},lodash.functionsIn=function(object){return null==object?[]:baseFunctions(object,keysIn(object))},lodash.groupBy=groupBy,lodash.initial=function(array){return(null==array?0:array.length)?baseSlice(array,0,-1):[]},lodash.intersection=coreJsData,lodash.intersectionBy=ctxSetTimeout,lodash.intersectionWith=Symbol,lodash.invert=invert,lodash.invertBy=invertBy,lodash.invokeMap=invokeMap,lodash.iteratee=iteratee,lodash.keyBy=keyBy,lodash.keys=keys,lodash.keysIn=keysIn,lodash.map=map,lodash.mapKeys=function(object,iteratee){var result={};return iteratee=getIteratee(iteratee,3),baseForOwn(object,function(value,key,object){baseAssignValue(result,iteratee(value,key,object),value)}),result},lodash.mapValues=function(object,iteratee){var result={};return iteratee=getIteratee(iteratee,3),baseForOwn(object,function(value,key,object){baseAssignValue(result,key,iteratee(value,key,object))}),result},lodash.matches=function(source){return baseMatches(baseClone(source,1))},lodash.matchesProperty=function(path,srcValue){return baseMatchesProperty(path,baseClone(srcValue,1))},lodash.memoize=memoize,lodash.merge=merge,lodash.mergeWith=mergeWith,lodash.method=method,lodash.methodOf=methodOf,lodash.mixin=mixin,lodash.negate=negate,lodash.nthArg=function(n){return n=toInteger(n),baseRest(function(args){return baseNth(args,n)})},lodash.omit=omit,lodash.omitBy=function(object,predicate){return pickBy(object,negate(getIteratee(predicate)))},lodash.once=function(func){return before(2,func)},lodash.orderBy=function(collection,iteratees,orders,guard){return null==collection?[]:baseOrderBy(collection,iteratees=isArray(iteratees)?iteratees:null==iteratees?[]:[iteratees],orders=isArray(orders=guard?undefined:orders)?orders:null==orders?[]:[orders])},lodash.over=over,lodash.overArgs=castRest,lodash.overEvery=overEvery,lodash.overSome=overSome,lodash.partial=partial,lodash.partialRight=partialRight,lodash.partition=partition,lodash.pick=pick,lodash.pickBy=pickBy,lodash.property=property,lodash.propertyOf=function(object){return function(path){return null==object?undefined:baseGet(object,path)}},lodash.pull=ctxClearTimeout,lodash.pullAll=pullAll,lodash.pullAllBy=function(array,values,iteratee){return array&&array.length&&values&&values.length?basePullAll(array,values,getIteratee(iteratee,2)):array},lodash.pullAllWith=function(array,values,comparator){return array&&array.length&&values&&values.length?basePullAll(array,values,undefined,comparator):array},lodash.pullAt=pullAt,lodash.range=range,lodash.rangeRight=rangeRight,lodash.rearg=rearg,lodash.reject=function(collection,predicate){return(isArray(collection)?arrayFilter:baseFilter)(collection,negate(getIteratee(predicate,3)))},lodash.remove=function(array,predicate){var result=[];if(!array||!array.length)return result;var index=-1,indexes=[],length=array.length;for(predicate=getIteratee(predicate,3);++index<length;){var value=array[index];predicate(value,index,array)&&(result.push(value),indexes.push(index))}return basePullAt(array,indexes),result},lodash.rest=function(func,start){if("function"!=typeof func)throw new TypeError(FUNC_ERROR_TEXT);return baseRest(func,start=start===undefined?start:toInteger(start))},lodash.reverse=reverse,lodash.sampleSize=function(collection,n,guard){return n=(guard?isIterateeCall(collection,n,guard):n===undefined)?1:toInteger(n),(isArray(collection)?arraySampleSize:baseSampleSize)(collection,n)},lodash.set=function(object,path,value){return null==object?object:baseSet(object,path,value)},lodash.setWith=function(object,path,value,customizer){return customizer="function"==typeof customizer?customizer:undefined,null==object?object:baseSet(object,path,value,customizer)},lodash.shuffle=function(collection){return(isArray(collection)?arrayShuffle:baseShuffle)(collection)},lodash.slice=function(array,start,end){var length=null==array?0:array.length;return length?(end=end&&"number"!=typeof end&&isIterateeCall(array,start,end)?(start=0,length):(start=null==start?0:toInteger(start),end===undefined?length:toInteger(end)),baseSlice(array,start,end)):[]},lodash.sortBy=sortBy,lodash.sortedUniq=function(array){return array&&array.length?baseSortedUniq(array):[]},lodash.sortedUniqBy=function(array,iteratee){return array&&array.length?baseSortedUniq(array,getIteratee(iteratee,2)):[]},lodash.split=function(string,separator,limit){return limit&&"number"!=typeof limit&&isIterateeCall(string,separator,limit)&&(separator=limit=undefined),(limit=limit===undefined?4294967295:limit>>>0)?(string=toString(string))&&("string"==typeof separator||null!=separator&&!isRegExp(separator))&&!(separator=baseToString(separator))&&hasUnicode(string)?castSlice(stringToArray(string),0,limit):string.split(separator,limit):[]},lodash.spread=function(func,start){if("function"!=typeof func)throw new TypeError(FUNC_ERROR_TEXT);return start=null==start?0:nativeMax(toInteger(start),0),baseRest(function(args){var array=args[start],args=castSlice(args,0,start);return array&&arrayPush(args,array),apply(func,this,args)})},lodash.tail=function(array){var length=null==array?0:array.length;return length?baseSlice(array,1,length):[]},lodash.take=function(array,n,guard){return array&&array.length?baseSlice(array,0,(n=guard||n===undefined?1:toInteger(n))<0?0:n):[]},lodash.takeRight=function(array,n,guard){var length=null==array?0:array.length;return length?baseSlice(array,(n=length-(n=guard||n===undefined?1:toInteger(n)))<0?0:n,length):[]},lodash.takeRightWhile=function(array,predicate){return array&&array.length?baseWhile(array,getIteratee(predicate,3),!1,!0):[]},lodash.takeWhile=function(array,predicate){return array&&array.length?baseWhile(array,getIteratee(predicate,3)):[]},lodash.tap=function(value,interceptor){return interceptor(value),value},lodash.throttle=function(func,wait,options){var leading=!0,trailing=!0;if("function"!=typeof func)throw new TypeError(FUNC_ERROR_TEXT);return isObject(options)&&(leading="leading"in options?!!options.leading:leading,trailing="trailing"in options?!!options.trailing:trailing),debounce(func,wait,{leading:leading,maxWait:wait,trailing:trailing})},lodash.thru=thru,lodash.toArray=toArray,lodash.toPairs=toPairs,lodash.toPairsIn=toPairsIn,lodash.toPath=function(value){return isArray(value)?arrayMap(value,toKey):isSymbol(value)?[value]:copyArray(stringToPath(toString(value)))},lodash.toPlainObject=toPlainObject,lodash.transform=function(object,iteratee,accumulator){var Ctor,isArr=isArray(object),isArrLike=isArr||isBuffer(object)||isTypedArray(object);return iteratee=getIteratee(iteratee,4),null==accumulator&&(Ctor=object&&object.constructor,accumulator=isArrLike?isArr?new Ctor:[]:isObject(object)&&isFunction(Ctor)?baseCreate(getPrototype(object)):{}),(isArrLike?arrayEach:baseForOwn)(object,function(value,index,object){return iteratee(accumulator,value,index,object)}),accumulator},lodash.unary=function(func){return ary(func,1)},lodash.union=union,lodash.unionBy=unionBy,lodash.unionWith=unionWith,lodash.uniq=function(array){return array&&array.length?baseUniq(array):[]},lodash.uniqBy=function(array,iteratee){return array&&array.length?baseUniq(array,getIteratee(iteratee,2)):[]},lodash.uniqWith=function(array,comparator){return comparator="function"==typeof comparator?comparator:undefined,array&&array.length?baseUniq(array,undefined,comparator):[]},lodash.unset=function(object,path){return null==object||baseUnset(object,path)},lodash.unzip=unzip,lodash.unzipWith=unzipWith,lodash.update=function(object,path,updater){return null==object?object:baseUpdate(object,path,castFunction(updater))},lodash.updateWith=function(object,path,updater,customizer){return customizer="function"==typeof customizer?customizer:undefined,null==object?object:baseUpdate(object,path,castFunction(updater),customizer)},lodash.values=values,lodash.valuesIn=function(object){return null==object?[]:baseValues(object,keysIn(object))},lodash.without=without,lodash.words=words,lodash.wrap=function(value,wrapper){return partial(castFunction(wrapper),value)},lodash.xor=xor,lodash.xorBy=xorBy,lodash.xorWith=xorWith,lodash.zip=zip,lodash.zipObject=function(props,values){return baseZipObject(props||[],values||[],assignValue)},lodash.zipObjectDeep=function(props,values){return baseZipObject(props||[],values||[],baseSet)},lodash.zipWith=zipWith,lodash.entries=toPairs,lodash.entriesIn=toPairsIn,lodash.extend=assignIn,lodash.extendWith=assignInWith,mixin(lodash,lodash),lodash.add=add,lodash.attempt=attempt,lodash.camelCase=camelCase,lodash.capitalize=capitalize,lodash.ceil=ceil,lodash.clamp=function(number,lower,upper){return upper===undefined&&(upper=lower,lower=undefined),upper!==undefined&&(upper=(upper=toNumber(upper))==upper?upper:0),lower!==undefined&&(lower=(lower=toNumber(lower))==lower?lower:0),baseClamp(toNumber(number),lower,upper)},lodash.clone=function(value){return baseClone(value,4)},lodash.cloneDeep=function(value){return baseClone(value,5)},lodash.cloneDeepWith=function(value,customizer){return baseClone(value,5,customizer="function"==typeof customizer?customizer:undefined)},lodash.cloneWith=function(value,customizer){return baseClone(value,4,customizer="function"==typeof customizer?customizer:undefined)},lodash.conformsTo=function(object,source){return null==source||baseConformsTo(object,source,keys(source))},lodash.deburr=deburr,lodash.defaultTo=function(value,defaultValue){return null==value||value!=value?defaultValue:value},lodash.divide=divide,lodash.endsWith=function(string,target,position){string=toString(string),target=baseToString(target);var length=string.length,length=position=position===undefined?length:baseClamp(toInteger(position),0,length);return 0<=(position-=target.length)&&string.slice(position,length)==target},lodash.eq=eq,lodash.escape=function(string){return(string=toString(string))&&reHasUnescapedHtml.test(string)?string.replace(reUnescapedHtml,escapeHtmlChar):string},lodash.escapeRegExp=function(string){return(string=toString(string))&&reHasRegExpChar.test(string)?string.replace(reRegExpChar,"\\$&"):string},lodash.every=function(collection,predicate,guard){return(isArray(collection)?arrayEvery:baseEvery)(collection,getIteratee(predicate=guard&&isIterateeCall(collection,predicate,guard)?undefined:predicate,3))},lodash.find=find,lodash.findIndex=findIndex,lodash.findKey=function(object,predicate){return baseFindKey(object,getIteratee(predicate,3),baseForOwn)},lodash.findLast=findLast,lodash.findLastIndex=findLastIndex,lodash.findLastKey=function(object,predicate){return baseFindKey(object,getIteratee(predicate,3),baseForOwnRight)},lodash.floor=floor,lodash.forEach=forEach,lodash.forEachRight=forEachRight,lodash.forIn=function(object,iteratee){return null==object?object:baseFor(object,getIteratee(iteratee,3),keysIn)},lodash.forInRight=function(object,iteratee){return null==object?object:baseForRight(object,getIteratee(iteratee,3),keysIn)},lodash.forOwn=function(object,iteratee){return object&&baseForOwn(object,getIteratee(iteratee,3))},lodash.forOwnRight=function(object,iteratee){return object&&baseForOwnRight(object,getIteratee(iteratee,3))},lodash.get=get,lodash.gt=gt,lodash.gte=gte,lodash.has=function(object,path){return null!=object&&hasPath(object,path,baseHas)},lodash.hasIn=hasIn,lodash.head=head,lodash.identity=identity,lodash.includes=function(collection,value,fromIndex,guard){return collection=isArrayLike(collection)?collection:values(collection),fromIndex=fromIndex&&!guard?toInteger(fromIndex):0,guard=collection.length,fromIndex<0&&(fromIndex=nativeMax(guard+fromIndex,0)),isString(collection)?fromIndex<=guard&&-1<collection.indexOf(value,fromIndex):!!guard&&-1<baseIndexOf(collection,value,fromIndex)},lodash.indexOf=function(array,value,fromIndex){var length=null==array?0:array.length;return length?(fromIndex=null==fromIndex?0:toInteger(fromIndex),baseIndexOf(array,value,fromIndex=fromIndex<0?nativeMax(length+fromIndex,0):fromIndex)):-1},lodash.inRange=function(number,start,end){return start=toFinite(start),end===undefined?(end=start,start=0):end=toFinite(end),function(number,start,end){return number>=nativeMin(start,end)&&number<nativeMax(start,end)}(number=toNumber(number),start,end)},lodash.invoke=invoke,lodash.isArguments=isArguments,lodash.isArray=isArray,lodash.isArrayBuffer=isArrayBuffer,lodash.isArrayLike=isArrayLike,lodash.isArrayLikeObject=isArrayLikeObject,lodash.isBoolean=function(value){return!0===value||!1===value||isObjectLike(value)&&baseGetTag(value)==boolTag},lodash.isBuffer=isBuffer,lodash.isDate=funcProto,lodash.isElement=function(value){return isObjectLike(value)&&1===value.nodeType&&!isPlainObject(value)},lodash.isEmpty=function(value){if(null==value)return!0;if(isArrayLike(value)&&(isArray(value)||"string"==typeof value||"function"==typeof value.splice||isBuffer(value)||isTypedArray(value)||isArguments(value)))return!value.length;var key,tag=getTag(value);if(tag==mapTag||tag==setTag)return!value.size;if(isPrototype(value))return!baseKeys(value).length;for(key in value)if(hasOwnProperty.call(value,key))return!1;return!0},lodash.isEqual=function(value,other){return baseIsEqual(value,other)},lodash.isEqualWith=function(value,other,customizer){var result=(customizer="function"==typeof customizer?customizer:undefined)?customizer(value,other):undefined;return result===undefined?baseIsEqual(value,other,undefined,customizer):!!result},lodash.isError=isError,lodash.isFinite=function(value){return"number"==typeof value&&nativeIsFinite(value)},lodash.isFunction=isFunction,lodash.isInteger=isInteger,lodash.isLength=isLength,lodash.isMap=isMap,lodash.isMatch=function(object,source){return object===source||baseIsMatch(object,source,getMatchData(source))},lodash.isMatchWith=function(object,source,customizer){return customizer="function"==typeof customizer?customizer:undefined,baseIsMatch(object,source,getMatchData(source),customizer)},lodash.isNaN=function(value){return isNumber(value)&&value!=+value},lodash.isNative=function(value){if(isMaskable(value))throw new Error("Unsupported core-js use. Try https://npms.io/search?q=ponyfill.");return baseIsNative(value)},lodash.isNil=function(value){return null==value},lodash.isNull=function(value){return null===value},lodash.isNumber=isNumber,lodash.isObject=isObject,lodash.isObjectLike=isObjectLike,lodash.isPlainObject=isPlainObject,lodash.isRegExp=isRegExp,lodash.isSafeInteger=function(value){return isInteger(value)&&-9007199254740991<=value&&value<=9007199254740991},lodash.isSet=isSet,lodash.isString=isString,lodash.isSymbol=isSymbol,lodash.isTypedArray=isTypedArray,lodash.isUndefined=function(value){return value===undefined},lodash.isWeakMap=function(value){return isObjectLike(value)&&getTag(value)==weakMapTag},lodash.isWeakSet=function(value){return isObjectLike(value)&&"[object WeakSet]"==baseGetTag(value)},lodash.join=function(array,separator){return null==array?"":nativeJoin.call(array,separator)},lodash.kebabCase=kebabCase,lodash.last=last,lodash.lastIndexOf=function(array,value,fromIndex){var length=null==array?0:array.length;if(!length)return-1;var index=length;return fromIndex!==undefined&&(index=(index=toInteger(fromIndex))<0?nativeMax(length+index,0):nativeMin(index,length-1)),value==value?function(array,value,fromIndex){for(var index=fromIndex+1;index--;)if(array[index]===value)return index;return index}(array,value,index):baseFindIndex(array,baseIsNaN,index,!0)},lodash.lowerCase=lowerCase,lodash.lowerFirst=lowerFirst,lodash.lt=lt,lodash.lte=lte,lodash.max=function(array){return array&&array.length?baseExtremum(array,identity,baseGt):undefined},lodash.maxBy=function(array,iteratee){return array&&array.length?baseExtremum(array,getIteratee(iteratee,2),baseGt):undefined},lodash.mean=function(array){return baseMean(array,identity)},lodash.meanBy=function(array,iteratee){return baseMean(array,getIteratee(iteratee,2))},lodash.min=function(array){return array&&array.length?baseExtremum(array,identity,baseLt):undefined},lodash.minBy=function(array,iteratee){return array&&array.length?baseExtremum(array,getIteratee(iteratee,2),baseLt):undefined},lodash.stubArray=stubArray,lodash.stubFalse=stubFalse,lodash.stubObject=function(){return{}},lodash.stubString=function(){return""},lodash.stubTrue=function(){return!0},lodash.multiply=multiply,lodash.nth=function(array,n){return array&&array.length?baseNth(array,toInteger(n)):undefined},lodash.noConflict=function(){return root._===this&&(root._=oldDash),this},lodash.noop=noop,lodash.now=now,lodash.pad=function(string,length,chars){string=toString(string);var strLength=(length=toInteger(length))?stringSize(string):0;return!length||length<=strLength?string:createPadding(nativeFloor(length=(length-strLength)/2),chars)+string+createPadding(nativeCeil(length),chars)},lodash.padEnd=function(string,length,chars){string=toString(string);var strLength=(length=toInteger(length))?stringSize(string):0;return length&&strLength<length?string+createPadding(length-strLength,chars):string},lodash.padStart=function(string,length,chars){string=toString(string);var strLength=(length=toInteger(length))?stringSize(string):0;return length&&strLength<length?createPadding(length-strLength,chars)+string:string},lodash.parseInt=function(string,radix,guard){return radix=guard||null==radix?0:radix&&+radix,nativeParseInt(toString(string).replace(reTrimStart,""),radix||0)},lodash.random=function(lower,upper,floating){var temp;return floating&&"boolean"!=typeof floating&&isIterateeCall(lower,upper,floating)&&(upper=floating=undefined),floating===undefined&&("boolean"==typeof upper?(floating=upper,upper=undefined):"boolean"==typeof lower&&(floating=lower,lower=undefined)),lower===undefined&&upper===undefined?(lower=0,upper=1):(lower=toFinite(lower),upper===undefined?(upper=lower,lower=0):upper=toFinite(upper)),upper<lower&&(temp=lower,lower=upper,upper=temp),floating||lower%1||upper%1?(temp=nativeRandom(),nativeMin(lower+temp*(upper-lower+freeParseFloat("1e-"+((temp+"").length-1))),upper)):baseRandom(lower,upper)},lodash.reduce=function(collection,iteratee,accumulator){var func=isArray(collection)?arrayReduce:baseReduce,initAccum=arguments.length<3;return func(collection,getIteratee(iteratee,4),accumulator,initAccum,baseEach)},lodash.reduceRight=function(collection,iteratee,accumulator){var func=isArray(collection)?arrayReduceRight:baseReduce,initAccum=arguments.length<3;return func(collection,getIteratee(iteratee,4),accumulator,initAccum,baseEachRight)},lodash.repeat=function(string,n,guard){return n=(guard?isIterateeCall(string,n,guard):n===undefined)?1:toInteger(n),baseRepeat(toString(string),n)},lodash.replace=function(){var args=arguments,string=toString(args[0]);return args.length<3?string:string.replace(args[1],args[2])},lodash.result=function(object,path,defaultValue){var index=-1,length=(path=castPath(path,object)).length;for(length||(length=1,object=undefined);++index<length;){var value=null==object?undefined:object[toKey(path[index])];value===undefined&&(index=length,value=defaultValue),object=isFunction(value)?value.call(object):value}return object},lodash.round=round,lodash.runInContext=runInContext,lodash.sample=function(collection){return(isArray(collection)?arraySample:baseSample)(collection)},lodash.size=function(collection){if(null==collection)return 0;if(isArrayLike(collection))return isString(collection)?stringSize(collection):collection.length;var tag=getTag(collection);return tag==mapTag||tag==setTag?collection.size:baseKeys(collection).length},lodash.snakeCase=snakeCase,lodash.some=function(collection,predicate,guard){return(isArray(collection)?arraySome:baseSome)(collection,getIteratee(predicate=guard&&isIterateeCall(collection,predicate,guard)?undefined:predicate,3))},lodash.sortedIndex=function(array,value){return baseSortedIndex(array,value)},lodash.sortedIndexBy=function(array,value,iteratee){return baseSortedIndexBy(array,value,getIteratee(iteratee,2))},lodash.sortedIndexOf=function(array,value){var length=null==array?0:array.length;if(length){var index=baseSortedIndex(array,value);if(index<length&&eq(array[index],value))return index}return-1},lodash.sortedLastIndex=function(array,value){return baseSortedIndex(array,value,!0)},lodash.sortedLastIndexBy=function(array,value,iteratee){return baseSortedIndexBy(array,value,getIteratee(iteratee,2),!0)},lodash.sortedLastIndexOf=function(array,value){if(null==array?0:array.length){var index=baseSortedIndex(array,value,!0)-1;if(eq(array[index],value))return index}return-1},lodash.startCase=startCase,lodash.startsWith=function(string,target,position){return string=toString(string),position=null==position?0:baseClamp(toInteger(position),0,string.length),target=baseToString(target),string.slice(position,position+target.length)==target},lodash.subtract=subtract,lodash.sum=function(array){return array&&array.length?baseSum(array,identity):0},lodash.sumBy=function(array,iteratee){return array&&array.length?baseSum(array,getIteratee(iteratee,2)):0},lodash.template=function(string,options,guard){var isEscaping,isEvaluating,settings=lodash.templateSettings;guard&&isIterateeCall(string,options,guard)&&(options=undefined),string=toString(string),options=assignInWith({},options,settings,customDefaultsAssignIn);var importsKeys=keys(guard=assignInWith({},options.imports,settings.imports,customDefaultsAssignIn)),importsValues=baseValues(guard,importsKeys),index=0,settings=options.interpolate||reNoMatch,source="__p += '",guard=RegExp((options.escape||reNoMatch).source+"|"+settings.source+"|"+(settings===reInterpolate?reEsTemplate:reNoMatch).source+"|"+(options.evaluate||reNoMatch).source+"|$","g"),sourceURL="//# sourceURL="+(hasOwnProperty.call(options,"sourceURL")?(options.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++templateCounter+"]")+"\n";if(string.replace(guard,function(match,escapeValue,interpolateValue,esTemplateValue,evaluateValue,offset){return interpolateValue=interpolateValue||esTemplateValue,source+=string.slice(index,offset).replace(reUnescapedString,escapeStringChar),escapeValue&&(isEscaping=!0,source+="' +\n__e("+escapeValue+") +\n'"),evaluateValue&&(isEvaluating=!0,source+="';\n"+evaluateValue+";\n__p += '"),interpolateValue&&(source+="' +\n((__t = ("+interpolateValue+")) == null ? '' : __t) +\n'"),index=offset+match.length,match}),source+="';\n",settings=hasOwnProperty.call(options,"variable")&&options.variable){if(reForbiddenIdentifierChars.test(settings))throw new Error("Invalid `variable` option passed into `_.template`")}else source="with (obj) {\n"+source+"\n}\n";if(source=(isEvaluating?source.replace(reEmptyStringLeading,""):source).replace(reEmptyStringMiddle,"$1").replace(reEmptyStringTrailing,"$1;"),source="function("+(settings||"obj")+") {\n"+(settings?"":"obj || (obj = {});\n")+"var __t, __p = ''"+(isEscaping?", __e = _.escape":"")+(isEvaluating?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+source+"return __p\n}",(guard=attempt(function(){return Function(importsKeys,sourceURL+"return "+source).apply(undefined,importsValues)})).source=source,isError(guard))throw guard;return guard},lodash.times=function(n,iteratee){if((n=toInteger(n))<1||9007199254740991<n)return[];for(var index=4294967295,length=nativeMin(n,4294967295),length=(n-=4294967295,baseTimes(length,iteratee=getIteratee(iteratee)));++index<n;)iteratee(index);return length},lodash.toFinite=toFinite,lodash.toInteger=toInteger,lodash.toLength=toLength,lodash.toLower=function(value){return toString(value).toLowerCase()},lodash.toNumber=toNumber,lodash.toSafeInteger=function(value){return value?baseClamp(toInteger(value),-9007199254740991,9007199254740991):0===value?value:0},lodash.toString=toString,lodash.toUpper=function(value){return toString(value).toUpperCase()},lodash.trim=function(string,chars,guard){return(string=toString(string))&&(guard||chars===undefined)?baseTrim(string):string&&(chars=baseToString(chars))?(guard=stringToArray(string),string=stringToArray(chars),castSlice(guard,charsStartIndex(guard,string),charsEndIndex(guard,string)+1).join("")):string},lodash.trimEnd=function(string,chars,guard){return(string=toString(string))&&(guard||chars===undefined)?string.slice(0,trimmedEndIndex(string)+1):string&&(chars=baseToString(chars))?castSlice(guard=stringToArray(string),0,charsEndIndex(guard,stringToArray(chars))+1).join(""):string},lodash.trimStart=function(string,chars,guard){return(string=toString(string))&&(guard||chars===undefined)?string.replace(reTrimStart,""):string&&(chars=baseToString(chars))?castSlice(guard=stringToArray(string),charsStartIndex(guard,stringToArray(chars))).join(""):string},lodash.truncate=function(string,options){var separator,length=30,omission="...",options=(isObject(options)&&(separator="separator"in options?options.separator:separator,length="length"in options?toInteger(options.length):length,omission="omission"in options?baseToString(options.omission):omission),(string=toString(string)).length);if((options=hasUnicode(string)?(strSymbols=stringToArray(string)).length:options)<=length)return string;if((options=length-stringSize(omission))<1)return omission;var strSymbols,length=strSymbols?castSlice(strSymbols,0,options).join(""):string.slice(0,options);if(separator===undefined)return length+omission;if(strSymbols&&(options+=length.length-options),isRegExp(separator)){if(string.slice(options).search(separator)){var match,substring=length;for((separator=separator.global?separator:RegExp(separator.source,toString(reFlags.exec(separator))+"g")).lastIndex=0;match=separator.exec(substring);)var newEnd=match.index;length=length.slice(0,newEnd===undefined?options:newEnd)}}else string.indexOf(baseToString(separator),options)==options||-1<(strSymbols=length.lastIndexOf(separator))&&(length=length.slice(0,strSymbols));return length+omission},lodash.unescape=function(string){return(string=toString(string))&&reHasEscapedHtml.test(string)?string.replace(reEscapedHtml,unescapeHtmlChar):string},lodash.uniqueId=function(prefix){var id=++idCounter;return toString(prefix)+id},lodash.upperCase=upperCase,lodash.upperFirst=upperFirst,lodash.each=forEach,lodash.eachRight=forEachRight,lodash.first=head,mixin(lodash,(source={},baseForOwn(lodash,function(func,methodName){hasOwnProperty.call(lodash.prototype,methodName)||(source[methodName]=func)}),source),{chain:!1}),lodash.VERSION="4.17.21",arrayEach(["bind","bindKey","curry","curryRight","partial","partialRight"],function(methodName){lodash[methodName].placeholder=lodash}),arrayEach(["drop","take"],function(methodName,index){LazyWrapper.prototype[methodName]=function(n){n=n===undefined?1:nativeMax(toInteger(n),0);var result=this.__filtered__&&!index?new LazyWrapper(this):this.clone();return result.__filtered__?result.__takeCount__=nativeMin(n,result.__takeCount__):result.__views__.push({size:nativeMin(n,4294967295),type:methodName+(result.__dir__<0?"Right":"")}),result},LazyWrapper.prototype[methodName+"Right"]=function(n){return this.reverse()[methodName](n).reverse()}}),arrayEach(["filter","map","takeWhile"],function(methodName,index){var type=index+1,isFilter=1==type||3==type;LazyWrapper.prototype[methodName]=function(iteratee){var result=this.clone();return result.__iteratees__.push({iteratee:getIteratee(iteratee,3),type:type}),result.__filtered__=result.__filtered__||isFilter,result}}),arrayEach(["head","last"],function(methodName,index){var takeName="take"+(index?"Right":"");LazyWrapper.prototype[methodName]=function(){return this[takeName](1).value()[0]}}),arrayEach(["initial","tail"],function(methodName,index){var dropName="drop"+(index?"":"Right");LazyWrapper.prototype[methodName]=function(){return this.__filtered__?new LazyWrapper(this):this[dropName](1)}}),LazyWrapper.prototype.compact=function(){return this.filter(identity)},LazyWrapper.prototype.find=function(predicate){return this.filter(predicate).head()},LazyWrapper.prototype.findLast=function(predicate){return this.reverse().find(predicate)},LazyWrapper.prototype.invokeMap=baseRest(function(path,args){return"function"==typeof path?new LazyWrapper(this):this.map(function(value){return baseInvoke(value,path,args)})}),LazyWrapper.prototype.reject=function(predicate){return this.filter(negate(getIteratee(predicate)))},LazyWrapper.prototype.slice=function(start,end){start=toInteger(start);var result=this;return result.__filtered__&&(0<start||end<0)?new LazyWrapper(result):(start<0?result=result.takeRight(-start):start&&(result=result.drop(start)),end!==undefined?(end=toInteger(end))<0?result.dropRight(-end):result.take(end-start):result)},LazyWrapper.prototype.takeRightWhile=function(predicate){return this.reverse().takeWhile(predicate).reverse()},LazyWrapper.prototype.toArray=function(){return this.take(4294967295)},baseForOwn(LazyWrapper.prototype,function(func,methodName){var checkIteratee=/^(?:filter|find|map|reject)|While$/.test(methodName),isTaker=/^(?:head|last)$/.test(methodName),lodashFunc=lodash[isTaker?"take"+("last"==methodName?"Right":""):methodName],retUnwrapped=isTaker||/^find/.test(methodName);lodashFunc&&(lodash.prototype[methodName]=function(){function interceptor(value){return value=lodashFunc.apply(lodash,arrayPush([value],args)),isTaker&&chainAll?value[0]:value}var result,value=this.__wrapped__,args=isTaker?[1]:arguments,isLazy=value instanceof LazyWrapper,iteratee=args[0],useLazy=isLazy||isArray(value),chainAll=(useLazy&&checkIteratee&&"function"==typeof iteratee&&1!=iteratee.length&&(isLazy=useLazy=!1),this.__chain__),iteratee=!!this.__actions__.length,isUnwrapped=retUnwrapped&&!chainAll,isLazy=isLazy&&!iteratee;return!retUnwrapped&&useLazy?(value=isLazy?value:new LazyWrapper(this),(result=func.apply(value,args)).__actions__.push({func:thru,args:[interceptor],thisArg:undefined}),new LodashWrapper(result,chainAll)):isUnwrapped&&isLazy?func.apply(this,args):(result=this.thru(interceptor),isUnwrapped?isTaker?result.value()[0]:result.value():result)})}),arrayEach(["pop","push","shift","sort","splice","unshift"],function(methodName){var func=arrayProto[methodName],chainName=/^(?:push|sort|unshift)$/.test(methodName)?"tap":"thru",retUnwrapped=/^(?:pop|shift)$/.test(methodName);lodash.prototype[methodName]=function(){var value,args=arguments;return retUnwrapped&&!this.__chain__?(value=this.value(),func.apply(isArray(value)?value:[],args)):this[chainName](function(value){return func.apply(isArray(value)?value:[],args)})}}),baseForOwn(LazyWrapper.prototype,function(func,methodName){var key,lodashFunc=lodash[methodName];lodashFunc&&(key=lodashFunc.name+"",hasOwnProperty.call(realNames,key)||(realNames[key]=[]),realNames[key].push({name:methodName,func:lodashFunc}))}),realNames[createHybrid(undefined,2).name]=[{name:"wrapper",func:undefined}],LazyWrapper.prototype.clone=function(){var result=new LazyWrapper(this.__wrapped__);return result.__actions__=copyArray(this.__actions__),result.__dir__=this.__dir__,result.__filtered__=this.__filtered__,result.__iteratees__=copyArray(this.__iteratees__),result.__takeCount__=this.__takeCount__,result.__views__=copyArray(this.__views__),result},LazyWrapper.prototype.reverse=function(){var result;return this.__filtered__?((result=new LazyWrapper(this)).__dir__=-1,result.__filtered__=!0):(result=this.clone()).__dir__*=-1,result},LazyWrapper.prototype.value=function(){var array=this.__wrapped__.value(),dir=this.__dir__,isArr=isArray(array),isRight=dir<0,arrLength=isArr?array.length:0,view=function(start,end,transforms){var index=-1,length=transforms.length;for(;++index<length;){var data=transforms[index],size=data.size;switch(data.type){case"drop":start+=size;break;case"dropRight":end-=size;break;case"take":end=nativeMin(end,start+size);break;case"takeRight":start=nativeMax(start,end-size)}}return{start:start,end:end}}(0,arrLength,this.__views__),start=view.start,length=(view=view.end)-start,index=isRight?view:start-1,iteratees=this.__iteratees__,iterLength=iteratees.length,resIndex=0,takeCount=nativeMin(length,this.__takeCount__);if(!isArr||!isRight&&arrLength==length&&takeCount==length)return baseWrapperValue(array,this.__actions__);var result=[];outer:for(;length--&&resIndex<takeCount;){for(var iterIndex=-1,value=array[index+=dir];++iterIndex<iterLength;){var data=iteratees[iterIndex],iteratee=data.iteratee,data=data.type,iteratee=iteratee(value);if(2==data)value=iteratee;else if(!iteratee){if(1==data)continue outer;break outer}}result[resIndex++]=value}return result},lodash.prototype.at=wrapperAt,lodash.prototype.chain=function(){return chain(this)},lodash.prototype.commit=function(){return new LodashWrapper(this.value(),this.__chain__)},lodash.prototype.next=function(){this.__values__===undefined&&(this.__values__=toArray(this.value()));var done=this.__index__>=this.__values__.length;return{done:done,value:done?undefined:this.__values__[this.__index__++]}},lodash.prototype.plant=function(value){for(var result,parent=this;parent instanceof baseLodash;)var clone=wrapperClone(parent),previous=(clone.__index__=0,clone.__values__=undefined,result?previous.__wrapped__=clone:result=clone,clone),parent=parent.__wrapped__;return previous.__wrapped__=value,result},lodash.prototype.reverse=function(){var value=this.__wrapped__;return value instanceof LazyWrapper?(value=value,(value=(value=this.__actions__.length?new LazyWrapper(this):value).reverse()).__actions__.push({func:thru,args:[reverse],thisArg:undefined}),new LodashWrapper(value,this.__chain__)):this.thru(reverse)},lodash.prototype.toJSON=lodash.prototype.valueOf=lodash.prototype.value=function(){return baseWrapperValue(this.__wrapped__,this.__actions__)},lodash.prototype.first=lodash.prototype.head,symIterator&&(lodash.prototype[symIterator]=function(){return this}),lodash}();freeModule?((freeModule.exports=_)._=_,rsAstral._=_):root._=_}.call(this)}.call(this)}.call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],261:[function(require,module,exports){!function(Buffer){!function(){function isDef(val){return void 0!==val&&""!==val}function has(range,name){return Object.hasOwnProperty.call(range,name)}function hasKey(range,name){return Object.hasOwnProperty.call(range,name)&&name}exports.compare=function(a,b){if(Buffer.isBuffer(a)){for(var l=Math.min(a.length,b.length),i=0;i<l;i++){var cmp=a[i]-b[i];if(cmp)return cmp}return a.length-b.length}return a<b?-1:b<a?1:0};var lowerBoundKey=exports.lowerBoundKey=function(range){return hasKey(range,"gt")||hasKey(range,"gte")||hasKey(range,"min")||(range.reverse?hasKey(range,"end"):hasKey(range,"start"))||void 0},lowerBound=exports.lowerBound=function(range,def){var k=lowerBoundKey(range);return k?range[k]:def},lowerBoundInclusive=exports.lowerBoundInclusive=function(range){return!has(range,"gt")},upperBoundInclusive=exports.upperBoundInclusive=function(range){return!has(range,"lt")},lowerBoundExclusive=exports.lowerBoundExclusive=function(range){return!lowerBoundInclusive(range)},upperBoundExclusive=exports.upperBoundExclusive=function(range){return!upperBoundInclusive(range)},upperBoundKey=exports.upperBoundKey=function(range){return hasKey(range,"lt")||hasKey(range,"lte")||hasKey(range,"max")||(range.reverse?hasKey(range,"start"):hasKey(range,"end"))||void 0},upperBound=exports.upperBound=function(range,def){var k=upperBoundKey(range);return k?range[k]:def};function id(e){return e}exports.start=function(range,def){return(range.reverse?upperBound:lowerBound)(range,def)},exports.end=function(range,def){return(range.reverse?lowerBound:upperBound)(range,def)},exports.startInclusive=function(range){return(range.reverse?upperBoundInclusive:lowerBoundInclusive)(range)},exports.endInclusive=function(range){return(range.reverse?lowerBoundInclusive:upperBoundInclusive)(range)},exports.toLtgt=function(range,_range,map,lower,upper){_range=_range||{},map=map||id;var defaults=3<arguments.length,lb=exports.lowerBoundKey(range),ub=exports.upperBoundKey(range);return lb?"gt"===lb?_range.gt=map(range.gt,!1):_range.gte=map(range[lb],!1):defaults&&(_range.gte=map(lower,!1)),ub?"lt"===ub?_range.lt=map(range.lt,!0):_range.lte=map(range[ub],!0):defaults&&(_range.lte=map(upper,!0)),null!=range.reverse&&(_range.reverse=!!range.reverse),has(_range,"max")&&delete _range.max,has(_range,"min")&&delete _range.min,has(_range,"start")&&delete _range.start,has(_range,"end")&&delete _range.end,_range},exports.contains=function(range,key,compare){compare=compare||exports.compare;var lb=lowerBound(range);if(isDef(lb)&&((cmp=compare(key,lb))<0||0===cmp&&lowerBoundExclusive(range)))return!1;var cmp,lb=upperBound(range);if(isDef(lb)&&(0<(cmp=compare(key,lb))||0===cmp&&upperBoundExclusive(range)))return!1;return!0},exports.filter=function(range,compare){return function(key){return exports.contains(range,key,compare)}}}.call(this)}.call(this,{isBuffer:require("../insert-module-globals/node_modules/is-buffer/index.js")})},{"../insert-module-globals/node_modules/is-buffer/index.js":221}],262:[function(require,module,exports){"use strict";var inherits=require("inherits"),HashBase=require("hash-base"),Buffer=require("safe-buffer").Buffer,ARRAY16=new Array(16);function MD5(){HashBase.call(this,64),this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878}function rotl(x,n){return x<<n|x>>>32-n}function fnF(a,b,c,d,m,k,s){return rotl(a+(b&c|~b&d)+m+k|0,s)+b|0}function fnG(a,b,c,d,m,k,s){return rotl(a+(b&d|c&~d)+m+k|0,s)+b|0}function fnH(a,b,c,d,m,k,s){return rotl(a+(b^c^d)+m+k|0,s)+b|0}function fnI(a,b,c,d,m,k,s){return rotl(a+(c^(b|~d))+m+k|0,s)+b|0}inherits(MD5,HashBase),MD5.prototype._update=function(){for(var M=ARRAY16,i=0;i<16;++i)M[i]=this._block.readInt32LE(4*i);var a=fnF(this._a,b=this._b,c=this._c,d=this._d,M[0],3614090360,7),d=fnF(d,a,b,c,M[1],3905402710,12),c=fnF(c,d,a,b,M[2],606105819,17),b=fnF(b,c,d,a,M[3],3250441966,22);a=fnF(a,b,c,d,M[4],4118548399,7),d=fnF(d,a,b,c,M[5],1200080426,12),c=fnF(c,d,a,b,M[6],2821735955,17),b=fnF(b,c,d,a,M[7],4249261313,22),a=fnF(a,b,c,d,M[8],1770035416,7),d=fnF(d,a,b,c,M[9],2336552879,12),c=fnF(c,d,a,b,M[10],4294925233,17),b=fnF(b,c,d,a,M[11],2304563134,22),a=fnF(a,b,c,d,M[12],1804603682,7),d=fnF(d,a,b,c,M[13],4254626195,12),c=fnF(c,d,a,b,M[14],2792965006,17),a=fnG(a,b=fnF(b,c,d,a,M[15],1236535329,22),c,d,M[1],4129170786,5),d=fnG(d,a,b,c,M[6],3225465664,9),c=fnG(c,d,a,b,M[11],643717713,14),b=fnG(b,c,d,a,M[0],3921069994,20),a=fnG(a,b,c,d,M[5],3593408605,5),d=fnG(d,a,b,c,M[10],38016083,9),c=fnG(c,d,a,b,M[15],3634488961,14),b=fnG(b,c,d,a,M[4],3889429448,20),a=fnG(a,b,c,d,M[9],568446438,5),d=fnG(d,a,b,c,M[14],3275163606,9),c=fnG(c,d,a,b,M[3],4107603335,14),b=fnG(b,c,d,a,M[8],1163531501,20),a=fnG(a,b,c,d,M[13],2850285829,5),d=fnG(d,a,b,c,M[2],4243563512,9),c=fnG(c,d,a,b,M[7],1735328473,14),a=fnH(a,b=fnG(b,c,d,a,M[12],2368359562,20),c,d,M[5],4294588738,4),d=fnH(d,a,b,c,M[8],2272392833,11),c=fnH(c,d,a,b,M[11],1839030562,16),b=fnH(b,c,d,a,M[14],4259657740,23),a=fnH(a,b,c,d,M[1],2763975236,4),d=fnH(d,a,b,c,M[4],1272893353,11),c=fnH(c,d,a,b,M[7],4139469664,16),b=fnH(b,c,d,a,M[10],3200236656,23),a=fnH(a,b,c,d,M[13],681279174,4),d=fnH(d,a,b,c,M[0],3936430074,11),c=fnH(c,d,a,b,M[3],3572445317,16),b=fnH(b,c,d,a,M[6],76029189,23),a=fnH(a,b,c,d,M[9],3654602809,4),d=fnH(d,a,b,c,M[12],3873151461,11),c=fnH(c,d,a,b,M[15],530742520,16),a=fnI(a,b=fnH(b,c,d,a,M[2],3299628645,23),c,d,M[0],4096336452,6),d=fnI(d,a,b,c,M[7],1126891415,10),c=fnI(c,d,a,b,M[14],2878612391,15),b=fnI(b,c,d,a,M[5],4237533241,21),a=fnI(a,b,c,d,M[12],1700485571,6),d=fnI(d,a,b,c,M[3],2399980690,10),c=fnI(c,d,a,b,M[10],4293915773,15),b=fnI(b,c,d,a,M[1],2240044497,21),a=fnI(a,b,c,d,M[8],1873313359,6),d=fnI(d,a,b,c,M[15],4264355552,10),c=fnI(c,d,a,b,M[6],2734768916,15),b=fnI(b,c,d,a,M[13],1309151649,21),a=fnI(a,b,c,d,M[4],4149444226,6),d=fnI(d,a,b,c,M[11],3174756917,10),c=fnI(c,d,a,b,M[2],718787259,15),b=fnI(b,c,d,a,M[9],3951481745,21),this._a=this._a+a|0,this._b=this._b+b|0,this._c=this._c+c|0,this._d=this._d+d|0},MD5.prototype._digest=function(){this._block[this._blockOffset++]=128,56<this._blockOffset&&(this._block.fill(0,this._blockOffset,64),this._update(),this._blockOffset=0),this._block.fill(0,this._blockOffset,56),this._block.writeUInt32LE(this._length[0],56),this._block.writeUInt32LE(this._length[1],60),this._update();var buffer=Buffer.allocUnsafe(16);return buffer.writeInt32LE(this._a,0),buffer.writeInt32LE(this._b,4),buffer.writeInt32LE(this._c,8),buffer.writeInt32LE(this._d,12),buffer},module.exports=MD5},{"hash-base":189,inherits:220,"safe-buffer":367}],263:[function(require,module,exports){var bn=require("bn.js"),brorand=require("brorand");function MillerRabin(rand){this.rand=rand||new brorand.Rand}(module.exports=MillerRabin).create=function(rand){return new MillerRabin(rand)},MillerRabin.prototype._randbelow=function(n){var len=n.bitLength(),min_bytes=Math.ceil(len/8);do{var a=new bn(this.rand.generate(min_bytes))}while(0<=a.cmp(n));return a},MillerRabin.prototype._randrange=function(start,stop){stop=stop.sub(start);return start.add(this._randbelow(stop))},MillerRabin.prototype.test=function(n,k,cb){for(var len=n.bitLength(),red=bn.mont(n),rone=new bn(1).toRed(red),n1=(k=k||Math.max(1,len/48|0),n.subn(1)),s=0;!n1.testn(s);s++);for(var d=n.shrn(s),rn1=n1.toRed(red);0<k;k--){var a=this._randrange(new bn(2),n1),x=(cb&&cb(a),a.toRed(red).redPow(d));if(0!==x.cmp(rone)&&0!==x.cmp(rn1)){for(var i=1;i<s;i++){if(0===(x=x.redSqr()).cmp(rone))return!1;if(0===x.cmp(rn1))break}if(i===s)return!1}}return!0},MillerRabin.prototype.getDivisor=function(n,k){for(var len=n.bitLength(),red=bn.mont(n),rone=new bn(1).toRed(red),n1=(k=k||Math.max(1,len/48|0),n.subn(1)),s=0;!n1.testn(s);s++);for(var d=n.shrn(s),rn1=n1.toRed(red);0<k;k--){var a=this._randrange(new bn(2),n1),g=n.gcd(a);if(0!==g.cmpn(1))return g;var x=a.toRed(red).redPow(d);if(0!==x.cmp(rone)&&0!==x.cmp(rn1)){for(var i=1;i<s;i++){if(0===(x=x.redSqr()).cmp(rone))return x.fromRed().subn(1).gcd(n);if(0===x.cmp(rn1))break}if(i===s)return(x=x.redSqr()).fromRed().subn(1).gcd(n)}}return!1}},{"bn.js":264,brorand:67}],264:[function(require,module,exports){arguments[4][22][0].apply(exports,arguments)},{buffer:68,dup:22}],265:[function(require,module,exports){function assert(val,msg){if(!val)throw new Error(msg||"Assertion failed")}(module.exports=assert).equal=function(l,r,msg){if(l!=r)throw new Error(msg||"Assertion failed: "+l+" != "+r)}},{}],266:[function(require,module,exports){"use strict";function zero2(word){return 1===word.length?"0"+word:word}function toHex(msg){for(var res="",i=0;i<msg.length;i++)res+=zero2(msg[i].toString(16));return res}exports.toArray=function(msg,enc){if(Array.isArray(msg))return msg.slice();if(!msg)return[];var res=[];if("string"!=typeof msg){for(var i=0;i<msg.length;i++)res[i]=0|msg[i];return res}if("hex"===enc){(msg=msg.replace(/[^a-z0-9]+/gi,"")).length%2!=0&&(msg="0"+msg);for(i=0;i<msg.length;i+=2)res.push(parseInt(msg[i]+msg[i+1],16))}else for(i=0;i<msg.length;i++){var c=msg.charCodeAt(i),hi=c>>8,c=255&c;hi?res.push(hi,c):res.push(c)}return res},exports.zero2=zero2,exports.toHex=toHex,exports.encode=function(arr,enc){return"hex"===enc?toHex(arr):arr}},{}],267:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(){return"undefined"==typeof window?require("crypto").webcrypto:window.crypto}},{crypto:143}],268:[function(require,module,exports){!function(global,Buffer){!function(){"use strict";var __createBinding=this&&this.__createBinding||(Object.create?function(o,m,k,k2){void 0===k2&&(k2=k),Object.defineProperty(o,k2,{enumerable:!0,get:function(){return m[k]}})}:function(o,m,k,k2){o[k2=void 0===k2?k:k2]=m[k]}),__exportStar=this&&this.__exportStar||function(m,exports){for(var p in m)"default"===p||Object.prototype.hasOwnProperty.call(exports,p)||__createBinding(exports,m,p)},__importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}},elliptic_1=(Object.defineProperty(exports,"__esModule",{value:!0}),exports.ToolDb=exports.handleSubscribe=exports.handleQuery=exports.handlePut=exports.handlePong=exports.handlePing=exports.handleGet=exports.handleCrdtPut=exports.handleCrdtGet=exports.handleCrdt=exports.ToolDbNetwork=exports.ToolDbNetworkAdapter=exports.verifyData=exports.saveKeysComb=exports.loadKeysComb=exports.importKey=exports.generateKeysComb=exports.generateKeyPair=exports.generateKeyFromPassword=exports.exportKey=exports.encryptWithPass=exports.encryptData=exports.encodeKeyString=exports.deriveSecret=exports.decryptWithPass=exports.decryptData=exports.decodeKeyString=exports.verifyMessage=exports.uint8ToBase64=exports.toBase64=exports.textRandom=exports.stringToArrayBuffer=exports.randomAnimal=exports.generateIv=exports.fromBase64=exports.base64ToUint8=exports.base64ToBinaryDocument=exports.base64ToBinaryChange=exports.base64ToArrayBuffer=exports.arrayBufferToString=exports.arrayBufferToBase64=exports.signData=exports.sha256=exports.sha1=exports.uniq=exports.proofOfWork=void 0,__importDefault(require("elliptic"))),proofOfWork_1=(__exportStar(require("./types/tooldb"),exports),__exportStar(require("./types/message"),exports),global.Buffer=global.Buffer||require("buffer").Buffer,"undefined"==typeof btoa&&(global.btoa=function(str){return Buffer.from(str,"binary").toString("base64")}),"undefined"==typeof atob&&(global.atob=function(b64Encoded){return Buffer.from(b64Encoded,"base64").toString("binary")}),"undefined"==typeof window?(global.crypto=require("crypto").webcrypto,global.ecp256=new elliptic_1.default.ec("p256")):window.ecp256=new elliptic_1.default.ec("p256"),require("./utils/proofOfWork")),uniq_1=(Object.defineProperty(exports,"proofOfWork",{enumerable:!0,get:function(){return __importDefault(proofOfWork_1).default}}),require("./utils/uniq")),sha1_1=(Object.defineProperty(exports,"uniq",{enumerable:!0,get:function(){return __importDefault(uniq_1).default}}),require("./utils/sha1")),sha256_1=(Object.defineProperty(exports,"sha1",{enumerable:!0,get:function(){return __importDefault(sha1_1).default}}),require("./utils/sha256")),signData_1=(Object.defineProperty(exports,"sha256",{enumerable:!0,get:function(){return __importDefault(sha256_1).default}}),require("./utils/signData")),arrayBufferToBase64_1=(Object.defineProperty(exports,"signData",{enumerable:!0,get:function(){return __importDefault(signData_1).default}}),require("./utils/arrayBufferToBase64")),arrayBufferToString_1=(Object.defineProperty(exports,"arrayBufferToBase64",{enumerable:!0,get:function(){return __importDefault(arrayBufferToBase64_1).default}}),require("./utils/arrayBufferToString")),base64ToArrayBuffer_1=(Object.defineProperty(exports,"arrayBufferToString",{enumerable:!0,get:function(){return __importDefault(arrayBufferToString_1).default}}),require("./utils/base64ToArrayBuffer")),base64ToBinaryChange_1=(Object.defineProperty(exports,"base64ToArrayBuffer",{enumerable:!0,get:function(){return __importDefault(base64ToArrayBuffer_1).default}}),require("./utils/base64ToBinaryChange")),base64ToBinaryDocument_1=(Object.defineProperty(exports,"base64ToBinaryChange",{enumerable:!0,get:function(){return __importDefault(base64ToBinaryChange_1).default}}),require("./utils/base64ToBinaryDocument")),base64ToUint8_1=(Object.defineProperty(exports,"base64ToBinaryDocument",{enumerable:!0,get:function(){return __importDefault(base64ToBinaryDocument_1).default}}),require("./utils/base64ToUint8")),fromBase64_1=(Object.defineProperty(exports,"base64ToUint8",{enumerable:!0,get:function(){return __importDefault(base64ToUint8_1).default}}),require("./utils/fromBase64")),generateIv_1=(Object.defineProperty(exports,"fromBase64",{enumerable:!0,get:function(){return __importDefault(fromBase64_1).default}}),require("./utils/generateIv")),randomAnimal_1=(Object.defineProperty(exports,"generateIv",{enumerable:!0,get:function(){return __importDefault(generateIv_1).default}}),require("./utils/randomAnimal")),stringToArrayBuffer_1=(Object.defineProperty(exports,"randomAnimal",{enumerable:!0,get:function(){return __importDefault(randomAnimal_1).default}}),require("./utils/stringToArrayBuffer")),textRandom_1=(Object.defineProperty(exports,"stringToArrayBuffer",{enumerable:!0,get:function(){return __importDefault(stringToArrayBuffer_1).default}}),require("./utils/textRandom")),toBase64_1=(Object.defineProperty(exports,"textRandom",{enumerable:!0,get:function(){return __importDefault(textRandom_1).default}}),require("./utils/toBase64")),uint8ToBase64_1=(Object.defineProperty(exports,"toBase64",{enumerable:!0,get:function(){return __importDefault(toBase64_1).default}}),require("./utils/uint8ToBase64")),verifyMessage_1=(Object.defineProperty(exports,"uint8ToBase64",{enumerable:!0,get:function(){return __importDefault(uint8ToBase64_1).default}}),require("./utils/verifyMessage")),decodeKeyString_1=(Object.defineProperty(exports,"verifyMessage",{enumerable:!0,get:function(){return __importDefault(verifyMessage_1).default}}),require("./utils/crypto/decodeKeyString")),decryptData_1=(Object.defineProperty(exports,"decodeKeyString",{enumerable:!0,get:function(){return __importDefault(decodeKeyString_1).default}}),require("./utils/crypto/decryptData")),decryptWithPass_1=(Object.defineProperty(exports,"decryptData",{enumerable:!0,get:function(){return __importDefault(decryptData_1).default}}),require("./utils/crypto/decryptWithPass")),deriveSecret_1=(Object.defineProperty(exports,"decryptWithPass",{enumerable:!0,get:function(){return __importDefault(decryptWithPass_1).default}}),require("./utils/crypto/deriveSecret")),encodeKeyString_1=(Object.defineProperty(exports,"deriveSecret",{enumerable:!0,get:function(){return __importDefault(deriveSecret_1).default}}),require("./utils/crypto/encodeKeyString")),encryptData_1=(Object.defineProperty(exports,"encodeKeyString",{enumerable:!0,get:function(){return __importDefault(encodeKeyString_1).default}}),require("./utils/crypto/encryptData")),encryptWithPass_1=(Object.defineProperty(exports,"encryptData",{enumerable:!0,get:function(){return __importDefault(encryptData_1).default}}),require("./utils/crypto/encryptWithPass")),exportKey_1=(Object.defineProperty(exports,"encryptWithPass",{enumerable:!0,get:function(){return __importDefault(encryptWithPass_1).default}}),require("./utils/crypto/exportKey")),generateKeyFromPassword_1=(Object.defineProperty(exports,"exportKey",{enumerable:!0,get:function(){return __importDefault(exportKey_1).default}}),require("./utils/crypto/generateKeyFromPassword")),generateKeyPair_1=(Object.defineProperty(exports,"generateKeyFromPassword",{enumerable:!0,get:function(){return __importDefault(generateKeyFromPassword_1).default}}),require("./utils/crypto/generateKeyPair")),generateKeysComb_1=(Object.defineProperty(exports,"generateKeyPair",{enumerable:!0,get:function(){return __importDefault(generateKeyPair_1).default}}),require("./utils/crypto/generateKeysComb")),importKey_1=(Object.defineProperty(exports,"generateKeysComb",{enumerable:!0,get:function(){return __importDefault(generateKeysComb_1).default}}),require("./utils/crypto/importKey")),loadKeysComb_1=(Object.defineProperty(exports,"importKey",{enumerable:!0,get:function(){return __importDefault(importKey_1).default}}),require("./utils/crypto/loadKeysComb")),saveKeysComb_1=(Object.defineProperty(exports,"loadKeysComb",{enumerable:!0,get:function(){return __importDefault(loadKeysComb_1).default}}),require("./utils/crypto/saveKeysComb")),verifyData_1=(Object.defineProperty(exports,"saveKeysComb",{enumerable:!0,get:function(){return __importDefault(saveKeysComb_1).default}}),require("./utils/crypto/verifyData")),networkAdapterBase_1=(Object.defineProperty(exports,"verifyData",{enumerable:!0,get:function(){return __importDefault(verifyData_1).default}}),require("./networkAdapterBase")),toolDbNetwork_1=(Object.defineProperty(exports,"ToolDbNetworkAdapter",{enumerable:!0,get:function(){return __importDefault(networkAdapterBase_1).default}}),require("./toolDbNetwork")),handleCrdt_1=(Object.defineProperty(exports,"ToolDbNetwork",{enumerable:!0,get:function(){return __importDefault(toolDbNetwork_1).default}}),require("./messageHandlers/handleCrdt")),handleCrdtGet_1=(Object.defineProperty(exports,"handleCrdt",{enumerable:!0,get:function(){return __importDefault(handleCrdt_1).default}}),require("./messageHandlers/handleCrdtGet")),handleCrdtPut_1=(Object.defineProperty(exports,"handleCrdtGet",{enumerable:!0,get:function(){return __importDefault(handleCrdtGet_1).default}}),require("./messageHandlers/handleCrdtPut")),handleGet_1=(Object.defineProperty(exports,"handleCrdtPut",{enumerable:!0,get:function(){return __importDefault(handleCrdtPut_1).default}}),require("./messageHandlers/handleGet")),handlePing_1=(Object.defineProperty(exports,"handleGet",{enumerable:!0,get:function(){return __importDefault(handleGet_1).default}}),require("./messageHandlers/handlePing")),handlePong_1=(Object.defineProperty(exports,"handlePing",{enumerable:!0,get:function(){return __importDefault(handlePing_1).default}}),require("./messageHandlers/handlePong")),handlePut_1=(Object.defineProperty(exports,"handlePong",{enumerable:!0,get:function(){return __importDefault(handlePong_1).default}}),require("./messageHandlers/handlePut")),handleQuery_1=(Object.defineProperty(exports,"handlePut",{enumerable:!0,get:function(){return __importDefault(handlePut_1).default}}),require("./messageHandlers/handleQuery")),handleSubscribe_1=(Object.defineProperty(exports,"handleQuery",{enumerable:!0,get:function(){return __importDefault(handleQuery_1).default}}),require("./messageHandlers/handleSubscribe")),tooldb_1=(Object.defineProperty(exports,"handleSubscribe",{enumerable:!0,get:function(){return __importDefault(handleSubscribe_1).default}}),require("./tooldb"));Object.defineProperty(exports,"ToolDb",{enumerable:!0,get:function(){return __importDefault(tooldb_1).default}})}.call(this)}.call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},require("buffer").Buffer)},{"./messageHandlers/handleCrdt":271,"./messageHandlers/handleCrdtGet":272,"./messageHandlers/handleCrdtPut":273,"./messageHandlers/handleGet":275,"./messageHandlers/handlePing":276,"./messageHandlers/handlePong":277,"./messageHandlers/handlePut":278,"./messageHandlers/handleQuery":279,"./messageHandlers/handleSubscribe":280,"./networkAdapterBase":281,"./toolDbNetwork":290,"./tooldb":298,"./types/message":299,"./types/tooldb":300,"./utils/arrayBufferToBase64":301,"./utils/arrayBufferToString":303,"./utils/base64ToArrayBuffer":304,"./utils/base64ToBinaryChange":305,"./utils/base64ToBinaryDocument":306,"./utils/base64ToUint8":307,"./utils/crypto/decodeKeyString":309,"./utils/crypto/decryptData":310,"./utils/crypto/decryptWithPass":311,"./utils/crypto/deriveSecret":312,"./utils/crypto/encodeKeyString":313,"./utils/crypto/encryptData":314,"./utils/crypto/encryptWithPass":315,"./utils/crypto/exportKey":316,"./utils/crypto/generateKeyFromPassword":317,"./utils/crypto/generateKeyPair":318,"./utils/crypto/generateKeysComb":319,"./utils/crypto/importKey":320,"./utils/crypto/loadKeysComb":321,"./utils/crypto/saveKeysComb":322,"./utils/crypto/verifyData":323,"./utils/fromBase64":324,"./utils/generateIv":325,"./utils/proofOfWork":330,"./utils/randomAnimal":331,"./utils/sha1":332,"./utils/sha256":333,"./utils/signData":334,"./utils/stringToArrayBuffer":335,"./utils/textRandom":336,"./utils/toBase64":337,"./utils/uint8ToBase64":338,"./utils/uniq":339,"./utils/verifyMessage":340,buffer:112,crypto:143,elliptic:159}],269:[function(require,module,exports){"use strict";var __importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}},automerge_1=(Object.defineProperty(exports,"__esModule",{value:!0}),__importDefault(require("automerge")));exports.default=function(key,doDefault){var _this=this;return void 0===doDefault&&(doDefault=!0),new Promise(function(resolve,reject){_this.documents[key]?resolve(_this.documents[key]):_this.store.get(key+".crdt",function(err,data){var loaded_1,currentDoc=null;data?("string"==typeof(loaded_1=data)&&(data=data.split(","),loaded_1=new Uint8Array(data.length),data.forEach(function(s,i){loaded_1[i]=parseInt(s)})),currentDoc=automerge_1.default.load(loaded_1)):doDefault&&(currentDoc=automerge_1.default.init()),resolve(currentDoc)})})}},{automerge:61}],270:[function(require,module,exports){"use strict";var __spreadArray=this&&this.__spreadArray||function(to,from,pack){if(pack||2===arguments.length)for(var ar,i=0,l=from.length;i<l;i++)!ar&&i in from||((ar=ar||Array.prototype.slice.call(from,0,i))[i]=from[i]);return to.concat(ar||Array.prototype.slice.call(from))},_1=(Object.defineProperty(exports,"__esModule",{value:!0}),require("."));exports.default=function(arg0,arg1,arg2,arg3,arg4,arg5){var title,isNode;this.options.debug&&(title=(isNode="undefined"==typeof window)?this.options.storageName:"%c"+this.options.storageName,isNode=isNode?"":"background: #"+(0,_1.sha1)(this.options.storageName).slice(-6)+"; padding: 2px; color: black",console.log.apply(console,__spreadArray([title,isNode],[arg0,arg1,arg2,arg3,arg4,arg4,arg5].slice(0,arguments.length),!1)))}},{".":268}],271:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var __1=require("..");exports.default=function(message,remotePeerId){var key=message.key,message=(this.triggerKeyListener(key,message),(0,__1.base64ToBinaryDocument)(message.doc));this.store.put(key+".crdt",message,function(err,data){})}},{"..":268}],272:[function(require,module,exports){"use strict";var __importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}},automerge_1=(Object.defineProperty(exports,"__esModule",{value:!0}),__importDefault(require("automerge"))),__1=require("..");exports.default=function(message,remotePeerId){var _this=this;this.loadCrdtDocument(message.key,!1).then(function(currentDoc){currentDoc?(currentDoc=automerge_1.default.save(currentDoc||automerge_1.default.init()),_this.network.sendToClientId(remotePeerId,{type:"crdt",id:message.id,key:message.key,to:[],doc:(0,__1.uint8ToBase64)(currentDoc)})):(_this.logger("Local key not found, relay",JSON.stringify(message)),_this.network.sendToAll(message,!0))})}},{"..":268,automerge:61}],273:[function(require,module,exports){"use strict";var __importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}},automerge_1=(Object.defineProperty(exports,"__esModule",{value:!0}),__importDefault(require("automerge"))),__1=require(".."),toolDbVerificationWrapper_1=__importDefault(require("../toolDbVerificationWrapper"));exports.default=function(message,remotePeerId){var _this=this;toolDbVerificationWrapper_1.default.call(this,message).then(function(value){if(value===__1.VerifyResult.Verified){var key_1=message.k,data=[];try{data=JSON.parse(message.v)}catch(e){}var changes_1=data.map(__1.base64ToBinaryChange);_this.loadCrdtDocument(key_1).then(function(currentDoc){var newDoc=automerge_1.default.init();try{newDoc=automerge_1.default.applyChanges(currentDoc||automerge_1.default.init(),changes_1)[0]}catch(e){try{newDoc=automerge_1.default.applyChanges(automerge_1.default.init(),changes_1)[0]}catch(ee){_this.logger(ee)}}_this.documents[key_1]=newDoc;currentDoc=automerge_1.default.save(newDoc),_this.store.put(key_1+".crdt",currentDoc,function(err,data){}),newDoc={type:"crdt",key:key_1,id:message.id,to:[],doc:(0,__1.uint8ToBase64)(currentDoc)};_this.triggerKeyListener(key_1,newDoc),_this.network.sendToAll(newDoc,!0)})}else console.log("unverified message",value,message)})}},{"..":268,"../toolDbVerificationWrapper":297,automerge:61}],274:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(message,remotePeerId){var _this=this;if(this.functions[message.function])try{this.functions[message.function](message.args).then(function(ret){ret={return:ret,type:"functionReturn",id:message.id,code:"OK",to:[]};_this.network.sendToClientId(remotePeerId,ret)}).catch(function(e){e={return:JSON.stringify(e),type:"functionReturn",id:message.id,code:"ERR",to:[]};_this.network.sendToClientId(remotePeerId,e)})}catch(e){var messageReturn={return:e.toString(),type:"functionReturn",id:message.id,code:"ERR",to:[]};this.network.sendToClientId(remotePeerId,messageReturn)}else{messageReturn={return:"Function not found",type:"functionReturn",id:message.id,code:"NOT_FOUND",to:[]};this.network.sendToClientId(remotePeerId,messageReturn)}}},{}],275:[function(require,module,exports){"use strict";var __assign=this&&this.__assign||function(){return(__assign=Object.assign||function(t){for(var s,i=1,n=arguments.length;i<n;i++)for(var p in s=arguments[i])Object.prototype.hasOwnProperty.call(s,p)&&(t[p]=s[p]);return t}).apply(this,arguments)};Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(message,remotePeerId){var _this=this;this.store.get(message.key,function(err,data){if(data)try{var oldData=__assign(__assign({type:"put"},JSON.parse(data)),{id:message.id,to:[]});_this.network.sendToClientId(remotePeerId,oldData)}catch(e){}else _this.logger("Local key not found, relay",JSON.stringify(message)),_this.network.sendToAll(message,!0)})}},{}],276:[function(require,module,exports){"use strict";var __importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}},verifyPeer_1=(Object.defineProperty(exports,"__esModule",{value:!0}),__importDefault(require("../utils/verifyPeer")));exports.default=function(message,remotePeerId){var _this=this;this.isConnected||(this.isConnected=!0,this.onConnect()),(0,verifyPeer_1.default)(message.peer).then(function(verified){verified&&message.peer.topic===_this.options.topic?(_this.peers[message.peer.pubkey]=message.peer,0===_this.serverPeers.filter(function(p){return p.pubkey===message.peer.pubkey}).length&&message.isServer&&_this.serverPeers.push(message.peer),_this.network.sendToClientId(remotePeerId,{type:"pong",isServer:_this.options.server,clientId:_this.network.getClientAddress(),to:[],servers:_this.serverPeers,id:message.id}),_this.onPeerConnect(message.peer.pubkey)):_this.logger("Blocked a remote peer from joining; ",message)})}},{"../utils/verifyPeer":341}],277:[function(require,module,exports){"use strict";var __importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}},verifyPeer_1=(Object.defineProperty(exports,"__esModule",{value:!0}),__importDefault(require("../utils/verifyPeer")));exports.default=function(message,remotePeerId){var _this=this;this.isConnected||(this.isConnected=!0,this.onConnect()),message.servers&&message.servers.forEach(function(peer){(0,verifyPeer_1.default)(peer).then(function(verified){verified&&peer.topic===_this.options.topic&&(_this.peers[peer.pubkey]=peer,0===_this.serverPeers.filter(function(p){return p.pubkey===peer.pubkey}).length&&peer.host&&peer.port&&_this.serverPeers.push(peer))})}),this.onPeerConnect(message.clientId)}},{"../utils/verifyPeer":341}],278:[function(require,module,exports){"use strict";var __assign=this&&this.__assign||function(){return(__assign=Object.assign||function(t){for(var s,i=1,n=arguments.length;i<n;i++)for(var p in s=arguments[i])Object.prototype.hasOwnProperty.call(s,p)&&(t[p]=s[p]);return t}).apply(this,arguments)},__importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}},__1=(Object.defineProperty(exports,"__esModule",{value:!0}),require("..")),toolDbVerificationWrapper_1=__importDefault(require("../toolDbVerificationWrapper"));exports.default=function(message,remotePeerId){var _this=this;toolDbVerificationWrapper_1.default.call(this,message).then(function(value){value===__1.VerifyResult.Verified?(_this.network.sendToAll(message,!0),_this.store.get(message.k,function(err,oldData){var key;!oldData||(oldData=__assign({type:"put",to:[]},JSON.parse(oldData))).t<message.t?(key=message.k,_this.triggerKeyListener(key,message),_this.store.put(message.k,JSON.stringify(message),function(err,data){})):(key=message.k,_this.triggerKeyListener(key,oldData))})):console.warn("unverified message: ",value,message)})}},{"..":268,"../toolDbVerificationWrapper":297}],279:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(message,remotePeerId){var _this=this;message.key.length<3||(this.store.query(message.key).then(function(keys){_this.network.sendToClientId(remotePeerId,{type:"queryAck",id:message.id,to:[],keys:keys})}),this.options.server&&this.network.sendToAll(message,!0))}},{}],280:[function(require,module,exports){"use strict";var __assign=this&&this.__assign||function(){return(__assign=Object.assign||function(t){for(var s,i=1,n=arguments.length;i<n;i++)for(var p in s=arguments[i])Object.prototype.hasOwnProperty.call(s,p)&&(t[p]=s[p]);return t}).apply(this,arguments)},__importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}},automerge_1=(Object.defineProperty(exports,"__esModule",{value:!0}),__importDefault(require("automerge"))),__1=require("..");exports.default=function(message,remotePeerId){var subId,_this=this;remotePeerId&&(subId=remotePeerId+"-"+message.key,this.subscriptions.includes(subId)||(this.subscriptions.push(subId),this.addKeyListener(message.key,function(msg){"put"!==msg.type&&"crdt"!==msg.type||!remotePeerId||_this.network.sendToClientId(remotePeerId,msg)}))),this.store.get(message.key,function(err,data){if(data)try{var oldData=__assign(__assign({},JSON.parse(data)),{id:message.id,to:[]});_this.network.sendToClientId(remotePeerId,oldData)}catch(e){}}),this.loadCrdtDocument(message.key,!1).then(function(doc){doc&&(doc=automerge_1.default.save(doc),doc={type:"crdt",key:message.key,to:[],id:(0,__1.textRandom)(10),doc:(0,__1.uint8ToBase64)(doc)},_this.network.sendToClientId(remotePeerId,doc))})}},{"..":268,automerge:61}],281:[function(require,module,exports){"use strict";var __assign=this&&this.__assign||function(){return(__assign=Object.assign||function(t){for(var s,i=1,n=arguments.length;i<n;i++)for(var p in s=arguments[i])Object.prototype.hasOwnProperty.call(s,p)&&(t[p]=s[p]);return t}).apply(this,arguments)},__spreadArray=this&&this.__spreadArray||function(to,from,pack){if(pack||2===arguments.length)for(var ar,i=0,l=from.length;i<l;i++)!ar&&i in from||((ar=ar||Array.prototype.slice.call(from,0,i))[i]=from[i]);return to.concat(ar||Array.prototype.slice.call(from))},__importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}},_1=(Object.defineProperty(exports,"__esModule",{value:!0}),require(".")),getPeerSignature_1=__importDefault(require("./utils/getPeerSignature")),__importDefault=function(){function ToolDbNetworkAdapter(db){var _this=this;this._clientToSend={},this._isClientConnected={},this._clientIsServer={},(this._tooldb=db).on("init",function(){_this.tooldb.options.server&&_this.getMeAsPeer().then(function(meAsPeer){_this.tooldb.serverPeers.push(meAsPeer)})})}return Object.defineProperty(ToolDbNetworkAdapter.prototype,"clientToSend",{get:function(){return this._clientToSend},enumerable:!1,configurable:!0}),Object.defineProperty(ToolDbNetworkAdapter.prototype,"isClientConnected",{get:function(){return this._isClientConnected},enumerable:!1,configurable:!0}),Object.defineProperty(ToolDbNetworkAdapter.prototype,"tooldb",{get:function(){return this._tooldb},enumerable:!1,configurable:!0}),ToolDbNetworkAdapter.prototype.getMeAsPeer=function(){var _this=this,timestamp=(new Date).getTime();return void 0===this.tooldb.options.defaultKeys?Promise.reject():(0,getPeerSignature_1.default)(this.tooldb.options.defaultKeys.privateKey,this.tooldb.options.topic,timestamp,this.tooldb.options.host,this.tooldb.options.port).then(function(signature){return{topic:_this.tooldb.options.topic,timestamp:timestamp,host:_this.tooldb.options.host,port:_this.tooldb.options.port,pubkey:_this.tooldb.getPubKey(),sig:signature}})},ToolDbNetworkAdapter.prototype.isConnected=function(clientId){return!!this._isClientConnected[clientId]&&this._isClientConnected[clientId]()},ToolDbNetworkAdapter.prototype.isServer=function(clientId){return this._clientIsServer[clientId]||!1},ToolDbNetworkAdapter.prototype.craftPingMessage=function(){var _this=this;return this.getMeAsPeer().then(function(meAsPeer){return JSON.stringify({type:"ping",clientId:_this.getClientAddress(),to:[_this.getClientAddress()],isServer:_this.tooldb.options.server,id:(0,_1.textRandom)(10),peer:meAsPeer})})},ToolDbNetworkAdapter.prototype.executeSendToClient=function(clientId,message){this._clientToSend[clientId]&&this._clientToSend[clientId](message)},ToolDbNetworkAdapter.prototype.getClientAddress=function(){return this.tooldb.pubKey},ToolDbNetworkAdapter.prototype.onClientDisconnect=function(clientId){delete this._clientToSend[clientId],delete this._clientIsServer[clientId],delete this._isClientConnected[clientId]},ToolDbNetworkAdapter.prototype.onClientMessage=function(message,clientId,setClientId){clientId&&!this.tooldb.processedOutHashes[clientId]&&(this.tooldb.processedOutHashes[clientId]=[]);try{var cid,parsedMessage=JSON.parse(message);"ping"===parsedMessage.type||"pong"===parsedMessage.type?(setClientId(cid=parsedMessage.clientId),this._clientIsServer[cid]=parsedMessage.isServer,this.tooldb.processedOutHashes[cid]=[],this.tooldb.clientOnMessage(parsedMessage,cid)):clientId&&this.tooldb.clientOnMessage(parsedMessage,clientId)}catch(e){this.tooldb.logger("Got message ERR",message),this.tooldb.logger(e)}},ToolDbNetworkAdapter.prototype.sendToAll=function(msg,crossServerOnly){var _this=this,pubkey=(void 0===crossServerOnly&&(crossServerOnly=!1),this.getClientAddress()),to=pubkey?(0,_1.uniq)(__spreadArray(__spreadArray([],msg.to,!0),[pubkey],!1)):msg.to,finalMessage=JSON.stringify(__assign(__assign({},msg),{to:to}));Object.keys(this.clientToSend).filter(function(id){return!to.includes(id)}).filter(function(clientId){return _this.isConnected(clientId)}).forEach(function(clientId){(crossServerOnly&&_this.isServer(clientId)||!crossServerOnly)&&(_this.tooldb.logger(to.map(function(k){return k.slice(-20)}),"Sent out to (all):",clientId.slice(-20)),"put"===msg.type||"crdtPut"===msg.type?_this.tooldb.processedOutHashes[clientId].includes(msg.h)||(_this.executeSendToClient(clientId,finalMessage),_this.tooldb.processedOutHashes[clientId].push(msg.h)):_this.executeSendToClient(clientId,finalMessage))})},ToolDbNetworkAdapter.prototype.sendToClientId=function(clientId,msg){var pubkey=this.getClientAddress(),pubkey=pubkey?(0,_1.uniq)(__spreadArray(__spreadArray([],msg.to,!0),[pubkey],!1)):msg.to,finalMessage=JSON.stringify(__assign(__assign({},msg),{to:pubkey}));this.tooldb.logger(pubkey.map(function(k){return k.slice(-20)}),"Sent out to (single):",clientId.slice(-20)),"put"===msg.type||"crdtPut"===msg.type?clientId&&!this.tooldb.processedOutHashes[clientId].includes(msg.h)&&(this.executeSendToClient(clientId,finalMessage),this.tooldb.processedOutHashes[clientId].push(msg.h)):this.executeSendToClient(clientId,finalMessage)},ToolDbNetworkAdapter}();exports.default=__importDefault},{".":268,"./utils/getPeerSignature":326}],282:[function(require,module,exports){"use strict";var __importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}},encodeKeyString_1=(Object.defineProperty(exports,"__esModule",{value:!0}),__importDefault(require("./utils/crypto/encodeKeyString"))),exportKey_1=__importDefault(require("./utils/crypto/exportKey")),generateKeysComb_1=__importDefault(require("./utils/crypto/generateKeysComb")),randomAnimal_1=__importDefault(require("./utils/randomAnimal"));exports.default=function(){var _this=this;return(0,generateKeysComb_1.default)().then(function(newKeys){return(0,exportKey_1.default)("spki",newKeys.signKeys.publicKey).then(function(skpub){return(0,encodeKeyString_1.default)(skpub)}).then(function(pubKey){return _this.user={keys:newKeys,name:"Anonymous "+(0,randomAnimal_1.default)(),pubKey:pubKey},newKeys})})}},{"./utils/crypto/encodeKeyString":313,"./utils/crypto/exportKey":316,"./utils/crypto/generateKeysComb":319,"./utils/randomAnimal":331}],283:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(message,remotePeerId){var msgId;if(this.processedIds[message.type]||(this.processedIds[message.type]=[]),!this.processedIds[message.type].includes(message.id))if(this.processedIds[message.type].push(message.id),this.logger("message",message,remotePeerId),message.id&&(msgId=message.id,this._idListeners[msgId]&&(this._idListeners[msgId](message),this.removeIdListener(msgId))),void 0===message||void 0===message.type)this.logger("Message is invalid!",message,typeof message);else switch(message.type){case"ping":this.handlePing(message,remotePeerId);break;case"pong":this.handlePong(message,remotePeerId);break;case"subscribe":this.handleSubscribe(message,remotePeerId);break;case"get":this.handleGet(message,remotePeerId);break;case"put":this.handlePut(message,remotePeerId);break;case"crdtPut":this.handleCrdtPut(message,remotePeerId);break;case"crdtGet":this.handleCrdtGet(message,remotePeerId);break;case"query":this.handleQuery(message,remotePeerId);break;case"crdt":this.handleCrdt(message,remotePeerId);break;case"function":this.handleFunction(message,remotePeerId)}}},{}],284:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _1=require(".");exports.default=function(key,userNamespaced,timeoutMs){var _this=this;return void 0===userNamespaced&&(userNamespaced=!1),void 0===timeoutMs&&(timeoutMs=1e3),new Promise(function(resolve,reject){var _a,finalKey,msgId,cancelTimeout;userNamespaced&&void 0===(null==(_a=_this.user)?void 0:_a.pubKey)?reject(new Error("You are not authorized yet!")):(finalKey=userNamespaced?":"+(null==(_a=_this.user)?void 0:_a.pubKey)+"."+key:key,_this.logger("CRDT GET > "+finalKey),msgId=(0,_1.textRandom)(10),cancelTimeout=setTimeout(function(){_this.loadCrdtDocument(finalKey).then(function(data){if(data)try{_this.removeIdListener(msgId),resolve(data)}catch(e){resolve(null)}else resolve(null)})},timeoutMs),_this.addIdListener(msgId,function(msg){_this.logger("CRDT GET RECV  > "+finalKey,msg),clearTimeout(cancelTimeout),"crdt"===msg.type&&resolve(msg.doc)}),_this.network.sendToAll({type:"crdtGet",to:[],key:finalKey,id:msgId}))})}},{".":268}],285:[function(require,module,exports){"use strict";var __assign=this&&this.__assign||function(){return(__assign=Object.assign||function(t){for(var s,i=1,n=arguments.length;i<n;i++)for(var p in s=arguments[i])Object.prototype.hasOwnProperty.call(s,p)&&(t[p]=s[p]);return t}).apply(this,arguments)},__awaiter=this&&this.__awaiter||function(thisArg,_arguments,P,generator){return new(P=P||Promise)(function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator.throw(value))}catch(e){reject(e)}}function step(result){var value;result.done?resolve(result.value):((value=result.value)instanceof P?value:new P(function(resolve){resolve(value)})).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())})},__generator=this&&this.__generator||function(thisArg,body){var f,y,t,_={label:0,sent:function(){if(1&t[0])throw t[1];return t[1]},trys:[],ops:[]},g={next:verb(0),throw:verb(1),return:verb(2)};return"function"==typeof Symbol&&(g[Symbol.iterator]=function(){return this}),g;function verb(n){return function(v){var op=[n,v];if(f)throw new TypeError("Generator is already executing.");for(;_;)try{if(f=1,y&&(t=2&op[0]?y.return:op[0]?y.throw||((t=y.return)&&t.call(y),0):y.next)&&!(t=t.call(y,op[1])).done)return t;switch(y=0,(op=t?[2&op[0],t.value]:op)[0]){case 0:case 1:t=op;break;case 4:return _.label++,{value:op[1],done:!1};case 5:_.label++,y=op[1],op=[0];continue;case 7:op=_.ops.pop(),_.trys.pop();continue;default:if(!(t=0<(t=_.trys).length&&t[t.length-1])&&(6===op[0]||2===op[0])){_=0;continue}if(3===op[0]&&(!t||op[1]>t[0]&&op[1]<t[3])){_.label=op[1];break}if(6===op[0]&&_.label<t[1]){_.label=t[1],t=op;break}if(t&&_.label<t[2]){_.label=t[2],_.ops.push(op);break}t[2]&&_.ops.pop(),_.trys.pop();continue}op=body.call(thisArg,_)}catch(e){op=[6,e],y=0}finally{f=t=0}if(5&op[0])throw op[1];return{value:op[0]?op[1]:void 0,done:!0}}}},__importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}},_1=(Object.defineProperty(exports,"__esModule",{value:!0}),require(".")),proofOfWork_1=__importDefault(require("./utils/proofOfWork")),signData_1=__importDefault(require("./utils/signData"));exports.default=function(key,value,userNamespaced){var _this=this;return void 0===userNamespaced&&(userNamespaced=!1),new Promise(function(resolve,reject){var timestamp,encodedData,dataString;key.includes(".")?reject(new Error("Key cannot include dots!; "+key)):_this.user?(timestamp=(new Date).getTime(),dataString=""+(encodedData=JSON.stringify(value.map(_1.uint8ToBase64)))+_this.user.pubKey+timestamp,(0,proofOfWork_1.default)(dataString,_this.options.pow).then(function(_a){var hash=_a.hash,nonce=_a.nonce;null!=(_a=_this.user)&&_a.keys&&(0,signData_1.default)(hash,_this.user.keys.signKeys.privateKey).then(function(signature){return __awaiter(_this,void 0,void 0,function(){var data,_a;return __generator(this,function(_c){return data={k:userNamespaced?":"+(null==(_a=this.user)?void 0:_a.pubKey)+"."+key:key,p:(null==(_a=this.user)?void 0:_a.pubKey)||"",n:nonce,t:timestamp,h:hash,s:(0,_1.arrayBufferToBase64)(signature),v:encodedData},this.logger("PUT CRDT > "+key,data),data=__assign({type:"crdtPut",id:(0,_1.textRandom)(10),to:[]},data),this.network.sendToAll(data),resolve(data),[2]})})}).catch(reject)}).catch(reject)):reject(new Error("You need to log in before you can PUT."))})}},{".":268,"./utils/proofOfWork":330,"./utils/signData":334}],286:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _1=require(".");exports.default=function(fName,args,timeoutMs){var _this=this;return void 0===timeoutMs&&(timeoutMs=1e4),new Promise(function(resolve,reject){_this.logger("FUNCTION > "+fName);var msgId=(0,_1.textRandom)(10),cancelTimeout=setTimeout(function(){resolve({return:"Timed out",code:"ERR"})},timeoutMs);_this.addIdListener(msgId,function(msg){_this.logger("FUNCTION RECV  > "+fName,msg),clearTimeout(cancelTimeout),"functionReturn"===msg.type&&resolve({return:msg.return,code:msg.code})}),_this.network.sendToAll({type:"function",to:[],function:fName,args:args,id:msgId})})}},{".":268}],287:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _1=require(".");exports.default=function(key,userNamespaced,timeoutMs){var _this=this;return void 0===userNamespaced&&(userNamespaced=!1),void 0===timeoutMs&&(timeoutMs=1e3),new Promise(function(resolve,reject){var _a,finalKey,msgId,cancelTimeout;userNamespaced&&void 0===(null==(_a=_this.user)?void 0:_a.pubKey)?reject(new Error("You are not authorized yet!")):(finalKey=userNamespaced?":"+(null==(_a=_this.user)?void 0:_a.pubKey)+"."+key:key,_this.logger("GET > "+finalKey),msgId=(0,_1.textRandom)(10),cancelTimeout=setTimeout(function(){_this.store.get(finalKey,function(err,data){if(data)try{var message=JSON.parse(data);resolve(message.v)}catch(e){resolve(null)}else resolve(null)})},timeoutMs),_this.addIdListener(msgId,function(msg){_this.logger("GET RECV  > "+finalKey,msg),clearTimeout(cancelTimeout),"put"===msg.type&&resolve(msg.v)}),_this.store.get(finalKey,function(err,data){if(data)try{var val=JSON.parse(data).v;clearTimeout(cancelTimeout),_this.removeIdListener(msgId),resolve(val)}catch(e){}}),_this.network.sendToAll({type:"get",to:[],key:finalKey,id:msgId}))})}},{".":268}],288:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(){if(""===this.pubKey||void 0===this.pubKey)throw new Error("You are not authorized yet.");return this.pubKey}},{}],289:[function(require,module,exports){"use strict";var __importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}},encodeKeyString_1=(Object.defineProperty(exports,"__esModule",{value:!0}),__importDefault(require("./utils/crypto/encodeKeyString"))),exportKey_1=__importDefault(require("./utils/crypto/exportKey")),randomAnimal_1=__importDefault(require("./utils/randomAnimal"));exports.default=function(keys,username){var _this=this;return(0,exportKey_1.default)("spki",keys.signKeys.publicKey).then(function(skpub){return(0,encodeKeyString_1.default)(skpub)}).then(function(pubKey){return _this.user={keys:keys,name:username||"Anonymous "+(0,randomAnimal_1.default)(),pubKey:pubKey},keys})}},{"./utils/crypto/encodeKeyString":313,"./utils/crypto/exportKey":316,"./utils/randomAnimal":331}],290:[function(require,module,exports){"use strict";var extendStatics,__extends=this&&this.__extends||(extendStatics=function(d,b){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)Object.prototype.hasOwnProperty.call(b,p)&&(d[p]=b[p])})(d,b)},function(d,b){if("function"!=typeof b&&null!==b)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}),__assign=this&&this.__assign||function(){return(__assign=Object.assign||function(t){for(var s,i=1,n=arguments.length;i<n;i++)for(var p in s=arguments[i])Object.prototype.hasOwnProperty.call(s,p)&&(t[p]=s[p]);return t}).apply(this,arguments)},__awaiter=this&&this.__awaiter||function(thisArg,_arguments,P,generator){return new(P=P||Promise)(function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator.throw(value))}catch(e){reject(e)}}function step(result){var value;result.done?resolve(result.value):((value=result.value)instanceof P?value:new P(function(resolve){resolve(value)})).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())})},__generator=this&&this.__generator||function(thisArg,body){var f,y,t,_={label:0,sent:function(){if(1&t[0])throw t[1];return t[1]},trys:[],ops:[]},g={next:verb(0),throw:verb(1),return:verb(2)};return"function"==typeof Symbol&&(g[Symbol.iterator]=function(){return this}),g;function verb(n){return function(v){var op=[n,v];if(f)throw new TypeError("Generator is already executing.");for(;_;)try{if(f=1,y&&(t=2&op[0]?y.return:op[0]?y.throw||((t=y.return)&&t.call(y),0):y.next)&&!(t=t.call(y,op[1])).done)return t;switch(y=0,(op=t?[2&op[0],t.value]:op)[0]){case 0:case 1:t=op;break;case 4:return _.label++,{value:op[1],done:!1};case 5:_.label++,y=op[1],op=[0];continue;case 7:op=_.ops.pop(),_.trys.pop();continue;default:if(!(t=0<(t=_.trys).length&&t[t.length-1])&&(6===op[0]||2===op[0])){_=0;continue}if(3===op[0]&&(!t||op[1]>t[0]&&op[1]<t[3])){_.label=op[1];break}if(6===op[0]&&_.label<t[1]){_.label=t[1],t=op;break}if(t&&_.label<t[2]){_.label=t[2],_.ops.push(op);break}t[2]&&_.ops.pop(),_.trys.pop();continue}op=body.call(thisArg,_)}catch(e){op=[6,e],y=0}finally{f=t=0}if(5&op[0])throw op[1];return{value:op[0]?op[1]:void 0,done:!0}}}},__importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}},ws_1=(Object.defineProperty(exports,"__esModule",{value:!0}),__importDefault(require("ws"))),_1=require("."),arrayBufferToHex_1=__importDefault(require("./utils/arrayBufferToHex")),waitFor_1=__importDefault(require("./utils/waitFor")),defaultTrackerUrls=["wss://tracker.webtorrent.dev","wss://tracker.openwebtorrent.com","wss://tracker.files.fm:7073/announce","wss://tooldb-tracker.herokuapp.com/"],__importDefault=function(_super){function ToolDbNetwork(db){var _this_1=_super.call(this,db)||this,_this=(_this_1._window="undefined"==typeof window?void 0:window,_this_1.isNode="undefined"!=typeof jest||"undefined"==typeof window,_this_1.wss=!_this_1.isNode&&_this_1._window?_this_1._window.WebSocket||_this_1._window.webkitWebSocket||_this_1._window.mozWebSocket:ws_1.default,_this_1.sockets={},_this_1.socketListeners={},_this_1.serverPeerData={},_this_1.serversBlacklist=[],_this_1.serverPeers=[],_this_1.serversFinding=[],_this_1.trackerUrls=defaultTrackerUrls,_this_1.handledOffers={},_this_1._awaitingConnections={},_this_1.server=null,_this_1._messageQueue=[],_this_1.removeFromAwaiting=function(pubkey){_this_1._awaitingConnections[pubkey]&&delete _this_1._awaitingConnections[pubkey]},_this_1.makeSocket=function(url){return new Promise(function(resolve){if(_this_1.sockets[url])resolve(_this_1.sockets[url]);else{_this_1.socketListeners[url]=_this_1.onSocketMessage;try{var socket_1=new _this_1.wss(url);_this_1.sockets[url]=socket_1;socket_1.onopen=function(){resolve(this)},socket_1.onmessage=function(e){return _this_1.socketListeners[url](socket_1,e)},socket_1.onerror=function(){delete _this_1.sockets[url],resolve(null)},socket_1.onclose=function(){delete _this_1.sockets[url]}}catch(e){resolve(null)}}})},_this_1.getServerPeerData=function(){return new Promise(function(resolve,reject){var _a;null!=(_a=_this_1.tooldb.options.defaultKeys)&&_a.privateKey?(0,_1.signData)(_this_1.tooldb.options.host,null==(_a=_this_1.tooldb.options.defaultKeys)?void 0:_a.privateKey).then(function(signature){signature={host:_this_1.tooldb.options.host,port:_this_1.tooldb.options.port,ssl:_this_1.tooldb.options.ssl,name:_this_1.tooldb.options.serverName,pubKey:_this_1.tooldb.getPubKey(),signature:(0,arrayBufferToHex_1.default)(signature)};resolve(signature)}):reject()})},_this_1.announce=function(socket,infoHash){return __awaiter(_this_1,void 0,void 0,function(){var pubKey,message;return __generator(this,function(_a){return pubKey=this.getClientAddress(),this.tooldb.logger("announce",infoHash,pubKey),pubKey&&(this.tooldb.options.server?this.getServerPeerData().then(function(offer){var offers=[0,1,2].map(function(n){return{offer:{sdp:JSON.stringify(offer),type:"offer"},offer_id:(0,_1.textRandom)(20)}}),offers={action:"announce",info_hash:infoHash,peer_id:pubKey.slice(-20),numwant:1,offers:offers};socket.send(JSON.stringify(offers))}):(message={action:"announce",info_hash:infoHash,peer_id:pubKey.slice(-20),numwant:1},socket.send(JSON.stringify(message)))),[2]})})},_this_1.announceAll=function(){return __awaiter(_this_1,void 0,void 0,function(){var infoHash,_this_1=this;return __generator(this,function(_a){return infoHash=this.codeToHash(this.tooldb.getPubKey()),this.trackerUrls.forEach(function(url,index){return __awaiter(_this_1,void 0,void 0,function(){var socket;return __generator(this,function(_a){switch(_a.label){case 0:return[4,this.makeSocket(url)];case 1:return(socket=_a.sent())&&1===socket.readyState&&this.announce(socket,infoHash),[2]}})})}),[2]})})},_this_1.findServer=function(serverKey){return __awaiter(_this_1,void 0,void 0,function(){var infoHash_1,_this_1=this;return __generator(this,function(_a){return console.log("findServer",serverKey),this.serversFinding.includes(serverKey)||(this.serversFinding.push(serverKey),infoHash_1=this.codeToHash(serverKey),this.trackerUrls.forEach(function(url){return __awaiter(_this_1,void 0,void 0,function(){var socket;return __generator(this,function(_a){switch(_a.label){case 0:return[4,this.makeSocket(url)];case 1:return(socket=_a.sent())&&1===socket.readyState&&this.announce(socket,infoHash_1),[2]}})})})),[2]})})},_this_1.stopAnnounce=function(){Object.values(_this_1.sockets).forEach(function(socket){socket&&(socket.terminate(),socket.close())}),_this_1.announceInterval&&clearInterval(_this_1.announceInterval)},_this_1.onSocketMessage=function(socket,e){return __awaiter(_this_1,void 0,void 0,function(){var val,serverData_1,_a;return __generator(this,function(_b){try{val=JSON.parse(e.data)}catch(_e){return this.tooldb.logger("Received malformed JSON",e.data),[2]}return val["failure reason"]||val.peer_id&&val.peer_id===(null==(_a=this.getClientAddress())?void 0:_a.slice(-20))||val.offer&&val.offer_id&&(this.handledOffers[val.offer_id]||(this.handledOffers[val.offer_id]=!0,serverData_1=JSON.parse(val.offer.sdp),0===this.serverPeers.filter(function(s){return s.pubKey===serverData_1.pubKey}).length&&-1===this.serversBlacklist.indexOf(serverData_1.pubKey)&&(console.log("Now we connect to ",serverData_1),this.connectTo(serverData_1)))),[2]})})},_this_1.connectTo=function(serverPeer){try{var wsUrl=serverPeer.ssl?"wss://"+serverPeer.host:"ws://"+serverPeer.host+":"+serverPeer.port,wss_1=new _this_1.wss(wsUrl),clientId_1=serverPeer.pubKey;return _this_1.serverPeers.push(serverPeer),_this_1.isClientConnected[serverPeer.pubKey]=function(){return wss_1.readyState===wss_1.OPEN},_this_1.clientToSend[serverPeer.pubKey]=function(_msg){wss_1.send(_msg)},_this_1._awaitingConnections[serverPeer.pubKey]?_this_1._awaitingConnections[serverPeer.pubKey].socket=wss_1:_this_1._awaitingConnections[serverPeer.pubKey]={socket:wss_1,tries:0,defer:null,server:__assign({},serverPeer)},wss_1.onclose=function(_error){_this_1.serverPeers=_this_1.serverPeers.filter(function(s){return s.pubKey!==serverPeer.pubKey}),-1===_this_1.serversBlacklist.indexOf(serverPeer.pubKey)&&_this_1.reconnect(serverPeer.pubKey)},wss_1.onerror=function(_error){_this_1.serverPeers=_this_1.serverPeers.filter(function(s){return s.pubKey!==serverPeer.pubKey}),"ETIMEDOUT"!==(null==(_error=null==_error?void 0:_error.error)?void 0:_error.code)&&-1===_this_1.serversBlacklist.indexOf(serverPeer.pubKey)&&_this_1.reconnect(serverPeer.pubKey)},wss_1.onopen=function(){_this_1.removeFromAwaiting(serverPeer.pubKey),_this_1.tooldb.logger("Connected to "+serverPeer.host+":"+serverPeer.port+" sucessfully."),_this_1.craftPingMessage().then(function(msg){wss_1.send(msg)}),_this_1.serverPeerData[serverPeer.pubKey]=serverPeer},wss_1.onmessage=function(msg){msg&&_this_1.onClientMessage(msg.data,clientId_1,function(id){clientId_1=id})},wss_1}catch(e){_this_1.tooldb.logger("onconnect err",e)}},_this_1.reconnect=function(pubkey){var connection=_this_1._awaitingConnections[pubkey];connection&&(connection.defer&&clearTimeout(connection.defer),_this_1.tooldb.logger("tries: "+connection.tries),connection.tries<_this_1.tooldb.options.maxRetries&&-1===_this_1.serversBlacklist.indexOf(pubkey)?connection.defer=setTimeout(function(){_this_1._awaitingConnections[pubkey].tries+=1,_this_1.tooldb.logger("connection to "+connection.server.host+":"+connection.server.port+" retry."),_this_1.connectTo(connection.server)},_this_1.tooldb.options.wait):(_this_1.tooldb.logger("connection attempts to "+connection.server.host+":"+connection.server.port+" exceeded,"),_this_1.serversBlacklist.push(pubkey),_this_1.removeFromAwaiting(pubkey)))},_this_1);return _this.tooldb.options.server&&(0,waitFor_1.default)(function(){try{return void 0!==_this.tooldb.getPubKey()}catch(_a){return!1}}).then(function(){setTimeout(function(){_this.announceInterval=setInterval(_this.announceAll,1e4),_this.announceAll()},500)}),_this_1.tooldb.options.server&&_this_1.isNode&&(_this_1.server=new ws_1.default.Server({port:_this_1.tooldb.options.port,server:_this_1.tooldb.options.httpServer}),_this_1.server.on("connection",function(socket){var clientId=null;socket.on("close",function(){clientId&&_this_1.onClientDisconnect(clientId)}),socket.on("error",function(){clientId&&_this_1.onClientDisconnect(clientId)}),socket.on("message",function(message){_this_1.onClientMessage(message,clientId||"",function(id){clientId=id,_this_1.isClientConnected[id]=function(){return socket.readyState===socket.OPEN},_this_1.clientToSend[id]=function(_msg){socket.send(_msg)}})})})),_this_1}return __extends(ToolDbNetwork,_super),Object.defineProperty(ToolDbNetwork.prototype,"messageQueue",{get:function(){return this._messageQueue},enumerable:!1,configurable:!0}),ToolDbNetwork.prototype.pushToMessageQueue=function(msg,to){this._messageQueue.push({message:msg,time:Date.now(),to:to})},ToolDbNetwork.prototype.codeToHash=function(code){return(0,_1.sha1)(code).slice(-20)},ToolDbNetwork.prototype.sendToAll=function(msg,crossServerOnly){(crossServerOnly=void 0===crossServerOnly?!1:crossServerOnly)?this.sendToAllServers(msg):(this.pushToMessageQueue(msg,[]),this.tryExecuteMessageQueue())},ToolDbNetwork.prototype.sendToClientId=function(clientId,msg){this.pushToMessageQueue(msg,[clientId]),this.tryExecuteMessageQueue()},ToolDbNetwork.prototype.sendToAllServers=function(msg){var _this_1=this;this.pushToMessageQueue(msg,this.serverPeers.map(function(s){return s.pubKey}).filter(function(s){return s!==_this_1.tooldb.getPubKey()})),this.tryExecuteMessageQueue()},ToolDbNetwork.prototype.tryExecuteMessageQueue=function(){var _this_1=this,sentMessageIDs=[],messagesToDelete=[],pubKey=this.getClientAddress();this._messageQueue.forEach(function(q){var finalMessageString_1,message=q.message;q.time+6e4<Date.now()?messagesToDelete.push(message.id):(pubKey&&!message.to.includes(pubKey)&&message.to.push(pubKey),finalMessageString_1=JSON.stringify(message),0<q.to.length?q.to.forEach(function(toClient){!message.to.includes(toClient)&&_this_1.isClientConnected[toClient]&&_this_1.isClientConnected[toClient]()&&(_this_1.clientToSend[toClient](finalMessageString_1),sentMessageIDs.push(message.id)),0===_this_1.serverPeers.filter(function(s){return s.pubKey===toClient}).length&&_this_1.findServer(toClient)}):Object.keys(_this_1.clientToSend).forEach(function(toClient){!message.to.includes(toClient)&&_this_1.isClientConnected[toClient]&&_this_1.isClientConnected[toClient]()&&(_this_1.clientToSend[toClient](finalMessageString_1),sentMessageIDs.push(message.id))}))}),sentMessageIDs.forEach(function(id){var index=_this_1._messageQueue.findIndex(function(msg){return msg.message.id===id});_this_1._messageQueue.splice(index,1)}),messagesToDelete.forEach(function(id){var index=_this_1._messageQueue.findIndex(function(msg){return msg.message.id===id});_this_1._messageQueue.splice(index,1)}),0<this._messageQueue.length&&setTimeout(function(){_this_1.tryExecuteMessageQueue()},100)},ToolDbNetwork}(_1.ToolDbNetworkAdapter);exports.default=__importDefault},{".":268,"./utils/arrayBufferToHex":302,"./utils/waitFor":342,ws:380}],291:[function(require,module,exports){"use strict";var __assign=this&&this.__assign||function(){return(__assign=Object.assign||function(t){for(var s,i=1,n=arguments.length;i<n;i++)for(var p in s=arguments[i])Object.prototype.hasOwnProperty.call(s,p)&&(t[p]=s[p]);return t}).apply(this,arguments)},__awaiter=this&&this.__awaiter||function(thisArg,_arguments,P,generator){return new(P=P||Promise)(function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator.throw(value))}catch(e){reject(e)}}function step(result){var value;result.done?resolve(result.value):((value=result.value)instanceof P?value:new P(function(resolve){resolve(value)})).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())})},__generator=this&&this.__generator||function(thisArg,body){var f,y,t,_={label:0,sent:function(){if(1&t[0])throw t[1];return t[1]},trys:[],ops:[]},g={next:verb(0),throw:verb(1),return:verb(2)};return"function"==typeof Symbol&&(g[Symbol.iterator]=function(){return this}),g;function verb(n){return function(v){var op=[n,v];if(f)throw new TypeError("Generator is already executing.");for(;_;)try{if(f=1,y&&(t=2&op[0]?y.return:op[0]?y.throw||((t=y.return)&&t.call(y),0):y.next)&&!(t=t.call(y,op[1])).done)return t;switch(y=0,(op=t?[2&op[0],t.value]:op)[0]){case 0:case 1:t=op;break;case 4:return _.label++,{value:op[1],done:!1};case 5:_.label++,y=op[1],op=[0];continue;case 7:op=_.ops.pop(),_.trys.pop();continue;default:if(!(t=0<(t=_.trys).length&&t[t.length-1])&&(6===op[0]||2===op[0])){_=0;continue}if(3===op[0]&&(!t||op[1]>t[0]&&op[1]<t[3])){_.label=op[1];break}if(6===op[0]&&_.label<t[1]){_.label=t[1],t=op;break}if(t&&_.label<t[2]){_.label=t[2],_.ops.push(op);break}t[2]&&_.ops.pop(),_.trys.pop();continue}op=body.call(thisArg,_)}catch(e){op=[6,e],y=0}finally{f=t=0}if(5&op[0])throw op[1];return{value:op[0]?op[1]:void 0,done:!0}}}},__importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}},_1=(Object.defineProperty(exports,"__esModule",{value:!0}),require(".")),proofOfWork_1=__importDefault(require("./utils/proofOfWork")),signData_1=__importDefault(require("./utils/signData"));exports.default=function(key,value,userNamespaced){var _this=this;return void 0===userNamespaced&&(userNamespaced=!1),new Promise(function(resolve,reject){var timestamp,dataString;key.includes(".")?reject(new Error("Key cannot include dots!; "+key)):_this.user?(timestamp=(new Date).getTime(),dataString=""+JSON.stringify(value)+_this.user.pubKey+timestamp,(0,proofOfWork_1.default)(dataString,_this.options.pow).then(function(_a){var hash=_a.hash,nonce=_a.nonce;null!=(_a=_this.user)&&_a.keys&&(0,signData_1.default)(hash,_this.user.keys.signKeys.privateKey).then(function(signature){return __awaiter(_this,void 0,void 0,function(){var _a,_b;return __generator(this,function(_c){return _a=userNamespaced?":"+(null==(_a=this.user)?void 0:_a.pubKey)+"."+key:key,_b={k:_a,p:(null==(_b=this.user)?void 0:_b.pubKey)||"",n:nonce,t:timestamp,h:hash,s:(0,_1.arrayBufferToBase64)(signature),v:value},this.store.put(_a,JSON.stringify(_b),function(err,data){}),this.logger("PUT > "+key,_b),_b=__assign({type:"put",id:(0,_1.textRandom)(10),to:[]},_b),this.network.sendToAll(_b),resolve(_b),[2]})})}).catch(reject)}).catch(reject)):reject(new Error("You need to log in before you can PUT."))})}},{".":268,"./utils/proofOfWork":330,"./utils/signData":334}],292:[function(require,module,exports){"use strict";var __spreadArray=this&&this.__spreadArray||function(to,from,pack){if(pack||2===arguments.length)for(var ar,i=0,l=from.length;i<l;i++)!ar&&i in from||((ar=ar||Array.prototype.slice.call(from,0,i))[i]=from[i]);return to.concat(ar||Array.prototype.slice.call(from))},__importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}},lodash_1=(Object.defineProperty(exports,"__esModule",{value:!0}),__importDefault(require("lodash"))),_1=require(".");exports.default=function(key,userNamespaced,timeoutMs){var _this=this;return void 0===userNamespaced&&(userNamespaced=!1),void 0===timeoutMs&&(timeoutMs=1e3),new Promise(function(resolve,reject){var _a,finalKey,foundKeys,timeout,finishListening;userNamespaced&&void 0===(null==(_a=_this.user)?void 0:_a.pubKey)?reject(new Error("You are not authorized yet!")):!userNamespaced&&key.length<3?reject(new Error("Query key is too short")):(finalKey=userNamespaced?":"+(null==(_a=_this.user)?void 0:_a.pubKey)+"."+key:key,_this.logger("QUERY > "+finalKey),reject=(0,_1.textRandom)(10),foundKeys=[],_this.store.query(finalKey).then(function(localKeys){foundKeys=__spreadArray(__spreadArray([],foundKeys,!0),localKeys,!0),timeout=setTimeout(finishListening,timeoutMs)}),finishListening=function(){resolve(lodash_1.default.uniq(foundKeys))},_this.addIdListener(reject,function(msg){_this.logger("QUERY RECV  > "+finalKey,msg),"queryAck"===msg.type&&(foundKeys=__spreadArray(__spreadArray([],foundKeys,!0),msg.keys,!0),timeout&&clearTimeout(timeout),timeout=setTimeout(finishListening,timeoutMs))}),_this.network.sendToAll({type:"query",to:[],key:finalKey,id:reject}))})}},{".":268,lodash:260}],293:[function(require,module,exports){"use strict";var __spreadArray=this&&this.__spreadArray||function(to,from,pack){if(pack||2===arguments.length)for(var ar,i=0,l=from.length;i<l;i++)!ar&&i in from||((ar=ar||Array.prototype.slice.call(from,0,i))[i]=from[i]);return to.concat(ar||Array.prototype.slice.call(from))},__importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}},lodash_1=(Object.defineProperty(exports,"__esModule",{value:!0}),__importDefault(require("lodash"))),textRandom_1=__importDefault(require("./utils/textRandom"));exports.default=function(pubKey){var _this=this;return new Promise(function(resolve,reject){var localKeys;_this.store.query("").then(function(keys){localKeys=keys,function(tooldb,serverPubKey,timeoutMs){void 0===timeoutMs&&(timeoutMs=1e3);return new Promise(function(resolve,reject){var _a,foundKeys,timeout,finishListening;void 0===(null==(_a=tooldb.user)?void 0:_a.pubKey)?reject(new Error("You are not authorized yet!")):(tooldb.logger("QUERY ALL > "+serverPubKey),_a=(0,textRandom_1.default)(10),foundKeys=[],finishListening=function(){resolve(lodash_1.default.uniq(foundKeys))},tooldb.addIdListener(_a,function(msg){tooldb.logger("QUERY ALL RECV  > ",msg),"queryAck"===msg.type&&(foundKeys=__spreadArray(__spreadArray([],foundKeys,!0),msg.keys,!0),timeout&&clearTimeout(timeout),timeout=setTimeout(finishListening,timeoutMs))}),tooldb.network.sendToClientId(serverPubKey,{type:"query",to:[],key:"",id:_a}))})}(_this,pubKey).then(function(remoteKeys){var missingKeys_1,synced_1;remoteKeys&&0<(missingKeys_1=lodash_1.default.difference(remoteKeys,localKeys)).length&&(_this.logger("MISSING KEYS > ",missingKeys_1.length),remoteKeys=(0,textRandom_1.default)(10),synced_1=0,_this.addIdListener(remoteKeys,function(msg){_this.logger("SERVER SYNC RECV  > ",msg),"put"===msg.type&&synced_1++,synced_1===missingKeys_1.length&&resolve(synced_1)}),_this.network.sendToClientId(pubKey,{type:"get",to:[],key:missingKeys_1[0],id:remoteKeys}))})})})}},{"./utils/textRandom":336,lodash:260}],294:[function(require,module,exports){"use strict";var __assign=this&&this.__assign||function(){return(__assign=Object.assign||function(t){for(var s,i=1,n=arguments.length;i<n;i++)for(var p in s=arguments[i])Object.prototype.hasOwnProperty.call(s,p)&&(t[p]=s[p]);return t}).apply(this,arguments)},__awaiter=this&&this.__awaiter||function(thisArg,_arguments,P,generator){return new(P=P||Promise)(function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator.throw(value))}catch(e){reject(e)}}function step(result){var value;result.done?resolve(result.value):((value=result.value)instanceof P?value:new P(function(resolve){resolve(value)})).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())})},__generator=this&&this.__generator||function(thisArg,body){var f,y,t,_={label:0,sent:function(){if(1&t[0])throw t[1];return t[1]},trys:[],ops:[]},g={next:verb(0),throw:verb(1),return:verb(2)};return"function"==typeof Symbol&&(g[Symbol.iterator]=function(){return this}),g;function verb(n){return function(v){var op=[n,v];if(f)throw new TypeError("Generator is already executing.");for(;_;)try{if(f=1,y&&(t=2&op[0]?y.return:op[0]?y.throw||((t=y.return)&&t.call(y),0):y.next)&&!(t=t.call(y,op[1])).done)return t;switch(y=0,(op=t?[2&op[0],t.value]:op)[0]){case 0:case 1:t=op;break;case 4:return _.label++,{value:op[1],done:!1};case 5:_.label++,y=op[1],op=[0];continue;case 7:op=_.ops.pop(),_.trys.pop();continue;default:if(!(t=0<(t=_.trys).length&&t[t.length-1])&&(6===op[0]||2===op[0])){_=0;continue}if(3===op[0]&&(!t||op[1]>t[0]&&op[1]<t[3])){_.label=op[1];break}if(6===op[0]&&_.label<t[1]){_.label=t[1],t=op;break}if(t&&_.label<t[2]){_.label=t[2],_.ops.push(op);break}t[2]&&_.ops.pop(),_.trys.pop();continue}op=body.call(thisArg,_)}catch(e){op=[6,e],y=0}finally{f=t=0}if(5&op[0])throw op[1];return{value:op[0]?op[1]:void 0,done:!0}}}},__importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}},decodeKeyString_1=(Object.defineProperty(exports,"__esModule",{value:!0}),__importDefault(require("./utils/crypto/decodeKeyString"))),decryptWithPass_1=__importDefault(require("./utils/crypto/decryptWithPass")),importKey_1=__importDefault(require("./utils/crypto/importKey")),base64ToUint8_1=__importDefault(require("./utils/base64ToUint8")),catchReturn_1=__importDefault(require("./utils/catchReturn")),fromBase64_1=__importDefault(require("./utils/fromBase64")),sha256_1=__importDefault(require("./utils/sha256"));exports.default=function(user,password){var _this=this;return new Promise(function(resolve,reject){_this.getData("=="+user,!1,5e3).then(function(_user){_user?(0,sha256_1.default)(password)!==_user.pass?reject("Invalid password"):(0,decryptWithPass_1.default)((0,fromBase64_1.default)(_user.keys.skpriv),password,(0,base64ToUint8_1.default)(_user.iv)).then(function(decryptedskpriv){(0,decryptWithPass_1.default)((0,fromBase64_1.default)(_user.keys.ekpriv),password,(0,base64ToUint8_1.default)(_user.iv)).then(function(decryptedekpriv){var parsedKeys=__assign(__assign({},_user.keys),{skpriv:decryptedskpriv||"",ekpriv:decryptedekpriv||""});!function(){return __awaiter(this,void 0,void 0,function(){var skpub,skpriv,ekpub,ekpriv;return __generator(this,function(_a){switch(_a.label){case 0:return[4,(0,importKey_1.default)((0,decodeKeyString_1.default)(parsedKeys.skpub),"spki","ECDSA",["verify"]).catch(catchReturn_1.default)];case 1:return skpub=_a.sent(),[4,(0,importKey_1.default)((0,decodeKeyString_1.default)(parsedKeys.skpriv),"pkcs8","ECDSA",["sign"]).catch(catchReturn_1.default)];case 2:return skpriv=_a.sent(),[4,(0,importKey_1.default)((0,decodeKeyString_1.default)(parsedKeys.ekpub),"spki","ECDH",[]).catch(catchReturn_1.default)];case 3:return ekpub=_a.sent(),[4,(0,importKey_1.default)((0,decodeKeyString_1.default)(parsedKeys.ekpriv),"pkcs8","ECDH",["deriveKey","deriveBits"]).catch(catchReturn_1.default)];case 4:return ekpriv=_a.sent(),[2,{skpub:skpub,skpriv:skpriv,ekpub:ekpub,ekpriv:ekpriv}]}})})}().then(function(_a){var skpub=_a.skpub,skpriv=_a.skpriv,ekpub=_a.ekpub,_a=_a.ekpriv;skpub&&skpriv&&ekpub&&_a?(_this.user={keys:skpub={signKeys:{publicKey:skpub,privateKey:skpriv},encryptionKeys:{publicKey:ekpub,privateKey:_a}},name:user,pubKey:_user.keys.skpub},resolve(skpub)):reject(new Error("Could not import keys"))}).catch(catchReturn_1.default)}).catch(catchReturn_1.default)}):reject("Could not find user")}).catch(console.warn)})}},{"./utils/base64ToUint8":307,"./utils/catchReturn":308,"./utils/crypto/decodeKeyString":309,"./utils/crypto/decryptWithPass":311,"./utils/crypto/importKey":320,"./utils/fromBase64":324,"./utils/sha256":333}],295:[function(require,module,exports){"use strict";var __assign=this&&this.__assign||function(){return(__assign=Object.assign||function(t){for(var s,i=1,n=arguments.length;i<n;i++)for(var p in s=arguments[i])Object.prototype.hasOwnProperty.call(s,p)&&(t[p]=s[p]);return t}).apply(this,arguments)},__awaiter=this&&this.__awaiter||function(thisArg,_arguments,P,generator){return new(P=P||Promise)(function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator.throw(value))}catch(e){reject(e)}}function step(result){var value;result.done?resolve(result.value):((value=result.value)instanceof P?value:new P(function(resolve){resolve(value)})).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())})},__generator=this&&this.__generator||function(thisArg,body){var f,y,t,_={label:0,sent:function(){if(1&t[0])throw t[1];return t[1]},trys:[],ops:[]},g={next:verb(0),throw:verb(1),return:verb(2)};return"function"==typeof Symbol&&(g[Symbol.iterator]=function(){return this}),g;function verb(n){return function(v){var op=[n,v];if(f)throw new TypeError("Generator is already executing.");for(;_;)try{if(f=1,y&&(t=2&op[0]?y.return:op[0]?y.throw||((t=y.return)&&t.call(y),0):y.next)&&!(t=t.call(y,op[1])).done)return t;switch(y=0,(op=t?[2&op[0],t.value]:op)[0]){case 0:case 1:t=op;break;case 4:return _.label++,{value:op[1],done:!1};case 5:_.label++,y=op[1],op=[0];continue;case 7:op=_.ops.pop(),_.trys.pop();continue;default:if(!(t=0<(t=_.trys).length&&t[t.length-1])&&(6===op[0]||2===op[0])){_=0;continue}if(3===op[0]&&(!t||op[1]>t[0]&&op[1]<t[3])){_.label=op[1];break}if(6===op[0]&&_.label<t[1]){_.label=t[1],t=op;break}if(t&&_.label<t[2]){_.label=t[2],_.ops.push(op);break}t[2]&&_.ops.pop(),_.trys.pop();continue}op=body.call(thisArg,_)}catch(e){op=[6,e],y=0}finally{f=t=0}if(5&op[0])throw op[1];return{value:op[0]?op[1]:void 0,done:!0}}}},__importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}},_1=(Object.defineProperty(exports,"__esModule",{value:!0}),require(".")),encryptWithPass_1=__importDefault(require("./utils/crypto/encryptWithPass")),generateKeysComb_1=__importDefault(require("./utils/crypto/generateKeysComb")),saveKeysComb_1=__importDefault(require("./utils/crypto/saveKeysComb")),generateIv_1=__importDefault(require("./utils/generateIv")),proofOfWork_1=__importDefault(require("./utils/proofOfWork")),sha256_1=__importDefault(require("./utils/sha256")),signData_1=__importDefault(require("./utils/signData")),toBase64_1=__importDefault(require("./utils/toBase64")),uint8ToBase64_1=__importDefault(require("./utils/uint8ToBase64"));exports.default=function(user,password){return __awaiter(this,void 0,void 0,function(){var userRoot,_this=this;return __generator(this,function(_a){return userRoot="=="+user,[2,new Promise(function(resolve,reject){_this.getData(userRoot,!1,3e3).then(function(data){null===data?(0,generateKeysComb_1.default)().then(function(keys){keys?(0,saveKeysComb_1.default)(keys.signKeys,keys.encryptionKeys).then(function(savedKeys){var iv=(0,generateIv_1.default)(),encskpriv="",encekpriv="";(0,encryptWithPass_1.default)(savedKeys.skpriv,password,iv).then(function(skenc){(0,encryptWithPass_1.default)(savedKeys.ekpriv,password,iv).then(function(ekenc){skenc&&(encskpriv=skenc),ekenc&&(encekpriv=ekenc);var userData={keys:{skpub:savedKeys.skpub,skpriv:(0,toBase64_1.default)(encskpriv),ekpub:savedKeys.ekpub,ekpriv:(0,toBase64_1.default)(encekpriv)},iv:(0,uint8ToBase64_1.default)(iv),pass:(0,sha256_1.default)(password)},timestamp=(new Date).getTime(),ekenc=""+JSON.stringify(userData)+savedKeys.skpub+timestamp;(0,proofOfWork_1.default)(ekenc,0).then(function(_a){var hash=_a.hash,nonce=_a.nonce;(0,signData_1.default)(hash,keys.signKeys.privateKey).then(function(signature){signature={k:userRoot,p:savedKeys.skpub,n:nonce,t:timestamp,h:hash,s:(0,_1.arrayBufferToBase64)(signature),v:userData},_this.logger("SIGNUP PUT > "+userRoot,signature),signature=__assign({type:"put",id:(0,_1.textRandom)(10),to:[]},signature);_this.network.sendToAll(signature),resolve(signature)})}).catch(reject)}).catch(reject)}).catch(reject)}).catch(function(){return reject(new Error(""))}):reject(new Error("Could not generate keys"))}).catch(function(){return reject(new Error("Could not generate keys"))}):reject(new Error("User already exists!"))}).catch(function(){reject(new Error("Could not fetch user"))})})]})})}},{".":268,"./utils/crypto/encryptWithPass":315,"./utils/crypto/generateKeysComb":319,"./utils/crypto/saveKeysComb":322,"./utils/generateIv":325,"./utils/proofOfWork":330,"./utils/sha256":333,"./utils/signData":334,"./utils/toBase64":337,"./utils/uint8ToBase64":338}],296:[function(require,module,exports){"use strict";var __importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}},_1=(Object.defineProperty(exports,"__esModule",{value:!0}),require(".")),automerge_1=__importDefault(require("automerge"));exports.default=function(key,userNamespaced){var _this=this;return void 0===userNamespaced&&(userNamespaced=!1),new Promise(function(resolve,reject){var _a,finalKey;userNamespaced&&void 0===(null==(_a=_this.user)?void 0:_a.pubKey)?reject(new Error("You are not authorized yet!")):(finalKey=userNamespaced?":"+(null==(_a=_this.user)?void 0:_a.pubKey)+"."+key:key,_this.logger("Subscribe > "+finalKey),reject=(0,_1.textRandom)(10),_this.store.get(finalKey,function(err,data){if(data)try{var message=JSON.parse(data);_this.triggerKeyListener(finalKey,message)}catch(e){}}),_this.loadCrdtDocument(finalKey,!1).then(function(doc){doc&&(doc=automerge_1.default.save(doc),doc={type:"crdt",key:finalKey,id:(0,_1.textRandom)(10),to:[],doc:(0,_1.uint8ToBase64)(doc)},_this.triggerKeyListener(finalKey,doc))}),_this.network.sendToAll({type:"subscribe",key:finalKey,to:[],id:reject}),resolve())})}},{".":268,automerge:61}],297:[function(require,module,exports){"use strict";var __awaiter=this&&this.__awaiter||function(thisArg,_arguments,P,generator){return new(P=P||Promise)(function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator.throw(value))}catch(e){reject(e)}}function step(result){var value;result.done?resolve(result.value):((value=result.value)instanceof P?value:new P(function(resolve){resolve(value)})).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())})},__generator=this&&this.__generator||function(thisArg,body){var f,y,t,_={label:0,sent:function(){if(1&t[0])throw t[1];return t[1]},trys:[],ops:[]},g={next:verb(0),throw:verb(1),return:verb(2)};return"function"==typeof Symbol&&(g[Symbol.iterator]=function(){return this}),g;function verb(n){return function(v){var op=[n,v];if(f)throw new TypeError("Generator is already executing.");for(;_;)try{if(f=1,y&&(t=2&op[0]?y.return:op[0]?y.throw||((t=y.return)&&t.call(y),0):y.next)&&!(t=t.call(y,op[1])).done)return t;switch(y=0,(op=t?[2&op[0],t.value]:op)[0]){case 0:case 1:t=op;break;case 4:return _.label++,{value:op[1],done:!1};case 5:_.label++,y=op[1],op=[0];continue;case 7:op=_.ops.pop(),_.trys.pop();continue;default:if(!(t=0<(t=_.trys).length&&t[t.length-1])&&(6===op[0]||2===op[0])){_=0;continue}if(3===op[0]&&(!t||op[1]>t[0]&&op[1]<t[3])){_.label=op[1];break}if(6===op[0]&&_.label<t[1]){_.label=t[1],t=op;break}if(t&&_.label<t[2]){_.label=t[2],_.ops.push(op);break}t[2]&&_.ops.pop(),_.trys.pop();continue}op=body.call(thisArg,_)}catch(e){op=[6,e],y=0}finally{f=t=0}if(5&op[0])throw op[1];return{value:op[0]?op[1]:void 0,done:!0}}}},_1=(Object.defineProperty(exports,"__esModule",{value:!0}),require("."));exports.default=function(data){var _this=this;return new Promise(function(resolve){_this.verifyMessage(data,_this.options.pow).then(function(verified){return __awaiter(_this,void 0,void 0,function(){var skipCustom_1;return __generator(this,function(_a){return verified?(skipCustom_1=!0,this._customVerificator.forEach(function(listener){listener&&data.k&&data.k.startsWith(listener.key)&&(skipCustom_1=!1,listener.fn(data).then(function(verified){resolve(verified?_1.VerifyResult.Verified:_1.VerifyResult.CustomVerificationFailed)}).catch(function(e){resolve(_1.VerifyResult.CustomVerificationFailed)}))}),skipCustom_1&&resolve(verified)):resolve(_1.VerifyResult.InvalidVerification),[2]})})})})}},{".":268}],298:[function(require,module,exports){"use strict";var extendStatics,__extends=this&&this.__extends||(extendStatics=function(d,b){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)Object.prototype.hasOwnProperty.call(b,p)&&(d[p]=b[p])})(d,b)},function(d,b){if("function"!=typeof b&&null!==b)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}),__assign=this&&this.__assign||function(){return(__assign=Object.assign||function(t){for(var s,i=1,n=arguments.length;i<n;i++)for(var p in s=arguments[i])Object.prototype.hasOwnProperty.call(s,p)&&(t[p]=s[p]);return t}).apply(this,arguments)},__importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}},events_1=(Object.defineProperty(exports,"__esModule",{value:!0}),exports.KEY_PREFIX=void 0,__importDefault(require("events"))),_1=require("."),logger_1=__importDefault(require("./logger")),toolDbGet_1=__importDefault(require("./toolDbGet")),toolDbPut_1=__importDefault(require("./toolDbPut")),toolDbSignIn_1=__importDefault(require("./toolDbSignIn")),toolDbSignUp_1=__importDefault(require("./toolDbSignUp")),toolDbNetwork_1=__importDefault(require("./toolDbNetwork")),toolDbCrdtGet_1=__importDefault(require("./toolDbCrdtGet")),toolDbCrdtPut_1=__importDefault(require("./toolDbCrdtPut")),toolDbGetPubKey_1=__importDefault(require("./toolDbGetPubKey")),toolDbAnonSignIn_1=__importDefault(require("./toolDbAnonSignIn")),toolDbServerSync_1=__importDefault(require("./toolDbServerSync")),toolDbClientOnMessage_1=__importDefault(require("./toolDbClientOnMessage")),toolDbVerificationWrapper_1=__importDefault(require("./toolDbVerificationWrapper")),leveldb_1=__importDefault(require("./utils/leveldb")),indexedb_1=__importDefault(require("./utils/indexedb")),toolDbSubscribe_1=__importDefault(require("./toolDbSubscribe")),toolDbQueryKeys_1=__importDefault(require("./toolDbQueryKeys")),loadCrdtDocument_1=__importDefault(require("./loadCrdtDocument")),toolDbKeysSignIn_1=__importDefault(require("./toolDbKeysSignIn")),handleGet_1=__importDefault(require("./messageHandlers/handleGet")),handlePut_1=__importDefault(require("./messageHandlers/handlePut")),handlePing_1=__importDefault(require("./messageHandlers/handlePing")),handlePong_1=__importDefault(require("./messageHandlers/handlePong")),handleCrdt_1=__importDefault(require("./messageHandlers/handleCrdt")),handleQuery_1=__importDefault(require("./messageHandlers/handleQuery")),handleCrdtGet_1=__importDefault(require("./messageHandlers/handleCrdtGet")),handleCrdtPut_1=__importDefault(require("./messageHandlers/handleCrdtPut")),handleSubscribe_1=__importDefault(require("./messageHandlers/handleSubscribe")),arrayBufferToHex_1=__importDefault(require("./utils/arrayBufferToHex")),handleFunction_1=__importDefault(require("./messageHandlers/handleFunction")),toolDbFunction_1=__importDefault(require("./toolDbFunction")),__importDefault=(exports.KEY_PREFIX="3059301306072a8648ce3d020106082a8648ce3d03010703420004",function(_super){function ToolDb(options){void 0===options&&(options={});var _this=_super.call(this)||this;return _this._peers={},_this._serverPeers=[],_this.logger=logger_1.default,_this._documents={},_this._pubKey=void 0,_this.clientOnMessage=toolDbClientOnMessage_1.default,_this.verifyMessage=_1.verifyMessage,_this._subscriptions=[],_this.isConnected=!1,_this._processedIds={},_this._processedOutHashes={},_this.subscribeData=toolDbSubscribe_1.default,_this.onDisconnect=function(){},_this.onConnect=function(){},_this.onPeerDisconnect=function(peerId){},_this.onPeerConnect=function(peerId){},_this.loadCrdtDocument=loadCrdtDocument_1.default,_this.getData=toolDbGet_1.default,_this.putData=toolDbPut_1.default,_this.putCrdt=toolDbCrdtPut_1.default,_this.getCrdt=toolDbCrdtGet_1.default,_this.queryKeys=toolDbQueryKeys_1.default,_this.doFunction=toolDbFunction_1.default,_this.getPubKey=toolDbGetPubKey_1.default,_this.serverSync=toolDbServerSync_1.default,_this.signIn=toolDbSignIn_1.default,_this.anonSignIn=toolDbAnonSignIn_1.default,_this.keysSignIn=toolDbKeysSignIn_1.default,_this.signUp=toolDbSignUp_1.default,_this.verify=toolDbVerificationWrapper_1.default,_this.handlePing=handlePing_1.default,_this.handlePong=handlePong_1.default,_this.handleCrdt=handleCrdt_1.default,_this.handleCrdtGet=handleCrdtGet_1.default,_this.handleCrdtPut=handleCrdtPut_1.default,_this.handleGet=handleGet_1.default,_this.handlePut=handlePut_1.default,_this.handleQuery=handleQuery_1.default,_this.handleSubscribe=handleSubscribe_1.default,_this.handleFunction=handleFunction_1.default,_this._idListeners={},_this.addIdListener=function(id,fn){_this._idListeners[id]=fn},_this.removeIdListener=function(id){delete _this._idListeners[id]},_this._functions={},_this._keyListeners=[],_this.addKeyListener=function(key,fn){return _this._keyListeners.push({key:key,timeout:null,fn:fn}),_this._keyListeners.length},_this.removeKeyListener=function(id){var _a;null!=(_a=_this._keyListeners[id])&&_a.timeout&&clearTimeout((null==(_a=_this._keyListeners[id])?void 0:_a.timeout)||void 0),_this._keyListeners[id]=null},_this.triggerKeyListener=function(key,message){_this._keyListeners.forEach(function(listener){(null==listener?void 0:listener.key)===key&&(listener.timeout&&clearTimeout(listener.timeout),listener.timeout=setTimeout(function(){return listener.fn(message)},_this.options.triggerDebouce))})},_this._customVerificator=[],_this.addCustomVerification=function(key,fn){return _this._customVerificator.push({key:key,fn:fn}),_this._customVerificator.length},_this.removeCustomVerification=function(id){_this._customVerificator[id]=null},_this.user=void 0,_this._options={db:"tooldb",maxRetries:5,triggerDebouce:100,wait:2e3,pow:0,server:!1,host:"127.0.0.1",port:8080,debug:!1,httpServer:void 0,networkAdapter:toolDbNetwork_1.default,storageName:"tooldb",storageAdapter:("undefined"==typeof window?leveldb_1:indexedb_1).default,topic:"",defaultKeys:void 0,maxPeers:4,ssl:!1,serverName:"default-server"},_this._options=__assign(__assign({},_this.options),options),_this._options.defaultKeys?(0,_1.exportKey)("spki",_this._options.defaultKeys.publicKey).then(function(skpub){_this._pubKey=(0,arrayBufferToHex_1.default)(skpub),_this._pubKey.startsWith(exports.KEY_PREFIX)&&(_this._pubKey=_this._pubKey.slice(exports.KEY_PREFIX.length)),_this.emit("init",_this._pubKey)}):(0,_1.generateKeyPair)("ECDSA",!1).then(function(key){key.publicKey&&key.privateKey&&(_this._options.defaultKeys=key,(0,_1.exportKey)("spki",key.publicKey).then(function(skpub){_this._pubKey=(0,arrayBufferToHex_1.default)(skpub),_this._pubKey.startsWith(exports.KEY_PREFIX)&&(_this._pubKey=_this._pubKey.slice(exports.KEY_PREFIX.length)),_this.emit("init",_this._pubKey)}))}),_this._network=new _this.options.networkAdapter(_this),_this._store=_this.options.storageAdapter(_this.options.storageName),_this}return __extends(ToolDb,_super),Object.defineProperty(ToolDb.prototype,"subscriptions",{get:function(){return this._subscriptions},enumerable:!1,configurable:!0}),Object.defineProperty(ToolDb.prototype,"pubKey",{get:function(){return this._pubKey},enumerable:!1,configurable:!0}),Object.defineProperty(ToolDb.prototype,"processedIds",{get:function(){return this._processedIds},enumerable:!1,configurable:!0}),Object.defineProperty(ToolDb.prototype,"processedOutHashes",{get:function(){return this._processedOutHashes},enumerable:!1,configurable:!0}),Object.defineProperty(ToolDb.prototype,"serverPeers",{get:function(){return this._serverPeers},enumerable:!1,configurable:!0}),ToolDb.prototype.getUserNamespacedKey=function(key){var _a;return":"+((null==(_a=this.user)?void 0:_a.pubKey)||"")+"."+key},Object.defineProperty(ToolDb.prototype,"functions",{get:function(){return this._functions},enumerable:!1,configurable:!0}),ToolDb.prototype.addServerFunction=function(functionName,fn){this._functions[functionName]=fn},Object.defineProperty(ToolDb.prototype,"options",{get:function(){return this._options},enumerable:!1,configurable:!0}),Object.defineProperty(ToolDb.prototype,"network",{get:function(){return this._network},enumerable:!1,configurable:!0}),Object.defineProperty(ToolDb.prototype,"peers",{get:function(){return this._peers},enumerable:!1,configurable:!0}),Object.defineProperty(ToolDb.prototype,"store",{get:function(){return this._store},enumerable:!1,configurable:!0}),Object.defineProperty(ToolDb.prototype,"documents",{get:function(){return this._documents},enumerable:!1,configurable:!0}),ToolDb}(events_1.default));exports.default=__importDefault},{".":268,"./loadCrdtDocument":269,"./logger":270,"./messageHandlers/handleCrdt":271,"./messageHandlers/handleCrdtGet":272,"./messageHandlers/handleCrdtPut":273,"./messageHandlers/handleFunction":274,"./messageHandlers/handleGet":275,"./messageHandlers/handlePing":276,"./messageHandlers/handlePong":277,"./messageHandlers/handlePut":278,"./messageHandlers/handleQuery":279,"./messageHandlers/handleSubscribe":280,"./toolDbAnonSignIn":282,"./toolDbClientOnMessage":283,"./toolDbCrdtGet":284,"./toolDbCrdtPut":285,"./toolDbFunction":286,"./toolDbGet":287,"./toolDbGetPubKey":288,"./toolDbKeysSignIn":289,"./toolDbNetwork":290,"./toolDbPut":291,"./toolDbQueryKeys":292,"./toolDbServerSync":293,"./toolDbSignIn":294,"./toolDbSignUp":295,"./toolDbSubscribe":296,"./toolDbVerificationWrapper":297,"./utils/arrayBufferToHex":302,"./utils/indexedb":328,"./utils/leveldb":329,events:178}],299:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.VerifyResult=void 0,function(VerifyResult){VerifyResult.CustomVerificationFailed="CustomVerificationFailed",VerifyResult.InvalidData="InvalidData",VerifyResult.InvalidVerification="InvalidVerification",VerifyResult.CantOverwrite="CantOverwrite",VerifyResult.InvalidTimestamp="InvalidTimestamp",VerifyResult.PubKeyMismatch="PubKeyMismatch",VerifyResult.NoProofOfWork="NoProofOfWork",VerifyResult.InvalidHashNonce="InvalidHashNonce",VerifyResult.InvalidSignature="InvalidSignature",VerifyResult.Verified="Verified"}(exports.VerifyResult||(exports.VerifyResult={}))},{}],300:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0})},{}],301:[function(require,module,exports){"use strict";var __importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}},arrayBufferToString_1=(Object.defineProperty(exports,"__esModule",{value:!0}),__importDefault(require("./arrayBufferToString"))),toBase64_1=__importDefault(require("./toBase64"));exports.default=function(arr){return(0,toBase64_1.default)((0,arrayBufferToString_1.default)(arr))}},{"./arrayBufferToString":303,"./toBase64":337}],302:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(buffer){for(var c,data_view=new DataView(buffer),hex="",iii=0,len=data_view.byteLength;iii<len;iii+=1)hex+=c=(c=data_view.getUint8(iii).toString(16)).length<2?"0"+c:c;return hex}},{}],303:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(arr){for(var byteArray=new Uint8Array(arr),byteString="",i=0;i<byteArray.byteLength;i+=1)byteString+=String.fromCodePoint(byteArray[i]);return byteString}},{}],304:[function(require,module,exports){"use strict";var __importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}},fromBase64_1=(Object.defineProperty(exports,"__esModule",{value:!0}),__importDefault(require("./fromBase64"))),stringToArrayBuffer_1=__importDefault(require("./stringToArrayBuffer"));exports.default=function(str){return(0,stringToArrayBuffer_1.default)((0,fromBase64_1.default)(str))}},{"./fromBase64":324,"./stringToArrayBuffer":335}],305:[function(require,module,exports){"use strict";var __importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}},fromBase64_1=(Object.defineProperty(exports,"__esModule",{value:!0}),__importDefault(require("./fromBase64")));exports.default=function(based){for(var str=(0,fromBase64_1.default)(based),based=new ArrayBuffer(str.length),bufView=new Uint8Array(based),i=0,strLen=str.length;i<strLen;i+=1)bufView[i]=str.charCodeAt(i);return bufView.__binaryChange=!0,bufView}},{"./fromBase64":324}],306:[function(require,module,exports){"use strict";var __importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}},fromBase64_1=(Object.defineProperty(exports,"__esModule",{value:!0}),__importDefault(require("./fromBase64")));exports.default=function(based){for(var str=(0,fromBase64_1.default)(based),based=new ArrayBuffer(str.length),bufView=new Uint8Array(based),i=0,strLen=str.length;i<strLen;i+=1)bufView[i]=str.charCodeAt(i);return bufView.__binaryDocument=!0,bufView}},{"./fromBase64":324}],307:[function(require,module,exports){"use strict";var __importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}},fromBase64_1=(Object.defineProperty(exports,"__esModule",{value:!0}),__importDefault(require("./fromBase64")));exports.default=function(based){for(var str=(0,fromBase64_1.default)(based),based=new ArrayBuffer(str.length),bufView=new Uint8Array(based),i=0,strLen=str.length;i<strLen;i+=1)bufView[i]=str.charCodeAt(i);return bufView}},{"./fromBase64":324}],308:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(arg){}},{}],309:[function(require,module,exports){!function(global){!function(){"use strict";var __importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}},stringToArrayBuffer_1=(Object.defineProperty(exports,"__esModule",{value:!0}),__importDefault(require("../stringToArrayBuffer")));exports.default=function(keydataB64){return keydataB64=global.atob(keydataB64),(0,stringToArrayBuffer_1.default)(keydataB64)}}.call(this)}.call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../stringToArrayBuffer":335}],310:[function(require,module,exports){"use strict";var __importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}},getCrypto_1=(Object.defineProperty(exports,"__esModule",{value:!0}),__importDefault(require("../../getCrypto"))),arrayBufferToString_1=__importDefault(require("../arrayBufferToString")),base64ToUint8_1=__importDefault(require("../base64ToUint8")),catchReturn_1=__importDefault(require("../catchReturn")),stringToArrayBuffer_1=__importDefault(require("../stringToArrayBuffer"));exports.default=function(data,privateKey,iv){return(0,getCrypto_1.default)().subtle.decrypt({name:"AES-GCM",iv:(0,base64ToUint8_1.default)(iv),tagLength:128},privateKey,(0,stringToArrayBuffer_1.default)(data)).then(function(decrypted){return(0,arrayBufferToString_1.default)(decrypted)}).catch(catchReturn_1.default)}},{"../../getCrypto":267,"../arrayBufferToString":303,"../base64ToUint8":307,"../catchReturn":308,"../stringToArrayBuffer":335}],311:[function(require,module,exports){"use strict";var __importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}},arrayBufferToString_1=(Object.defineProperty(exports,"__esModule",{value:!0}),__importDefault(require("../arrayBufferToString"))),catchReturn_1=__importDefault(require("../catchReturn")),generateKeyFromPassword_1=__importDefault(require("./generateKeyFromPassword")),stringToArrayBuffer_1=__importDefault(require("../stringToArrayBuffer")),getCrypto_1=__importDefault(require("../../getCrypto"));exports.default=function(data,password,vector){var crypto=(0,getCrypto_1.default)();return(0,generateKeyFromPassword_1.default)(password).then(function(keyObject){return crypto.subtle.decrypt({name:"AES-GCM",iv:vector},keyObject,(0,stringToArrayBuffer_1.default)(data)).then(function(result){return(0,arrayBufferToString_1.default)(result)}).catch(catchReturn_1.default)}).catch(catchReturn_1.default)}},{"../../getCrypto":267,"../arrayBufferToString":303,"../catchReturn":308,"../stringToArrayBuffer":335,"./generateKeyFromPassword":317}],312:[function(require,module,exports){"use strict";var __importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}},getCrypto_1=(Object.defineProperty(exports,"__esModule",{value:!0}),__importDefault(require("../../getCrypto")));exports.default=function(keys){return(0,getCrypto_1.default)().subtle.deriveKey({name:"ECDH",public:keys.publicKey},keys.privateKey,{name:"AES-GCM",length:256},!0,["encrypt","decrypt"])}},{"../../getCrypto":267}],313:[function(require,module,exports){!function(global){!function(){"use strict";var __importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}},arrayBufferToString_1=(Object.defineProperty(exports,"__esModule",{value:!0}),__importDefault(require("../arrayBufferToString")));exports.default=function(keydata){return keydata=(0,arrayBufferToString_1.default)(keydata),global.btoa(keydata)}}.call(this)}.call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../arrayBufferToString":303}],314:[function(require,module,exports){"use strict";var __importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}},getCrypto_1=(Object.defineProperty(exports,"__esModule",{value:!0}),__importDefault(require("../../getCrypto"))),arrayBufferToString_1=__importDefault(require("../arrayBufferToString")),stringToArrayBuffer_1=__importDefault(require("../stringToArrayBuffer"));exports.default=function(data,publicKey,iv){return(0,getCrypto_1.default)().subtle.encrypt({name:"AES-GCM",iv:iv,tagLength:128},publicKey,(0,stringToArrayBuffer_1.default)(data)).then(function(encrypted){return(0,arrayBufferToString_1.default)(encrypted)}).catch(console.error)}},{"../../getCrypto":267,"../arrayBufferToString":303,"../stringToArrayBuffer":335}],315:[function(require,module,exports){"use strict";var __importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}},arrayBufferToString_1=(Object.defineProperty(exports,"__esModule",{value:!0}),__importDefault(require("../arrayBufferToString"))),catchReturn_1=__importDefault(require("../catchReturn")),generateKeyFromPassword_1=__importDefault(require("./generateKeyFromPassword")),stringToArrayBuffer_1=__importDefault(require("../stringToArrayBuffer")),getCrypto_1=__importDefault(require("../../getCrypto"));exports.default=function(secretmessage,password,vector){var crypto=(0,getCrypto_1.default)();return(0,generateKeyFromPassword_1.default)(password).then(function(keyObject){return crypto.subtle.encrypt({name:"AES-GCM",iv:vector},keyObject,(0,stringToArrayBuffer_1.default)(secretmessage)).then(function(result){return(0,arrayBufferToString_1.default)(result)}).catch(catchReturn_1.default)}).catch(catchReturn_1.default)}},{"../../getCrypto":267,"../arrayBufferToString":303,"../catchReturn":308,"../stringToArrayBuffer":335,"./generateKeyFromPassword":317}],316:[function(require,module,exports){"use strict";var __importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}},getCrypto_1=(Object.defineProperty(exports,"__esModule",{value:!0}),__importDefault(require("../../getCrypto")));exports.default=function(format,key){return(0,getCrypto_1.default)().subtle.exportKey(format,key)}},{"../../getCrypto":267}],317:[function(require,module,exports){"use strict";var __importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}},getCrypto_1=(Object.defineProperty(exports,"__esModule",{value:!0}),__importDefault(require("../../getCrypto"))),stringToArrayBuffer_1=__importDefault(require("../stringToArrayBuffer"));exports.default=function(password){var crypto=(0,getCrypto_1.default)();return crypto.subtle.importKey("raw",(0,stringToArrayBuffer_1.default)(password),{name:"PBKDF2"},!1,["deriveKey"]).then(function(importedPassword){return crypto.subtle.deriveKey({name:"PBKDF2",salt:(0,stringToArrayBuffer_1.default)("t6sa@8d7!2ñs?=adjq2ng"),iterations:1e5,hash:"SHA-256"},importedPassword,{name:"AES-GCM",length:128},!1,["encrypt","decrypt"])})}},{"../../getCrypto":267,"../stringToArrayBuffer":335}],318:[function(require,module,exports){"use strict";var __importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}},getCrypto_1=(Object.defineProperty(exports,"__esModule",{value:!0}),__importDefault(require("../../getCrypto")));exports.default=function(mode,extractable){return void 0===extractable&&(extractable=!1),(0,getCrypto_1.default)().subtle.generateKey({name:mode,namedCurve:"P-256"},extractable,"ECDSA"===mode?["sign","verify"]:["deriveKey","deriveBits"])}},{"../../getCrypto":267}],319:[function(require,module,exports){"use strict";var __awaiter=this&&this.__awaiter||function(thisArg,_arguments,P,generator){return new(P=P||Promise)(function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator.throw(value))}catch(e){reject(e)}}function step(result){var value;result.done?resolve(result.value):((value=result.value)instanceof P?value:new P(function(resolve){resolve(value)})).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())})},__generator=this&&this.__generator||function(thisArg,body){var f,y,t,_={label:0,sent:function(){if(1&t[0])throw t[1];return t[1]},trys:[],ops:[]},g={next:verb(0),throw:verb(1),return:verb(2)};return"function"==typeof Symbol&&(g[Symbol.iterator]=function(){return this}),g;function verb(n){return function(v){var op=[n,v];if(f)throw new TypeError("Generator is already executing.");for(;_;)try{if(f=1,y&&(t=2&op[0]?y.return:op[0]?y.throw||((t=y.return)&&t.call(y),0):y.next)&&!(t=t.call(y,op[1])).done)return t;switch(y=0,(op=t?[2&op[0],t.value]:op)[0]){case 0:case 1:t=op;break;case 4:return _.label++,{value:op[1],done:!1};case 5:_.label++,y=op[1],op=[0];continue;case 7:op=_.ops.pop(),_.trys.pop();continue;default:if(!(t=0<(t=_.trys).length&&t[t.length-1])&&(6===op[0]||2===op[0])){_=0;continue}if(3===op[0]&&(!t||op[1]>t[0]&&op[1]<t[3])){_.label=op[1];break}if(6===op[0]&&_.label<t[1]){_.label=t[1],t=op;break}if(t&&_.label<t[2]){_.label=t[2],_.ops.push(op);break}t[2]&&_.ops.pop(),_.trys.pop();continue}op=body.call(thisArg,_)}catch(e){op=[6,e],y=0}finally{f=t=0}if(5&op[0])throw op[1];return{value:op[0]?op[1]:void 0,done:!0}}}},__importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}},generateKeyPair_1=(Object.defineProperty(exports,"__esModule",{value:!0}),__importDefault(require("./generateKeyPair")));exports.default=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(_a){return[2,new Promise(function(resolve){return(0,generateKeyPair_1.default)("ECDSA",!0).then(function(signKeys){return(0,generateKeyPair_1.default)("ECDH",!0).then(function(encryptionKeys){resolve({signKeys:signKeys,encryptionKeys:encryptionKeys})})})})]})})}},{"./generateKeyPair":318}],320:[function(require,module,exports){"use strict";var __importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}},getCrypto_1=(Object.defineProperty(exports,"__esModule",{value:!0}),__importDefault(require("../../getCrypto")));exports.default=function(key,type,algorithm,ops){return(0,getCrypto_1.default)().subtle.importKey(type,key,{name:algorithm,namedCurve:"P-256"},!0,ops)}},{"../../getCrypto":267}],321:[function(require,module,exports){"use strict";var __awaiter=this&&this.__awaiter||function(thisArg,_arguments,P,generator){return new(P=P||Promise)(function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator.throw(value))}catch(e){reject(e)}}function step(result){var value;result.done?resolve(result.value):((value=result.value)instanceof P?value:new P(function(resolve){resolve(value)})).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())})},__generator=this&&this.__generator||function(thisArg,body){var f,y,t,_={label:0,sent:function(){if(1&t[0])throw t[1];return t[1]},trys:[],ops:[]},g={next:verb(0),throw:verb(1),return:verb(2)};return"function"==typeof Symbol&&(g[Symbol.iterator]=function(){return this}),g;function verb(n){return function(v){var op=[n,v];if(f)throw new TypeError("Generator is already executing.");for(;_;)try{if(f=1,y&&(t=2&op[0]?y.return:op[0]?y.throw||((t=y.return)&&t.call(y),0):y.next)&&!(t=t.call(y,op[1])).done)return t;switch(y=0,(op=t?[2&op[0],t.value]:op)[0]){case 0:case 1:t=op;break;case 4:return _.label++,{value:op[1],done:!1};case 5:_.label++,y=op[1],op=[0];continue;case 7:op=_.ops.pop(),_.trys.pop();continue;default:if(!(t=0<(t=_.trys).length&&t[t.length-1])&&(6===op[0]||2===op[0])){_=0;continue}if(3===op[0]&&(!t||op[1]>t[0]&&op[1]<t[3])){_.label=op[1];break}if(6===op[0]&&_.label<t[1]){_.label=t[1],t=op;break}if(t&&_.label<t[2]){_.label=t[2],_.ops.push(op);break}t[2]&&_.ops.pop(),_.trys.pop();continue}op=body.call(thisArg,_)}catch(e){op=[6,e],y=0}finally{f=t=0}if(5&op[0])throw op[1];return{value:op[0]?op[1]:void 0,done:!0}}}},__importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}},catchReturn_1=(Object.defineProperty(exports,"__esModule",{value:!0}),__importDefault(require("../catchReturn"))),decodeKeyString_1=__importDefault(require("./decodeKeyString")),importKey_1=__importDefault(require("./importKey"));exports.default=function(parsedKeys){return new Promise(function(resolve,reject){!function(parsedKeys){return __awaiter(this,void 0,void 0,function(){var skpub,skpriv,ekpub,ekpriv;return __generator(this,function(_a){switch(_a.label){case 0:return[4,(0,importKey_1.default)((0,decodeKeyString_1.default)(parsedKeys.skpub),"spki","ECDSA",["verify"]).catch(catchReturn_1.default)];case 1:return skpub=_a.sent(),[4,(0,importKey_1.default)((0,decodeKeyString_1.default)(parsedKeys.skpriv),"pkcs8","ECDSA",["sign"]).catch(catchReturn_1.default)];case 2:return skpriv=_a.sent(),[4,(0,importKey_1.default)((0,decodeKeyString_1.default)(parsedKeys.ekpub),"spki","ECDH",[]).catch(catchReturn_1.default)];case 3:return ekpub=_a.sent(),[4,(0,importKey_1.default)((0,decodeKeyString_1.default)(parsedKeys.ekpriv),"pkcs8","ECDH",["deriveKey","deriveBits"]).catch(catchReturn_1.default)];case 4:return ekpriv=_a.sent(),[2,{skpub:skpub,skpriv:skpriv,ekpub:ekpub,ekpriv:ekpriv}]}})})}(parsedKeys).then(function(_a){var skpub=_a.skpub,skpriv=_a.skpriv,ekpub=_a.ekpub,_a=_a.ekpriv;skpub&&skpriv&&ekpub&&_a?resolve({signKeys:{publicKey:skpub,privateKey:skpriv},encryptionKeys:{publicKey:ekpub,privateKey:_a}}):reject(new Error("Could not import keys"))})})}},{"../catchReturn":308,"./decodeKeyString":309,"./importKey":320}],322:[function(require,module,exports){"use strict";var __awaiter=this&&this.__awaiter||function(thisArg,_arguments,P,generator){return new(P=P||Promise)(function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator.throw(value))}catch(e){reject(e)}}function step(result){var value;result.done?resolve(result.value):((value=result.value)instanceof P?value:new P(function(resolve){resolve(value)})).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())})},__generator=this&&this.__generator||function(thisArg,body){var f,y,t,_={label:0,sent:function(){if(1&t[0])throw t[1];return t[1]},trys:[],ops:[]},g={next:verb(0),throw:verb(1),return:verb(2)};return"function"==typeof Symbol&&(g[Symbol.iterator]=function(){return this}),g;function verb(n){return function(v){var op=[n,v];if(f)throw new TypeError("Generator is already executing.");for(;_;)try{if(f=1,y&&(t=2&op[0]?y.return:op[0]?y.throw||((t=y.return)&&t.call(y),0):y.next)&&!(t=t.call(y,op[1])).done)return t;switch(y=0,(op=t?[2&op[0],t.value]:op)[0]){case 0:case 1:t=op;break;case 4:return _.label++,{value:op[1],done:!1};case 5:_.label++,y=op[1],op=[0];continue;case 7:op=_.ops.pop(),_.trys.pop();continue;default:if(!(t=0<(t=_.trys).length&&t[t.length-1])&&(6===op[0]||2===op[0])){_=0;continue}if(3===op[0]&&(!t||op[1]>t[0]&&op[1]<t[3])){_.label=op[1];break}if(6===op[0]&&_.label<t[1]){_.label=t[1],t=op;break}if(t&&_.label<t[2]){_.label=t[2],_.ops.push(op);break}t[2]&&_.ops.pop(),_.trys.pop();continue}op=body.call(thisArg,_)}catch(e){op=[6,e],y=0}finally{f=t=0}if(5&op[0])throw op[1];return{value:op[0]?op[1]:void 0,done:!0}}}},__importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}},encodeKeyString_1=(Object.defineProperty(exports,"__esModule",{value:!0}),__importDefault(require("./encodeKeyString"))),exportKey_1=__importDefault(require("./exportKey"));exports.default=function(signKeys,encryptionKeys){return __awaiter(this,void 0,void 0,function(){var skpub,skpriv,ekpub,ekpriv;return __generator(this,function(_a){switch(_a.label){case 0:return[4,(0,exportKey_1.default)("spki",signKeys.publicKey)];case 1:return skpub=_a.sent(),[4,(0,exportKey_1.default)("pkcs8",signKeys.privateKey)];case 2:return skpriv=_a.sent(),[4,(0,exportKey_1.default)("spki",encryptionKeys.publicKey)];case 3:return ekpub=_a.sent(),[4,(0,exportKey_1.default)("pkcs8",encryptionKeys.privateKey)];case 4:return ekpriv=_a.sent(),[2,{skpub:(0,encodeKeyString_1.default)(skpub),skpriv:(0,encodeKeyString_1.default)(skpriv),ekpub:(0,encodeKeyString_1.default)(ekpub),ekpriv:(0,encodeKeyString_1.default)(ekpriv)}]}})})}},{"./encodeKeyString":313,"./exportKey":316}],323:[function(require,module,exports){"use strict";var __importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}},getCrypto_1=(Object.defineProperty(exports,"__esModule",{value:!0}),__importDefault(require("../../getCrypto"))),stringToArrayBuffer_1=__importDefault(require("../stringToArrayBuffer"));exports.default=function(data,signature,publicKey,hashName){return void 0===hashName&&(hashName="SHA-256"),(0,getCrypto_1.default)().subtle.verify({name:"ECDSA",hash:{name:hashName}},publicKey,signature,(0,stringToArrayBuffer_1.default)(data))}},{"../../getCrypto":267,"../stringToArrayBuffer":335}],324:[function(require,module,exports){!function(global){!function(){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(str){return decodeURIComponent(escape(global.atob(str)))}}.call(this)}.call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],325:[function(require,module,exports){"use strict";var __importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}},getCrypto_1=(Object.defineProperty(exports,"__esModule",{value:!0}),__importDefault(require("../getCrypto")));exports.default=function(){return(0,getCrypto_1.default)().getRandomValues(new Uint8Array(12))}},{"../getCrypto":267}],326:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var __1=require("..");exports.default=function(privateKey,topic,timestamp,host,port){return topic=(0,__1.sha256)(topic+"-"+timestamp+"-"+host+":"+port),(0,__1.signData)(topic,privateKey,"SHA-1").then(__1.arrayBufferToBase64)}},{"..":268}],327:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(hex){return(hex=hex.toUpperCase().match(/[\dA-F]{2}/gi))?(hex=hex.map(function(s){return parseInt(s,16)}),new Uint8Array(hex).buffer):new Uint8Array}},{}],328:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(dbName){void 0===dbName&&(dbName="tooldb");var db=null,store={start:function(){},put:function(key,data,callback){},get:function(key,callback){},query:function(key){return Promise.resolve([])},quit:function(){}};return store.start=function(){var open=indexedDB.open(dbName,1);open.onupgradeneeded=function(eve){eve.target.result.createObjectStore(dbName)},open.onsuccess=function(){db=open.result},open.onerror=function(eve){console.warn(eve||1)}},store.start(),store.quit=function(){db&&(db.close(),db=null)},store.put=function(key,data,cb){var tx,obj,req;db?(req=(obj=(tx=db.transaction([dbName],"readwrite")).objectStore(dbName)).put(data,""+key),cb&&(req.onsuccess=obj.onsuccess=tx.onsuccess=function(){cb(!1)},req.onabort=obj.onabort=tx.onabort=function(eve){cb(eve||"put.tx.abort")},req.onerror=obj.onerror=tx.onerror=function(eve){cb(eve||"put.tx.error")})):setTimeout(function(){store.put(key,data,cb)},1)},store.get=function(key,cb){var req;db?((req=db.transaction([dbName],"readonly").objectStore(dbName).get(""+key)).onsuccess=function(){cb(!1,req.result)},req.onabort=function(eve){cb(eve||4)},req.onerror=function(eve){cb(eve||5)}):setTimeout(function(){store.get(key,cb)},9)},store.query=function(key){return new Promise(function(resolve,reject){try{var keyRange=IDBKeyRange.bound(key,key+"|",!0,!0),obj=db.transaction([dbName],"readonly").objectStore(dbName),keysArray_1=[];obj.openCursor(keyRange).onsuccess=function(event){var cursor=event.target.result;cursor?(keysArray_1.push(event.target.result.key),cursor.continue()):resolve(keysArray_1)}}catch(error){reject(error)}})},setInterval(function(){db&&db.close(),db=null,store.start()},15e3),store}},{}],329:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(dbName){void 0===dbName&&(dbName="tooldb");var level=require("level"),db=null,store={start:function(){},put:function(key,data,callback){},get:function(key,callback){},query:function(key){return Promise.resolve([])},quit:function(){}};return store.start=function(){db=level(dbName)},store.start(),store.quit=function(){db.close()},store.put=function(key,data,cb){db.put(key,data,function(err){err?cb&&cb(err):cb&&cb(!1)})},store.get=function(key,cb){db?db.get(key,function(err,value){err?cb&&cb(err):cb&&cb(!1,value)}):setTimeout(function(){store.get(key,cb)},9)},store.query=function(key){return new Promise(function(resolve,reject){try{var array_1=[];db.createKeyStream({gte:key,lte:key+"￿"}).on("data",function(data){array_1.push(data)}).on("error",function(err){reject(err)}).on("close",function(){resolve(array_1)})}catch(error){reject(error)}})},store}},{level:255}],330:[function(require,module,exports){"use strict";var __importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}},sha256_1=(Object.defineProperty(exports,"__esModule",{value:!0}),__importDefault(require("./sha256")));exports.default=function(value,difficulty){return new Promise(function(resolve){for(var nonce=0,hash=(0,sha256_1.default)(""+value+nonce);hash.substring(0,difficulty)!==Array(difficulty+1).join("0");)hash=(0,sha256_1.default)(""+value+(nonce+=1));resolve({nonce:nonce,hash:hash})})}},{"./sha256":333}],331:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var animals=["Pug","Chicken","Slug","Snail","Pig","Cow","Sheep","Horse","Squirrel","Turtle","Unicorn","Dragon","Dolphin","Cat","Chow Chow","Elephant","Meerkat","Polar Bear","Bear","Rabbit","Koala","Parrot","Raven","Frog","Rat","Mouse","Bee","Tiger","Lion","Giraffe","Ant","Spider","Zebra"];exports.default=function(){return animals[Math.round(Math.random()*animals.length)]}},{}],332:[function(require,module,exports){"use strict";var __importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}},crypto_1=(Object.defineProperty(exports,"__esModule",{value:!0}),__importDefault(require("crypto")));exports.default=function(str,hex){void 0===hex&&(hex=!0);var hash=crypto_1.default.createHash("sha1");return hash.update(str),hash.digest(hex?"hex":"base64")}},{crypto:143}],333:[function(require,module,exports){"use strict";var __importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}},crypto_1=(Object.defineProperty(exports,"__esModule",{value:!0}),__importDefault(require("crypto")));exports.default=function(str,hex){void 0===hex&&(hex=!0);var hash=crypto_1.default.createHash("sha256");return hash.update(str),hash.digest(hex?"hex":"base64")}},{crypto:143}],334:[function(require,module,exports){"use strict";var __importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}},getCrypto_1=(Object.defineProperty(exports,"__esModule",{value:!0}),__importDefault(require("../getCrypto"))),stringToArrayBuffer_1=__importDefault(require("./stringToArrayBuffer"));exports.default=function(data,privateKey,hashName){return void 0===hashName&&(hashName="SHA-256"),(0,getCrypto_1.default)().subtle.sign({name:"ECDSA",hash:{name:hashName}},privateKey,(0,stringToArrayBuffer_1.default)(data))}},{"../getCrypto":267,"./stringToArrayBuffer":335}],335:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(str){for(var buf=new ArrayBuffer(str.length),bufView=new Uint8Array(buf),i=0,strLen=str.length;i<strLen;i+=1)bufView[i]=str.charCodeAt(i);return buf}},{}],336:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(_l,_c){for(var l=_l=void 0===_l?24:_l,s="",c=_c||"0123456789ABCDEFGHIJKLMNOPQRSTUVWXZabcdefghijklmnopqrstuvwxyz";0<l;)s+=c.charAt(Math.floor(Math.random()*c.length)),--l;return s}},{}],337:[function(require,module,exports){!function(global){!function(){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(str){return global.btoa(unescape(encodeURIComponent(str)))}}.call(this)}.call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],338:[function(require,module,exports){"use strict";var __importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}},toBase64_1=(Object.defineProperty(exports,"__esModule",{value:!0}),__importDefault(require("./toBase64")));exports.default=function(byteArray){for(var byteString="",i=0;i<byteArray.byteLength;i+=1)byteString+=String.fromCodePoint(byteArray[i]);return(0,toBase64_1.default)(byteString)}},{"./toBase64":337}],339:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(array){return Array.from(new Set(array))}},{}],340:[function(require,module,exports){"use strict";var __awaiter=this&&this.__awaiter||function(thisArg,_arguments,P,generator){return new(P=P||Promise)(function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator.throw(value))}catch(e){reject(e)}}function step(result){var value;result.done?resolve(result.value):((value=result.value)instanceof P?value:new P(function(resolve){resolve(value)})).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())})},__generator=this&&this.__generator||function(thisArg,body){var f,y,t,_={label:0,sent:function(){if(1&t[0])throw t[1];return t[1]},trys:[],ops:[]},g={next:verb(0),throw:verb(1),return:verb(2)};return"function"==typeof Symbol&&(g[Symbol.iterator]=function(){return this}),g;function verb(n){return function(v){var op=[n,v];if(f)throw new TypeError("Generator is already executing.");for(;_;)try{if(f=1,y&&(t=2&op[0]?y.return:op[0]?y.throw||((t=y.return)&&t.call(y),0):y.next)&&!(t=t.call(y,op[1])).done)return t;switch(y=0,(op=t?[2&op[0],t.value]:op)[0]){case 0:case 1:t=op;break;case 4:return _.label++,{value:op[1],done:!1};case 5:_.label++,y=op[1],op=[0];continue;case 7:op=_.ops.pop(),_.trys.pop();continue;default:if(!(t=0<(t=_.trys).length&&t[t.length-1])&&(6===op[0]||2===op[0])){_=0;continue}if(3===op[0]&&(!t||op[1]>t[0]&&op[1]<t[3])){_.label=op[1];break}if(6===op[0]&&_.label<t[1]){_.label=t[1],t=op;break}if(t&&_.label<t[2]){_.label=t[2],_.ops.push(op);break}t[2]&&_.ops.pop(),_.trys.pop();continue}op=body.call(thisArg,_)}catch(e){op=[6,e],y=0}finally{f=t=0}if(5&op[0])throw op[1];return{value:op[0]?op[1]:void 0,done:!0}}}},__importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}},sha256_1=(Object.defineProperty(exports,"__esModule",{value:!0}),__importDefault(require("./sha256"))),message_1=require("../types/message"),decodeKeyString_1=__importDefault(require("./crypto/decodeKeyString")),importKey_1=__importDefault(require("./crypto/importKey")),verifyData_1=__importDefault(require("./crypto/verifyData")),__1=require("..");exports.default=function(msg,pow){return void 0===pow&&(pow=0),__awaiter(this,void 0,void 0,function(){var strData,publicKeyNamespace,key_1,data,pubKey,_this=this;return __generator(this,function(_a){switch(_a.label){case 0:return(strData=JSON.stringify(msg.v),void 0===msg.t||void 0===msg.k||void 0===msg.h||void 0===msg.p||void 0===msg.s)?[2,message_1.VerifyResult.InvalidData]:msg.t>(new Date).getTime()+3e4?[2,message_1.VerifyResult.InvalidTimestamp]:(publicKeyNamespace=!1,":"==msg.k.slice(0,1)&&(publicKeyNamespace=msg.k.split(".")[0].slice(1)),"=="!=msg.k.slice(0,2)?[3,2]:(key_1=msg.k,[4,new Promise(function(resolve){_this.store.get(key_1,function(err,data){if(data)try{var message=JSON.parse(data);resolve(message)}catch(e){resolve(null)}else resolve(null)})})]));case 1:if((data=_a.sent())&&data.p!==msg.p)return[2,message_1.VerifyResult.CantOverwrite];_a.label=2;case 2:if(data=msg.p,publicKeyNamespace&&publicKeyNamespace!==data)return[2,message_1.VerifyResult.PubKeyMismatch];if(0<pow){if(msg.h.slice(0,pow)!==new Array(pow).fill("0").join(""))return[2,message_1.VerifyResult.NoProofOfWork];if((0,sha256_1.default)(""+strData+data+msg.t+msg.n)!==msg.h)return[2,message_1.VerifyResult.InvalidHashNonce]}return[4,(0,importKey_1.default)((0,decodeKeyString_1.default)(data),"spki","ECDSA",["verify"])];case 3:return pubKey=_a.sent(),[4,(0,verifyData_1.default)(msg.h,(0,__1.base64ToArrayBuffer)(msg.s),pubKey)];case 4:return[2,_a.sent()?message_1.VerifyResult.Verified:message_1.VerifyResult.InvalidSignature]}})})}},{"..":268,"../types/message":299,"./crypto/decodeKeyString":309,"./crypto/importKey":320,"./crypto/verifyData":323,"./sha256":333}],341:[function(require,module,exports){"use strict";var __importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}},__1=(Object.defineProperty(exports,"__esModule",{value:!0}),require("..")),tooldb_1=require("../tooldb"),hexToArrayBuffer_1=__importDefault(require("./hexToArrayBuffer"));exports.default=function(peer){return(0,__1.importKey)((0,hexToArrayBuffer_1.default)(tooldb_1.KEY_PREFIX+peer.pubkey),"spki","ECDSA",["verify"]).then(function(pubKey){return(0,__1.verifyData)((0,__1.sha256)(peer.topic+"-"+peer.timestamp+"-"+peer.host+":"+peer.port),(0,__1.base64ToArrayBuffer)(peer.sig),pubKey,"SHA-1")})}},{"..":268,"../tooldb":298,"./hexToArrayBuffer":327}],342:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(fn,interval,timeout){return void 0===interval&&(interval=100),void 0===timeout&&(timeout=3e4),new Promise(function(resolve,reject){var intervalFn=setInterval(function(){fn()&&(clearInterval(intervalFn),clearTimeout(timeoutFn),resolve())},interval),timeoutFn=setTimeout(function(){clearInterval(intervalFn),reject()},timeout)})}},{}],343:[function(require,module,exports){module.exports={"2.16.840.1.101.3.4.1.1":"aes-128-ecb","2.16.840.1.101.3.4.1.2":"aes-128-cbc","2.16.840.1.101.3.4.1.3":"aes-128-ofb","2.16.840.1.101.3.4.1.4":"aes-128-cfb","2.16.840.1.101.3.4.1.21":"aes-192-ecb","2.16.840.1.101.3.4.1.22":"aes-192-cbc","2.16.840.1.101.3.4.1.23":"aes-192-ofb","2.16.840.1.101.3.4.1.24":"aes-192-cfb","2.16.840.1.101.3.4.1.41":"aes-256-ecb","2.16.840.1.101.3.4.1.42":"aes-256-cbc","2.16.840.1.101.3.4.1.43":"aes-256-ofb","2.16.840.1.101.3.4.1.44":"aes-256-cfb"}},{}],344:[function(require,module,exports){"use strict";var asn1=require("asn1.js"),require=(exports.certificate=require("./certificate"),asn1.define("RSAPrivateKey",function(){this.seq().obj(this.key("version").int(),this.key("modulus").int(),this.key("publicExponent").int(),this.key("privateExponent").int(),this.key("prime1").int(),this.key("prime2").int(),this.key("exponent1").int(),this.key("exponent2").int(),this.key("coefficient").int())})),require=(exports.RSAPrivateKey=require,asn1.define("RSAPublicKey",function(){this.seq().obj(this.key("modulus").int(),this.key("publicExponent").int())})),require=(exports.RSAPublicKey=require,asn1.define("SubjectPublicKeyInfo",function(){this.seq().obj(this.key("algorithm").use(AlgorithmIdentifier),this.key("subjectPublicKey").bitstr())})),AlgorithmIdentifier=(exports.PublicKey=require,asn1.define("AlgorithmIdentifier",function(){this.seq().obj(this.key("algorithm").objid(),this.key("none").null_().optional(),this.key("curve").objid().optional(),this.key("params").seq().obj(this.key("p").int(),this.key("q").int(),this.key("g").int()).optional())})),require=asn1.define("PrivateKeyInfo",function(){this.seq().obj(this.key("version").int(),this.key("algorithm").use(AlgorithmIdentifier),this.key("subjectPrivateKey").octstr())}),require=(exports.PrivateKey=require,asn1.define("EncryptedPrivateKeyInfo",function(){this.seq().obj(this.key("algorithm").seq().obj(this.key("id").objid(),this.key("decrypt").seq().obj(this.key("kde").seq().obj(this.key("id").objid(),this.key("kdeparams").seq().obj(this.key("salt").octstr(),this.key("iters").int())),this.key("cipher").seq().obj(this.key("algo").objid(),this.key("iv").octstr()))),this.key("subjectPrivateKey").octstr())})),require=(exports.EncryptedPrivateKey=require,asn1.define("DSAPrivateKey",function(){this.seq().obj(this.key("version").int(),this.key("p").int(),this.key("q").int(),this.key("g").int(),this.key("pub_key").int(),this.key("priv_key").int())})),require=(exports.DSAPrivateKey=require,exports.DSAparam=asn1.define("DSAparam",function(){this.int()}),asn1.define("ECPrivateKey",function(){this.seq().obj(this.key("version").int(),this.key("privateKey").octstr(),this.key("parameters").optional().explicit(0).use(ECParameters),this.key("publicKey").optional().explicit(1).bitstr())})),ECParameters=(exports.ECPrivateKey=require,asn1.define("ECParameters",function(){this.choice({namedCurve:this.objid()})}));exports.signature=asn1.define("signature",function(){this.seq().obj(this.key("r").int(),this.key("s").int())})},{"./certificate":345,"asn1.js":8}],345:[function(require,module,exports){"use strict";var require=require("asn1.js"),Time=require.define("Time",function(){this.choice({utcTime:this.utctime(),generalTime:this.gentime()})}),AttributeTypeValue=require.define("AttributeTypeValue",function(){this.seq().obj(this.key("type").objid(),this.key("value").any())}),AlgorithmIdentifier=require.define("AlgorithmIdentifier",function(){this.seq().obj(this.key("algorithm").objid(),this.key("parameters").optional(),this.key("curve").objid().optional())}),SubjectPublicKeyInfo=require.define("SubjectPublicKeyInfo",function(){this.seq().obj(this.key("algorithm").use(AlgorithmIdentifier),this.key("subjectPublicKey").bitstr())}),RelativeDistinguishedName=require.define("RelativeDistinguishedName",function(){this.setof(AttributeTypeValue)}),RDNSequence=require.define("RDNSequence",function(){this.seqof(RelativeDistinguishedName)}),Name=require.define("Name",function(){this.choice({rdnSequence:this.use(RDNSequence)})}),Validity=require.define("Validity",function(){this.seq().obj(this.key("notBefore").use(Time),this.key("notAfter").use(Time))}),Extension=require.define("Extension",function(){this.seq().obj(this.key("extnID").objid(),this.key("critical").bool().def(!1),this.key("extnValue").octstr())}),TBSCertificate=require.define("TBSCertificate",function(){this.seq().obj(this.key("version").explicit(0).int().optional(),this.key("serialNumber").int(),this.key("signature").use(AlgorithmIdentifier),this.key("issuer").use(Name),this.key("validity").use(Validity),this.key("subject").use(Name),this.key("subjectPublicKeyInfo").use(SubjectPublicKeyInfo),this.key("issuerUniqueID").implicit(1).bitstr().optional(),this.key("subjectUniqueID").implicit(2).bitstr().optional(),this.key("extensions").explicit(3).seqof(Extension).optional())}),require=require.define("X509Certificate",function(){this.seq().obj(this.key("tbsCertificate").use(TBSCertificate),this.key("signatureAlgorithm").use(AlgorithmIdentifier),this.key("signatureValue").bitstr())});module.exports=require},{"asn1.js":8}],346:[function(require,module,exports){var findProc=/Proc-Type: 4,ENCRYPTED[\n\r]+DEK-Info: AES-((?:128)|(?:192)|(?:256))-CBC,([0-9A-H]+)[\n\r]+([0-9A-z\n\r+/=]+)[\n\r]+/m,startRegex=/^-----BEGIN ((?:.*? KEY)|CERTIFICATE)-----/m,fullRegex=/^-----BEGIN ((?:.*? KEY)|CERTIFICATE)-----([0-9A-z\n\r+/=]+)-----END \1-----$/m,evp=require("evp_bytestokey"),ciphers=require("browserify-aes"),Buffer=require("safe-buffer").Buffer;module.exports=function(okey,password){var cipherText,suite,iv,okey=okey.toString(),match=okey.match(findProc);return iv=match?(suite="aes"+match[1],iv=Buffer.from(match[2],"hex"),cipherText=Buffer.from(match[3].replace(/[\r\n]/g,""),"base64"),password=evp(password,iv.slice(0,8),parseInt(match[1],10)).key,match=[],suite=ciphers.createDecipheriv(suite,password,iv),match.push(suite.update(cipherText)),match.push(suite.final()),Buffer.concat(match)):(password=okey.match(fullRegex),Buffer.from(password[2].replace(/[\r\n]/g,""),"base64")),{tag:okey.match(startRegex)[1],data:iv}}},{"browserify-aes":71,evp_bytestokey:179,"safe-buffer":367}],347:[function(require,module,exports){var asn1=require("./asn1"),aesid=require("./aesid.json"),fixProc=require("./fixProc"),ciphers=require("browserify-aes"),compat=require("pbkdf2"),Buffer=require("safe-buffer").Buffer;function parseKeys(buffer){"object"!=typeof buffer||Buffer.isBuffer(buffer)||(password=buffer.passphrase,buffer=buffer.key),"string"==typeof buffer&&(buffer=Buffer.from(buffer));var password,subtype,ndata,buffer=fixProc(buffer,password),type=buffer.tag,data=buffer.data;switch(type){case"CERTIFICATE":ndata=asn1.certificate.decode(data,"der").tbsCertificate.subjectPublicKeyInfo;case"PUBLIC KEY":switch(subtype=(ndata=ndata||asn1.PublicKey.decode(data,"der")).algorithm.algorithm.join(".")){case"1.2.840.113549.1.1.1":return asn1.RSAPublicKey.decode(ndata.subjectPublicKey.data,"der");case"1.2.840.10045.2.1":return ndata.subjectPrivateKey=ndata.subjectPublicKey,{type:"ec",data:ndata};case"1.2.840.10040.4.1":return ndata.algorithm.params.pub_key=asn1.DSAparam.decode(ndata.subjectPublicKey.data,"der"),{type:"dsa",data:ndata.algorithm.params};default:throw new Error("unknown key id "+subtype)}case"ENCRYPTED PRIVATE KEY":data=function(data,password){var salt=data.algorithm.decrypt.kde.kdeparams.salt,iters=parseInt(data.algorithm.decrypt.kde.kdeparams.iters.toString(),10),algo=aesid[data.algorithm.decrypt.cipher.algo.join(".")],iv=data.algorithm.decrypt.cipher.iv,data=data.subjectPrivateKey,keylen=parseInt(algo.split("-")[1],10)/8,password=compat.pbkdf2Sync(password,salt,iters,keylen,"sha1"),salt=ciphers.createDecipheriv(algo,password,iv),iters=[];return iters.push(salt.update(data)),iters.push(salt.final()),Buffer.concat(iters)}(data=asn1.EncryptedPrivateKey.decode(data,"der"),password);case"PRIVATE KEY":switch(subtype=(ndata=asn1.PrivateKey.decode(data,"der")).algorithm.algorithm.join(".")){case"1.2.840.113549.1.1.1":return asn1.RSAPrivateKey.decode(ndata.subjectPrivateKey,"der");case"1.2.840.10045.2.1":return{curve:ndata.algorithm.curve,privateKey:asn1.ECPrivateKey.decode(ndata.subjectPrivateKey,"der").privateKey};case"1.2.840.10040.4.1":return ndata.algorithm.params.priv_key=asn1.DSAparam.decode(ndata.subjectPrivateKey,"der"),{type:"dsa",params:ndata.algorithm.params};default:throw new Error("unknown key id "+subtype)}case"RSA PUBLIC KEY":return asn1.RSAPublicKey.decode(data,"der");case"RSA PRIVATE KEY":return asn1.RSAPrivateKey.decode(data,"der");case"DSA PRIVATE KEY":return{type:"dsa",params:asn1.DSAPrivateKey.decode(data,"der")};case"EC PRIVATE KEY":return{curve:(data=asn1.ECPrivateKey.decode(data,"der")).parameters.value,privateKey:data.privateKey};default:throw new Error("unknown key type "+type)}}(module.exports=parseKeys).signature=asn1.signature},{"./aesid.json":343,"./asn1":344,"./fixProc":346,"browserify-aes":71,pbkdf2:348,"safe-buffer":367}],348:[function(require,module,exports){exports.pbkdf2=require("./lib/async"),exports.pbkdf2Sync=require("./lib/sync")},{"./lib/async":349,"./lib/sync":352}],349:[function(require,module,exports){!function(global){!function(){var ZERO_BUF,nextTick,Buffer=require("safe-buffer").Buffer,checkParameters=require("./precondition"),defaultEncoding=require("./default-encoding"),sync=require("./sync"),toBuffer=require("./to-buffer"),subtle=global.crypto&&global.crypto.subtle,toBrowser={sha:"SHA-1","sha-1":"SHA-1",sha1:"SHA-1",sha256:"SHA-256","sha-256":"SHA-256",sha384:"SHA-384","sha-384":"SHA-384","sha-512":"SHA-512",sha512:"SHA-512"},checks=[];function getNextTick(){return nextTick=nextTick||(global.process&&global.process.nextTick?global.process.nextTick:global.queueMicrotask||global.setImmediate||global.setTimeout)}function browserPbkdf2(password,salt,iterations,length,algo){return subtle.importKey("raw",password,{name:"PBKDF2"},!1,["deriveBits"]).then(function(key){return subtle.deriveBits({name:"PBKDF2",salt:salt,iterations:iterations,hash:{name:algo}},key,length<<3)}).then(function(res){return Buffer.from(res)})}module.exports=function(password,salt,iterations,keylen,digest,callback){"function"==typeof digest&&(callback=digest,digest=void 0);var algo=toBrowser[(digest=digest||"sha1").toLowerCase()];if(algo&&"function"==typeof global.Promise){if(checkParameters(iterations,keylen),password=toBuffer(password,defaultEncoding,"Password"),salt=toBuffer(salt,defaultEncoding,"Salt"),"function"!=typeof callback)throw new Error("No callback provided to pbkdf2");!function(promise,callback){promise.then(function(out){getNextTick()(function(){callback(null,out)})},function(e){getNextTick()(function(){callback(e)})})}(function(algo){if(global.process&&!global.process.browser)return Promise.resolve(!1);if(!subtle||!subtle.importKey||!subtle.deriveBits)return Promise.resolve(!1);if(void 0!==checks[algo])return checks[algo];var prom=browserPbkdf2(ZERO_BUF=ZERO_BUF||Buffer.alloc(8),ZERO_BUF,10,128,algo).then(function(){return!0}).catch(function(){return!1});return checks[algo]=prom}(algo).then(function(resp){return resp?browserPbkdf2(password,salt,iterations,keylen,algo):sync(password,salt,iterations,keylen,digest)}),callback)}else getNextTick()(function(){var out;try{out=sync(password,salt,iterations,keylen,digest)}catch(e){return callback(e)}callback(null,out)})}}.call(this)}.call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./default-encoding":350,"./precondition":351,"./sync":352,"./to-buffer":353,"safe-buffer":367}],350:[function(require,module,exports){!function(process,global){!function(){var defaultEncoding;defaultEncoding=global.process&&global.process.browser||!global.process||!global.process.version||6<=parseInt(process.version.split(".")[0].slice(1),10)?"utf-8":"binary",module.exports=defaultEncoding}.call(this)}.call(this,require("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{_process:354}],351:[function(require,module,exports){var MAX_ALLOC=Math.pow(2,30)-1;module.exports=function(iterations,keylen){if("number"!=typeof iterations)throw new TypeError("Iterations not a number");if(iterations<0)throw new TypeError("Bad iterations");if("number"!=typeof keylen)throw new TypeError("Key length not a number");if(keylen<0||MAX_ALLOC<keylen||keylen!=keylen)throw new TypeError("Bad key length")}},{}],352:[function(require,module,exports){var md5=require("create-hash/md5"),RIPEMD160=require("ripemd160"),sha=require("sha.js"),Buffer=require("safe-buffer").Buffer,checkParameters=require("./precondition"),defaultEncoding=require("./default-encoding"),toBuffer=require("./to-buffer"),ZEROS=Buffer.alloc(128),sizes={md5:16,sha1:20,sha224:28,sha256:32,sha384:48,sha512:64,rmd160:20,ripemd160:20};function Hmac(alg,key,saltLen){for(var hash=function(alg){return"rmd160"===alg||"ripemd160"===alg?function(data){return(new RIPEMD160).update(data).digest()}:"md5"===alg?md5:function(data){return sha(alg).update(data).digest()}}(alg),blocksize="sha512"===alg||"sha384"===alg?128:64,ipad=(key.length>blocksize?key=hash(key):key.length<blocksize&&(key=Buffer.concat([key,ZEROS],blocksize)),Buffer.allocUnsafe(blocksize+sizes[alg])),opad=Buffer.allocUnsafe(blocksize+sizes[alg]),i=0;i<blocksize;i++)ipad[i]=54^key[i],opad[i]=92^key[i];saltLen=Buffer.allocUnsafe(blocksize+saltLen+4);ipad.copy(saltLen,0,0,blocksize),this.ipad1=saltLen,this.ipad2=ipad,this.opad=opad,this.alg=alg,this.blocksize=blocksize,this.hash=hash,this.size=sizes[alg]}Hmac.prototype.run=function(data,ipad){return data.copy(ipad,this.blocksize),this.hash(ipad).copy(this.opad,this.blocksize),this.hash(this.opad)},module.exports=function(password,salt,iterations,keylen,digest){checkParameters(iterations,keylen);for(var hmac=new Hmac(digest=digest||"sha1",password=toBuffer(password,defaultEncoding,"Password"),(salt=toBuffer(salt,defaultEncoding,"Salt")).length),DK=Buffer.allocUnsafe(keylen),block1=Buffer.allocUnsafe(salt.length+4),destPos=(salt.copy(block1,0,0,salt.length),0),hLen=sizes[digest],l=Math.ceil(keylen/hLen),i=1;i<=l;i++){block1.writeUInt32BE(i,salt.length);for(var T=hmac.run(block1,hmac.ipad1),U=T,j=1;j<iterations;j++)for(var U=hmac.run(U,hmac.ipad2),k=0;k<hLen;k++)T[k]^=U[k];T.copy(DK,destPos),destPos+=hLen}return DK}},{"./default-encoding":350,"./precondition":351,"./to-buffer":353,"create-hash/md5":140,ripemd160:365,"safe-buffer":367,"sha.js":370}],353:[function(require,module,exports){var Buffer=require("safe-buffer").Buffer;module.exports=function(thing,encoding,name){if(Buffer.isBuffer(thing))return thing;if("string"==typeof thing)return Buffer.from(thing,encoding);if(ArrayBuffer.isView(thing))return Buffer.from(thing.buffer);throw new TypeError(name+" must be a string, a Buffer, a typed array or a DataView")}},{"safe-buffer":367}],354:[function(require,module,exports){var cachedSetTimeout,cachedClearTimeout,module=module.exports={};function defaultSetTimout(){throw new Error("setTimeout has not been defined")}function defaultClearTimeout(){throw new Error("clearTimeout has not been defined")}try{cachedSetTimeout="function"==typeof setTimeout?setTimeout:defaultSetTimout}catch(e){cachedSetTimeout=defaultSetTimout}try{cachedClearTimeout="function"==typeof clearTimeout?clearTimeout:defaultClearTimeout}catch(e){cachedClearTimeout=defaultClearTimeout}function runTimeout(fun){if(cachedSetTimeout===setTimeout)return setTimeout(fun,0);if((cachedSetTimeout===defaultSetTimout||!cachedSetTimeout)&&setTimeout)return(cachedSetTimeout=setTimeout)(fun,0);try{return cachedSetTimeout(fun,0)}catch(e){try{return cachedSetTimeout.call(null,fun,0)}catch(e){return cachedSetTimeout.call(this,fun,0)}}}var currentQueue,queue=[],draining=!1,queueIndex=-1;function cleanUpNextTick(){draining&&currentQueue&&(draining=!1,currentQueue.length?queue=currentQueue.concat(queue):queueIndex=-1,queue.length&&drainQueue())}function drainQueue(){if(!draining){for(var timeout=runTimeout(cleanUpNextTick),len=(draining=!0,queue.length);len;){for(currentQueue=queue,queue=[];++queueIndex<len;)currentQueue&&currentQueue[queueIndex].run();queueIndex=-1,len=queue.length}currentQueue=null,draining=!1,!function(marker){if(cachedClearTimeout===clearTimeout)return clearTimeout(marker);if((cachedClearTimeout===defaultClearTimeout||!cachedClearTimeout)&&clearTimeout)return(cachedClearTimeout=clearTimeout)(marker);try{cachedClearTimeout(marker)}catch(e){try{return cachedClearTimeout.call(null,marker)}catch(e){return cachedClearTimeout.call(this,marker)}}}(timeout)}}function Item(fun,array){this.fun=fun,this.array=array}function noop(){}module.nextTick=function(fun){var args=new Array(arguments.length-1);if(1<arguments.length)for(var i=1;i<arguments.length;i++)args[i-1]=arguments[i];queue.push(new Item(fun,args)),1!==queue.length||draining||runTimeout(drainQueue)},Item.prototype.run=function(){this.fun.apply(null,this.array)},module.title="browser",module.browser=!0,module.env={},module.argv=[],module.version="",module.versions={},module.on=noop,module.addListener=noop,module.once=noop,module.off=noop,module.removeListener=noop,module.removeAllListeners=noop,module.emit=noop,module.prependListener=noop,module.prependOnceListener=noop,module.listeners=function(name){return[]},module.binding=function(name){throw new Error("process.binding is not supported")},module.cwd=function(){return"/"},module.chdir=function(dir){throw new Error("process.chdir is not supported")},module.umask=function(){return 0}},{}],355:[function(require,module,exports){exports.publicEncrypt=require("./publicEncrypt"),exports.privateDecrypt=require("./privateDecrypt"),exports.privateEncrypt=function(key,buf){return exports.publicEncrypt(key,buf,!0)},exports.publicDecrypt=function(key,buf){return exports.privateDecrypt(key,buf,!0)}},{"./privateDecrypt":358,"./publicEncrypt":359}],356:[function(require,module,exports){var createHash=require("create-hash"),Buffer=require("safe-buffer").Buffer;module.exports=function(seed,len){for(var c,t=Buffer.alloc(0),i=0;t.length<len;)c=function(c){var out=Buffer.allocUnsafe(4);return out.writeUInt32BE(c,0),out}(i++),t=Buffer.concat([t,createHash("sha1").update(seed).update(c).digest()]);return t.slice(0,len)}},{"create-hash":139,"safe-buffer":367}],357:[function(require,module,exports){arguments[4][22][0].apply(exports,arguments)},{buffer:68,dup:22}],358:[function(require,module,exports){var parseKeys=require("parse-asn1"),mgf=require("./mgf"),xor=require("./xor"),BN=require("bn.js"),crt=require("browserify-rsa"),createHash=require("create-hash"),withPublic=require("./withPublic"),Buffer=require("safe-buffer").Buffer;module.exports=function(privateKey,enc,reverse){var padding=privateKey.padding||(reverse?1:4),privateKey=parseKeys(privateKey),k=privateKey.modulus.byteLength();if(enc.length>k||0<=new BN(enc).cmp(privateKey.modulus))throw new Error("decryption error");var enc=reverse?withPublic(new BN(enc),privateKey):crt(enc,privateKey),zBuffer=Buffer.alloc(k-enc.length);if(enc=Buffer.concat([zBuffer,enc],k),4===padding)return function(key,msg){var key=key.modulus.byteLength(),iHash=createHash("sha1").update(Buffer.alloc(0)).digest(),hLen=iHash.length;if(0!==msg[0])throw new Error("decryption error");var maskedSeed=msg.slice(1,hLen+1),msg=msg.slice(hLen+1),maskedSeed=xor(maskedSeed,mgf(msg,hLen)),db=xor(msg,mgf(maskedSeed,key-hLen-1));if(function(a,b){a=Buffer.from(a),b=Buffer.from(b);var dif=0,len=a.length;a.length!==b.length&&(dif++,len=Math.min(a.length,b.length));var i=-1;for(;++i<len;)dif+=a[i]^b[i];return dif}(iHash,db.slice(0,hLen)))throw new Error("decryption error");var i=hLen;for(;0===db[i];)i++;if(1===db[i++])return db.slice(i);throw new Error("decryption error")}(privateKey,enc);if(1===padding)return function(msg,reverse){var p1=msg.slice(0,2),i=2,status=0;for(;0!==msg[i++];)if(i>=msg.length){status++;break}var ps=msg.slice(2,i-1);("0002"!==p1.toString("hex")&&!reverse||"0001"!==p1.toString("hex")&&reverse)&&status++;ps.length<8&&status++;if(status)throw new Error("decryption error");return msg.slice(i)}(enc,reverse);if(3===padding)return enc;throw new Error("unknown padding")}},{"./mgf":356,"./withPublic":360,"./xor":361,"bn.js":357,"browserify-rsa":89,"create-hash":139,"parse-asn1":347,"safe-buffer":367}],359:[function(require,module,exports){var parseKeys=require("parse-asn1"),randomBytes=require("randombytes"),createHash=require("create-hash"),mgf=require("./mgf"),xor=require("./xor"),BN=require("bn.js"),withPublic=require("./withPublic"),crt=require("browserify-rsa"),Buffer=require("safe-buffer").Buffer;module.exports=function(publicKey,msg,reverse){var paddedMsg,padding=publicKey.padding||(reverse?1:4),publicKey=parseKeys(publicKey);if(4===padding)paddedMsg=function(key,msg){var key=key.modulus.byteLength(),mLen=msg.length,iHash=createHash("sha1").update(Buffer.alloc(0)).digest(),hLen=iHash.length,hLen2=2*hLen;if(key-hLen2-2<mLen)throw new Error("message too long");var mLen=Buffer.alloc(key-mLen-hLen2-2),hLen2=key-hLen-1,seed=randomBytes(hLen),iHash=xor(Buffer.concat([iHash,mLen,Buffer.alloc(1,1),msg],hLen2),mgf(seed,hLen2)),mLen=xor(seed,mgf(iHash,hLen));return new BN(Buffer.concat([Buffer.alloc(1),mLen,iHash],key))}(publicKey,msg);else if(1===padding)paddedMsg=function(key,msg,reverse){var mLen=msg.length,key=key.modulus.byteLength();if(key-11<mLen)throw new Error("message too long");mLen=reverse?Buffer.alloc(key-mLen-3,255):function(len){var num,out=Buffer.allocUnsafe(len),i=0,cache=randomBytes(2*len),cur=0;for(;i<len;)cur===cache.length&&(cache=randomBytes(2*len),cur=0),(num=cache[cur++])&&(out[i++]=num);return out}(key-mLen-3);return new BN(Buffer.concat([Buffer.from([0,reverse?1:2]),mLen,Buffer.alloc(1),msg],key))}(publicKey,msg,reverse);else{if(3!==padding)throw new Error("unknown padding");if(0<=(paddedMsg=new BN(msg)).cmp(publicKey.modulus))throw new Error("data too long for modulus")}return(reverse?crt:withPublic)(paddedMsg,publicKey)}},{"./mgf":356,"./withPublic":360,"./xor":361,"bn.js":357,"browserify-rsa":89,"create-hash":139,"parse-asn1":347,randombytes:363,"safe-buffer":367}],360:[function(require,module,exports){var BN=require("bn.js"),Buffer=require("safe-buffer").Buffer;module.exports=function(paddedMsg,key){return Buffer.from(paddedMsg.toRed(BN.mont(key.modulus)).redPow(new BN(key.publicExponent)).fromRed().toArray())}},{"bn.js":357,"safe-buffer":367}],361:[function(require,module,exports){module.exports=function(a,b){for(var len=a.length,i=-1;++i<len;)a[i]^=b[i];return a}},{}],362:[function(require,module,exports){!function(global){!function(){let promise;module.exports="function"==typeof queueMicrotask?queueMicrotask.bind("undefined"!=typeof window?window:global):cb=>(promise=promise||Promise.resolve()).then(cb).catch(err=>setTimeout(()=>{throw err},0))}.call(this)}.call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],363:[function(require,module,exports){!function(process,global){!function(){"use strict";var Buffer=require("safe-buffer").Buffer,crypto=global.crypto||global.msCrypto;crypto&&crypto.getRandomValues?module.exports=function(size,cb){if(4294967295<size)throw new RangeError("requested too many random bytes");var bytes=Buffer.allocUnsafe(size);if(0<size)if(65536<size)for(var generated=0;generated<size;generated+=65536)crypto.getRandomValues(bytes.slice(generated,generated+65536));else crypto.getRandomValues(bytes);return"function"!=typeof cb?bytes:process.nextTick(function(){cb(null,bytes)})}:module.exports=function(){throw new Error("Secure random number generation is not supported by this browser.\nUse Chrome, Firefox or Internet Explorer 11")}}.call(this)}.call(this,require("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{_process:354,"safe-buffer":367}],364:[function(require,module,exports){!function(process,global){!function(){"use strict";function oldBrowser(){throw new Error("secure random number generation not supported by this browser\nuse chrome, FireFox or Internet Explorer 11")}var safeBuffer=require("safe-buffer"),randombytes=require("randombytes"),Buffer=safeBuffer.Buffer,kBufferMaxLength=safeBuffer.kMaxLength,crypto=global.crypto||global.msCrypto,kMaxUint32=Math.pow(2,32)-1;function assertOffset(offset,length){if("number"!=typeof offset||offset!=offset)throw new TypeError("offset must be a number");if(kMaxUint32<offset||offset<0)throw new TypeError("offset must be a uint32");if(kBufferMaxLength<offset||length<offset)throw new RangeError("offset out of range")}function assertSize(size,offset,length){if("number"!=typeof size||size!=size)throw new TypeError("size must be a number");if(kMaxUint32<size||size<0)throw new TypeError("size must be a uint32");if(length<size+offset||kBufferMaxLength<size)throw new RangeError("buffer too small")}function actualFill(buf,offset,size,cb){var ourBuf;if(process.browser)return ourBuf=buf.buffer,ourBuf=new Uint8Array(ourBuf,offset,size),crypto.getRandomValues(ourBuf),cb?void process.nextTick(function(){cb(null,buf)}):buf;{if(!cb)return randombytes(size).copy(buf,offset),buf;randombytes(size,function(err,bytes){if(err)return cb(err);bytes.copy(buf,offset),cb(null,buf)})}}crypto&&crypto.getRandomValues||!process.browser?(exports.randomFill=function(buf,offset,size,cb){if(!(Buffer.isBuffer(buf)||buf instanceof global.Uint8Array))throw new TypeError('"buf" argument must be a Buffer or Uint8Array');if("function"==typeof offset)cb=offset,offset=0,size=buf.length;else if("function"==typeof size)cb=size,size=buf.length-offset;else if("function"!=typeof cb)throw new TypeError('"cb" argument must be a function');return assertOffset(offset,buf.length),assertSize(size,offset,buf.length),actualFill(buf,offset,size,cb)},exports.randomFillSync=function(buf,offset,size){void 0===offset&&(offset=0);if(!(Buffer.isBuffer(buf)||buf instanceof global.Uint8Array))throw new TypeError('"buf" argument must be a Buffer or Uint8Array');assertOffset(offset,buf.length),void 0===size&&(size=buf.length-offset);return assertSize(size,offset,buf.length),actualFill(buf,offset,size)}):(exports.randomFill=oldBrowser,exports.randomFillSync=oldBrowser)}.call(this)}.call(this,require("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{_process:354,randombytes:363,"safe-buffer":367}],365:[function(require,module,exports){"use strict";var Buffer=require("buffer").Buffer,inherits=require("inherits"),HashBase=require("hash-base"),ARRAY16=new Array(16),zl=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13],zr=[5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11],sl=[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6],sr=[8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11],hl=[0,1518500249,1859775393,2400959708,2840853838],hr=[1352829926,1548603684,1836072691,2053994217,0];function RIPEMD160(){HashBase.call(this,64),this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878,this._e=3285377520}function rotl(x,n){return x<<n|x>>>32-n}function fn1(a,b,c,d,e,m,k,s){return rotl(a+(b^c^d)+m+k|0,s)+e|0}function fn2(a,b,c,d,e,m,k,s){return rotl(a+(b&c|~b&d)+m+k|0,s)+e|0}function fn3(a,b,c,d,e,m,k,s){return rotl(a+((b|~c)^d)+m+k|0,s)+e|0}function fn4(a,b,c,d,e,m,k,s){return rotl(a+(b&d|c&~d)+m+k|0,s)+e|0}function fn5(a,b,c,d,e,m,k,s){return rotl(a+(b^(c|~d))+m+k|0,s)+e|0}inherits(RIPEMD160,HashBase),RIPEMD160.prototype._update=function(){for(var words=ARRAY16,j=0;j<16;++j)words[j]=this._block.readInt32LE(4*j);for(var al=0|this._a,bl=0|this._b,cl=0|this._c,dl=0|this._d,el=0|this._e,ar=0|this._a,br=0|this._b,cr=0|this._c,dr=0|this._d,er=0|this._e,i=0;i<80;i+=1)var tl,tr=i<16?(tl=fn1(al,bl,cl,dl,el,words[zl[i]],hl[0],sl[i]),fn5(ar,br,cr,dr,er,words[zr[i]],hr[0],sr[i])):i<32?(tl=fn2(al,bl,cl,dl,el,words[zl[i]],hl[1],sl[i]),fn4(ar,br,cr,dr,er,words[zr[i]],hr[1],sr[i])):i<48?(tl=fn3(al,bl,cl,dl,el,words[zl[i]],hl[2],sl[i]),fn3(ar,br,cr,dr,er,words[zr[i]],hr[2],sr[i])):i<64?(tl=fn4(al,bl,cl,dl,el,words[zl[i]],hl[3],sl[i]),fn2(ar,br,cr,dr,er,words[zr[i]],hr[3],sr[i])):(tl=fn5(al,bl,cl,dl,el,words[zl[i]],hl[4],sl[i]),fn1(ar,br,cr,dr,er,words[zr[i]],hr[4],sr[i])),al=el,el=dl,dl=rotl(cl,10),cl=bl,bl=tl,ar=er,er=dr,dr=rotl(cr,10),cr=br,br=tr;var t=this._b+cl+dr|0;this._b=this._c+dl+er|0,this._c=this._d+el+ar|0,this._d=this._e+al+br|0,this._e=this._a+bl+cr|0,this._a=t},RIPEMD160.prototype._digest=function(){this._block[this._blockOffset++]=128,56<this._blockOffset&&(this._block.fill(0,this._blockOffset,64),this._update(),this._blockOffset=0),this._block.fill(0,this._blockOffset,56),this._block.writeUInt32LE(this._length[0],56),this._block.writeUInt32LE(this._length[1],60),this._update();var buffer=Buffer.alloc?Buffer.alloc(20):new Buffer(20);return buffer.writeInt32LE(this._a,0),buffer.writeInt32LE(this._b,4),buffer.writeInt32LE(this._c,8),buffer.writeInt32LE(this._d,12),buffer.writeInt32LE(this._e,16),buffer},module.exports=RIPEMD160},{buffer:112,"hash-base":189,inherits:220}],366:[function(require,module,exports){module.exports=function(tasks,limit,cb){if("number"!=typeof limit)throw new Error("second argument must be a Number");let results,len,pending,keys,isErrored,isSync=!0,next;pending=len=Array.isArray(tasks)?(results=[],tasks.length):(keys=Object.keys(tasks),results={},keys.length);function done(err){function end(){cb&&cb(err,results),cb=null}isSync?queueMicrotask(end):end()}function each(i,err,result){if(results[i]=result,err&&(isErrored=!0),0==--pending||err)done(err);else if(!isErrored&&next<len){let key;key=keys?keys[next]:next,next+=1,tasks[key](function(err,result){each(key,err,result)})}}next=limit,pending?keys?keys.some(function(key,i){return tasks[key](function(err,result){each(key,err,result)}),i===limit-1}):tasks.some(function(task,i){return task(function(err,result){each(i,err,result)}),i===limit-1}):done(null);isSync=!1};const queueMicrotask=require("queue-microtask")},{"queue-microtask":362}],367:[function(require,module,exports){var buffer=require("buffer"),Buffer=buffer.Buffer;function copyProps(src,dst){for(var key in src)dst[key]=src[key]}function SafeBuffer(arg,encodingOrOffset,length){return Buffer(arg,encodingOrOffset,length)}Buffer.from&&Buffer.alloc&&Buffer.allocUnsafe&&Buffer.allocUnsafeSlow?module.exports=buffer:(copyProps(buffer,exports),exports.Buffer=SafeBuffer),copyProps(Buffer,SafeBuffer),SafeBuffer.from=function(arg,encodingOrOffset,length){if("number"==typeof arg)throw new TypeError("Argument must not be a number");return Buffer(arg,encodingOrOffset,length)},SafeBuffer.alloc=function(size,fill,encoding){if("number"!=typeof size)throw new TypeError("Argument must be a number");size=Buffer(size);return void 0!==fill?"string"==typeof encoding?size.fill(fill,encoding):size.fill(fill):size.fill(0),size},SafeBuffer.allocUnsafe=function(size){if("number"!=typeof size)throw new TypeError("Argument must be a number");return Buffer(size)},SafeBuffer.allocUnsafeSlow=function(size){if("number"!=typeof size)throw new TypeError("Argument must be a number");return buffer.SlowBuffer(size)}},{buffer:112}],368:[function(require,module,exports){!function(process){!function(){"use strict";var key,buffer=require("buffer"),Buffer=buffer.Buffer,safer={};for(key in buffer)buffer.hasOwnProperty(key)&&"SlowBuffer"!==key&&"Buffer"!==key&&(safer[key]=buffer[key]);var Safer=safer.Buffer={};for(key in Buffer)Buffer.hasOwnProperty(key)&&"allocUnsafe"!==key&&"allocUnsafeSlow"!==key&&(Safer[key]=Buffer[key]);if(safer.Buffer.prototype=Buffer.prototype,Safer.from&&Safer.from!==Uint8Array.from||(Safer.from=function(value,encodingOrOffset,length){if("number"==typeof value)throw new TypeError('The "value" argument must not be of type number. Received type '+typeof value);if(value&&void 0===value.length)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof value);return Buffer(value,encodingOrOffset,length)}),Safer.alloc||(Safer.alloc=function(size,fill,encoding){if("number"!=typeof size)throw new TypeError('The "size" argument must be of type number. Received type '+typeof size);if(size<0||2*(1<<30)<=size)throw new RangeError('The value "'+size+'" is invalid for option "size"');size=Buffer(size);return fill&&0!==fill.length?"string"==typeof encoding?size.fill(fill,encoding):size.fill(fill):size.fill(0),size}),!safer.kStringMaxLength)try{safer.kStringMaxLength=process.binding("buffer").kStringMaxLength}catch(e){}safer.constants||(safer.constants={MAX_LENGTH:safer.kMaxLength},safer.kStringMaxLength&&(safer.constants.MAX_STRING_LENGTH=safer.kStringMaxLength)),module.exports=safer}.call(this)}.call(this,require("_process"))},{_process:354,buffer:112}],369:[function(require,module,exports){var Buffer=require("safe-buffer").Buffer;function Hash(blockSize,finalSize){this._block=Buffer.alloc(blockSize),this._finalSize=finalSize,this._blockSize=blockSize,this._len=0}Hash.prototype.update=function(data,enc){"string"==typeof data&&(data=Buffer.from(data,enc=enc||"utf8"));for(var block=this._block,blockSize=this._blockSize,length=data.length,accum=this._len,offset=0;offset<length;){for(var assigned=accum%blockSize,remainder=Math.min(length-offset,blockSize-assigned),i=0;i<remainder;i++)block[assigned+i]=data[offset+i];offset+=remainder,(accum+=remainder)%blockSize==0&&this._update(block)}return this._len+=length,this},Hash.prototype.digest=function(enc){var rem=this._len%this._blockSize,rem=(this._block[rem]=128,this._block.fill(0,1+rem),rem>=this._finalSize&&(this._update(this._block),this._block.fill(0)),8*this._len),rem=(rem<=4294967295?this._block.writeUInt32BE(rem,this._blockSize-4):(this._block.writeUInt32BE((rem-(rem=(4294967295&rem)>>>0))/4294967296,this._blockSize-8),this._block.writeUInt32BE(rem,this._blockSize-4)),this._update(this._block),this._hash());return enc?rem.toString(enc):rem},Hash.prototype._update=function(){throw new Error("_update must be implemented by subclass")},module.exports=Hash},{"safe-buffer":367}],370:[function(require,module,exports){(exports=module.exports=function(algorithm){algorithm=algorithm.toLowerCase();var Algorithm=exports[algorithm];if(Algorithm)return new Algorithm;throw new Error(algorithm+" is not supported (we accept pull requests)")}).sha=require("./sha"),exports.sha1=require("./sha1"),exports.sha224=require("./sha224"),exports.sha256=require("./sha256"),exports.sha384=require("./sha384"),exports.sha512=require("./sha512")},{"./sha":371,"./sha1":372,"./sha224":373,"./sha256":374,"./sha384":375,"./sha512":376}],371:[function(require,module,exports){var inherits=require("inherits"),Hash=require("./hash"),Buffer=require("safe-buffer").Buffer,K=[1518500249,1859775393,-1894007588,-899497514],W=new Array(80);function Sha(){this.init(),this._w=W,Hash.call(this,64,56)}inherits(Sha,Hash),Sha.prototype.init=function(){return this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878,this._e=3285377520,this},Sha.prototype._update=function(M){for(var W=this._w,a=0|this._a,b=0|this._b,c=0|this._c,d=0|this._d,e=0|this._e,i=0;i<16;++i)W[i]=M.readInt32BE(4*i);for(;i<80;++i)W[i]=W[i-3]^W[i-8]^W[i-14]^W[i-16];for(var j=0;j<80;++j)var s=~~(j/20),s=0|(a<<5|a>>>27)+function(s,b,c,d){return 0===s?b&c|~b&d:2===s?b&c|b&d|c&d:b^c^d}(s,b,c,d)+e+W[j]+K[s],e=d,d=c,c=function(num){return num<<30|num>>>2}(b),b=a,a=s;this._a=a+this._a|0,this._b=b+this._b|0,this._c=c+this._c|0,this._d=d+this._d|0,this._e=e+this._e|0},Sha.prototype._hash=function(){var H=Buffer.allocUnsafe(20);return H.writeInt32BE(0|this._a,0),H.writeInt32BE(0|this._b,4),H.writeInt32BE(0|this._c,8),H.writeInt32BE(0|this._d,12),H.writeInt32BE(0|this._e,16),H},module.exports=Sha},{"./hash":369,inherits:220,"safe-buffer":367}],372:[function(require,module,exports){var inherits=require("inherits"),Hash=require("./hash"),Buffer=require("safe-buffer").Buffer,K=[1518500249,1859775393,-1894007588,-899497514],W=new Array(80);function Sha1(){this.init(),this._w=W,Hash.call(this,64,56)}inherits(Sha1,Hash),Sha1.prototype.init=function(){return this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878,this._e=3285377520,this},Sha1.prototype._update=function(M){for(var num,W=this._w,a=0|this._a,b=0|this._b,c=0|this._c,d=0|this._d,e=0|this._e,i=0;i<16;++i)W[i]=M.readInt32BE(4*i);for(;i<80;++i)W[i]=(num=W[i-3]^W[i-8]^W[i-14]^W[i-16])<<1|num>>>31;for(var j=0;j<80;++j)var s=~~(j/20),s=function(num){return num<<5|num>>>27}(a)+function(s,b,c,d){return 0===s?b&c|~b&d:2===s?b&c|b&d|c&d:b^c^d}(s,b,c,d)+e+W[j]+K[s]|0,e=d,d=c,c=function(num){return num<<30|num>>>2}(b),b=a,a=s;this._a=a+this._a|0,this._b=b+this._b|0,this._c=c+this._c|0,this._d=d+this._d|0,this._e=e+this._e|0},Sha1.prototype._hash=function(){var H=Buffer.allocUnsafe(20);return H.writeInt32BE(0|this._a,0),H.writeInt32BE(0|this._b,4),H.writeInt32BE(0|this._c,8),H.writeInt32BE(0|this._d,12),H.writeInt32BE(0|this._e,16),H},module.exports=Sha1},{"./hash":369,inherits:220,"safe-buffer":367}],373:[function(require,module,exports){var inherits=require("inherits"),Sha256=require("./sha256"),Hash=require("./hash"),Buffer=require("safe-buffer").Buffer,W=new Array(64);function Sha224(){this.init(),this._w=W,Hash.call(this,64,56)}inherits(Sha224,Sha256),Sha224.prototype.init=function(){return this._a=3238371032,this._b=914150663,this._c=812702999,this._d=4144912697,this._e=4290775857,this._f=1750603025,this._g=1694076839,this._h=3204075428,this},Sha224.prototype._hash=function(){var H=Buffer.allocUnsafe(28);return H.writeInt32BE(this._a,0),H.writeInt32BE(this._b,4),H.writeInt32BE(this._c,8),H.writeInt32BE(this._d,12),H.writeInt32BE(this._e,16),H.writeInt32BE(this._f,20),H.writeInt32BE(this._g,24),H},module.exports=Sha224},{"./hash":369,"./sha256":374,inherits:220,"safe-buffer":367}],374:[function(require,module,exports){var inherits=require("inherits"),Hash=require("./hash"),Buffer=require("safe-buffer").Buffer,K=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],W=new Array(64);function Sha256(){this.init(),this._w=W,Hash.call(this,64,56)}inherits(Sha256,Hash),Sha256.prototype.init=function(){return this._a=1779033703,this._b=3144134277,this._c=1013904242,this._d=2773480762,this._e=1359893119,this._f=2600822924,this._g=528734635,this._h=1541459225,this},Sha256.prototype._update=function(M){for(var x,W=this._w,a=0|this._a,b=0|this._b,c=0|this._c,d=0|this._d,e=0|this._e,f=0|this._f,g=0|this._g,h=0|this._h,i=0;i<16;++i)W[i]=M.readInt32BE(4*i);for(;i<64;++i)W[i]=0|(((x=W[i-2])>>>17|x<<15)^(x>>>19|x<<13)^x>>>10)+W[i-7]+function(x){return(x>>>7|x<<25)^(x>>>18|x<<14)^x>>>3}(W[i-15])+W[i-16];for(var j=0;j<64;++j)var T1=h+function(x){return(x>>>6|x<<26)^(x>>>11|x<<21)^(x>>>25|x<<7)}(e)+function(x,y,z){return z^x&(y^z)}(e,f,g)+K[j]+W[j]|0,T2=function(x){return(x>>>2|x<<30)^(x>>>13|x<<19)^(x>>>22|x<<10)}(a)+function(x,y,z){return x&y|z&(x|y)}(a,b,c)|0,h=g,g=f,f=e,e=d+T1|0,d=c,c=b,b=a,a=T1+T2|0;this._a=a+this._a|0,this._b=b+this._b|0,this._c=c+this._c|0,this._d=d+this._d|0,this._e=e+this._e|0,this._f=f+this._f|0,this._g=g+this._g|0,this._h=h+this._h|0},Sha256.prototype._hash=function(){var H=Buffer.allocUnsafe(32);return H.writeInt32BE(this._a,0),H.writeInt32BE(this._b,4),H.writeInt32BE(this._c,8),H.writeInt32BE(this._d,12),H.writeInt32BE(this._e,16),H.writeInt32BE(this._f,20),H.writeInt32BE(this._g,24),H.writeInt32BE(this._h,28),H},module.exports=Sha256},{"./hash":369,inherits:220,"safe-buffer":367}],375:[function(require,module,exports){var inherits=require("inherits"),SHA512=require("./sha512"),Hash=require("./hash"),Buffer=require("safe-buffer").Buffer,W=new Array(160);function Sha384(){this.init(),this._w=W,Hash.call(this,128,112)}inherits(Sha384,SHA512),Sha384.prototype.init=function(){return this._ah=3418070365,this._bh=1654270250,this._ch=2438529370,this._dh=355462360,this._eh=1731405415,this._fh=2394180231,this._gh=3675008525,this._hh=1203062813,this._al=3238371032,this._bl=914150663,this._cl=812702999,this._dl=4144912697,this._el=4290775857,this._fl=1750603025,this._gl=1694076839,this._hl=3204075428,this},Sha384.prototype._hash=function(){var H=Buffer.allocUnsafe(48);function writeInt64BE(h,l,offset){H.writeInt32BE(h,offset),H.writeInt32BE(l,offset+4)}return writeInt64BE(this._ah,this._al,0),writeInt64BE(this._bh,this._bl,8),writeInt64BE(this._ch,this._cl,16),writeInt64BE(this._dh,this._dl,24),writeInt64BE(this._eh,this._el,32),writeInt64BE(this._fh,this._fl,40),H},module.exports=Sha384},{"./hash":369,"./sha512":376,inherits:220,"safe-buffer":367}],376:[function(require,module,exports){var inherits=require("inherits"),Hash=require("./hash"),Buffer=require("safe-buffer").Buffer,K=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591],W=new Array(160);function Sha512(){this.init(),this._w=W,Hash.call(this,128,112)}function Ch(x,y,z){return z^x&(y^z)}function maj(x,y,z){return x&y|z&(x|y)}function sigma0(x,xl){return(x>>>28|xl<<4)^(xl>>>2|x<<30)^(xl>>>7|x<<25)}function sigma1(x,xl){return(x>>>14|xl<<18)^(x>>>18|xl<<14)^(xl>>>9|x<<23)}function getCarry(a,b){return a>>>0<b>>>0?1:0}inherits(Sha512,Hash),Sha512.prototype.init=function(){return this._ah=1779033703,this._bh=3144134277,this._ch=1013904242,this._dh=2773480762,this._eh=1359893119,this._fh=2600822924,this._gh=528734635,this._hh=1541459225,this._al=4089235720,this._bl=2227873595,this._cl=4271175723,this._dl=1595750129,this._el=2917565137,this._fl=725511199,this._gl=4215389547,this._hl=327033209,this},Sha512.prototype._update=function(M){for(var W=this._w,ah=0|this._ah,bh=0|this._bh,ch=0|this._ch,dh=0|this._dh,eh=0|this._eh,fh=0|this._fh,gh=0|this._gh,hh=0|this._hh,al=0|this._al,bl=0|this._bl,cl=0|this._cl,dl=0|this._dl,el=0|this._el,fl=0|this._fl,gl=0|this._gl,hl=0|this._hl,i=0;i<32;i+=2)W[i]=M.readInt32BE(4*i),W[i+1]=M.readInt32BE(4*i+4);for(;i<160;i+=2){var xh=W[i-30],xl=W[i-30+1],gamma0=function(x,xl){return(x>>>1|xl<<31)^(x>>>8|xl<<24)^x>>>7}(xh,xl),gamma0l=function(x,xl){return(x>>>1|xl<<31)^(x>>>8|xl<<24)^(x>>>7|xl<<25)}(xl,xh),gamma1=function(x,xl){return(x>>>19|xl<<13)^(xl>>>29|x<<3)^x>>>6}(xh=W[i-4],xl=W[i-4+1]),xl=function(x,xl){return(x>>>19|xl<<13)^(xl>>>29|x<<3)^(x>>>6|xl<<26)}(xl,xh),xh=W[i-14],Wi7l=W[i-14+1],Wi16h=W[i-32],Wi16l=W[i-32+1],Wil=gamma0l+Wi7l|0,Wih=gamma0+xh+getCarry(Wil,gamma0l)|0;Wih=(Wih=Wih+gamma1+getCarry(Wil=Wil+xl|0,xl)|0)+Wi16h+getCarry(Wil=Wil+Wi16l|0,Wi16l)|0,W[i]=Wih,W[i+1]=Wil}for(var j=0;j<160;j+=2){Wih=W[j],Wil=W[j+1];var majh=maj(ah,bh,ch),majl=maj(al,bl,cl),sigma0h=sigma0(ah,al),sigma0l=sigma0(al,ah),sigma1h=sigma1(eh,el),sigma1l=sigma1(el,eh),Kil=K[j+1],chh=Ch(eh,fh,gh),chl=Ch(el,fl,gl),sigma1l=hl+sigma1l|0,chh=(sigma1h=(((hh+sigma1h+getCarry(sigma1l,hl)|0)+chh+getCarry(sigma1l=sigma1l+chl|0,chl)|0)+K[j]+getCarry(sigma1l=sigma1l+Kil|0,Kil)|0)+Wih+getCarry(sigma1l=sigma1l+Wil|0,Wil)|0,sigma0l+majl|0),chl=sigma0h+majh+getCarry(chh,sigma0l)|0,hh=gh,hl=gl,gh=fh,gl=fl,fh=eh,fl=el,eh=dh+sigma1h+getCarry(el=dl+sigma1l|0,dl)|0,dh=ch,dl=cl,ch=bh,cl=bl,bh=ah,bl=al,ah=sigma1h+chl+getCarry(al=sigma1l+chh|0,sigma1l)|0}this._al=this._al+al|0,this._bl=this._bl+bl|0,this._cl=this._cl+cl|0,this._dl=this._dl+dl|0,this._el=this._el+el|0,this._fl=this._fl+fl|0,this._gl=this._gl+gl|0,this._hl=this._hl+hl|0,this._ah=this._ah+ah+getCarry(this._al,al)|0,this._bh=this._bh+bh+getCarry(this._bl,bl)|0,this._ch=this._ch+ch+getCarry(this._cl,cl)|0,this._dh=this._dh+dh+getCarry(this._dl,dl)|0,this._eh=this._eh+eh+getCarry(this._el,el)|0,this._fh=this._fh+fh+getCarry(this._fl,fl)|0,this._gh=this._gh+gh+getCarry(this._gl,gl)|0,this._hh=this._hh+hh+getCarry(this._hl,hl)|0},Sha512.prototype._hash=function(){var H=Buffer.allocUnsafe(64);function writeInt64BE(h,l,offset){H.writeInt32BE(h,offset),H.writeInt32BE(l,offset+4)}return writeInt64BE(this._ah,this._al,0),writeInt64BE(this._bh,this._bl,8),writeInt64BE(this._ch,this._cl,16),writeInt64BE(this._dh,this._dl,24),writeInt64BE(this._eh,this._el,32),writeInt64BE(this._fh,this._fl,40),writeInt64BE(this._gh,this._gl,48),writeInt64BE(this._hh,this._hl,56),H},module.exports=Sha512},{"./hash":369,inherits:220,"safe-buffer":367}],377:[function(require,module,exports){"use strict";var Buffer=require("safe-buffer").Buffer,isEncoding=Buffer.isEncoding||function(encoding){switch((encoding=""+encoding)&&encoding.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function normalizeEncoding(enc){var nenc=function(enc){if(!enc)return"utf8";for(var retried;;)switch(enc){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return enc;default:if(retried)return;enc=(""+enc).toLowerCase(),retried=!0}}(enc);if("string"==typeof nenc||Buffer.isEncoding!==isEncoding&&isEncoding(enc))return nenc||enc;throw new Error("Unknown encoding: "+enc)}function StringDecoder(encoding){var nb;switch(this.encoding=normalizeEncoding(encoding),this.encoding){case"utf16le":this.text=utf16Text,this.end=utf16End,nb=4;break;case"utf8":this.fillLast=utf8FillLast,nb=4;break;case"base64":this.text=base64Text,this.end=base64End,nb=3;break;default:return this.write=simpleWrite,void(this.end=simpleEnd)}this.lastNeed=0,this.lastTotal=0,this.lastChar=Buffer.allocUnsafe(nb)}function utf8CheckByte(byte){return byte<=127?0:byte>>5==6?2:byte>>4==14?3:byte>>3==30?4:byte>>6==2?-1:-2}function utf8FillLast(buf){var p=this.lastTotal-this.lastNeed,r=function(self,buf){return 128!=(192&buf[0])?(self.lastNeed=0,"�"):1<self.lastNeed&&1<buf.length?128!=(192&buf[1])?(self.lastNeed=1,"�"):2<self.lastNeed&&2<buf.length&&128!=(192&buf[2])?(self.lastNeed=2,"�"):void 0:void 0}(this,buf);return void 0!==r?r:this.lastNeed<=buf.length?(buf.copy(this.lastChar,p,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(buf.copy(this.lastChar,p,0,buf.length),void(this.lastNeed-=buf.length))}function utf16Text(buf,i){if((buf.length-i)%2!=0)return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=buf[buf.length-1],buf.toString("utf16le",i,buf.length-1);i=buf.toString("utf16le",i);if(i){var c=i.charCodeAt(i.length-1);if(55296<=c&&c<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=buf[buf.length-2],this.lastChar[1]=buf[buf.length-1],i.slice(0,-1)}return i}function utf16End(buf){var end,buf=buf&&buf.length?this.write(buf):"";return this.lastNeed?(end=this.lastTotal-this.lastNeed,buf+this.lastChar.toString("utf16le",0,end)):buf}function base64Text(buf,i){var n=(buf.length-i)%3;return 0==n?buf.toString("base64",i):(this.lastNeed=3-n,this.lastTotal=3,1==n?this.lastChar[0]=buf[buf.length-1]:(this.lastChar[0]=buf[buf.length-2],this.lastChar[1]=buf[buf.length-1]),buf.toString("base64",i,buf.length-n))}function base64End(buf){buf=buf&&buf.length?this.write(buf):"";return this.lastNeed?buf+this.lastChar.toString("base64",0,3-this.lastNeed):buf}function simpleWrite(buf){return buf.toString(this.encoding)}function simpleEnd(buf){return buf&&buf.length?this.write(buf):""}(exports.StringDecoder=StringDecoder).prototype.write=function(buf){if(0===buf.length)return"";var r,i;if(this.lastNeed){if(void 0===(r=this.fillLast(buf)))return"";i=this.lastNeed,this.lastNeed=0}else i=0;return i<buf.length?r?r+this.text(buf,i):this.text(buf,i):r||""},StringDecoder.prototype.end=function(buf){buf=buf&&buf.length?this.write(buf):"";return this.lastNeed?buf+"�":buf},StringDecoder.prototype.text=function(buf,i){var total=function(self,buf,i){var j=buf.length-1;if(j<i)return 0;var nb=utf8CheckByte(buf[j]);if(0<=nb)return 0<nb&&(self.lastNeed=nb-1),nb;if(--j<i||-2===nb)return 0;if(0<=(nb=utf8CheckByte(buf[j])))return 0<nb&&(self.lastNeed=nb-2),nb;if(--j<i||-2===nb)return 0;if(0<=(nb=utf8CheckByte(buf[j])))return 0<nb&&(2===nb?nb=0:self.lastNeed=nb-3),nb;return 0}(this,buf,i);if(!this.lastNeed)return buf.toString("utf8",i);this.lastTotal=total;total=buf.length-(total-this.lastNeed);return buf.copy(this.lastChar,0,total),buf.toString("utf8",i,total)},StringDecoder.prototype.fillLast=function(buf){if(this.lastNeed<=buf.length)return buf.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);buf.copy(this.lastChar,this.lastTotal-this.lastNeed,0,buf.length),this.lastNeed-=buf.length}},{"safe-buffer":367}],378:[function(require,module,exports){!function(global){!function(){function config(name){try{if(!global.localStorage)return}catch(_){return}name=global.localStorage[name];return null!=name&&"true"===String(name).toLowerCase()}module.exports=function(fn,msg){if(config("noDeprecation"))return fn;var warned=!1;return function(){if(!warned){if(config("throwDeprecation"))throw new Error(msg);config("traceDeprecation")?console.trace(msg):console.warn(msg),warned=!0}return fn.apply(this,arguments)}}}.call(this)}.call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],379:[function(require,module,exports){!function(global){!function(){"use strict";var forEach=require("for-each"),availableTypedArrays=require("available-typed-arrays"),callBound=require("call-bind/callBound"),$toString=callBound("Object.prototype.toString"),hasToStringTag=require("has-tostringtag/shams")(),g="undefined"==typeof globalThis?global:globalThis,availableTypedArrays=availableTypedArrays(),$slice=callBound("String.prototype.slice"),toStrTags={},gOPD=require("es-abstract/helpers/getOwnPropertyDescriptor"),getPrototypeOf=Object.getPrototypeOf,isTypedArray=(hasToStringTag&&gOPD&&getPrototypeOf&&forEach(availableTypedArrays,function(typedArray){var arr,descriptor;"function"==typeof g[typedArray]&&(arr=new g[typedArray],Symbol.toStringTag in arr&&(arr=getPrototypeOf(arr),(descriptor=gOPD(arr,Symbol.toStringTag))||(arr=getPrototypeOf(arr),descriptor=gOPD(arr,Symbol.toStringTag)),toStrTags[typedArray]=descriptor.get))}),require("is-typed-array"));module.exports=function(value){return!!isTypedArray(value)&&(hasToStringTag&&Symbol.toStringTag in value?function(value){var foundName=!1;return forEach(toStrTags,function(getter,typedArray){if(!foundName)try{var name=getter.call(value);name===typedArray&&(foundName=name)}catch(e){}}),foundName}(value):$slice($toString(value),8,-1))}}.call(this)}.call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"available-typed-arrays":64,"call-bind/callBound":132,"es-abstract/helpers/getOwnPropertyDescriptor":177,"for-each":181,"has-tostringtag/shams":187,"is-typed-array":226}],380:[function(require,module,exports){"use strict";module.exports=function(){throw new Error("ws does not work in the browser. Browser clients must use the native WebSocket object")}},{}]},{},[1])(1)});
